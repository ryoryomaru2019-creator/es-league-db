
<!-- 
  ========================================
  eS League DB Pro 2026
  Version: v52.179 Phase 4.22 Sprint3-FIXED + BugFix
  Date: 2026-02-23
  Features:
    - 選手データ一括インポート（CSV/JSON対応）
    - チーム自動マッチング（あいまい一致）
    - インポートプレビュー機能
    - 重複チェック機能
    - ✅ AI一括自動解析（動作保証版）
  ========================================
-->

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eS League DB Pro 2026 v52.177 Phase 4.22 Sprint3-FIXED</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>

        /* ============================================ */
           CSS変数定義（ライト/ダークモード）
           参考: https://www.webcreatorbox.com/blog/dark-mode
           ============================================ */
        
        :root {
            /* 背景色 */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            
            /* テキスト色 */
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-tertiary: #94a3b8;
            
            /* 境界線 */
            --border-color: #e2e8f0;
            --border-light: #f1f5f9;
            
            /* 影 */
            --shadow: rgba(0, 0, 0, 0.1);
            --shadow-heavy: rgba(0, 0, 0, 0.3);
            --overlay: rgba(15, 23, 42, 0.8);
            
            /* アクセントカラー */
            --accent-emerald: #10b981;
            --accent-purple: #8b5cf6;
            --accent-amber: #f59e0b;
            --accent-red: #ef4444;
            
            /* 入力欄 */
            --input-bg: #f1f5f9;
            --input-border: #e2e8f0;
            
            /* モーダル */
            --modal-bg: #ffffff;  /* モーダル背景 */
        }
        
        /* ダークモード設定 */
        [data-theme="dark"] {
            /* 背景色 */
            --bg-primary: #0f172a;        /* カード背景 - 白を維持 */
            --bg-secondary: #0f172a;      /* メイン背景 - 濃紺 */
            --bg-tertiary: #1e293b;       /* サブ背景 - ダークグレー */
            
            /* テキスト色 */
            --text-primary: #f1f5f9;      /* メインテキスト - オフホワイト */
            --text-secondary: #cbd5e1;    /* サブテキスト - ライトグレー */
            --text-tertiary: #94a3b8;     /* 第3テキスト */
            
            /* 境界線 */
            --border-color: #334155;
            --border-light: #475569;
            
            /* 影 */
            --shadow: rgba(0, 0, 0, 0.5);
            --shadow-heavy: rgba(0, 0, 0, 0.8);
            --overlay: rgba(0, 0, 0, 0.9);
            
            /* アクセントカラー（明るく） */
            --accent-emerald: #34d399;
            --accent-purple: #a78bfa;
            --accent-amber: #fbbf24;
            --accent-red: #f87171;
            
            /* 入力欄 */
            --input-bg: #1e293b;
            --input-border: #475569;
            
            /* モーダル */
            --modal-bg: #1e293b;  /* ダークモード: 暗い背景 */
        }

        /* ============================================
           ダークモード CSS変数とスタイル
           ============================================ */
        
        /* ライトモード（デフォルト） */
        
        
        /* ダークモード */
        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;
            --border-color: #334155;
            --border-light: #475569;
            --shadow: rgba(0, 0, 0, 0.5);
            --shadow-heavy: rgba(0, 0, 0, 0.8);
            --overlay: rgba(0, 0, 0, 0.9);
            --accent-emerald: #34d399;
            --accent-purple: #a78bfa;
            --accent-amber: #fbbf24;
            --accent-red: #f87171;
            --input-bg: #1e293b;
            --input-border: #475569;
            --modal-bg: #1e293b;  /* ダークモード: 暗い背景 */
        }
        
        
        /* ============================================
           強力なダークモードスタイル（Tailwind上書き）
           ============================================ */
        
        /* すべての白背景要素を上書き */
        [data-theme="dark"] .bg-white,
        [data-theme="dark"] [class*="bg-white"] {
            background-color: var(--bg-secondary) !important;
        }
        
        /* ===== すべての主要要素への強制適用 ===== */
        [data-theme="dark"] #app,
        [data-theme="dark"] main,
        [data-theme="dark"] section,
        [data-theme="dark"] div:not(.modal-overlay):not([class*="emerald"]):not([class*="purple"]):not([class*="status"]) {
            background-color: var(--bg-secondary) !important;
            color: var(--text-primary) !important;
        }
        
        [data-theme="dark"] header {
            background-color: var(--bg-tertiary) !important;
            color: var(--text-primary) !important;
        }
        
        [data-theme="dark"] .table-container {
            background-color: var(--bg-primary) !important;
        }
        
        [data-theme="dark"] table {
            background-color: var(--bg-primary) !important;
        }
        
        [data-theme="dark"] thead,
        [data-theme="dark"] th {
            background-color: var(--bg-tertiary) !important;
            color: var(--text-primary) !important;
        }
        
        [data-theme="dark"] tbody,
        [data-theme="dark"] td {
            background-color: var(--bg-primary) !important;
            color: var(--text-primary) !important;
            border-color: var(--border-color) !important;
        }

        
        [data-theme="dark"] .bg-slate-50,
        [data-theme="dark"] [class*="bg-slate-50"] {
            background-color: var(--bg-tertiary) !important;
        }
        
        [data-theme="dark"] .bg-slate-100,
        [data-theme="dark"] [class*="bg-slate-100"] {
            background-color: var(--bg-tertiary) !important;
        }
        
        /* すべての境界線 */
        [data-theme="dark"] .border-slate-100,
        [data-theme="dark"] .border-slate-200,
        [data-theme="dark"] [class*="border-slate"] {
            border-color: var(--border-color) !important;
        }
        
        /* テキスト色 */
        [data-theme="dark"] .text-slate-800,
        [data-theme="dark"] .text-slate-700,
        [data-theme="dark"] .text-slate-600 {
            color: var(--text-primary) !important;
        }
        
        [data-theme="dark"] .text-slate-400,
        [data-theme="dark"] .text-slate-500 {
            color: var(--text-secondary) !important;
        }
        
        /* 入力欄（より具体的なセレクタ） */
        [data-theme="dark"] input[type="text"],
        [data-theme="dark"] input[type="password"],
        [data-theme="dark"] input[type="number"],
        [data-theme="dark"] input[type="email"],
        [data-theme="dark"] textarea,
        [data-theme="dark"] select {
            background-color: var(--input-bg) !important;
            border-color: var(--input-border) !important;
            color: var(--text-primary) !important;
        }
        
        [data-theme="dark"] input::placeholder,
        [data-theme="dark"] textarea::placeholder {
            color: var(--text-tertiary) !important;
            opacity: 1;
        }
        
        /* ボタン（白背景のもの） */
        [data-theme="dark"] button.bg-white {
            background-color: var(--bg-tertiary) !important;
            color: var(--text-primary) !important;
        }
        
        /* テーブルヘッダー */
        [data-theme="dark"] thead {
            background-color: var(--bg-tertiary) !important;
        }
        
        [data-theme="dark"] thead th {
            color: var(--text-secondary) !important;
            background-color: transparent !important;
        }
        
        /* テーブル行の区切り */
        [data-theme="dark"] .divide-slate-50 > * + * {
            border-color: var(--border-color) !important;
        }
        
        /* ドロップダウン・セレクトボックス */
        [data-theme="dark"] select option {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
        }
        
        /* カード類 */
        [data-theme="dark"] [class*="rounded-"][class*="shadow"] {
            box-shadow: 0 4px 12px var(--shadow) !important;
        }
        
        /* アクセントカラーの背景（緑・紫・青など）は維持 */
        [data-theme="dark"] .bg-emerald-50,
        [data-theme="dark"] .bg-purple-50,
        [data-theme="dark"] .bg-indigo-600,
        [data-theme="dark"] .bg-emerald-600,
        [data-theme="dark"] .bg-slate-800 {
            /* これらは元の色を維持 */
        }
        
        /* ヘッダーのバージョンバッジ */
        [data-theme="dark"] .bg-emerald-600 {
            background-color: #059669 !important;
        }
        
        /* モーダルのAPIキー警告エリア */
        [data-theme="dark"] .bg-yellow-50,
        [data-theme="dark"] [style*="background: #fef3c7"] {
            background-color: #854d0e !important;
            border-color: #a16207 !important;
        }
        
        [data-theme="dark"] .text-yellow-800,
        [data-theme="dark"] [style*="color: #92400e"] {
            color: #fef3c7 !important;
        }
        
        /* ステータスバッジ */
        [data-theme="dark"] .status-active {
            background-color: #064e3b;
            color: #6ee7b7;
            border-color: #047857;
        }
        
        [data-theme="dark"] .status-left {
            background-color: #7f1d1d;
            color: #fca5a5;
            border-color: #991b1b;
        }
        
        [data-theme="dark"] .status-fa {
            background-color: var(--bg-tertiary);
            color: var(--text-secondary);
            border-color: var(--border-color);
        }
        
        /* ホバー効果 */
        [data-theme="dark"] tbody tr:hover {
            background-color: var(--bg-tertiary) !important;
        }
        
        [data-theme="dark"] .sortable:hover {
            background-color: var(--bg-secondary) !important;
        }
        
        /* ナビゲーション */
        [data-theme="dark"] nav {
            border-bottom-color: var(--border-color) !important;
        }
        
        /* スクロールバー */
        [data-theme="dark"] .custom-scrollbar::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }
        
        [data-theme="dark"] .custom-scrollbar::-webkit-scrollbar-thumb {
            background: var(--border-color);
        }
        
        /* フォーカス時の境界線 */
        [data-theme="dark"] input:focus,
        [data-theme="dark"] textarea:focus,
        [data-theme="dark"] select:focus {
            border-color: var(--accent-emerald) !important;
            background-color: var(--bg-secondary) !important;
        }
        
        /* インライン style 属性の上書き（重要） */
        [data-theme="dark"] div[style*="background: white"],
        [data-theme="dark"] div[style*="background: #fff"],
        [data-theme="dark"] div[style*="background: #ffffff"] {
            background-color: var(--bg-secondary) !important;
        }
        
        [data-theme="dark"] div[style*="background: #f7fafc"],
        [data-theme="dark"] div[style*="background: #f1f5f9"] {
            background-color: var(--bg-tertiary) !important;
        }

        
        /* ============================================
           重要な要素への明示的適用
           ============================================ */
        
        /* html背景 */
        html {
            background-color: var(--bg-secondary);
        }
        
        /* ヘッダー */
        header {
            background-color: transparent !important;
        }
        
        /* ナビゲーション */
        nav {
            background-color: transparent !important;
        }
        
        /* 段落・見出し */
        p, h1, h2, h3, h4, h5, h6, span, label {
            color: var(--text-primary);
        }
        
        /* リンク */
        a {
            color: var(--text-primary);
        }

        /* body と基本要素 */
        body {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* テーブルコンテナ */
        .table-container {
            background: var(--bg-primary);
            border-color: var(--border-color);
        }
        
        /* テーブル行 */
        th, td {
            border-bottom-color: var(--border-light);
            color: var(--text-primary);
        }
        
        th {
            background-color: var(--bg-tertiary);
        }
        
        tbody tr:hover {
            background-color: var(--bg-tertiary);
        }
        
        /* モーダルの背景をCSS変数で統一 */
        .modal-content,
        .modal-container {
            background: var(--modal-bg) !important;
            color: var(--text-primary) !important;
        }
        
        .modal-header {
            border-bottom-color: var(--border-color);
        }
        
        .modal-title {
            color: var(--text-primary);
        }
        
        /* 入力欄 */
        .input-box,
        input[type="text"],
        input[type="password"],
        input[type="number"],
        textarea,
        select {
            background: var(--input-bg) !important;
            border-color: var(--input-border) !important;
            color: var(--text-primary) !important;
        }
        
        input::placeholder,
        textarea::placeholder {
            color: var(--text-tertiary);
        }
        
        /* ボタン */
        .sortable:hover {
            background: var(--bg-tertiary);
        }
        
        /* ドロップゾーン */
        .drop-zone,
        #csv-drop-zone {
            background: var(--bg-tertiary) !important;
            border-color: var(--border-color) !important;
        }
        
        /* ヒストリーカード */
        .history-card {
            background: var(--bg-primary);
        }
        
        /* タブ */
        nav button {
            color: var(--text-secondary);
        }
        
        nav button:hover {
            color: var(--accent-emerald);
        }
        
        .tab-active {
            color: var(--accent-emerald) !important;
        }
        
        /* テーマトグルボタン */
        
        /* ============================================
           トグルスイッチ（ON/OFFスイッチ）
           ============================================ */
        
        #themeToggleContainer {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 50;
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            padding: 10px 16px;
            border-radius: 12px;
            box-shadow: 0 4px 12px var(--shadow);
            transition: all 0.3s ease;
        }
        
        #themeToggleContainer:hover {
            box-shadow: 0 6px 20px var(--shadow-heavy);
        }
        
        #themeToggleLabel {
            font-size: 14px;
            font-weight: bold;
            color: var(--text-primary);
            user-select: none;
            cursor: pointer;
        }
        
        /* トグルスイッチ本体 */
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 26px;
            background: #cbd5e1;
            border-radius: 34px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        /* スイッチのつまみ */
        .toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        /* ON状態（ダークモード） */
        .toggle-switch input:checked + .toggle-slider {
            transform: translateX(24px);
        }
        
        .toggle-switch input:checked ~ .toggle-slider {
            transform: translateX(24px);
        }
        
        [data-theme="dark"] .toggle-switch {
            background: #34d399;  /* 緑色でON状態を示す */
        }
        
        /* ホバー効果 */
        .toggle-switch:hover .toggle-slider {
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
        }

        
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@900&family=Noto+Sans+JP:wght@900&display=swap');
        
        * { font-family: 'Inter', 'Noto Sans JP', sans-serif; font-weight: 900 !important; font-style: italic !important; }
        body { 
            overflow-x: hidden; 
            background-color: var(--bg-secondary); 
            color: var(--text-primary); 
            margin: 0;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* ===== ダークモード: body要素への強制適用 ===== */

        /* ============================================================
           v52.174: 包括的ダークモード追加CSS
           ============================================================ */

        /* キューカード */
        [data-theme="dark"] .queue-card {
            background-color: var(--bg-secondary) !important;
            border-color: var(--border-color) !important;
            color: var(--text-primary) !important;
        }
        [data-theme="dark"] .queue-card.status-done {
            background-color: #052e16 !important;
            border-left-color: #34d399 !important;
        }
        [data-theme="dark"] .queue-card.status-error {
            background-color: #2d0a0a !important;
            border-left-color: #f87171 !important;
        }
        [data-theme="dark"] .queue-card.status-processing {
            background-color: #0c1a3e !important;
        }
        [data-theme="dark"] .queue-card.status-aborted {
            background-color: #2d1f00 !important;
        }
        /* キューカード内テキスト */
        [data-theme="dark"] .queue-card p,
        [data-theme="dark"] .queue-card span:not([class*="bg-"]):not([class*="text-green"]):not([class*="text-red"]):not([class*="text-blue"]):not([class*="text-amber"]) {
            color: var(--text-primary) !important;
        }
        [data-theme="dark"] .queue-card .text-gray-700,
        [data-theme="dark"] .queue-card .text-gray-800,
        [data-theme="dark"] .queue-card .text-gray-900,
        [data-theme="dark"] .queue-card .font-semibold,
        [data-theme="dark"] .queue-card .font-bold {
            color: var(--text-primary) !important;
        }
        [data-theme="dark"] .queue-card .text-gray-500,
        [data-theme="dark"] .queue-card .text-gray-400 {
            color: var(--text-secondary) !important;
        }
        /* キューカード hover */
        [data-theme="dark"] .queue-card:hover,
        [data-theme="dark"] .queue-card .hover\:bg-gray-50:hover {
            background-color: var(--bg-tertiary) !important;
        }
        /* ログエリア */
        [data-theme="dark"] .queue-card [class*="border-l-4"] {
            background-color: var(--bg-primary) !important;
            color: var(--text-secondary) !important;
        }
        /* 全般的な gray-* 系 */
        [data-theme="dark"] .bg-gray-50,
        [data-theme="dark"] .bg-gray-100,
        [data-theme="dark"] [class*="bg-gray-50"],
        [data-theme="dark"] [class*="bg-gray-100"] {
            background-color: var(--bg-tertiary) !important;
        }
        [data-theme="dark"] .bg-gray-200,
        [data-theme="dark"] [class*="bg-gray-200"] {
            background-color: #334155 !important;
        }
        [data-theme="dark"] .text-gray-700,
        [data-theme="dark"] .text-gray-800,
        [data-theme="dark"] .text-gray-900,
        [data-theme="dark"] [class*="text-gray-7"],
        [data-theme="dark"] [class*="text-gray-8"],
        [data-theme="dark"] [class*="text-gray-9"] {
            color: var(--text-primary) !important;
        }
        [data-theme="dark"] .text-gray-500,
        [data-theme="dark"] .text-gray-600,
        [data-theme="dark"] [class*="text-gray-5"],
        [data-theme="dark"] [class*="text-gray-6"] {
            color: var(--text-secondary) !important;
        }
        [data-theme="dark"] .border-gray-200,
        [data-theme="dark"] [class*="border-gray-"] {
            border-color: var(--border-color) !important;
        }
        /* マージモーダルダーク */
        [data-theme="dark"] #mergeConflictList,
        [data-theme="dark"] #cardMergeConflictList {
            background-color: var(--bg-primary) !important;
        }
        [data-theme="dark"] #mergeConflictList .bg-white,
        [data-theme="dark"] #cardMergeConflictList .bg-white {
            background-color: var(--bg-secondary) !important;
        }
        [data-theme="dark"] .bg-blue-50 { background-color: #0c1a3e !important; }
        [data-theme="dark"] .bg-orange-50 { background-color: #2d1500 !important; }
        [data-theme="dark"] .bg-red-50 { background-color: #2d0a0a !important; }
        [data-theme="dark"] .bg-emerald-50 { background-color: #052e16 !important; }
        [data-theme="dark"] .bg-amber-50,
        [data-theme="dark"] .bg-amber-25 { background-color: #2d1f00 !important; }
        /* ツールチップ */
        [data-theme="dark"] .tooltip-content {
            background-color: #1e293b !important;
            color: #f1f5f9 !important;
            border-color: #475569 !important;
        }
        /* DBバージョン履歴カード */
        [data-theme="dark"] .db-snapshot-card {
            background-color: var(--bg-secondary) !important;
            border-color: var(--border-color) !important;
            color: var(--text-primary) !important;
        }
        [data-theme="dark"] .db-snapshot-card.is-active {
            border-color: #34d399 !important;
        }
        [data-theme="dark"] .db-snapshot-card.is-past {
            border-color: #f87171 !important;
        }
        /* アドミンタブボタン */
        [data-theme="dark"] .admin-tab-btn {
            color: var(--text-secondary) !important;
        }
        [data-theme="dark"] .admin-tab-btn.active {
            color: var(--accent-emerald) !important;
            border-bottom-color: var(--accent-emerald) !important;
        }
        /* label-tag */
        [data-theme="dark"] .label-tag {
            background-color: var(--bg-tertiary) !important;
            color: var(--text-primary) !important;
            border-color: var(--border-color) !important;
        }

        [data-theme="dark"] body {
            background-color: var(--bg-secondary) !important;
            color: var(--text-primary) !important;
        }
        
        [data-theme="dark"] html {
            background-color: var(--bg-secondary) !important;
        }

        
        /* UI Components */
        .text-muted { color: #94a3b8; font-size: 10px; text-transform: uppercase; letter-spacing: 0.1em; }
        .tab-active { border-bottom: 4px solid #10b981; color: #10b981; }
        .subtab-active { background-color: #1e293b; color: white; }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        .table-container { width: 100%; overflow-x: auto; border-radius: 1.5rem; background: white; border: 1px solid #e2e8f0; -webkit-overflow-scrolling: touch; }
        .custom-scrollbar::-webkit-scrollbar { height: 8px; width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        
        th, td { padding: 1.25rem 1rem; border-bottom: 1px solid #f1f5f9; white-space: nowrap; font-size: 11px; }
        .sortable { cursor: pointer; user-select: none; transition: 0.2s; }
        .sortable:hover { background: #f1f5f9; color: #10b981; }
        
        .status-badge { padding: 4px 10px; border-radius: 6px; font-size: 10px; text-transform: uppercase; border: 1px solid; }
        .status-active { background-color: #dcfce7; color: #166534; border-color: #bbf7d0; }
        .status-left { background-color: #fee2e2; color: #991b1b; border-color: #fecaca; }
        .status-fa { background-color: #f3f4f6; color: #4b5563; border-color: #d1d5db; }

        .drop-zone { border: 4px dashed #e2e8f0; border-radius: 2rem; background: #f8fafc; cursor: pointer; min-height: 180px; position: relative; transition: 0.2s; }
        .drop-zone.drag-over { border-color: #10b981; background: #f0fdf4; }

        .modal-overlay { background: rgba(15, 23, 42, 0.8); overscroll-behavior: contain; }
        .input-box { background: #f1f5f9; border: 2px solid #e2e8f0; border-radius: 12px; padding: 12px; width: 100%; outline: none; }
        .input-box:focus { border-color: #10b981; background: white; }

        .history-card { border-left: 4px solid #10b981; background: white; padding: 1rem; border-radius: 0 1rem 1rem 0; margin-bottom: 1rem; }
        .diff-up { color: #10b981; font-size: 10px; }
        .diff-down { color: #ef4444; font-size: 10px; }

        .column-chip, .league-label-chip, .custom-label-chip { cursor: pointer; transition: 0.2s; user-select: none; border: 2px solid transparent; }
        .column-chip.active, .league-label-chip.selected, .custom-label-chip.selected { background-color: #10b981 !important; color: white !important; border-color: #059669; }

        .btn-analyzing { opacity: 0.7; pointer-events: none; }
        .log-item { border-left: 4px solid #e2e8f0; padding-left: 16px; margin-bottom: 12px; font-size: 11px; }
        .log-item.active { border-left-color: #6366f1; color: #6366f1; }
        .log-item.done { border-left-color: #10b981; color: #10b981; }
        .log-item.error { border-left-color: #ef4444; color: #ef4444; }

        /* Scanning Animation */
        @keyframes gradient-scan { 
            0% { background-position: 0% 50%; } 
            50% { background-position: 100% 50%; } 
            100% { background-position: 0% 50%; } 
        }
        .log-item.scanning {
            background: linear-gradient(270deg, #f0fdf4, #bbf7d0, #f0fdf4);
            background-size: 200% 200%;
            animation: gradient-scan 1.5s ease infinite;
            border-left-color: #10b981;
            color: #047857;
        }

        /* Resizer */
        #playersResizer { transition: background 0.2s; position: relative; z-index: 10; }
        #playersResizer:hover, .resizing #playersResizer { background-color: #10b981; }
        #playersResizer::after { content: '● ● ●'; position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); color: #cbd5e1; font-size: 8px; letter-spacing: 2px; }
        .resizing #playersResizer::after { color: white; }

        .thumb-grid { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 12px; }
        .thumb-item { position: relative; width: 60px; height: 60px; border-radius: 8px; overflow: hidden; border: 2px solid white; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .thumb-remove { position: absolute; top: 0; right: 0; background: rgba(239, 68, 68, 0.9); color: white; width: 16px; height: 16px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 12px; }
        
        .label-tag { background: #e0f2fe; color: #0369a1; padding: 2px 8px; border-radius: 4px; font-size: 9px; margin-right: 4px; border: 1px solid #bae6fd; }
        .label-tag.system-no-jersey { background: #f3f4f6; color: #6b7280; border-color: #e5e7eb; }
        .label-tag.system-fa { background: #f3f4f6; color: #4b5563; border-color: #9ca3af; border-style: dashed; }
        
        /* Tag Container for flex display of multiple special cards */
        .tag-container { display: flex; flex-wrap: wrap; gap: 4px; white-space: normal !important; min-width: 180px; max-width: 320px; }

        /* Admin Tabs */
        .admin-tab-btn { transition: all 0.2s; opacity: 0.5; border-bottom: 2px solid transparent; }
        .admin-tab-btn.active { opacity: 1; border-color: #10b981; color: #10b981; }
        
        /* Help Button Pulse */
        .help-pulse:hover { animation: pulse-blue 2s infinite; }
        @keyframes pulse-blue {
            0% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.7); }
            70% { box-shadow: 0 0 0 6px rgba(99, 102, 241, 0); }
            100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); }
        }

        /* Queue Card Styles Enhanced */
        .queue-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); border-left: 6px solid transparent; position: relative; overflow: hidden; }
        .queue-card.status-waiting { border-left-color: #cbd5e1; opacity: 0.8; }
        
        .queue-card.status-processing { 
            border-left-color: #6366f1; 
            background: linear-gradient(90deg, #ffffff, #f0f4ff, #ffffff); 
            background-size: 200% 100%;
            animation: cardScan 2s linear infinite;
            transform: scale(1.02); 
            box-shadow: 0 10px 15px -3px rgba(99, 102, 241, 0.2); 
            opacity: 1; 
            z-index: 10; 
        }
        @keyframes cardScan { 0% { background-position: 100% 0%; } 100% { background-position: -100% 0%; } }

        .queue-card.status-done { border-left-color: #10b981; background-color: #f0fdf4; opacity: 0.9; }
        .queue-card.status-error { border-left-color: #ef4444; background-color: #fef2f2; }
        .queue-card.status-aborted { border-left-color: #f59e0b; background-color: #fffbeb; opacity: 0.8; }

        /* Progress Bar */
        .progress-bar-container { width: 100%; height: 6px; background: #e2e8f0; border-radius: 99px; overflow: hidden; margin-bottom: 1rem; }
        .progress-bar-fill { height: 100%; background: #6366f1; transition: width 0.3s ease; border-radius: 99px; }

        /* Step Badge */
        .step-badge {
            font-size: 9px; padding: 2px 8px; border-radius: 12px; letter-spacing: 0.05em; text-transform: uppercase;
            background: #eef2ff; color: #4f46e5; border: 1px solid #c7d2fe;
            display: inline-flex; align-items: center; gap: 4px;
        }

        /* AI Mode Tabs */
        .ai-mode-btn { opacity: 0.6; transition: 0.2s; border-bottom: 2px solid transparent; }
        .ai-mode-btn.active { opacity: 1; color: #4f46e5; border-color: #4f46e5; }

        /* Metric Tab Buttons */
        .metric-tab { transition: all 0.2s; }
        .metric-tab.active { background-color: #10b981; color: white; border-color: #10b981; }
        .metric-tab.inactive { background-color: #f1f5f9; color: #94a3b8; }

        /* AI Table Style overrides */
        .ai-markdown-table { width: 100%; text-align: left; border-collapse: collapse; margin-top: 1rem; margin-bottom: 1.5rem; font-size: 11px; background: white; border-radius: 1rem; overflow: hidden; box-shadow: 0 1px 2px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; }
        .ai-markdown-table th { background-color: #eef2ff; color: #3730a3; padding: 12px 16px; text-transform: uppercase; font-size: 10px; border-bottom: 2px solid #c7d2fe; white-space: nowrap; }
        .ai-markdown-table td { padding: 12px 16px; border-bottom: 1px solid #f1f5f9; color: #334155; }
        .ai-markdown-table tr:hover { background-color: #f8fafc; }

        /* Card Progress UI */
        .card-spinner { border: 3px solid rgba(99, 102, 241, 0.2); border-left-color: currentColor; border-radius: 50%; width: 1.25rem; height: 1.25rem; animation: spin 1s linear infinite; display: inline-block; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .card-progress-container { width: 100%; height: 8px; background: rgba(0,0,0,0.05); border-radius: 99px; overflow: hidden; margin-top: 8px; }
        .card-progress-bar { height: 100%; transition: width 0.4s ease-out; border-radius: 99px; }
        
        /* Custom Checkbox Container */
        .l2-check-container { max-height: 80px; overflow-y: auto; display: flex; flex-wrap: wrap; gap: 4px; padding: 4px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; }

        /* Transfer/Left Player Row Style */
        .row-left-player { background-color: #f8fafc; color: #94a3b8; }
        .row-left-player:hover { background-color: #f1f5f9; color: #64748b; }
        .row-left-player td { border-bottom-color: #e2e8f0; }
        .badge-past-team { font-size: 8px; padding: 1px 6px; border: 1px solid #cbd5e1; color: #64748b; border-radius: 4px; margin-left: 4px; display: inline-block; }
    
/* ========== Phase 4.11.55 Modal CSS ========== */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1000;
    justify-content: center;
    align-items: center;
    opacity: 1 !important;
    visibility: hidden;
    pointer-events: none;
}

.modal.active {
    display: flex;
    visibility: visible !important;
    opacity: 1 !important;
    pointer-events: auto;
}

.modal-overlay {
    position: absolute;
    top: 0;
    left: 0;
}

.modal-container {
    position: relative;
    background: #1e293b;  /* 完全不透明の背景色 */
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    max-width: 90vw;
    max-height: 90vh;
    overflow: auto;
    z-index: 1002;
    opacity: 1 !important;
    visibility: visible !important;
    pointer-events: auto;
}


/* モーダルコンテンツの背景設定 */
.modal-content {
    position: relative;
    background: #ffffff;  /* 明るい白色背景 */
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    max-width: 90vw;
    max-height: 90vh;
    overflow: auto;
    z-index: 1002;
    opacity: 1 !important;
    visibility: visible !important;
    pointer-events: auto;
    color: #0f172a;  /* 濃い文字色 */
}


/* データインポートモーダルの視認性向上 */
#import-modal .modal-content {
    background: #ffffff !important;
}

/* データインポートモーダルの .modal-container も白背景に */
#import-modal .modal-container {
    background: #ffffff !important;
    color: #0f172a !important;
}


#import-modal .modal-body {
    color: #0f172a !important;
}

#import-modal textarea,
#import-modal input[type="file"] {
    background: #f8fafc !important;
    color: #0f172a !important;
    border: 2px solid #e2e8f0 !important;
}

#import-modal .tab-content {
    background: #ffffff !important;
    color: #0f172a !important;
}



.modal-header {
    padding: 1.5rem 2rem;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-title {
    font-size: 1.3rem;
    font-weight: 600;
}

.modal-close {
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    transition: color 0.2s;
}

.modal-body {
    padding: 2rem;
}
/* ========== Phase 4.11.55 CSS End ========== */


        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    
/* FIX-C: Selected player row highlight (v52.178 dark-mode強化) */
.player-row-selected {
    background: linear-gradient(90deg, rgba(99,102,241,0.18) 0%, rgba(16,185,129,0.14) 100%) !important;
    box-shadow: 0 0 0 3px rgba(99,102,241,0.55) inset, 0 2px 12px rgba(99,102,241,0.25);
    outline: none;
}
.player-row-selected td {
    border-top: 2px solid rgba(99,102,241,0.4) !important;
    border-bottom: 2px solid rgba(99,102,241,0.4) !important;
    color: inherit !important;
}
/* ダークモード専用の選手選択ハイライト */
[data-theme="dark"] .player-row-selected {
    background: linear-gradient(90deg, rgba(129,140,248,0.35) 0%, rgba(52,211,153,0.25) 100%) !important;
    box-shadow: 0 0 0 3px rgba(129,140,248,0.8) inset, 0 2px 16px rgba(129,140,248,0.4);
}
[data-theme="dark"] .player-row-selected td {
    border-top: 2px solid rgba(129,140,248,0.6) !important;
    border-bottom: 2px solid rgba(129,140,248,0.6) !important;
    color: #e2e8f0 !important;
    font-weight: 600;
}

    /* ═══════════════════════════════════════════════════════════
       Sprint 3 CSS: Parallel Badge, Player Detail Panel, Sparkline
       ═══════════════════════════════════════════════════════════ */
    .parallel-badge {
        display: inline-block;
        background: linear-gradient(135deg, #6366f1, #8b5cf6);
        color: white;
        font-size: 0.65rem;
        font-weight: 700;
        padding: 2px 8px;
        border-radius: 999px;
        vertical-align: middle;
        margin-left: 6px;
    }
    .parallel-badge.active {
        animation: pulse 1.5s ease-in-out infinite;
    }
    @keyframes pulse {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.7; transform: scale(1.05); }
    }
    #playerDetailPanel {
        position: fixed;
        top: 0;
        right: -420px;
        width: 420px;
        height: 100vh;
        background: white;
        box-shadow: -4px 0 24px rgba(0,0,0,0.15);
        z-index: 1000;
        overflow-y: auto;
        transition: right 0.3s ease;
        padding: 20px;
    }
    #playerDetailPanel.open {
        right: 0;
    }
    .detail-close-btn {
        position: absolute;
        top: 12px;
        right: 16px;
        background: none;
        border: none;
        font-size: 1.4rem;
        cursor: pointer;
        color: #64748b;
        line-height: 1;
    }
    .detail-close-btn:hover { color: #1e293b; }
    .history-sparkline {
        width: 100%;
        height: 60px;
        display: block;
    }
    .transfer-export-btn {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        border: none;
        padding: 6px 14px;
        border-radius: 6px;
        font-size: 0.8rem;
        font-weight: 600;
        cursor: pointer;
        transition: opacity 0.2s;
    }
    .transfer-export-btn:hover { opacity: 0.85; }
    .api-key-row {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 6px 10px;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 6px;
        margin-bottom: 4px;
    }
    .api-key-label { flex: 1; font-size: 0.8rem; color: #475569; }
    .api-key-status {
        width: 8px; height: 8px;
        border-radius: 50%;
        background: #22c55e;
    }
    .api-key-status.inactive { background: #94a3b8; }
    .api-key-toggle, .api-key-remove {
        padding: 2px 8px;
        border-radius: 4px;
        border: 1px solid #cbd5e1;
        background: white;
        font-size: 0.7rem;
        cursor: pointer;
    }
    .api-key-remove { color: #ef4444; border-color: #fca5a5; }
    [data-theme="dark"] #playerDetailPanel {
        background: #1e293b;
        color: #e2e8f0;
    }
    [data-theme="dark"] .api-key-row {
        background: #334155;
        border-color: #475569;
    }

/* v52.178: シェイクアニメーション（エラー時） */
@keyframes shake {
    0%, 100% { transform: translateX(0); }
    15%       { transform: translateX(-6px); }
    30%       { transform: translateX(6px); }
    45%       { transform: translateX(-4px); }
    60%       { transform: translateX(4px); }
    75%       { transform: translateX(-2px); }
}
.shake-anim { animation: shake 0.5s ease-in-out; }
/* ── v52.181: リーグ年度フィールド強調スタイル ── */
.league-year-badge {
  font-style: italic;
  font-weight: 800;
  color: #4f46e5;
  background: linear-gradient(135deg, #eef2ff, #e0e7ff);
  border: 1px solid #c7d2fe;
  border-radius: 6px;
  padding: 2px 8px;
  font-size: 0.85rem;
  letter-spacing: 0.03em;
  display: inline-block;
  min-width: 36px;
  text-align: center;
}
.league-year-input {
  font-style: italic;
  font-weight: 800;
  color: #4338ca;
  text-align: center;
}
.league-label-display {
  display: flex;
  align-items: center;
  gap: 4px;
  flex-wrap: wrap;
}
.league-season-badge {
  font-weight: 700;
  color: #0f172a;
  background: #f1f5f9;
  border: 1px solid #e2e8f0;
  border-radius: 4px;
  padding: 1px 6px;
  font-size: 0.75rem;
}
.league-cat-badge {
  font-weight: 600;
  color: #374151;
  font-size: 0.75rem;
}
.league-div-badge {
  font-weight: 700;
  color: white;
  background: #10b981;
  border-radius: 4px;
  padding: 1px 6px;
  font-size: 0.7rem;
}
.league-div-badge.op {
  background: #f59e0b;
}
.league-form-grid {
  display: grid;
  grid-template-columns: 60px 70px 1fr 80px;
  gap: 6px;
  align-items: end;
}
.league-form-preview {
  background: linear-gradient(135deg, #f8fafc, #f1f5f9);
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 8px 12px;
  font-size: 0.72rem;
  color: #475569;
  min-height: 36px;
  display: flex;
  align-items: center;
  gap: 4px;
  flex-wrap: wrap;
}


/* ── v52.180 FIX-D: 統合検索フォームCSSスタイル ── */
.unified-search-wrap {
  position: relative;
  display: inline-flex;
  align-items: center;
  min-width: 280px;
}
.unified-search-wrap input {
  width: 100%;
  padding: 0.6rem 4.5rem 0.6rem 2.2rem;
}
.search-icon {
  position: absolute;
  left: 0.55rem;
  font-size: 0.85rem;
  pointer-events: none;
  z-index: 1;
  line-height: 1;
}
.search-kbd {
  position: absolute;
  right: 2.2rem;
  font-size: 0.6rem;
  color: #94a3b8;
  background: #f1f5f9;
  border: 1px solid #cbd5e1;
  border-radius: 4px;
  padding: 1px 4px;
  pointer-events: none;
  white-space: nowrap;
}
.search-clear {
  position: absolute;
  right: 0.55rem;
  background: none;
  border: none;
  font-size: 1rem;
  color: #94a3b8;
  cursor: pointer;
  padding: 0 2px;
  line-height: 1;
  display: flex;
  align-items: center;
  justify-content: center;
}
.search-clear:hover { color: #475569; }
.search-hint {
  position: absolute;
  top: calc(100% + 4px);
  left: 0;
  background: white;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  padding: 6px 10px;
  font-size: 0.7rem;
  color: #64748b;
  white-space: nowrap;
  z-index: 100;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}
.search-hint code {
  background: #f1f5f9;
  border-radius: 3px;
  padding: 1px 4px;
  font-size: 0.68rem;
  color: #334155;
}

</style>
<script>
// ========== v52.163.2: ラベル生成関数を最上位に移動 ==========
// v52.164: 連番管理は今後対応予定
// 現在は記事ごとに独立してラベル生成されるため、同じイベント名でも常に01になる
// 解決策: cardAutoQueue全体をスキャンして同じrawTitleの出現回数をカウント

// v52.174: Sequential number helper for same-title articles
function _getSequentialNumber(articleTitle, publishDate) {
  if (typeof cardAutoQueue === 'undefined' || !cardAutoQueue) return '01';
  const normTitle = (articleTitle || '').toLowerCase().replace(/\s+/g, ' ').trim();
  // Count how many items in queue have the same normalized rawTitle
  let count = 0;
  for (const item of cardAutoQueue) {
    const itemTitle = ((item.rawTitle || item.eventName) || '').toLowerCase().replace(/\s+/g, ' ').trim();
    if (itemTitle && itemTitle === normTitle) count++;
  }
  return String(Math.max(1, count + 1)).padStart(2, '0');
}

function generateCardLabel(articleTitle, publishDate) {
  console.log("[v52.174] generateCardLabel:", {articleTitle, publishDate});
  
  // v52.174: パターン0: "EAFC26 eS-League 17th CLUBS JAPAN" 形式
  // → "17th CJPN 01" (連番は既存カウントから自動生成)
  let matchCJPN = articleTitle.match(/EAFC\d+\s+eS-League\s+(\d+)th\s+CLUBS\s+JAPAN/i);
  if (!matchCJPN) matchCJPN = articleTitle.match(/(\d+)th\s+CLUBS\s+JAPAN/i);
  if (matchCJPN) {
    const season = matchCJPN[1] || matchCJPN[matchCJPN.length - 1];
    // 連番を計算: cardAutoQueueに同一rawTitle前回分があれば増分
    const seqNum = _getSequentialNumber(articleTitle, publishDate);
    return `${season}th CJPN ${seqNum}`;
  }

  // パターン1: "17th TOTW11" などの標準形式
  let match = articleTitle.match(/(\d+)th\s+([A-Z]+)(\d+)/i);
  if (match) {
    let num = match[2] + (match[3].padStart(2, '0'));
    return `${match[1]}th ${num}`;
  }
  
  // パターン2: "EAFC26 eS-League Cornerstones1" OR "EAFC26 Cornerstones1" → 年プレフィックス
  // v52.164.1: "eS-League" ありなしの両方に対応
  
  // ケース1: "EAFC26 eS-League JAPAN 17th TOTW11" のような複雑な形式
  match = articleTitle.match(/EAFC(\d{2})\s+eS-League\s+(?:JAPAN\s+)?(\d+)th\s+([A-Za-z\s]+?)(\d+)/i);
  if (match) {
    let year = match[1];
    let season = match[2];  // "17"
    let eventPart = match[3].trim();  // "TOTW"
    let num = (match[4] || "1").padStart(2, '0');
    let abbr = generateAbbreviation(eventPart);
    console.log("[v52.164.1] Pattern2-Case1:", {year, season, eventPart, num, abbr});
    return `${season}th ${abbr}${num}`;  // "17th TOTW11"
  }
  
  // ケース2: "EAFC26 eS-League Cornerstones1" のような形式（序数なし）
  match = articleTitle.match(/EAFC(\d{2})\s+(?:eS-League\s+)?([A-Za-z][A-Za-z\s]+?)(\d+)/i);
  if (match) {
    let year = match[1];
    let eventPart = match[2].trim();  // "Cornerstones"
    let num = (match[3] || "1").padStart(2, '0');
    let abbr = generateAbbreviation(eventPart);
    console.log("[v52.164.1] Pattern2-Case2:", {year, eventPart, num, abbr, original: articleTitle});
    return `${year} ${abbr} ${num}`;  // "26 CSTN 01"
  }
  
  // パターン3: "eS-League17th Judith CUP" → 序数+略語
  match = articleTitle.match(/eS-League(\d+)th\s+([^\d]+)(\d+)?/i);
  if (match) {
    let ord = match[1].padStart(2, '0') + "th";
    let abbr = generateAbbreviation(match[2]);
    let num = (match[3] || "1").padStart(2, '0');
    let suffix = /アップグレード|upgrade/i.test(articleTitle) ? " UG" : "";
    return `${ord} ${abbr} ${num}${suffix}`;
  }
  
  // フォールバック: タイトルから年月日を抽出
  if (publishDate) {
    let year = publishDate.substring(2, 4); // YYYY -> YY
    return `${year} ${articleTitle.substring(0, 4).toUpperCase()} 01`;
  }
  
  return articleTitle.substring(0, 20); // 最終手段
}

function generateAbbreviation(eventName) {
  const dict = {
    "cornerstones": "CSTN",
    "cornerstone": "CSTN",
    "judith cup": "JUDC",
    "totw": "TOTW",
    "toty": "TOTY",
    "icon": "ICON",
    "team of the week": "TOTW",
    "team of the year": "TOTY",
    "clubs japan": "CJPN",
    "club japan": "CJPN",
    "cjpn": "CJPN",
    "cj": "CJPN"
  };
  let key = eventName.toLowerCase().trim();
  if (dict[key]) return dict[key];
  
  // 動的生成: 大文字4文字
  let caps = eventName.match(/[A-Z]/g);
  if (caps && caps.length >= 4) return caps.slice(0, 4).join('');
  return eventName.replace(/[^A-Za-z]/g, '').substring(0, 4).toUpperCase();
}
// ========== v52.162: ラベル生成ロジック終了 ==========

// window公開
window.generateCardLabel = generateCardLabel;
window.generateAbbreviation = generateAbbreviation;
// ========== v52.163.2: ラベル生成関数移動完了 ==========


// ========================================
// Phase 4.11.55: グローバル定義（スコープ問題修正）
// ========================================

// 37チームのマスターデータ
const defaultTeams = [{l2: "", l1: "0400", name: "FC Onions", id: "143"}, {l2: "", l1: "0400", name: "WELLDONE", id: "146"}, {l2: "", l1: "0400", name: "Bana11", id: "213"}, {l2: "", l1: "0400", name: "Le Fort FC", id: "361"}, {l2: "", l1: "0400", name: "Aplastar CF", id: "461"}, {l2: "", l1: "0400", name: "Tesuryo", id: "545"}, {l2: "", l1: "0400", name: "SARUs", id: "546"}, {l2: "", l1: "0400", name: "WIZARD OF OZ", id: "628"}, {l2: "", l1: "0400", name: "MK BOMB", id: "076"}, {l2: "", l1: "0400", name: "HANNARI FC", id: "547"}, {l2: "", l1: "0400", name: "BEBLUES", id: "462"}, {l2: "", l1: "0400", name: "SEED JAPAN 2026", id: "071"}, {l2: "", l1: "0400", name: "Lultima Cena", id: "292"}, {l2: "", l1: "0400", name: "ADACHI DRAGON", id: "481"}, {l2: "0036", l1: "0401", name: "El Mago Öz FC", id: "154"}, {l2: "0036", l1: "0401", name: "DHC for MEN", id: "430"}, {l2: "0036", l1: "0401", name: "SEED JAPAN Plus", id: "073"}, {l2: "0036", l1: "0401", name: "AKATUKI", id: "101"}, {l2: "", l1: "0401", name: "WAKAMONO", id: "652"}, {l2: "", l1: "0401", name: "Ardwick", id: "655"}, {l2: "0036", l1: "0401", name: "Hookar", id: "511"}, {l2: "0036", l1: "0402", name: "AKIYAMA CC", id: "702"}, {l2: "", l1: "0402", name: "Stella de lux", id: "698"}, {l2: "0036", l1: "0402", name: "SNOW FANTASIA", id: "212"}, {l2: "0036", l1: "0402", name: "THE HORSE FACE", id: "710"}, {l2: "0036", l1: "0402", name: "Studio Children", id: "544"}, {l2: "", l1: "0402", name: "Forza Perfetta Calcio", id: "694"}, {l2: "", l1: "0402", name: "ArahatikJP", id: "695"}, {l2: "", l1: "0402", name: "OKUMURA KOUKI", id: "626"}, {l2: "", l1: "0402", name: "FC MATSUDO", id: "712"}, {l2: "0036", l1: "0402", name: "AS Maize", id: "722"}, {l2: "0036", l1: "0402", name: "Dynamite!JapanV2", id: "720"}, {l2: "0036", l1: "0402", name: "FC Anarchy", id: "719"}, {l2: "0036", l1: "0402", name: "FC Blau Fuego", id: "723"}, {l2: "0036", l1: "0402", name: "FC SENANO", id: "718"}, {l2: "0036", l1: "0402", name: "La Passione Blu", id: "721"}, {l2: "0036", l1: "0402", name: "R.A.D", id: "510"}];

// リーグラベルマップ
// ── v52.181: リーグカテゴリ 年度/シーズン/リーグ/DIV 構造化管理 ──
// leagueMeta: { [leagueId]: { year, season, category, div } }
const defaultLeagueMeta = {
  "0400": { year: "26",    season: "17th", category: "eS-League",    div: "01部" },
  "0401": { year: "26",    season: "17th", category: "eS-League",    div: "02部" },
  "0402": { year: "26",    season: "17th", category: "eS-League",    div: "03部" },
  "0036": { year: "26",    season: "17th", category: "Judith CUP",   div: "OP"   },
  "0405": { year: "26",    season: "11th", category: "GrowthLeague", div: "OP"   }
};
window.defaultLeagueMeta = defaultLeagueMeta;
let leagueMeta = { ...defaultLeagueMeta };
window.leagueMeta = leagueMeta;

// leagueLabelMap は { id → 表示名 } のまま保持 (後方互換)
function buildLeagueLabel(meta) {
  if (!meta) return '';
  return `${meta.year} ${meta.season} ${meta.category} ${meta.div}`;
}
const defaultLeagueLabelMap = {
  "": "設定なし",
  "0400": buildLeagueLabel(defaultLeagueMeta["0400"]),
  "0401": buildLeagueLabel(defaultLeagueMeta["0401"]),
  "0402": buildLeagueLabel(defaultLeagueMeta["0402"]),
  "0036": buildLeagueLabel(defaultLeagueMeta["0036"]),
  "0405": buildLeagueLabel(defaultLeagueMeta["0405"])
};

// leagueLabelMapも初期化
let leagueLabelMap = { ...defaultLeagueLabelMap };
leagueMeta = Object.assign({}, defaultLeagueMeta);
window.leagueMeta = leagueMeta;

// メッセージ表示関数
function showMessage(m, t) { 
    const el = document.getElementById('statusMessage'); 
    if(el) { 
        el.innerText = m; 
        el.className = 'fixed top-6 right-6 px-8 py-4 rounded-2xl shadow-2xl z-[100] transition-all text-sm border-2 ' + (t === 'success' ? 'bg-emerald-500 text-white' : 'bg-red-500 text-white'); 
        el.classList.remove('hidden'); 
        setTimeout(function() { el.classList.add('hidden'); }, 4000); 
    } 
}

console.log('[Phase 4.11.55] ✅ グローバル定義完了: defaultTeams(37), leagueLabelMap, showMessage');
console.log('[Phase 4.11.55] 📊 defaultTeams.length =', defaultTeams.length);

// windowオブジェクトにも登録（ES6モジュールからアクセス可能に）
if (typeof window !== 'undefined') {
    window.defaultTeams = defaultTeams;

const defaultPlayers = [
  {"id":1,"psid":"4_garchomp","nickname":"まとや","realName":null,"teamId":710,"teamName":"Team 710","number":"98","card":"-","overall":84,"apps":7,"winRate":86,"goals":0,"assists":0,"cleanSheets":3,"yellow":1,"red":0,"labels":["CORN01"],"specialCards":[],"status":"在籍"},
  {"id":2,"psid":"A-BaLon-A","nickname":null,"realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":3,"winRate":66,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":3,"psid":"A-Millennium-AGO","nickname":"アゴー","realName":null,"teamId":546,"teamName":"Team 546","number":"21","card":"-","overall":81,"apps":22,"winRate":50,"goals":2,"assists":1,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":4,"psid":"A-ZLATANERA","nickname":null,"realName":null,"teamId":546,"teamName":"Team 546","number":null,"card":"-","overall":null,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":5,"psid":"ARDY2104","nickname":"アルディ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":13,"winRate":53,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":6,"psid":"ARIAStyle_","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":8,"winRate":62,"goals":9,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":7,"psid":"ATASU_UNITED","nickname":"あたっす","realName":null,"teamId":710,"teamName":"Team 710","number":"45","card":"-","overall":null,"apps":1,"winRate":100,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":8,"psid":"A_buchi6","nickname":"ぶち","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":16,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":9,"psid":"Adam218255","nickname":"Adam218255","realName":null,"teamId":546,"teamName":"Team 546","number":"20","card":"-","overall":84,"apps":20,"winRate":50,"goals":0,"assists":3,"cleanSheets":5,"yellow":0,"red":0,"labels":["CORN01"],"specialCards":[],"status":"在籍"},
  {"id":10,"psid":"AfroN_ys","nickname":"アフロン","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":11,"winRate":54,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":11,"psid":"Aka-_n_Ari","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":"55","card":"-","overall":84,"apps":8,"winRate":62,"goals":1,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":12,"psid":"Aki12_infantry","nickname":"秋","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":12,"winRate":0,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":13,"psid":"AkiGamba","nickname":"アキ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":11,"winRate":18,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":14,"psid":"AkrWonderland","nickname":"AyKmIrRaA","realName":null,"teamId":546,"teamName":"Team 546","number":"97","card":"-","overall":54,"apps":9,"winRate":22,"goals":4,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":15,"psid":"AkrWonderlandNo4","nickname":"AkrWonderlandNo4","realName":null,"teamId":546,"teamName":"Team 546","number":"4","card":"-","overall":54,"apps":12,"winRate":58,"goals":4,"assists":8,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW04"],"specialCards":[],"status":"在籍"},
  {"id":16,"psid":"Akx100","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":"14","card":"-","overall":54,"apps":8,"winRate":25,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":17,"psid":"Alan2430190","nickname":"アラン","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":3,"winRate":66,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":18,"psid":"Alice-mint0827","nickname":"Alice-mint0827","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":14,"winRate":28,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":19,"psid":"Ama_Era","nickname":"どーてい","realName":null,"teamId":481,"teamName":"Team 481","number":null,"card":"-","overall":null,"apps":87,"winRate":44,"goals":22,"assists":7,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":20,"psid":"Amico_SaIe","nickname":"アミコセル","realName":null,"teamId":143,"teamName":"Team 143","number":null,"card":"-","overall":54,"apps":84,"winRate":70,"goals":37,"assists":17,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":21,"psid":"AnappeJr","nickname":"ラモス","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":59,"winRate":44,"goals":0,"assists":0,"cleanSheets":14,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":22,"psid":"Angel_Potato","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"18","card":"-","overall":54,"apps":20,"winRate":15,"goals":3,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":23,"psid":"AnimalMother1119","nickname":"盆","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"99","card":"-","overall":54,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":24,"psid":"Anya-KGnu","nickname":"アーニャ","realName":null,"teamId":73,"teamName":"Team 073","number":"5","card":"-","overall":54,"apps":31,"winRate":58,"goals":0,"assists":0,"cleanSheets":9,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":25,"psid":"Aouar8_kit","nickname":"たくや","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"8","card":"-","overall":62,"apps":14,"winRate":14,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":26,"psid":"Arsemal","nickname":"アーセマル","realName":null,"teamId":101,"teamName":"AKATUKI","number":null,"card":"-","overall":null,"apps":32,"winRate":21,"goals":1,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":27,"psid":"Arsenal_men107","nickname":"アーセナル男","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"45","card":"-","overall":54,"apps":10,"winRate":30,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":28,"psid":"Asaki-wgr","nickname":"アサキ","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":29,"psid":"Asan-syoui","nickname":"ショウイ","realName":null,"teamId":212,"teamName":"Team 212","number":"29","card":"-","overall":54,"apps":70,"winRate":20,"goals":10,"assists":6,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":30,"psid":"Asan-taii19","nickname":"ショウイ","realName":null,"teamId":212,"teamName":"Team 212","number":"11","card":"-","overall":54,"apps":20,"winRate":50,"goals":5,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":31,"psid":"Asherad_Saga","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":30,"winRate":50,"goals":2,"assists":1,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":32,"psid":"Ask_petit","nickname":"飛鳥女子高生","realName":null,"teamId":710,"teamName":"Team 710","number":"47","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":33,"psid":"Asriel-29","nickname":"アズリ","realName":null,"teamId":361,"teamName":"Team 361","number":"29","card":"-","overall":88,"apps":22,"winRate":50,"goals":14,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW02","TOTW05","TOTW08"],"specialCards":[],"status":"在籍"},
  {"id":34,"psid":"Atletico_ryuto","nickname":"りゅーと","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":28,"winRate":57,"goals":3,"assists":2,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":35,"psid":"Atsun_","nickname":"あつん","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":null,"card":"-","overall":null,"apps":5,"winRate":80,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":36,"psid":"AyKmIrRaA","nickname":"あきら","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":4,"winRate":25,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":37,"psid":"AyureIntel","nickname":"あゆれ","realName":null,"teamId":545,"teamName":"Tesuryo","number":"12","card":"-","overall":86,"apps":22,"winRate":50,"goals":0,"assists":1,"cleanSheets":9,"yellow":0,"red":0,"labels":["TOTW09","CORN02"],"specialCards":[],"status":"在籍"},
  {"id":38,"psid":"Azmin_3131","nickname":"Azmin_3131","realName":null,"teamId":546,"teamName":"Team 546","number":null,"card":"-","overall":null,"apps":21,"winRate":47,"goals":11,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":39,"psid":"B1CENTENNIAL_MAN","nickname":"かいと","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":243,"winRate":52,"goals":98,"assists":47,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":40,"psid":"B24munchenta","nickname":"たいが","realName":null,"teamId":545,"teamName":"Tesuryo","number":"5","card":"-","overall":54,"apps":22,"winRate":50,"goals":0,"assists":5,"cleanSheets":3,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":41,"psid":"BIANCONERO0205","nickname":"マルキ","realName":null,"teamId":212,"teamName":"Team 212","number":"19","card":"-","overall":54,"apps":8,"winRate":62,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":42,"psid":"BKWoodyinho11","nickname":"キングオブテン・さとる様","realName":null,"teamId":213,"teamName":"Team 213","number":"10","card":"-","overall":57,"apps":62,"winRate":36,"goals":4,"assists":3,"cleanSheets":13,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":43,"psid":"BLACK_HAWK-_-D","nickname":"ヤミユウギ","realName":null,"teamId":143,"teamName":"Team 143","number":"53","card":"-","overall":54,"apps":2,"winRate":100,"goals":1,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":44,"psid":"BONUS___777","nickname":"ボート君","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"20","card":"-","overall":54,"apps":5,"winRate":40,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":45,"psid":"Belladonna17","nickname":"ナカケイ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":8,"winRate":62,"goals":5,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":46,"psid":"Belltree005","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":10,"winRate":10,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":47,"psid":"Beningham-","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":"40","card":"-","overall":54,"apps":7,"winRate":42,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":48,"psid":"Big_Previous","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":16,"winRate":18,"goals":0,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":49,"psid":"BisMomiyor","nickname":"ヤスボウズ","realName":null,"teamId":73,"teamName":"Team 073","number":"31","card":"-","overall":60,"apps":5,"winRate":20,"goals":1,"assists":12,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":50,"psid":"BlackFootball19","nickname":"ブラック","realName":null,"teamId":143,"teamName":"Team 143","number":"26","card":"-","overall":54,"apps":12,"winRate":42,"goals":1,"assists":5,"cleanSheets":0,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":51,"psid":"Boranchi0522","nickname":"ぷりしっち","realName":null,"teamId":710,"teamName":"Team 710","number":"25","card":"-","overall":64,"apps":8,"winRate":88,"goals":2,"assists":2,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":52,"psid":"Brigz_Lei","nickname":"Brigz","realName":null,"teamId":511,"teamName":"Hookar","number":"1","card":"-","overall":85,"apps":3,"winRate":33,"goals":0,"assists":2,"cleanSheets":67,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":53,"psid":"Brustwarze-ELF07","nickname":"ブル","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":54,"winRate":42,"goals":25,"assists":13,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":54,"psid":"BullBase_Fuyu","nickname":"ブル","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":11,"winRate":0,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":55,"psid":"Bullet-ap","nickname":"ブリット","realName":null,"teamId":73,"teamName":"Team 073","number":"20","card":"-","overall":54,"apps":1,"winRate":42,"goals":0,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":56,"psid":"Burlington3","nickname":"バートン","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":94,"winRate":39,"goals":12,"assists":7,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":57,"psid":"C1garetteAsh","nickname":"しゃふ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"1","card":"-","overall":54,"apps":20,"winRate":15,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":58,"psid":"CG_Frontline","nickname":"CG_Frontline","realName":null,"teamId":546,"teamName":"Team 546","number":"77","card":"-","overall":54,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":59,"psid":"CHIR-seed1310","nickname":"チア","realName":null,"teamId":146,"teamName":"Team 146","number":"13","card":"-","overall":57,"apps":64,"winRate":64,"goals":0,"assists":0,"cleanSheets":30,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":60,"psid":"COPPA-MIJIN","nickname":"こっぱ","realName":null,"teamId":652,"teamName":"WAKAMONO","number":null,"card":"-","overall":null,"apps":8,"winRate":62,"goals":1,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":61,"psid":"CR7_ios","nickname":"しーあーる","realName":null,"teamId":545,"teamName":"Tesuryo","number":"16","card":"-","overall":59,"apps":20,"winRate":80,"goals":1,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":62,"psid":"CR_arisaka_1234","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":"15","card":"-","overall":84,"apps":2,"winRate":28,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":63,"psid":"Camui_G","nickname":null,"realName":null,"teamId":101,"teamName":"AKATUKI","number":null,"card":"-","overall":null,"apps":11,"winRate":18,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":64,"psid":"Carnage_ta03","nickname":"カー","realName":null,"teamId":212,"teamName":"Team 212","number":"53","card":"-","overall":54,"apps":3,"winRate":66,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":65,"psid":"Chepp_19","nickname":"こまちぇ","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"40","card":"-","overall":54,"apps":3,"winRate":33,"goals":2,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":66,"psid":"Chili-to-Matt","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"56","card":"-","overall":54,"apps":19,"winRate":21,"goals":1,"assists":1,"cleanSheets":0,"yellow":3,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":67,"psid":"Choko_1001","nickname":"ぐり","realName":null,"teamId":545,"teamName":"Tesuryo","number":"91","card":"-","overall":54,"apps":8,"winRate":50,"goals":3,"assists":17,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":68,"psid":"Chuhox","nickname":"チュホ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":69,"psid":"CleyXr","nickname":"アレックス","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":8,"winRate":0,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":70,"psid":"Crescent","nickname":"クレ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"15","card":"-","overall":54,"apps":8,"winRate":12,"goals":8,"assists":2,"cleanSheets":0,"yellow":1,"red":0,"labels":["TOTW03"],"specialCards":[],"status":"在籍"},
  {"id":71,"psid":"Curapikt76","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":49,"winRate":22,"goals":3,"assists":9,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":72,"psid":"Cy4xt","nickname":"ケイ","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":73,"psid":"D-ijk","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":null,"card":"-","overall":null,"apps":9,"winRate":33,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":74,"psid":"D4C_qqq","nickname":"テチコ","realName":null,"teamId":146,"teamName":"Team 146","number":"9","card":"-","overall":54,"apps":22,"winRate":77,"goals":10,"assists":6,"cleanSheets":0,"yellow":2,"red":0,"labels":["TOTW05"],"specialCards":[],"status":"退団"},
  {"id":75,"psid":"DARYL_716","nickname":"タクヤ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"9","card":"-","overall":61,"apps":1,"winRate":100,"goals":31,"assists":14,"cleanSheets":3,"yellow":0,"red":0,"labels":["TOTW04"],"specialCards":[],"status":"在籍"},
  {"id":76,"psid":"DAWN315","nickname":"夜明","realName":null,"teamId":546,"teamName":"Team 546","number":"31","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":77,"psid":"DEISLER","nickname":"ダイスラー","realName":null,"teamId":361,"teamName":"Team 361","number":"11","card":"-","overall":54,"apps":10,"winRate":50,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":78,"psid":"DGordon14","nickname":"グティ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":79,"psid":"DIO_twoooos5656","nickname":"ごろー","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":4,"winRate":25,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":80,"psid":"DJ__4_8","nickname":"ディージェイ","realName":null,"teamId":361,"teamName":"Team 361","number":"48","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":81,"psid":"DL-ambesten","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":6,"winRate":16,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":["EAFC17","CORN02","TOTW10"],"specialCards":[],"status":"退団"},
  {"id":82,"psid":"DOFI_JOKER","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"15","card":"-","overall":54,"apps":5,"winRate":0,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":83,"psid":"DaLaDaDa-777-","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":"88","card":"-","overall":54,"apps":8,"winRate":37,"goals":2,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":84,"psid":"Dahyuun7","nickname":"だひょん","realName":null,"teamId":545,"teamName":"Tesuryo","number":"21","card":"-","overall":54,"apps":12,"winRate":50,"goals":1,"assists":2,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":85,"psid":"Daichikiii","nickname":null,"realName":null,"teamId":694,"teamName":"Forza Perfetta Calcio","number":null,"card":"-","overall":null,"apps":9,"winRate":44,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":86,"psid":"Daigo522","nickname":"Vq1En_PK-KiLLer","realName":null,"teamId":546,"teamName":"Team 546","number":"9","card":"-","overall":54,"apps":12,"winRate":66,"goals":5,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":87,"psid":"Daiya_410","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":15,"winRate":53,"goals":6,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":88,"psid":"DeV1G0N","nickname":"でびごん","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":1,"winRate":100,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":89,"psid":"De__main","nickname":"ツッシー","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":5,"winRate":40,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":90,"psid":"Deepsky1125","nickname":"たけはら","realName":null,"teamId":76,"teamName":"MK BOMB","number":"46","card":"-","overall":54,"apps":2,"winRate":50,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":91,"psid":"Delete35","nickname":null,"realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":4,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":92,"psid":"Dhaihryou_5665","nickname":"ヒロ","realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":9,"winRate":33,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":93,"psid":"DnT_MISAMO","nickname":"おいちゃん","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"10","card":"-","overall":84,"apps":7,"winRate":42,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":94,"psid":"Dolekun18","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":"18","card":"-","overall":83,"apps":8,"winRate":25,"goals":3,"assists":5,"cleanSheets":0,"yellow":1,"red":0,"labels":["JUDI17","TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":95,"psid":"Don_Krieg524","nickname":null,"realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":96,"psid":"Dont_cut_in_line","nickname":null,"realName":null,"teamId":546,"teamName":"Team 546","number":null,"card":"-","overall":null,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":97,"psid":"Doromaro_bb","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"10","card":"-","overall":54,"apps":20,"winRate":20,"goals":9,"assists":4,"cleanSheets":2,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":98,"psid":"Dos_KeBe","nickname":"どすけべ","realName":null,"teamId":652,"teamName":"WAKAMONO","number":null,"card":"-","overall":54,"apps":8,"winRate":62,"goals":4,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":99,"psid":"DqYz_soto","nickname":null,"realName":null,"teamId":652,"teamName":"WAKAMONO","number":"6","card":"-","overall":54,"apps":8,"winRate":62,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":100,"psid":"DragonEnergy_V3","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":101,"psid":"Dread-locksss","nickname":"ドレッド","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":45,"winRate":44,"goals":2,"assists":0,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":102,"psid":"Dreadnouqhts","nickname":"ドレッド","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"13","card":"-","overall":54,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":103,"psid":"Dutchbigman4","nickname":"たけ","realName":null,"teamId":154,"teamName":"Team 154","number":"6","card":"-","overall":null,"apps":8,"winRate":37,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":104,"psid":"Dylqm","nickname":"ディラム","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":25,"winRate":44,"goals":5,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":105,"psid":"E-ternita","nickname":"アーチ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":106,"psid":"EGUHIKO_SAAS","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":10,"winRate":0,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":107,"psid":"ELEa_NoR_14","nickname":null,"realName":null,"teamId":655,"teamName":"Ardwick","number":null,"card":"-","overall":null,"apps":19,"winRate":47,"goals":5,"assists":2,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":108,"psid":"E_san11","nickname":"イーサン","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":21,"winRate":33,"goals":7,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":109,"psid":"Empote_5","nickname":"エンポテ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"16","card":"-","overall":54,"apps":4,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":110,"psid":"Engawa2002","nickname":null,"realName":null,"teamId":154,"teamName":"Team 154","number":"22","card":"-","overall":85,"apps":6,"winRate":33,"goals":1,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":["CORN01"],"specialCards":[],"status":"在籍"},
  {"id":111,"psid":"Esaking__","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":26,"winRate":19,"goals":3,"assists":3,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":112,"psid":"Eternity_300","nickname":"エテ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":3,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":113,"psid":"Evegil_","nickname":null,"realName":null,"teamId":481,"teamName":"Team 481","number":null,"card":"-","overall":null,"apps":6,"winRate":50,"goals":0,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":114,"psid":"FUT_WALKER","nickname":"うぉか","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":115,"psid":"Faipfeax00","nickname":"アグ丸","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":42,"winRate":55,"goals":12,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":116,"psid":"Famimimix","nickname":"ファミ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":117,"psid":"FantasY-Kitanojr","nickname":"キタノ","realName":null,"teamId":461,"teamName":"Team 461","number":"55","card":"-","overall":54,"apps":20,"winRate":55,"goals":5,"assists":6,"cleanSheets":4,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":118,"psid":"FarGie-","nickname":"ファング","realName":null,"teamId":73,"teamName":"Team 073","number":"9","card":"-","overall":83,"apps":18,"winRate":11,"goals":4,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"移動"},
  {"id":119,"psid":"Felriz","nickname":"えーちゃん","realName":null,"teamId":143,"teamName":"Team 143","number":"27","card":"-","overall":77,"apps":16,"winRate":69,"goals":1,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":["TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":120,"psid":"Femalepigs_2","nickname":null,"realName":null,"teamId":655,"teamName":"Ardwick","number":null,"card":"-","overall":null,"apps":10,"winRate":40,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":121,"psid":"Flatbox14","nickname":"フォックス","realName":null,"teamId":143,"teamName":"Team 143","number":null,"card":"-","overall":null,"apps":34,"winRate":71,"goals":0,"assists":1,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":122,"psid":"Fork526","nickname":"フォーク","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":11,"winRate":45,"goals":0,"assists":0,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":123,"psid":"Funnel8752","nickname":"ファンネル","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":16,"winRate":18,"goals":4,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":124,"psid":"GAREVER","nickname":"ガーバー","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":13,"winRate":15,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":125,"psid":"GEKKO_KEYAKI","nickname":"GEKKO_KEYAKI","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":126,"psid":"GI_GGS","nickname":"ギッグス","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"11","card":"-","overall":61,"apps":2,"winRate":66,"goals":1,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":127,"psid":"GKroosakoTC8","nickname":"クロース","realName":null,"teamId":461,"teamName":"Team 461","number":"1","card":"-","overall":84,"apps":10,"winRate":50,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":128,"psid":"GLXIM","nickname":"バブ","realName":null,"teamId":361,"teamName":"Team 361","number":"8","card":"-","overall":64,"apps":44,"winRate":40,"goals":2,"assists":7,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":129,"psid":"GLiMCLAP","nickname":"グリム","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":9,"winRate":11,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":130,"psid":"GOD---giraffe---","nickname":"キリン","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":8,"winRate":50,"goals":1,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":131,"psid":"GORISUMA_CB","nickname":"GORISUMA_CB","realName":null,"teamId":546,"teamName":"Team 546","number":"96","card":"-","overall":54,"apps":16,"winRate":62,"goals":0,"assists":0,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":132,"psid":"GPqne","nickname":"パネンカ","realName":null,"teamId":146,"teamName":"Team 146","number":"3","card":"-","overall":87,"apps":22,"winRate":63,"goals":2,"assists":1,"cleanSheets":14,"yellow":0,"red":0,"labels":["TOTW03","TOTW04","TOTW08","CORN01"],"specialCards":[],"status":"在籍"},
  {"id":133,"psid":"G_nashiko","nickname":"ゲキカラ","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":24,"winRate":33,"goals":1,"assists":1,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":134,"psid":"Gabrielus_467","nickname":"トミー","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":6,"winRate":50,"goals":0,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":135,"psid":"Galileo_800","nickname":"Galileo_800","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":22,"winRate":36,"goals":0,"assists":0,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":136,"psid":"Garuda-megalara","nickname":"ガルーダ","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":null,"card":"-","overall":null,"apps":3,"winRate":100,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":137,"psid":"Gashira_JP","nickname":"がっし","realName":null,"teamId":710,"teamName":"Team 710","number":"31","card":"-","overall":54,"apps":8,"winRate":88,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":138,"psid":"Gavetta_n","nickname":"ガベッタ","realName":null,"teamId":143,"teamName":"Team 143","number":"70","card":"-","overall":62,"apps":16,"winRate":69,"goals":3,"assists":7,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":139,"psid":"Gen2_clubD","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":"99","card":"-","overall":54,"apps":8,"winRate":25,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":140,"psid":"Georgeee---K","nickname":"ジョウジ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":6,"winRate":16,"goals":3,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":141,"psid":"Giant_Bigfoot12","nickname":"こだまん","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":3,"winRate":33,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":142,"psid":"Gilverto_","nickname":null,"realName":null,"teamId":481,"teamName":"Team 481","number":"6","card":"-","overall":54,"apps":10,"winRate":0,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW05"],"specialCards":[],"status":"在籍"},
  {"id":143,"psid":"Gimelez_Alonso","nickname":"アロンソ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"30","card":"-","overall":58,"apps":18,"winRate":55,"goals":0,"assists":0,"cleanSheets":9,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":144,"psid":"GinGinZemi","nickname":"でいじー","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":29,"winRate":34,"goals":0,"assists":0,"cleanSheets":9,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":145,"psid":"Giorno-0508","nickname":"ジョルノ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"37","card":"-","overall":55,"apps":113,"winRate":23,"goals":0,"assists":1,"cleanSheets":36,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":146,"psid":"GndrKedr","nickname":"レジェンダ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":6,"winRate":33,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":147,"psid":"Godric7023","nickname":"ボバン","realName":null,"teamId":101,"teamName":"AKATUKI","number":null,"card":"-","overall":null,"apps":40,"winRate":20,"goals":1,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":148,"psid":"GoldBaren107","nickname":"ぐみ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":60,"winRate":46,"goals":0,"assists":2,"cleanSheets":19,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":149,"psid":"Goldgene77","nickname":"ゴールド","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":10,"winRate":40,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":150,"psid":"Goro_Kun9","nickname":"ごろー","realName":null,"teamId":154,"teamName":"Team 154","number":"9","card":"-","overall":77,"apps":22,"winRate":9,"goals":6,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW10"],"specialCards":[],"status":"退団"},
  {"id":151,"psid":"Gqnzq2","nickname":"きよふゆ","realName":null,"teamId":545,"teamName":"Tesuryo","number":"2","card":"-","overall":54,"apps":14,"winRate":93,"goals":1,"assists":3,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":152,"psid":"Graceyy78","nickname":"グレイシー、ぐれ","realName":null,"teamId":694,"teamName":"Forza Perfetta Calcio","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":153,"psid":"Grimann_7","nickname":"グリ","realName":null,"teamId":544,"teamName":"Team 544","number":"77","card":"-","overall":54,"apps":6,"winRate":50,"goals":1,"assists":10,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW03","TOTW04"],"specialCards":[],"status":"在籍"},
  {"id":154,"psid":"Gyzx_kv","nickname":"すぎチャン","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":37,"winRate":32,"goals":0,"assists":3,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":155,"psid":"HIDEmaru_KING7","nickname":"コウ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":44,"winRate":27,"goals":7,"assists":10,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"移動"},
  {"id":156,"psid":"HIKARU_LEVI","nickname":"ハリー","realName":null,"teamId":361,"teamName":"Team 361","number":"1","card":"-","overall":54,"apps":22,"winRate":50,"goals":0,"assists":0,"cleanSheets":13,"yellow":0,"red":0,"labels":["TOTW03"],"specialCards":[],"status":"在籍"},
  {"id":157,"psid":"HT-cola","nickname":"HT-cola","realName":null,"teamId":546,"teamName":"Team 546","number":"56","card":"-","overall":64,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":158,"psid":"HUMAN_MADE_3","nickname":"もりもり","realName":null,"teamId":547,"teamName":"HANNARI FC","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":159,"psid":"HaMa421Sasuke","nickname":"サスケ","realName":null,"teamId":212,"teamName":"Team 212","number":"21","card":"-","overall":59,"apps":8,"winRate":62,"goals":25,"assists":19,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":160,"psid":"HageLargee","nickname":"はげらーじ","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"80","card":"-","overall":73,"apps":28,"winRate":57,"goals":2,"assists":10,"cleanSheets":4,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":161,"psid":"HalaraNightmare","nickname":"ディプロ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"8","card":"-","overall":54,"apps":18,"winRate":11,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":162,"psid":"HashiMOD","nickname":"はっしー","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":149,"winRate":27,"goals":0,"assists":2,"cleanSheets":37,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"移動"},
  {"id":163,"psid":"Hasta6avistaBa3y","nickname":"ララ","realName":null,"teamId":461,"teamName":"Team 461","number":"29","card":"-","overall":54,"apps":28,"winRate":28,"goals":3,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":164,"psid":"He_is_Helium","nickname":"シモ","realName":null,"teamId":462,"teamName":"Team 462","number":"14","card":"-","overall":54,"apps":13,"winRate":7,"goals":1,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":165,"psid":"Hedi_Slimane_7","nickname":"ゆーきんぐ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":40,"winRate":45,"goals":5,"assists":9,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":166,"psid":"Hidd-en-Mist","nickname":"世界のハイド様","realName":null,"teamId":511,"teamName":"Hookar","number":"19","card":"-","overall":54,"apps":2,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":167,"psid":"Hideppe_","nickname":"ヒデッペ","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":10,"winRate":10,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":168,"psid":"HilyS4m","nickname":"まっけん","realName":null,"teamId":710,"teamName":"Team 710","number":"2","card":"-","overall":54,"apps":3,"winRate":67,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":169,"psid":"Hohoemi_3_taro","nickname":"さんちゃん","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"92","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":170,"psid":"Honest-Liar39","nickname":"オネ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":19,"winRate":0,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":171,"psid":"Hosero","nickname":"ほせろ","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"34","card":"-","overall":72,"apps":8,"winRate":62,"goals":0,"assists":0,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":172,"psid":"HqluK1z","nickname":"ハルキ","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":4,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":173,"psid":"I-LOVE-BARRY-","nickname":"バリー","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":34,"winRate":11,"goals":0,"assists":2,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":174,"psid":"I3aGrey","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":15,"winRate":46,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":175,"psid":"IC-Tera","nickname":"テラ","realName":null,"teamId":146,"teamName":"Team 146","number":"10","card":"-","overall":64,"apps":22,"winRate":63,"goals":8,"assists":11,"cleanSheets":1,"yellow":1,"red":0,"labels":["TOTW04","TOTW05","TOTW09"],"specialCards":[],"status":"在籍"},
  {"id":176,"psid":"ICE_GOM3","nickname":"クマ","realName":null,"teamId":212,"teamName":"Team 212","number":"66","card":"-","overall":54,"apps":12,"winRate":58,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":177,"psid":"IL_Cielo_J","nickname":"ジュン","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"31","card":"-","overall":54,"apps":8,"winRate":62,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":178,"psid":"INFRUNET","nickname":"ヒラノ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":104,"winRate":37,"goals":9,"assists":8,"cleanSheets":18,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":179,"psid":"INORAN_F2","nickname":"イノラン","realName":null,"teamId":101,"teamName":"AKATUKI","number":"10","card":"-","overall":86,"apps":8,"winRate":12,"goals":1,"assists":19,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW01","TOTW04","TOTW05","JUDI17","TOTW08","TOTW09"],"specialCards":[],"status":"在籍"},
  {"id":180,"psid":"Il_Faraone92","nickname":"えるしゃら","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"92","card":"-","overall":81,"apps":22,"winRate":18,"goals":0,"assists":1,"cleanSheets":7,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":181,"psid":"Il_Genio__11","nickname":"毛蟹","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"7","card":"-","overall":54,"apps":18,"winRate":16,"goals":5,"assists":16,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":182,"psid":"Incer1sta_UpHill","nickname":"インセレ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":14,"winRate":28,"goals":1,"assists":0,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":183,"psid":"Inigba08","nickname":"イニグバ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"45","card":"-","overall":null,"apps":10,"winRate":20,"goals":1,"assists":1,"cleanSheets":1,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":184,"psid":"Inigba811","nickname":"イニグバ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":185,"psid":"Inoha_LGN","nickname":"いのは","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"5","card":"-","overall":54,"apps":17,"winRate":58,"goals":2,"assists":5,"cleanSheets":8,"yellow":0,"red":1,"labels":["TOTW04"],"specialCards":[],"status":"退団"},
  {"id":186,"psid":"Inter_Bex","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"12","card":"-","overall":54,"apps":4,"winRate":20,"goals":0,"assists":2,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":187,"psid":"Iverson_3_ers76","nickname":"ジョンソン","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":36,"winRate":44,"goals":1,"assists":3,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":188,"psid":"J-SWATT100","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":22,"winRate":72,"goals":32,"assists":8,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":189,"psid":"JATU-ikushow","nickname":"イクショウ","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"19","card":"-","overall":62,"apps":10,"winRate":20,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":["EAFC17"],"specialCards":[],"status":"在籍"},
  {"id":190,"psid":"JCK_TUBAKI08v","nickname":"ツバキ","realName":null,"teamId":461,"teamName":"Team 461","number":"64","card":"-","overall":54,"apps":4,"winRate":75,"goals":0,"assists":3,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":191,"psid":"JCK_marukusu0209","nickname":"マルクス","realName":null,"teamId":73,"teamName":"Team 073","number":"12","card":"-","overall":54,"apps":12,"winRate":58,"goals":1,"assists":3,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":192,"psid":"Jabba_TH3_Hutt73","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":"17","card":"-","overall":54,"apps":4,"winRate":25,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":193,"psid":"Jacquetsh","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":7,"winRate":57,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":194,"psid":"Jejeje0919","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":"3","card":"-","overall":54,"apps":3,"winRate":33,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW02"],"specialCards":[],"status":"在籍"},
  {"id":195,"psid":"Joe-Cole27","nickname":"ジョー","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":11,"winRate":18,"goals":0,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":196,"psid":"Johsuke_","nickname":null,"realName":null,"teamId":101,"teamName":"AKATUKI","number":null,"card":"-","overall":null,"apps":19,"winRate":36,"goals":5,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":197,"psid":"Jona3_Man_JiRo","nickname":"シュウ","realName":null,"teamId":481,"teamName":"Team 481","number":"23","card":"-","overall":54,"apps":6,"winRate":38,"goals":6,"assists":2,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":198,"psid":"K-ore-VinVin","nickname":"けー","realName":null,"teamId":710,"teamName":"Team 710","number":"29","card":"-","overall":54,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":199,"psid":"K0TOUGE","nickname":"小峠英二","realName":null,"teamId":361,"teamName":"Team 361","number":"21","card":"-","overall":79,"apps":22,"winRate":50,"goals":1,"assists":6,"cleanSheets":5,"yellow":0,"red":0,"labels":["TOTW02"],"specialCards":[],"status":"在籍"},
  {"id":200,"psid":"K1nllk","nickname":"きん","realName":null,"teamId":143,"teamName":"Team 143","number":"3","card":"-","overall":70,"apps":2,"winRate":100,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":201,"psid":"KA-GE-","nickname":"カゲ","realName":null,"teamId":546,"teamName":"Team 546","number":"99","card":"-","overall":84,"apps":18,"winRate":5,"goals":2,"assists":1,"cleanSheets":5,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"退団"},
  {"id":202,"psid":"KABO_H","nickname":"カボ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":8,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":203,"psid":"KABO_h","nickname":"KABO_h","realName":null,"teamId":462,"teamName":"Team 462","number":"15","card":"-","overall":54,"apps":11,"winRate":9,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":204,"psid":"KAZUTAKA307","nickname":"カズ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"7","card":"-","overall":83,"apps":5,"winRate":21,"goals":4,"assists":16,"cleanSheets":7,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":205,"psid":"KENDO_KlCHIGAl","nickname":"ケンキチ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":101,"winRate":58,"goals":6,"assists":6,"cleanSheets":16,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":206,"psid":"KENPIPII","nickname":"ケンピピ","realName":null,"teamId":361,"teamName":"Team 361","number":"42","card":"-","overall":66,"apps":14,"winRate":57,"goals":1,"assists":5,"cleanSheets":9,"yellow":0,"red":0,"labels":["TOTW01","TOTW02","TOTW03","CORN01"],"specialCards":[],"status":"在籍"},
  {"id":207,"psid":"KG_unselfish","nickname":"けーじー","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":69,"winRate":42,"goals":0,"assists":2,"cleanSheets":22,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":208,"psid":"KIRAKIRA-KEICHAN","nickname":"キラケイ","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":4,"winRate":50,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":209,"psid":"KMART_L42","nickname":"フッキー","realName":null,"teamId":546,"teamName":"Team 546","number":"40","card":"-","overall":62,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":210,"psid":"KOKE-C_-","nickname":"こけし","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"10","card":"-","overall":63,"apps":22,"winRate":18,"goals":1,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":211,"psid":"KSB_jackal","nickname":"ジャッカル","realName":null,"teamId":461,"teamName":"Team 461","number":"6","card":"-","overall":81,"apps":22,"winRate":54,"goals":0,"assists":0,"cleanSheets":8,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":212,"psid":"KURIMAN10_","nickname":"KURIMAN10_","realName":null,"teamId":546,"teamName":"Team 546","number":"45","card":"-","overall":54,"apps":14,"winRate":42,"goals":4,"assists":11,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":213,"psid":"Kaede_25_","nickname":"トンボ","realName":null,"teamId":212,"teamName":"Team 212","number":"2","card":"-","overall":54,"apps":6,"winRate":66,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":214,"psid":"Kaeru2komi","nickname":"カエル","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":128,"winRate":58,"goals":4,"assists":2,"cleanSheets":51,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":215,"psid":"Katamonzu555","nickname":"エラマメ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":7,"winRate":14,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":216,"psid":"Kazanista_0408","nickname":"カザニスタ","realName":null,"teamId":481,"teamName":"Team 481","number":"87","card":"-","overall":54,"apps":1,"winRate":34,"goals":0,"assists":1,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":217,"psid":"Kdon_zan122","nickname":"Kdon_zan122","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":11,"winRate":72,"goals":2,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":218,"psid":"KimchimanSP","nickname":"キムチマン","realName":null,"teamId":143,"teamName":"Team 143","number":null,"card":"-","overall":63,"apps":252,"winRate":68,"goals":7,"assists":21,"cleanSheets":106,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":219,"psid":"Kirito0714_","nickname":null,"realName":null,"teamId":655,"teamName":"Ardwick","number":null,"card":"-","overall":null,"apps":1,"winRate":100,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":220,"psid":"Kosa-yu84","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":18,"winRate":72,"goals":0,"assists":2,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":221,"psid":"Kotaro-L","nickname":"コタロー","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":124,"winRate":40,"goals":12,"assists":4,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":222,"psid":"Kuroe810","nickname":"カメン","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":42,"winRate":21,"goals":0,"assists":3,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":223,"psid":"LEGEND-Xx9xX-","nickname":"レジェンド","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":224,"psid":"LESLESTON","nickname":"シロ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":2,"winRate":100,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":225,"psid":"LIA-STYLE","nickname":"オチャ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":144,"winRate":62,"goals":10,"assists":18,"cleanSheets":65,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":226,"psid":"LIL-0718","nickname":"リル","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":21,"winRate":23,"goals":5,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":227,"psid":"LL---Bean","nickname":"マシマシ","realName":null,"teamId":361,"teamName":"Team 361","number":"2","card":"-","overall":58,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":228,"psid":"Lancio7216","nickname":"ラン","realName":null,"teamId":430,"teamName":"Team 430","number":"21","card":"-","overall":85,"apps":8,"winRate":37,"goals":3,"assists":1,"cleanSheets":10,"yellow":0,"red":0,"labels":["TOTW01","CORN01"],"specialCards":[],"status":"在籍"},
  {"id":229,"psid":"Latelanta_BC","nickname":"ラテ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":2,"winRate":100,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":230,"psid":"Laugh-Tale_7","nickname":"ラフテル","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":57,"winRate":33,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":231,"psid":"Leo_shu12","nickname":"しゅうや","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":18,"winRate":61,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":232,"psid":"Lewandaiki77","nickname":"タイ人","realName":null,"teamId":213,"teamName":"Team 213","number":"14","card":"-","overall":54,"apps":4,"winRate":75,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":233,"psid":"Lil_G_Vert_","nickname":"リル","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":234,"psid":"LivrpI","nickname":"サックン","realName":null,"teamId":146,"teamName":"Team 146","number":"8","card":"-","overall":81,"apps":22,"winRate":63,"goals":0,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":235,"psid":"Livrpl","nickname":"サックン","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":13,"winRate":69,"goals":2,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":236,"psid":"LozeNoah","nickname":"LozeNoah","realName":null,"teamId":154,"teamName":"Team 154","number":"16","card":"-","overall":54,"apps":12,"winRate":13,"goals":0,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":237,"psid":"M-Aubameyang","nickname":"バメヤン","realName":null,"teamId":146,"teamName":"Team 146","number":"53","card":"-","overall":56,"apps":28,"winRate":42,"goals":1,"assists":2,"cleanSheets":10,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":238,"psid":"MARUmasa03","nickname":"まるまさ","realName":null,"teamId":655,"teamName":"Ardwick","number":"8","card":"-","overall":72,"apps":34,"winRate":35,"goals":0,"assists":0,"cleanSheets":10,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":239,"psid":"MASA10-526","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":6,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":240,"psid":"MASAMASA65","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":"10","card":"-","overall":54,"apps":5,"winRate":20,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW05"],"specialCards":[],"status":"在籍"},
  {"id":241,"psid":"MASA_kichi3","nickname":"スヌーピー","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":242,"psid":"MD3456789","nickname":"エムディー","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":23,"winRate":43,"goals":1,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":243,"psid":"MEBOKKY","nickname":"ボッキー","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":10,"winRate":20,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":244,"psid":"MEVIUS268","nickname":"メビウス","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":23,"winRate":30,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":245,"psid":"MIRCO0828","nickname":"ミルコ","realName":null,"teamId":73,"teamName":"Team 073","number":"69","card":"-","overall":85,"apps":7,"winRate":14,"goals":6,"assists":7,"cleanSheets":1,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":246,"psid":"MKR7","nickname":"ベガッタ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":247,"psid":"MOKA1201","nickname":"るんば","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":248,"psid":"MORGAN-0115","nickname":"舎弟","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":33,"winRate":9,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":249,"psid":"MS14-S","nickname":"エム","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":null,"card":"-","overall":null,"apps":16,"winRate":56,"goals":0,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":250,"psid":"Ma_tto173","nickname":"まっと","realName":null,"teamId":461,"teamName":"Team 461","number":"2","card":"-","overall":54,"apps":53,"winRate":45,"goals":4,"assists":6,"cleanSheets":11,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":251,"psid":"Madles47","nickname":"よしれん","realName":null,"teamId":76,"teamName":"MK BOMB","number":"47","card":"-","overall":54,"apps":8,"winRate":50,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":252,"psid":"Magnum-60yards","nickname":"シュートが入らない","realName":null,"teamId":361,"teamName":"Team 361","number":"60","card":"-","overall":54,"apps":18,"winRate":50,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":253,"psid":"Make-win14","nickname":"めいのん","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"47","card":"-","overall":56,"apps":6,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":254,"psid":"MarsamaMarsama","nickname":"まーさま","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":78,"apps":3,"winRate":27,"goals":1,"assists":1,"cleanSheets":11,"yellow":0,"red":0,"labels":["TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":255,"psid":"Masa_Apple11","nickname":"まさ","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":72,"winRate":50,"goals":9,"assists":7,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":256,"psid":"Masan-chuGacky","nickname":"マサンチュ","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":13,"winRate":15,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":257,"psid":"Matsu-Jun-21","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":null,"card":"-","overall":null,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":["CORN01"],"specialCards":[],"status":"在籍"},
  {"id":258,"psid":"Mawile1st","nickname":"0号","realName":null,"teamId":546,"teamName":"Team 546","number":null,"card":"-","overall":null,"apps":55,"winRate":41,"goals":35,"assists":14,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":259,"psid":"Mbappe9Vini7","nickname":"Mbappe9Vini7","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":8,"winRate":62,"goals":0,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":260,"psid":"MeN_24my","nickname":"めん","realName":null,"teamId":461,"teamName":"Team 461","number":"4","card":"-","overall":85,"apps":22,"winRate":54,"goals":1,"assists":5,"cleanSheets":8,"yellow":1,"red":0,"labels":["TOTW08","CORN02"],"specialCards":[],"status":"在籍"},
  {"id":261,"psid":"MentayBoy","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":6,"winRate":83,"goals":4,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":262,"psid":"Miaou_Na46","nickname":"ショウタ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":103,"winRate":60,"goals":4,"assists":7,"cleanSheets":48,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":263,"psid":"Miiita_M","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":null,"card":"-","overall":null,"apps":3,"winRate":33,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":264,"psid":"Mikka_33","nickname":"ミッカ","realName":null,"teamId":143,"teamName":"Team 143","number":null,"card":"-","overall":56,"apps":206,"winRate":72,"goals":69,"assists":59,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":265,"psid":"Milamila13","nickname":"ロッソ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":20,"winRate":55,"goals":10,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":266,"psid":"Milanista-S2011","nickname":"ソノ","realName":null,"teamId":545,"teamName":"Tesuryo","number":"66","card":"-","overall":63,"apps":14,"winRate":50,"goals":0,"assists":0,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":267,"psid":"Mkun14","nickname":"えむ","realName":null,"teamId":710,"teamName":"Team 710","number":"69","card":"-","overall":54,"apps":6,"winRate":83,"goals":0,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":268,"psid":"Mo_11313","nickname":"モー","realName":null,"teamId":143,"teamName":"Team 143","number":"20","card":"-","overall":62,"apps":22,"winRate":54,"goals":0,"assists":6,"cleanSheets":20,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":269,"psid":"Mod19ric","nickname":"こば","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"19","card":"-","overall":54,"apps":6,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":270,"psid":"MojaX_ToT","nickname":"きよし","realName":null,"teamId":481,"teamName":"Team 481","number":"16","card":"-","overall":54,"apps":4,"winRate":40,"goals":5,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":271,"psid":"Momomomm22","nickname":"モモ","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":11,"winRate":45,"goals":0,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":272,"psid":"Monster-Renz2","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"98","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":273,"psid":"Moon_Shards2","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":274,"psid":"Mqrus-_-","nickname":"ギルティー","realName":null,"teamId":481,"teamName":"Team 481","number":null,"card":"-","overall":null,"apps":47,"winRate":34,"goals":0,"assists":4,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":275,"psid":"Mr-Ty-39","nickname":null,"realName":null,"teamId":547,"teamName":"HANNARI FC","number":"1","card":"-","overall":54,"apps":6,"winRate":0,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":276,"psid":"Munchkin_Fox","nickname":"フォックス","realName":null,"teamId":212,"teamName":"Team 212","number":"16","card":"-","overall":54,"apps":9,"winRate":66,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":277,"psid":"MyRoKix","nickname":"ロッキー","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":16,"winRate":50,"goals":10,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":278,"psid":"NEW_attama-kt-Z","nickname":"てぃむてぃむおっきまる","realName":null,"teamId":146,"teamName":"Team 146","number":"14","card":"-","overall":74,"apps":8,"winRate":88,"goals":3,"assists":5,"cleanSheets":3,"yellow":0,"red":0,"labels":["TOTW03","TOTW05"],"specialCards":[],"status":"退団"},
  {"id":279,"psid":"NEYMAR-DONO238","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":1,"winRate":100,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":280,"psid":"NGTKR69","nickname":"ころ","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":null,"card":"-","overall":null,"apps":29,"winRate":41,"goals":3,"assists":2,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":281,"psid":"NOVA_maedy","nickname":"マエチャン","realName":null,"teamId":73,"teamName":"Team 073","number":"14","card":"-","overall":54,"apps":92,"winRate":33,"goals":7,"assists":9,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":282,"psid":"Nally_1336","nickname":"なりこう","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"6","card":"-","overall":null,"apps":3,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":283,"psid":"Napoli-Works","nickname":null,"realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":6,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":284,"psid":"Nasri121017","nickname":"ナスリ","realName":null,"teamId":146,"teamName":"Team 146","number":"99","card":"-","overall":54,"apps":27,"winRate":59,"goals":13,"assists":10,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":285,"psid":"Nekop_one","nickname":"ネコプ","realName":null,"teamId":143,"teamName":"Team 143","number":null,"card":"-","overall":null,"apps":7,"winRate":86,"goals":0,"assists":0,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":286,"psid":"Nekosi-Panda1525","nickname":null,"realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":10,"winRate":10,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":287,"psid":"Nestalia_J","nickname":"ネス","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":9,"winRate":67,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":288,"psid":"New-Cola188605","nickname":"New-Cola188605","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":289,"psid":"New-mk1015","nickname":"ポール","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":3,"winRate":33,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":290,"psid":"Niccoli_Santi","nickname":"リー","realName":null,"teamId":361,"teamName":"Team 361","number":"6","card":"-","overall":84,"apps":22,"winRate":50,"goals":2,"assists":2,"cleanSheets":13,"yellow":1,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":291,"psid":"Nightsky-patrol","nickname":"デリ","realName":null,"teamId":143,"teamName":"Team 143","number":"4","card":"-","overall":54,"apps":16,"winRate":69,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":292,"psid":"NinjaNaruzo","nickname":"ナルオ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"4","card":"-","overall":84,"apps":20,"winRate":40,"goals":5,"assists":1,"cleanSheets":4,"yellow":1,"red":0,"labels":["CORN01"],"specialCards":[],"status":"在籍"},
  {"id":293,"psid":"Noan1023","nickname":"ノアン","realName":null,"teamId":626,"teamName":"OKUMURA KOUKI","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":294,"psid":"Nobodys_fault_20","nickname":"やましょう","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":13,"winRate":15,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":295,"psid":"NohYier_heisei8","nickname":"ノイヤー","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"41","card":"-","overall":54,"apps":27,"winRate":48,"goals":0,"assists":0,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":296,"psid":"Non22_99","nickname":"ノン","realName":null,"teamId":154,"teamName":"Team 154","number":"99","card":"-","overall":54,"apps":4,"winRate":50,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":297,"psid":"OAO-ONE_AND_ONLY","nickname":"びりちゃん","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":62,"apps":3,"winRate":41,"goals":1,"assists":5,"cleanSheets":17,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":298,"psid":"OCHA1991","nickname":"OCHA1991","realName":null,"teamId":546,"teamName":"Team 546","number":"26","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":299,"psid":"OGTz_z","nickname":"おが","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":149,"winRate":49,"goals":4,"assists":7,"cleanSheets":48,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":300,"psid":"OKINAWA_SOBA_07","nickname":"オキソバ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":17,"winRate":11,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":301,"psid":"ONIchan-_-zz","nickname":"おにちゃん","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"22","card":"-","overall":64,"apps":19,"winRate":21,"goals":4,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":302,"psid":"ORUGERUTO","nickname":"オル","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":22,"winRate":63,"goals":1,"assists":0,"cleanSheets":9,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":303,"psid":"OVOTATSUOVO","nickname":"おぼたっちゃん","realName":null,"teamId":462,"teamName":"Team 462","number":"80","card":"-","overall":54,"apps":8,"winRate":52,"goals":0,"assists":1,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":304,"psid":"Okosi_ARMY_Atusi","nickname":"あつし","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":305,"psid":"Omnia-vanitas9","nickname":"エム","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":18,"winRate":72,"goals":4,"assists":5,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":306,"psid":"On_My_Own_R18","nickname":"On_My_Own_R18","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":18,"winRate":66,"goals":2,"assists":4,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":307,"psid":"Onariri47","nickname":"なりー","realName":null,"teamId":545,"teamName":"Tesuryo","number":null,"card":"-","overall":58,"apps":10,"winRate":70,"goals":0,"assists":1,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":308,"psid":"Oni_Neko3","nickname":"オニネコ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":309,"psid":"OtokoUme350ml","nickname":"まさまさ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":151,"winRate":42,"goals":86,"assists":21,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":310,"psid":"Over_ash3056","nickname":"オーバ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"77","card":"-","overall":79,"apps":20,"winRate":60,"goals":1,"assists":0,"cleanSheets":9,"yellow":0,"red":0,"labels":["TOTW04","EAFC17","CORN01"],"specialCards":[],"status":"退団"},
  {"id":311,"psid":"PARASENNIN","nickname":null,"realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":13,"winRate":15,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":312,"psid":"PIKO-APPLE-2015","nickname":"ピコ","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":51,"winRate":29,"goals":0,"assists":0,"cleanSheets":10,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":313,"psid":"PINOandTacoRice","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":48,"winRate":22,"goals":1,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":314,"psid":"PIR0SIKI","nickname":"ピロシキ","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"2","card":"-","overall":54,"apps":16,"winRate":18,"goals":0,"assists":1,"cleanSheets":5,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":315,"psid":"POS__DIESEL","nickname":"ディーゼル","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":239,"winRate":59,"goals":0,"assists":0,"cleanSheets":127,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":316,"psid":"PPPPPPe_i213","nickname":"じゅん","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":58,"winRate":34,"goals":5,"assists":2,"cleanSheets":14,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":317,"psid":"PRIMOTIF","nickname":"プリモ","realName":null,"teamId":73,"teamName":"Team 073","number":"12","card":"-","overall":84,"apps":22,"winRate":36,"goals":0,"assists":2,"cleanSheets":8,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"退団"},
  {"id":318,"psid":"PUN__PEE","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":3,"winRate":66,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":319,"psid":"Patrasche7","nickname":"パトラッシュ","realName":null,"teamId":143,"teamName":"Team 143","number":null,"card":"-","overall":62,"apps":125,"winRate":66,"goals":15,"assists":14,"cleanSheets":35,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":320,"psid":"Pazushiba01","nickname":"ナカムラ","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"3","card":"-","overall":54,"apps":16,"winRate":37,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":321,"psid":"PerolinSensei","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":49,"winRate":49,"goals":0,"assists":0,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":322,"psid":"PhaseBomb","nickname":"アサシン","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":24,"winRate":20,"goals":0,"assists":0,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":323,"psid":"Piatti-unselfish","nickname":"ピアッティ","realName":null,"teamId":73,"teamName":"Team 073","number":"3","card":"-","overall":60,"apps":6,"winRate":16,"goals":1,"assists":1,"cleanSheets":8,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":324,"psid":"PikaChelsea8","nickname":"ピカチェル","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":43,"winRate":54,"goals":1,"assists":0,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":325,"psid":"Pipopippo009","nickname":"ピポ","realName":null,"teamId":430,"teamName":"Team 430","number":"20","card":"-","overall":null,"apps":7,"winRate":42,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":326,"psid":"Pix822","nickname":"ピク","realName":null,"teamId":212,"teamName":"Team 212","number":"61","card":"-","overall":54,"apps":5,"winRate":60,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":327,"psid":"PoNTaZi68","nickname":"たじぽん、ぽんたじ、たじ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"55","card":"-","overall":84,"apps":16,"winRate":12,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":328,"psid":"Pocho-X","nickname":"ポチョ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"5","card":"-","overall":84,"apps":8,"winRate":12,"goals":7,"assists":11,"cleanSheets":1,"yellow":0,"red":0,"labels":["CORN01","TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":329,"psid":"Poke_Bitss","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":"19","card":"-","overall":54,"apps":2,"winRate":100,"goals":2,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":330,"psid":"Ponta_3ol","nickname":"Ponta","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":17,"winRate":70,"goals":0,"assists":3,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":331,"psid":"PsychoPremium","nickname":"サイコ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":332,"psid":"Qmjgfvm","nickname":"トンボはん","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":49,"winRate":51,"goals":0,"assists":0,"cleanSheets":24,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":333,"psid":"R400_apex","nickname":"ヤギエル","realName":null,"teamId":143,"teamName":"Team 143","number":"27","card":"-","overall":65,"apps":22,"winRate":54,"goals":3,"assists":7,"cleanSheets":0,"yellow":1,"red":0,"labels":["TOTW03"],"specialCards":[],"status":"退団"},
  {"id":334,"psid":"RAPTOR-7-7-7","nickname":"烈風","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":32,"winRate":69,"goals":0,"assists":1,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":335,"psid":"REOL_n","nickname":"なおる","realName":null,"teamId":76,"teamName":"MK BOMB","number":"10","card":"-","overall":68,"apps":22,"winRate":36,"goals":8,"assists":10,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW01","TOTW02","TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":336,"psid":"RH9243","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":"2","card":"-","overall":54,"apps":8,"winRate":62,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":337,"psid":"RICHMOND_sports","nickname":"リッチモンド","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":72,"winRate":15,"goals":2,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":338,"psid":"RIP_Cheek","nickname":"くりやまさん","realName":null,"teamId":143,"teamName":"Team 143","number":"24","card":"-","overall":54,"apps":30,"winRate":57,"goals":1,"assists":1,"cleanSheets":14,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":339,"psid":"RNokuchan","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":340,"psid":"RNokuchan__","nickname":"おくちゃん","realName":null,"teamId":547,"teamName":"HANNARI FC","number":null,"card":"-","overall":null,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":341,"psid":"RNqpO__","nickname":"ナポ","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"99","card":"-","overall":54,"apps":15,"winRate":13,"goals":1,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":342,"psid":"ROY315","nickname":"ROY315","realName":null,"teamId":546,"teamName":"Team 546","number":null,"card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":343,"psid":"RVS_Toru","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":6,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":344,"psid":"RYO43yanazon","nickname":"リョウ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":11,"winRate":45,"goals":1,"assists":0,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":345,"psid":"RYU---87","nickname":"リュウ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":4,"winRate":0,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":346,"psid":"Re3chan_SB","nickname":"レミ","realName":null,"teamId":143,"teamName":"Team 143","number":"89","card":"-","overall":63,"apps":162,"winRate":75,"goals":0,"assists":5,"cleanSheets":92,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":347,"psid":"Re_mon55","nickname":"レモン","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":9,"winRate":44,"goals":3,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":348,"psid":"RedCross-14","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":349,"psid":"Relqsh","nickname":"ラッキョ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":181,"winRate":61,"goals":37,"assists":38,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":350,"psid":"Rey-chan_Jr","nickname":"れいそる","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":59,"winRate":41,"goals":2,"assists":1,"cleanSheets":16,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":351,"psid":"Ribetomato_109","nickname":"トマト","realName":null,"teamId":143,"teamName":"Team 143","number":"34","card":"-","overall":82,"apps":18,"winRate":61,"goals":2,"assists":1,"cleanSheets":7,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":352,"psid":"Rico_p1nz","nickname":"リコピン","realName":null,"teamId":710,"teamName":"Team 710","number":"1","card":"-","overall":54,"apps":8,"winRate":88,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":["TOTW09"],"specialCards":[],"status":"在籍"},
  {"id":353,"psid":"Right-R2417","nickname":"ライト","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"14","card":"-","overall":54,"apps":8,"winRate":12,"goals":1,"assists":1,"cleanSheets":2,"yellow":2,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":354,"psid":"Rilakkuma2106","nickname":"パワ－","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"33","card":"-","overall":84,"apps":8,"winRate":37,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":355,"psid":"RinLin17","nickname":"りんりん","realName":null,"teamId":545,"teamName":"Tesuryo","number":"7","card":"-","overall":84,"apps":22,"winRate":50,"goals":10,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW08"],"specialCards":[],"status":"在籍"},
  {"id":356,"psid":"Rinmikan13109","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":35,"winRate":37,"goals":5,"assists":7,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":357,"psid":"RokiOoizumiYou","nickname":"ロキオ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"8","card":"-","overall":54,"apps":2,"winRate":100,"goals":29,"assists":49,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW04"],"specialCards":[],"status":"退団"},
  {"id":358,"psid":"Roy_Yor_","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":29,"winRate":20,"goals":0,"assists":2,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":359,"psid":"Rs_eco","nickname":"マヤコン","realName":null,"teamId":143,"teamName":"Team 143","number":"22","card":"-","overall":57,"apps":54,"winRate":50,"goals":13,"assists":13,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":360,"psid":"Ruuu_ke","nickname":"おとうと","realName":null,"teamId":626,"teamName":"OKUMURA KOUKI","number":"7","card":"-","overall":54,"apps":16,"winRate":0,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":361,"psid":"Ryan-GIGGS--11","nickname":"ぎぐす","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":22,"winRate":41,"goals":1,"assists":0,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":362,"psid":"Ryu-gu-jo-_-","nickname":"リュウ","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":33,"winRate":42,"goals":0,"assists":0,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":363,"psid":"RyuRyu-to-666","nickname":"りゅーと","realName":null,"teamId":545,"teamName":"Tesuryo","number":null,"card":"-","overall":54,"apps":13,"winRate":85,"goals":0,"assists":4,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":364,"psid":"Ryussh","nickname":null,"realName":null,"teamId":547,"teamName":"HANNARI FC","number":"77","card":"-","overall":54,"apps":26,"winRate":30,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":365,"psid":"Ryutyan","nickname":"りゅうちゃん","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":53,"winRate":17,"goals":8,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"移動"},
  {"id":366,"psid":"Rz_xo17","nickname":null,"realName":null,"teamId":694,"teamName":"Forza Perfetta Calcio","number":"17","card":"-","overall":54,"apps":10,"winRate":40,"goals":3,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":367,"psid":"SAKOMARO7","nickname":"サコマロ","realName":null,"teamId":146,"teamName":"Team 146","number":"7","card":"-","overall":87,"apps":18,"winRate":66,"goals":13,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW03","EAFC17","TOTW09"],"specialCards":[],"status":"在籍"},
  {"id":368,"psid":"SAKO_G-Pakutin","nickname":"サコ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":24,"winRate":58,"goals":0,"assists":1,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":369,"psid":"SAKO_G_Pakutin","nickname":null,"realName":null,"teamId":154,"teamName":"Team 154","number":"13","card":"-","overall":54,"apps":18,"winRate":50,"goals":0,"assists":0,"cleanSheets":8,"yellow":0,"red":0,"labels":["TOTW04"],"specialCards":[],"status":"在籍"},
  {"id":370,"psid":"SAKO_Gpaku","nickname":null,"realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":12,"winRate":50,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":371,"psid":"SARU-QUALITY","nickname":"サル","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":372,"psid":"SASA-KA","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":"7","card":"-","overall":54,"apps":24,"winRate":20,"goals":0,"assists":0,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":373,"psid":"SATELLITE-31","nickname":"シャミ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":67,"winRate":44,"goals":11,"assists":7,"cleanSheets":14,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":374,"psid":"SAVIOR_SCUDETTO","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":375,"psid":"SCOR_PION_1115","nickname":null,"realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":4,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":376,"psid":"SCUDETTO_ACMILAN","nickname":"ミラン","realName":null,"teamId":361,"teamName":"Team 361","number":"15","card":"-","overall":63,"apps":4,"winRate":25,"goals":0,"assists":0,"cleanSheets":14,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":377,"psid":"SEVEN_4p","nickname":"セブン","realName":null,"teamId":710,"teamName":"Team 710","number":"7","card":"-","overall":54,"apps":5,"winRate":80,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":378,"psid":"SHISHAMO_04","nickname":"ししゃも","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":null,"card":"-","overall":null,"apps":3,"winRate":33,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":379,"psid":"SHiNp7","nickname":"しんぺい","realName":null,"teamId":481,"teamName":"Team 481","number":"30","card":"-","overall":null,"apps":8,"winRate":0,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":380,"psid":"SMAP_SATOSHI","nickname":"みーと","realName":null,"teamId":76,"teamName":"MK BOMB","number":"99","card":"-","overall":65,"apps":22,"winRate":36,"goals":0,"assists":0,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":381,"psid":"SNAF_KN725","nickname":"リョー","realName":null,"teamId":146,"teamName":"Team 146","number":"87","card":"-","overall":64,"apps":8,"winRate":88,"goals":6,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW05","TOTW08","TOTW09"],"specialCards":[],"status":"退団"},
  {"id":382,"psid":"SNOOPY_034","nickname":"スヌーピー","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":78,"winRate":26,"goals":5,"assists":4,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":383,"psid":"SNogu8910","nickname":"のぐ","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":70,"winRate":48,"goals":51,"assists":13,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":384,"psid":"SPARE-PART-0818","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":18,"winRate":55,"goals":3,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":385,"psid":"SR4_A24","nickname":"ベッカム","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":26,"winRate":53,"goals":1,"assists":6,"cleanSheets":9,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":386,"psid":"STM8800","nickname":"ウィル","realName":null,"teamId":143,"teamName":"Team 143","number":null,"card":"-","overall":null,"apps":22,"winRate":77,"goals":0,"assists":2,"cleanSheets":17,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":387,"psid":"SUKIKATTE3","nickname":"カッテ","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":39,"winRate":35,"goals":6,"assists":6,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":388,"psid":"SUNE0_returns","nickname":"スネオ","realName":null,"teamId":626,"teamName":"OKUMURA KOUKI","number":null,"card":"-","overall":null,"apps":3,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":389,"psid":"S_mappy_","nickname":"マッピー","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":15,"winRate":33,"goals":2,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":390,"psid":"Sakai_KJ","nickname":"Sakai_KJ","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":3,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":391,"psid":"Sakutaku0124","nickname":"バルス","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":13,"winRate":23,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":392,"psid":"Salah_0112","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"12","card":"-","overall":null,"apps":7,"winRate":14,"goals":0,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":393,"psid":"Sarr14_","nickname":"サール","realName":null,"teamId":361,"teamName":"Team 361","number":"14","card":"-","overall":56,"apps":20,"winRate":45,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":394,"psid":"See_Through21-21","nickname":"Dont_cut_in_line","realName":null,"teamId":546,"teamName":"Team 546","number":"90","card":"-","overall":61,"apps":22,"winRate":50,"goals":3,"assists":0,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":395,"psid":"SeriTheWorld_2","nickname":"せり","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"31","card":"-","overall":54,"apps":31,"winRate":54,"goals":0,"assists":0,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":396,"psid":"ShavadaDubiDaba","nickname":"ペラ","realName":null,"teamId":430,"teamName":"Team 430","number":"24","card":"-","overall":85,"apps":1,"winRate":100,"goals":1,"assists":15,"cleanSheets":5,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":397,"psid":"Shinononon1","nickname":"よんちゃん","realName":null,"teamId":546,"teamName":"Team 546","number":"36","card":"-","overall":54,"apps":11,"winRate":27,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":398,"psid":"Shootaka","nickname":"SARU","realName":null,"teamId":546,"teamName":"Team 546","number":"1","card":"-","overall":81,"apps":22,"winRate":50,"goals":4,"assists":19,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW04","TOTW08"],"specialCards":[],"status":"在籍"},
  {"id":399,"psid":"SiN_brkmn_Sky","nickname":null,"realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":400,"psid":"SipRhyme","nickname":"シマムー","realName":null,"teamId":143,"teamName":"Team 143","number":"21","card":"-","overall":59,"apps":14,"winRate":64,"goals":1,"assists":6,"cleanSheets":12,"yellow":0,"red":0,"labels":["TOTW05"],"specialCards":[],"status":"在籍"},
  {"id":401,"psid":"Siva__0b","nickname":"クロマメ","realName":null,"teamId":146,"teamName":"Team 146","number":"6","card":"-","overall":52,"apps":8,"winRate":37,"goals":15,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":402,"psid":"SizaceIona","nickname":"シザ","realName":null,"teamId":361,"teamName":"Team 361","number":"85","card":"-","overall":61,"apps":5,"winRate":60,"goals":12,"assists":16,"cleanSheets":17,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":403,"psid":"Small33","nickname":"すもる","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"33","card":"-","overall":54,"apps":16,"winRate":43,"goals":0,"assists":0,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":404,"psid":"SrvVinci2","nickname":"みんご","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":405,"psid":"Strormcrow","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"22","card":"-","overall":54,"apps":12,"winRate":66,"goals":0,"assists":3,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":406,"psid":"Suke_Home","nickname":"スケホーム","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":7,"winRate":14,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":407,"psid":"Sun7_no_tila","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":25,"winRate":40,"goals":2,"assists":3,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":408,"psid":"Surfman_","nickname":"さー","realName":null,"teamId":430,"teamName":"Team 430","number":"11","card":"-","overall":54,"apps":10,"winRate":20,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":409,"psid":"T-K-F-Iseya","nickname":null,"realName":null,"teamId":655,"teamName":"Ardwick","number":"83","card":"-","overall":54,"apps":33,"winRate":33,"goals":0,"assists":0,"cleanSheets":10,"yellow":0,"red":0,"labels":["TOTW03"],"specialCards":[],"status":"在籍"},
  {"id":410,"psid":"T-K-S-55","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":411,"psid":"TA-YA_Xll","nickname":"ターヤ","realName":null,"teamId":511,"teamName":"Hookar","number":"6","card":"-","overall":54,"apps":10,"winRate":70,"goals":4,"assists":1,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":412,"psid":"TAIPIKI_TK","nickname":"TAIPIKI_TK","realName":null,"teamId":462,"teamName":"Team 462","number":"10","card":"-","overall":54,"apps":16,"winRate":12,"goals":6,"assists":1,"cleanSheets":17,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":413,"psid":"TAKATAKA0109","nickname":"タカ","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":8,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":414,"psid":"TAKEZO81","nickname":"うどん","realName":null,"teamId":544,"teamName":"Team 544","number":"9","card":"-","overall":54,"apps":8,"winRate":62,"goals":4,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":415,"psid":"TANAKAM_JYT","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":"7","card":"-","overall":54,"apps":25,"winRate":16,"goals":2,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":416,"psid":"TATIS_JR2323","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":"23","card":"-","overall":null,"apps":6,"winRate":83,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":417,"psid":"TK-3-2000","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"3","card":"-","overall":54,"apps":10,"winRate":20,"goals":0,"assists":0,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":418,"psid":"TMhorn","nickname":"ティーエム","realName":null,"teamId":212,"teamName":"Team 212","number":"20","card":"-","overall":null,"apps":8,"winRate":62,"goals":1,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":419,"psid":"TONI_02_","nickname":"トニ","realName":null,"teamId":212,"teamName":"Team 212","number":"8","card":"-","overall":54,"apps":8,"winRate":62,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":420,"psid":"TORA-17-","nickname":"トラ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":17,"winRate":58,"goals":0,"assists":4,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":421,"psid":"TUNKU-f400-","nickname":null,"realName":null,"teamId":101,"teamName":"AKATUKI","number":"33","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":422,"psid":"TURBO_turbo0130","nickname":"ターボ","realName":null,"teamId":73,"teamName":"Team 073","number":"2","card":"-","overall":60,"apps":1,"winRate":40,"goals":3,"assists":7,"cleanSheets":26,"yellow":0,"red":1,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":423,"psid":"TaIsi_30","nickname":"タイシ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":93,"winRate":26,"goals":2,"assists":2,"cleanSheets":24,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":424,"psid":"TaMuRaHoNo2KZ46","nickname":"さもきち","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":10,"winRate":30,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":425,"psid":"Tadano_Kakashl","nickname":"カカシ","realName":null,"teamId":143,"teamName":"Team 143","number":"2","card":"-","overall":74,"apps":4,"winRate":50,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":426,"psid":"Taekkyon","nickname":"Taekkyon","realName":null,"teamId":546,"teamName":"Team 546","number":null,"card":"-","overall":null,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":427,"psid":"Takaback93","nickname":"たかおみ","realName":null,"teamId":545,"teamName":"Tesuryo","number":"30","card":"-","overall":72,"apps":16,"winRate":50,"goals":9,"assists":27,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW01","TOTW02"],"specialCards":[],"status":"在籍"},
  {"id":428,"psid":"Takezabeth","nickname":"ザベス","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":429,"psid":"TamokichiFire","nickname":"みーと","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":22,"winRate":45,"goals":6,"assists":4,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":430,"psid":"Tanachin_n","nickname":"田中","realName":null,"teamId":143,"teamName":"Team 143","number":"18","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":431,"psid":"Tesseract-22","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":"33","card":"-","overall":54,"apps":8,"winRate":25,"goals":3,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":432,"psid":"Th1qgo-UMG","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":6,"winRate":16,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":433,"psid":"The_Logic_Mello","nickname":"ブラックマン","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":434,"psid":"Titogba11","nickname":"コウキ","realName":null,"teamId":146,"teamName":"Team 146","number":"11","card":"-","overall":64,"apps":20,"winRate":60,"goals":14,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW03","TOTW04","TOTW10"],"specialCards":[],"status":"退団"},
  {"id":435,"psid":"Tktmasayosi24","nickname":null,"realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"13","card":"-","overall":54,"apps":26,"winRate":42,"goals":0,"assists":0,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":436,"psid":"To-gawa8396","nickname":"とがわ","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"8","card":"-","overall":54,"apps":5,"winRate":40,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":437,"psid":"ToRPopcorn","nickname":"レイ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":51,"winRate":33,"goals":7,"assists":7,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":438,"psid":"ToR_Pop-corn","nickname":"レイ","realName":null,"teamId":546,"teamName":"Team 546","number":"75","card":"-","overall":54,"apps":22,"winRate":50,"goals":7,"assists":12,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":439,"psid":"TokiOn2000","nickname":"ニセン","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":6,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":440,"psid":"Tokumori-Gyudon-","nickname":"特盛ぎゅーどん","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"1","card":"-","overall":59,"apps":20,"winRate":75,"goals":0,"assists":0,"cleanSheets":14,"yellow":0,"red":0,"labels":["TOTW02","TOTW04","EAFC17","TOTW08","TOTW10"],"specialCards":[],"status":"退団"},
  {"id":441,"psid":"Tsakt_916","nickname":"ツァクト","realName":null,"teamId":143,"teamName":"Team 143","number":null,"card":"-","overall":57,"apps":143,"winRate":69,"goals":21,"assists":29,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":442,"psid":"Tsunakan_2756","nickname":"Tsunakan_2756","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":443,"psid":"Tsuyu_Bou","nickname":"つゆぼう","realName":null,"teamId":361,"teamName":"Team 361","number":"10","card":"-","overall":72,"apps":22,"winRate":50,"goals":11,"assists":2,"cleanSheets":4,"yellow":1,"red":0,"labels":["TOTW02"],"specialCards":[],"status":"在籍"},
  {"id":444,"psid":"USK_113","nickname":"ゆー","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":11,"winRate":45,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":445,"psid":"Uma-graffitti","nickname":"ゆうま","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"27","card":"-","overall":54,"apps":2,"winRate":100,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":446,"psid":"Undead_Van06","nickname":"Undead_Van06","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":10,"winRate":70,"goals":0,"assists":0,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":447,"psid":"Undertaker_ysk","nickname":"ワイエスケー","realName":null,"teamId":146,"teamName":"Team 146","number":"23","card":"-","overall":84,"apps":18,"winRate":67,"goals":0,"assists":3,"cleanSheets":5,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"退団"},
  {"id":448,"psid":"UruTear_17","nickname":"ウルティア","realName":null,"teamId":655,"teamName":"Ardwick","number":"17","card":"-","overall":54,"apps":34,"winRate":35,"goals":5,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":449,"psid":"V--SECRET","nickname":"シクニキ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"2","card":"-","overall":54,"apps":16,"winRate":37,"goals":0,"assists":0,"cleanSheets":7,"yellow":1,"red":0,"labels":["TOTW09","TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":450,"psid":"V-kawa6-V","nickname":"カワ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":40,"winRate":27,"goals":4,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":451,"psid":"VAR001","nickname":null,"realName":null,"teamId":655,"teamName":"Ardwick","number":"7","card":"-","overall":54,"apps":15,"winRate":13,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":452,"psid":"Vans_Lino","nickname":"バンズ","realName":null,"teamId":146,"teamName":"Team 146","number":"14","card":"-","overall":56,"apps":20,"winRate":65,"goals":46,"assists":5,"cleanSheets":11,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":453,"psid":"Vermouth_LFC4869","nickname":"テツ","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":11,"winRate":45,"goals":1,"assists":1,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":454,"psid":"Veruxq","nickname":"なー","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":32,"winRate":37,"goals":1,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":455,"psid":"Violence-R18","nickname":"はるしるば","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":48,"winRate":33,"goals":27,"assists":10,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":456,"psid":"VitaminWater40","nickname":"あやたか","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":11,"winRate":27,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":457,"psid":"Vq1En_PK-KiLLer","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":87,"winRate":44,"goals":50,"assists":26,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW03","TOTW04"],"specialCards":[],"status":"退団"},
  {"id":458,"psid":"WE_ryu-chan","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":"7","card":"-","overall":54,"apps":11,"winRate":27,"goals":3,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":459,"psid":"WOL–1KER_LEGEND","nickname":"THE_1KER_ONE","realName":null,"teamId":462,"teamName":"Team 462","number":"1","card":"-","overall":54,"apps":22,"winRate":9,"goals":0,"assists":1,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":460,"psid":"Wasa7-miComet","nickname":"わさやん","realName":null,"teamId":547,"teamName":"HANNARI FC","number":null,"card":"-","overall":null,"apps":36,"winRate":58,"goals":2,"assists":2,"cleanSheets":10,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":461,"psid":"WeAreTheSARUs","nickname":"WeAreTheSARUs","realName":null,"teamId":546,"teamName":"Team 546","number":"17","card":"-","overall":54,"apps":30,"winRate":50,"goals":0,"assists":3,"cleanSheets":13,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":462,"psid":"We_play_Music","nickname":"ウィー","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":15,"winRate":20,"goals":0,"assists":2,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":463,"psid":"Wildspeedak69","nickname":"エーケー","realName":null,"teamId":545,"teamName":"Tesuryo","number":"14","card":"-","overall":81,"apps":20,"winRate":50,"goals":0,"assists":0,"cleanSheets":8,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":464,"psid":"Win_and_shine","nickname":"えすいー","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":11,"winRate":46,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":465,"psid":"Winson_Weirdo","nickname":"ウィンソン","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":2,"winRate":100,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":466,"psid":"X__LARGE__","nickname":"X__LARGE__","realName":null,"teamId":546,"teamName":"Team 546","number":"2","card":"-","overall":54,"apps":40,"winRate":50,"goals":1,"assists":5,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":467,"psid":"Y400-4926","nickname":"ゆう","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":26,"winRate":38,"goals":9,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":468,"psid":"YAHOO-_-SASAKI","nickname":"ささき","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"33","card":"-","overall":54,"apps":12,"winRate":41,"goals":9,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":469,"psid":"YAMADA-KATSUO_","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":27,"winRate":44,"goals":0,"assists":1,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":470,"psid":"YDUBD","nickname":"ゆう","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"89","card":"-","overall":54,"apps":4,"winRate":15,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":471,"psid":"YGGD0320","nickname":"クズマノ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":4,"winRate":50,"goals":0,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":472,"psid":"YGGDO0320","nickname":"クズマノ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":473,"psid":"YNWA96_yu","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":7,"winRate":71,"goals":5,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":474,"psid":"YUUICHI0529","nickname":"YUUICHI0529","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"29","card":"-","overall":64,"apps":8,"winRate":25,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":475,"psid":"YUZU_IKUTA","nickname":"ゆず","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":7,"winRate":28,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":476,"psid":"YYT18_","nickname":"ユヤ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":80,"winRate":61,"goals":3,"assists":7,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":477,"psid":"Y__HORNET__Y","nickname":"オーライ","realName":null,"teamId":481,"teamName":"Team 481","number":null,"card":"-","overall":null,"apps":6,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":478,"psid":"Yasaka_Kou","nickname":"ヤサカ","realName":null,"teamId":655,"teamName":"Ardwick","number":null,"card":"-","overall":null,"apps":10,"winRate":60,"goals":0,"assists":0,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":479,"psid":"Yawnmada","nickname":null,"realName":null,"teamId":547,"teamName":"HANNARI FC","number":"4","card":"-","overall":54,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":480,"psid":"Yellow-Pato-__","nickname":"らいらい","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":5,"winRate":40,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":481,"psid":"Yopi_7","nickname":"よぴ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":6,"winRate":33,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":482,"psid":"Yossing1109","nickname":null,"realName":null,"teamId":101,"teamName":"AKATUKI","number":"34","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":483,"psid":"YoungMountain_W","nickname":"おくむらこうきラバー","realName":null,"teamId":626,"teamName":"OKUMURA KOUKI","number":"14","card":"-","overall":54,"apps":15,"winRate":0,"goals":2,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":484,"psid":"YuNapoli24147","nickname":"嘘つきピーター","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":3,"winRate":66,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":485,"psid":"ZAION777","nickname":"タンケダ","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"4","card":"-","overall":84,"apps":8,"winRate":62,"goals":7,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"退団"},
  {"id":486,"psid":"ZETA_DIESEL","nickname":null,"realName":null,"teamId":652,"teamName":"WAKAMONO","number":"17","card":"-","overall":54,"apps":10,"winRate":70,"goals":3,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":487,"psid":"ZI-no166","nickname":"ジジ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":45,"winRate":28,"goals":1,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":488,"psid":"Zayn_Malik_123","nickname":"ワイケーシー","realName":null,"teamId":545,"teamName":"Tesuryo","number":"9","card":"-","overall":58,"apps":20,"winRate":45,"goals":3,"assists":7,"cleanSheets":0,"yellow":0,"red":0,"labels":["EAFC17"],"specialCards":[],"status":"在籍"},
  {"id":489,"psid":"Zeeda_SD","nickname":"ゼーダ","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":7,"winRate":14,"goals":1,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":490,"psid":"Zumarkovic","nickname":"ビッチ","realName":null,"teamId":154,"teamName":"Team 154","number":"3","card":"-","overall":84,"apps":6,"winRate":33,"goals":3,"assists":3,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW04","CORN02"],"specialCards":[],"status":"在籍"},
  {"id":491,"psid":"_ABS_2142","nickname":null,"realName":null,"teamId":545,"teamName":"Tesuryo","number":null,"card":"-","overall":54,"apps":10,"winRate":70,"goals":1,"assists":4,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":492,"psid":"a_tomo84","nickname":"あと","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":243,"winRate":51,"goals":82,"assists":54,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":493,"psid":"acm-mcu","nickname":"ミラン","realName":null,"teamId":655,"teamName":"Ardwick","number":"99","card":"-","overall":54,"apps":16,"winRate":31,"goals":1,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":494,"psid":"actor-Yasu22","nickname":"ひろ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":26,"winRate":3,"goals":2,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":495,"psid":"acxlapin","nickname":"こみ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"5","card":"-","overall":84,"apps":20,"winRate":20,"goals":2,"assists":0,"cleanSheets":7,"yellow":0,"red":0,"labels":["TOTW04","CORN01"],"specialCards":[],"status":"退団"},
  {"id":496,"psid":"ada_ma","nickname":"こけし","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":27,"winRate":22,"goals":2,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":497,"psid":"afc_fan05","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":"13","card":"-","overall":54,"apps":20,"winRate":35,"goals":9,"assists":0,"cleanSheets":0,"yellow":1,"red":0,"labels":["TOTW01","TOTW02"],"specialCards":[],"status":"在籍"},
  {"id":498,"psid":"aizawasan21","nickname":"ざーさん","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":10,"winRate":40,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":499,"psid":"akires819youtube","nickname":"アサヒ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":8,"winRate":75,"goals":0,"assists":2,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":500,"psid":"alderweireld_08","nickname":"はち","realName":null,"teamId":461,"teamName":"Team 461","number":"11","card":"-","overall":59,"apps":75,"winRate":41,"goals":7,"assists":8,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":501,"psid":"alucowl","nickname":"ある","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":186,"winRate":50,"goals":3,"assists":4,"cleanSheets":54,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":502,"psid":"ame_HaiL","nickname":"ame_HaiL","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":21,"winRate":66,"goals":0,"assists":2,"cleanSheets":11,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":503,"psid":"analysis14","nickname":"れっど","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":12,"winRate":58,"goals":0,"assists":0,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":504,"psid":"aotan15","nickname":"アオト","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":14,"winRate":21,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":505,"psid":"aq14923","nickname":"あきゅ","realName":null,"teamId":511,"teamName":"Hookar","number":"4","card":"-","overall":null,"apps":8,"winRate":75,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":506,"psid":"arahatik-kaicho","nickname":null,"realName":null,"teamId":695,"teamName":"ArahatikJP","number":"96","card":"-","overall":54,"apps":8,"winRate":25,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":507,"psid":"arctic-antarctic","nickname":"どんたこす","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"24","card":"-","overall":54,"apps":27,"winRate":48,"goals":3,"assists":6,"cleanSheets":3,"yellow":0,"red":0,"labels":["TOTW03"],"specialCards":[],"status":"在籍"},
  {"id":508,"psid":"arsfm68","nickname":"リル","realName":null,"teamId":655,"teamName":"Ardwick","number":"58","card":"-","overall":54,"apps":34,"winRate":35,"goals":4,"assists":1,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":509,"psid":"arthiro","nickname":"ヒロ","realName":null,"teamId":655,"teamName":"Ardwick","number":"18","card":"-","overall":54,"apps":23,"winRate":47,"goals":1,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":510,"psid":"astrononmical","nickname":"アストロ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":23,"winRate":26,"goals":8,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":511,"psid":"asuya8msy0hl7","nickname":"アスヤシキ","realName":null,"teamId":73,"teamName":"Team 073","number":"7","card":"-","overall":73,"apps":22,"winRate":50,"goals":28,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":["EAFC17","TOTW08","TOTW09"],"specialCards":[],"status":"退団"},
  {"id":512,"psid":"ataru-bb","nickname":"アタル","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"87","card":"-","overall":54,"apps":24,"winRate":58,"goals":0,"assists":0,"cleanSheets":10,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":513,"psid":"atiekeita999","nickname":"ルイス","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"17","card":"-","overall":54,"apps":30,"winRate":13,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":514,"psid":"atoxp","nickname":"atoxp","realName":null,"teamId":511,"teamName":"Hookar","number":"17","card":"-","overall":85,"apps":8,"winRate":75,"goals":69,"assists":27,"cleanSheets":0,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":515,"psid":"atsuya-bb","nickname":"アツヤ","realName":null,"teamId":143,"teamName":"Team 143","number":"10","card":"-","overall":60,"apps":4,"winRate":75,"goals":2,"assists":72,"cleanSheets":21,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":516,"psid":"ayayagumicompany","nickname":"あやや","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":21,"winRate":38,"goals":1,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":517,"psid":"azzurri5104","nickname":"アズ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":21,"winRate":28,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":518,"psid":"babylon0987","nickname":"バベル","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":22,"winRate":40,"goals":1,"assists":6,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":519,"psid":"bad_vibes-71","nickname":null,"realName":null,"teamId":101,"teamName":"AKATUKI","number":"18","card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":520,"psid":"banbi-_-","nickname":"バンビ","realName":null,"teamId":481,"teamName":"Team 481","number":"5","card":"-","overall":54,"apps":6,"winRate":25,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":521,"psid":"bao96jp","nickname":"ばお","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":6,"winRate":83,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":522,"psid":"beibure-do","nickname":"ビシャ","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"26","card":"-","overall":81,"apps":19,"winRate":26,"goals":0,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":523,"psid":"blue-moon-3116","nickname":"サキッチョ","realName":null,"teamId":212,"teamName":"Team 212","number":"18","card":"-","overall":54,"apps":8,"winRate":62,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":524,"psid":"bobio4444","nickname":"bobio4444","realName":null,"teamId":462,"teamName":"Team 462","number":"31","card":"-","overall":54,"apps":10,"winRate":20,"goals":4,"assists":2,"cleanSheets":13,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":525,"psid":"bra_via5k","nickname":"bra_via5k","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":67,"winRate":50,"goals":16,"assists":5,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":526,"psid":"braiansatou","nickname":"リキ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":12,"winRate":16,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":527,"psid":"bucciarati-927","nickname":"ブチャラティ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"30","card":"-","overall":54,"apps":4,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":528,"psid":"buffalo----16","nickname":"バッファロー","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":4,"winRate":25,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":529,"psid":"bumpofryu","nickname":"りゅう","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":10,"winRate":20,"goals":3,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":530,"psid":"buraiansatou","nickname":"リキ","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"9","card":"-","overall":54,"apps":19,"winRate":26,"goals":7,"assists":6,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":531,"psid":"buzzy0m0d0","nickname":null,"realName":null,"teamId":626,"teamName":"OKUMURA KOUKI","number":"4","card":"-","overall":54,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":532,"psid":"byodoin__asahi","nickname":"あさひ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"2","card":"-","overall":54,"apps":18,"winRate":25,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":533,"psid":"c_h_a_s__","nickname":"c_h_a_s__","realName":null,"teamId":545,"teamName":"Tesuryo","number":"74","card":"-","overall":55,"apps":8,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":534,"psid":"caim_433","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":14,"winRate":71,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":535,"psid":"callmecha17","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":"7","card":"-","overall":54,"apps":16,"winRate":43,"goals":12,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":536,"psid":"capistiano","nickname":"シーオレ","realName":null,"teamId":213,"teamName":"Team 213","number":"98","card":"-","overall":84,"apps":22,"winRate":77,"goals":4,"assists":1,"cleanSheets":16,"yellow":0,"red":0,"labels":["TOTW02","TOTW05","EAFC17","TOTW09","CORN02","TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":537,"psid":"caramelo1836","nickname":"ダボ","realName":null,"teamId":694,"teamName":"Forza Perfetta Calcio","number":"21","card":"-","overall":64,"apps":11,"winRate":45,"goals":1,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":["TOTW02","TOTW04"],"specialCards":[],"status":"在籍"},
  {"id":538,"psid":"catcat-reona0502","nickname":"くるぶし","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":9,"winRate":55,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":539,"psid":"catcat_reona0502","nickname":"かんだい","realName":null,"teamId":545,"teamName":"Tesuryo","number":"25","card":"-","overall":75,"apps":22,"winRate":50,"goals":5,"assists":0,"cleanSheets":9,"yellow":0,"red":0,"labels":["TOTW01","TOTW02"],"specialCards":[],"status":"在籍"},
  {"id":540,"psid":"cfc_tito11","nickname":"ケビン","realName":null,"teamId":461,"teamName":"Team 461","number":"7","card":"-","overall":59,"apps":22,"winRate":54,"goals":13,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW03","TOTW09"],"specialCards":[],"status":"在籍"},
  {"id":541,"psid":"cha_chika9","nickname":"チカラ","realName":null,"teamId":481,"teamName":"Team 481","number":"10","card":"-","overall":54,"apps":18,"winRate":35,"goals":2,"assists":2,"cleanSheets":2,"yellow":0,"red":0,"labels":["TOTW05"],"specialCards":[],"status":"在籍"},
  {"id":542,"psid":"chanc-el92","nickname":"ちゃんく","realName":null,"teamId":698,"teamName":"Team 698","number":"9","card":"-","overall":85,"apps":8,"winRate":25,"goals":2,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":543,"psid":"chanchan_TAISA","nickname":"タイサ","realName":null,"teamId":212,"teamName":"Team 212","number":"99","card":"-","overall":61,"apps":3,"winRate":33,"goals":39,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":544,"psid":"checheru","nickname":"くそじじい","realName":null,"teamId":546,"teamName":"Team 546","number":"87","card":"-","overall":54,"apps":57,"winRate":47,"goals":0,"assists":0,"cleanSheets":18,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":545,"psid":"chelmadrid","nickname":"角煮きのこ","realName":null,"teamId":461,"teamName":"Team 461","number":"33","card":"-","overall":57,"apps":20,"winRate":50,"goals":8,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":546,"psid":"chely-0819","nickname":"チェリー","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"4","card":"-","overall":54,"apps":17,"winRate":11,"goals":2,"assists":2,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":547,"psid":"chiaki07070613","nickname":"ちあき","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":17,"winRate":58,"goals":0,"assists":1,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":548,"psid":"chiptune58","nickname":"ちっぷ","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":549,"psid":"chirin777","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":6,"winRate":66,"goals":0,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":550,"psid":"choco_anpanR","nickname":"チョコ","realName":null,"teamId":481,"teamName":"Team 481","number":"22","card":"-","overall":54,"apps":20,"winRate":34,"goals":0,"assists":4,"cleanSheets":2,"yellow":0,"red":1,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":551,"psid":"chomango97","nickname":null,"realName":null,"teamId":694,"teamName":"Forza Perfetta Calcio","number":"10","card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":552,"psid":"chupa1109","nickname":"チュパ","realName":null,"teamId":546,"teamName":"Team 546","number":"19","card":"-","overall":57,"apps":25,"winRate":36,"goals":8,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":553,"psid":"city_nana7","nickname":"ザック","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":30,"winRate":33,"goals":1,"assists":0,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":554,"psid":"cobra_7gravity","nickname":"コブラ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":25,"winRate":32,"goals":11,"assists":2,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":555,"psid":"coca-in-zion","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":39,"winRate":51,"goals":0,"assists":0,"cleanSheets":10,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":556,"psid":"cocohiko193","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":"69","card":"-","overall":54,"apps":12,"winRate":16,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":557,"psid":"conical_rattle3","nickname":"ジャビィ","realName":null,"teamId":511,"teamName":"Hookar","number":"25","card":"-","overall":64,"apps":8,"winRate":75,"goals":2,"assists":18,"cleanSheets":2,"yellow":0,"red":0,"labels":["TOTW09"],"specialCards":[],"status":"在籍"},
  {"id":558,"psid":"coward_fox11","nickname":"ひば","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":11,"winRate":72,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":559,"psid":"crazy_keito1212","nickname":"ケイト","realName":null,"teamId":545,"teamName":"Tesuryo","number":"17","card":"-","overall":62,"apps":4,"winRate":50,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":560,"psid":"d0gulu__m","nickname":null,"realName":null,"teamId":143,"teamName":"Team 143","number":"37","card":"-","overall":54,"apps":22,"winRate":64,"goals":7,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW01","TOTW03","TOTW09"],"specialCards":[],"status":"在籍"},
  {"id":561,"psid":"daipop_","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":562,"psid":"danger-golila","nickname":"デンゴリ","realName":null,"teamId":361,"teamName":"Team 361","number":"56","card":"-","overall":54,"apps":4,"winRate":50,"goals":0,"assists":1,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":563,"psid":"danron0215","nickname":"ミルナー","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":3,"winRate":66,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":564,"psid":"dark-ness072","nickname":"おかわり","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":114,"winRate":45,"goals":2,"assists":24,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":565,"psid":"dcg-p","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":23,"winRate":69,"goals":3,"assists":3,"cleanSheets":3,"yellow":0,"red":0,"labels":["TOTW04"],"specialCards":[],"status":"退団"},
  {"id":566,"psid":"delicious_soda32","nickname":"たんさんすい","realName":null,"teamId":546,"teamName":"Team 546","number":"6","card":"-","overall":54,"apps":8,"winRate":25,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":567,"psid":"delpielle","nickname":"デル","realName":null,"teamId":430,"teamName":"Team 430","number":"10","card":"-","overall":84,"apps":8,"winRate":37,"goals":6,"assists":15,"cleanSheets":7,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":568,"psid":"didgedilli-p","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"36","card":"-","overall":54,"apps":16,"winRate":18,"goals":0,"assists":1,"cleanSheets":5,"yellow":0,"red":0,"labels":["TOTW03"],"specialCards":[],"status":"在籍"},
  {"id":569,"psid":"dimmer12","nickname":"ディマ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":21,"winRate":42,"goals":0,"assists":0,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":570,"psid":"direnma_ohuro","nickname":"オフロスキー","realName":null,"teamId":212,"teamName":"Team 212","number":"26","card":"-","overall":54,"apps":12,"winRate":41,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":571,"psid":"dlplalana","nickname":"よしき","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":13,"winRate":69,"goals":0,"assists":1,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":572,"psid":"dnypro","nickname":"ドニ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":26,"winRate":50,"goals":0,"assists":2,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":573,"psid":"domingesu-0019","nickname":"ドミンゲス","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":27,"winRate":33,"goals":5,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":574,"psid":"dondons99","nickname":null,"realName":null,"teamId":101,"teamName":"AKATUKI","number":"36","card":"-","overall":54,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":575,"psid":"doukan_ota","nickname":"おおたどうかん","realName":null,"teamId":694,"teamName":"Forza Perfetta Calcio","number":"6","card":"-","overall":null,"apps":4,"winRate":75,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":576,"psid":"dq44e","nickname":"とまじろー","realName":null,"teamId":710,"teamName":"Team 710","number":"10","card":"-","overall":64,"apps":3,"winRate":67,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":["TOTW05","JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":577,"psid":"dri__ft","nickname":"ドリフト","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"16","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":578,"psid":"dundun8128","nickname":"ビンドゥンドゥン","realName":null,"teamId":101,"teamName":"AKATUKI","number":"22","card":"-","overall":61,"apps":8,"winRate":12,"goals":1,"assists":1,"cleanSheets":17,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":579,"psid":"dygG554","nickname":"タケ","realName":null,"teamId":212,"teamName":"Team 212","number":"30","card":"-","overall":83,"apps":6,"winRate":66,"goals":16,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":580,"psid":"e-hiRomaneeConti","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":24,"winRate":45,"goals":1,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":581,"psid":"e0qv_ive","nickname":"いぶ","realName":null,"teamId":626,"teamName":"OKUMURA KOUKI","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":582,"psid":"ebi_pool0528","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":"95","card":"-","overall":54,"apps":2,"winRate":100,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":583,"psid":"eiko102jp","nickname":"wani102417","realName":null,"teamId":462,"teamName":"Team 462","number":"27","card":"-","overall":73,"apps":10,"winRate":10,"goals":6,"assists":3,"cleanSheets":1,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":584,"psid":"employee_roster","nickname":"employee_roster","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":31,"winRate":38,"goals":0,"assists":1,"cleanSheets":9,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":585,"psid":"ersyara","nickname":"エルシャラ","realName":null,"teamId":547,"teamName":"HANNARI FC","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":586,"psid":"eru12__","nickname":"つぽ","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":48,"winRate":42,"goals":8,"assists":8,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":587,"psid":"eses75","nickname":"エス","realName":null,"teamId":481,"teamName":"Team 481","number":"75","card":"-","overall":81,"apps":22,"winRate":35,"goals":13,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":588,"psid":"eucha16_VT_JP","nickname":"えう","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":2,"winRate":100,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":589,"psid":"fCs_zK","nickname":"クルトン","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":4,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":590,"psid":"faason","nickname":"ファソン","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":10,"winRate":50,"goals":1,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":591,"psid":"faith1102","nickname":null,"realName":null,"teamId":101,"teamName":"AKATUKI","number":"38","card":"-","overall":54,"apps":68,"winRate":27,"goals":0,"assists":3,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":592,"psid":"fasson","nickname":"ファソン","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":60,"winRate":43,"goals":5,"assists":8,"cleanSheets":10,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":593,"psid":"fcb10masa","nickname":"オシム","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":87,"winRate":42,"goals":0,"assists":1,"cleanSheets":30,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":594,"psid":"fcpc-shishi","nickname":"シシ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":77,"winRate":54,"goals":54,"assists":22,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":595,"psid":"fitted_wagon0","nickname":"関口","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":6,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":596,"psid":"flounder----18","nickname":"みつ","realName":null,"teamId":361,"teamName":"Team 361","number":"30","card":"-","overall":85,"apps":22,"winRate":50,"goals":4,"assists":3,"cleanSheets":1,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":597,"psid":"foottaichi","nickname":"タイチ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":10,"winRate":20,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":598,"psid":"forza_InterYn55","nickname":"エイジ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":17,"winRate":5,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":599,"psid":"ft9-che","nickname":"よっぴ","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"10","card":"-","overall":81,"apps":14,"winRate":21,"goals":9,"assists":4,"cleanSheets":1,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":600,"psid":"fu--rufu","nickname":"フル","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":16,"winRate":43,"goals":0,"assists":2,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":601,"psid":"fuko-D5asurum","nickname":"フコ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":10,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":602,"psid":"fulagukentiku","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"4","card":"-","overall":73,"apps":16,"winRate":31,"goals":0,"assists":1,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":603,"psid":"funyaXD","nickname":"フナキ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":14,"winRate":21,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":604,"psid":"fuuma-fuuma","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"23","card":"-","overall":54,"apps":23,"winRate":43,"goals":0,"assists":0,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":605,"psid":"fuumin_soccer_","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"86","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":606,"psid":"fuzzy_suit42","nickname":"ミノ","realName":null,"teamId":146,"teamName":"Team 146","number":"42","card":"-","overall":85,"apps":22,"winRate":63,"goals":22,"assists":9,"cleanSheets":15,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":607,"psid":"g_dSiva","nickname":"シヴァ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":608,"psid":"gajumaruuuuuuu","nickname":"ガジュマル","realName":null,"teamId":461,"teamName":"Team 461","number":"22","card":"-","overall":54,"apps":14,"winRate":21,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":609,"psid":"gan-next-boy","nickname":"エルニーニョ","realName":null,"teamId":154,"teamName":"Team 154","number":"10","card":"-","overall":84,"apps":8,"winRate":37,"goals":1,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":["TOTW01","JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":610,"psid":"ganorugu","nickname":"ガノルグ","realName":null,"teamId":146,"teamName":"Team 146","number":"9","card":"-","overall":81,"apps":20,"winRate":70,"goals":17,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW03","TOTW05","TOTW08","TOTW09"],"specialCards":[],"status":"在籍"},
  {"id":611,"psid":"garchomp_4","nickname":"まとや","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":38,"winRate":52,"goals":2,"assists":6,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":612,"psid":"garou0219-2","nickname":"ガロウ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"19","card":"-","overall":54,"apps":22,"winRate":13,"goals":6,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":613,"psid":"gashi_66","nickname":"ガーシー","realName":null,"teamId":146,"teamName":"Team 146","number":"2","card":"-","overall":80,"apps":22,"winRate":63,"goals":1,"assists":1,"cleanSheets":15,"yellow":0,"red":0,"labels":["THUN17","TOTW08","TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":614,"psid":"gehataku","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"7","card":"-","overall":54,"apps":14,"winRate":14,"goals":1,"assists":1,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":615,"psid":"genius_rin","nickname":"ディスク","realName":null,"teamId":361,"teamName":"Team 361","number":"7","card":"-","overall":85,"apps":22,"winRate":50,"goals":4,"assists":8,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW02","TOTW05"],"specialCards":[],"status":"在籍"},
  {"id":616,"psid":"genki09-24","nickname":"げんき","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"24","card":"-","overall":54,"apps":10,"winRate":20,"goals":5,"assists":8,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":617,"psid":"genteel-stack02","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":618,"psid":"gihren-z240","nickname":null,"realName":null,"teamId":652,"teamName":"WAKAMONO","number":null,"card":"-","overall":null,"apps":9,"winRate":66,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":619,"psid":"gipple--","nickname":"ギップル","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":4,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":620,"psid":"glitter-_-","nickname":"ぐり","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"9","card":"-","overall":null,"apps":5,"winRate":40,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":621,"psid":"gloria--1026","nickname":"ポンデ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":7,"winRate":14,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":622,"psid":"gobame0808","nickname":"ごばめ","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":6,"winRate":33,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":623,"psid":"goldcloth777","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":"44","card":"-","overall":54,"apps":9,"winRate":44,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":1,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":624,"psid":"gomachanP","nickname":"ゴマチャン","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":625,"psid":"goodsun21","nickname":"グッサン","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"21","card":"-","overall":84,"apps":22,"winRate":18,"goals":0,"assists":0,"cleanSheets":7,"yellow":1,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":626,"psid":"goofyFtai","nickname":"タイチ","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":6,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":627,"psid":"gron1162","nickname":"ジーロン","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":18,"winRate":22,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":628,"psid":"guava--22","nickname":"ぐあば","realName":null,"teamId":143,"teamName":"Team 143","number":"55","card":"-","overall":60,"apps":18,"winRate":67,"goals":0,"assists":0,"cleanSheets":7,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":629,"psid":"guners_yu_77","nickname":"ゆうちゃん","realName":null,"teamId":73,"teamName":"Team 073","number":"47","card":"-","overall":61,"apps":22,"winRate":36,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"移動"},
  {"id":630,"psid":"gunson-x","nickname":"ピグレット","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":8,"winRate":37,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":631,"psid":"guz-yang","nickname":"グズやん","realName":null,"teamId":547,"teamName":"HANNARI FC","number":null,"card":"-","overall":null,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":632,"psid":"h0tate_rbl","nickname":null,"realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":8,"winRate":37,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":633,"psid":"hagakuremind","nickname":"ボーイ","realName":null,"teamId":73,"teamName":"Team 073","number":"18","card":"-","overall":84,"apps":8,"winRate":12,"goals":0,"assists":3,"cleanSheets":1,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":634,"psid":"hage_desune","nickname":"hage_desune","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":7,"winRate":57,"goals":0,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":635,"psid":"hagimaru3150","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":"99","card":"-","overall":54,"apps":24,"winRate":25,"goals":2,"assists":1,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":636,"psid":"hajitoto9","nickname":"ハジ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":33,"winRate":36,"goals":0,"assists":0,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":637,"psid":"hanamarunana","nickname":"ナナマル","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":638,"psid":"hand_in","nickname":"ハンド","realName":null,"teamId":481,"teamName":"Team 481","number":"24","card":"-","overall":55,"apps":4,"winRate":44,"goals":0,"assists":0,"cleanSheets":19,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":639,"psid":"hand_kaz","nickname":"カズ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":103,"winRate":61,"goals":46,"assists":16,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":640,"psid":"happyPremiumg","nickname":"ルーファー","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":5,"winRate":60,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":641,"psid":"happy_yamada","nickname":"ヤマダ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":4,"winRate":25,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":642,"psid":"happyjackun","nickname":"ジャック","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":62,"winRate":58,"goals":12,"assists":12,"cleanSheets":18,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":643,"psid":"happytommyg","nickname":"トミジー","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":644,"psid":"happyukeraizg","nickname":"スレッジ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"19","card":"-","overall":56,"apps":22,"winRate":36,"goals":3,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW08"],"specialCards":[],"status":"在籍"},
  {"id":645,"psid":"harut-munt","nickname":"むんてぃ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"14","card":"-","overall":54,"apps":16,"winRate":37,"goals":3,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":646,"psid":"harut1n1n","nickname":"はるちん","realName":null,"teamId":547,"teamName":"HANNARI FC","number":null,"card":"-","overall":null,"apps":45,"winRate":53,"goals":0,"assists":0,"cleanSheets":18,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":647,"psid":"hassy_tky","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"28","card":"-","overall":84,"apps":16,"winRate":12,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":648,"psid":"have_bullterrier","nickname":"すまいるだいき","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":12,"winRate":50,"goals":1,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":649,"psid":"hawaii_no_kodomo","nickname":"根津","realName":null,"teamId":481,"teamName":"Team 481","number":"39","card":"-","overall":54,"apps":3,"winRate":67,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":650,"psid":"hayato8810CR7","nickname":"ハヤト","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":651,"psid":"hernia_ojisan","nickname":"ナカムラ","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":20,"winRate":15,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":652,"psid":"hhh_14_gg","nickname":"トモ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":18,"winRate":33,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":653,"psid":"hiiiiiiikaru0320","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"29","card":"-","overall":54,"apps":4,"winRate":27,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":654,"psid":"hina_moneylove1","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":"9","card":"-","overall":64,"apps":8,"winRate":37,"goals":7,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW01","TOTW02","TOTW03","TOTW04","TOTW05"],"specialCards":[],"status":"在籍"},
  {"id":655,"psid":"hir54","nickname":"ヒロ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":5,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":656,"psid":"hirofoot7","nickname":"タツ","realName":null,"teamId":73,"teamName":"Team 073","number":"6","card":"-","overall":84,"apps":18,"winRate":11,"goals":1,"assists":1,"cleanSheets":4,"yellow":0,"red":0,"labels":["CORN01"],"specialCards":[],"status":"退団"},
  {"id":657,"psid":"hiroyukitanaka96","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":58,"winRate":32,"goals":30,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":658,"psid":"hoshi2420","nickname":"ほし","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":3,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":659,"psid":"hy6454","nickname":"ヒル","realName":null,"teamId":430,"teamName":"Team 430","number":"30","card":"-","overall":54,"apps":6,"winRate":33,"goals":0,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":660,"psid":"iZ3rost_s","nickname":"ムギ","realName":null,"teamId":143,"teamName":"Team 143","number":null,"card":"-","overall":null,"apps":2,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":661,"psid":"i_kkyu3","nickname":null,"realName":null,"teamId":695,"teamName":"ArahatikJP","number":"10","card":"-","overall":54,"apps":8,"winRate":25,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":662,"psid":"iesalegend","nickname":"iesalegend","realName":null,"teamId":511,"teamName":"Hookar","number":"33","card":"-","overall":null,"apps":8,"winRate":75,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":663,"psid":"if_Kevin21","nickname":"ケビン","realName":null,"teamId":76,"teamName":"MK BOMB","number":"21","card":"-","overall":83,"apps":22,"winRate":77,"goals":2,"assists":10,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW05","THUN17","TOTW09","TOTW10"],"specialCards":[],"status":"退団"},
  {"id":664,"psid":"ihiro1207","nickname":"ヒロ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":8,"winRate":12,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":665,"psid":"iiiz_one_","nickname":"りゅー","realName":null,"teamId":143,"teamName":"Team 143","number":null,"card":"-","overall":null,"apps":53,"winRate":60,"goals":1,"assists":3,"cleanSheets":29,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":666,"psid":"ikurisu3131","nickname":"クリス","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":4,"winRate":25,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":667,"psid":"imohachi0811","nickname":"いもはち","realName":null,"teamId":655,"teamName":"Ardwick","number":"4","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":668,"psid":"inuswear","nickname":"いぬまる","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":26,"winRate":30,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":669,"psid":"ipod-I0-","nickname":"Ipod","realName":null,"teamId":511,"teamName":"Hookar","number":"22","card":"-","overall":69,"apps":119,"winRate":62,"goals":15,"assists":7,"cleanSheets":46,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":670,"psid":"ipu_7896","nickname":"ヤマ","realName":null,"teamId":154,"teamName":"Team 154","number":"24","card":"-","overall":85,"apps":6,"winRate":33,"goals":3,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":671,"psid":"itokintoki","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":"20","card":"-","overall":54,"apps":10,"winRate":30,"goals":0,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":672,"psid":"itoo_itoo","nickname":"いとう","realName":null,"teamId":213,"teamName":"Team 213","number":"8","card":"-","overall":59,"apps":99,"winRate":46,"goals":41,"assists":17,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":673,"psid":"iwachan7482","nickname":null,"realName":null,"teamId":143,"teamName":"Team 143","number":null,"card":"-","overall":null,"apps":14,"winRate":36,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":674,"psid":"jaguar561","nickname":"ジャガー","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":4,"winRate":50,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":675,"psid":"jam_wp112","nickname":"りべむ","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":12,"winRate":58,"goals":0,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":676,"psid":"jet_black_boy10","nickname":"ジェット","realName":null,"teamId":545,"teamName":"Tesuryo","number":"3","card":"-","overall":54,"apps":4,"winRate":50,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":677,"psid":"jeze88","nickname":"ジェゼ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"3","card":"-","overall":56,"apps":99,"winRate":24,"goals":2,"assists":7,"cleanSheets":20,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":678,"psid":"jgajag","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":"12","card":"-","overall":84,"apps":8,"winRate":62,"goals":0,"assists":1,"cleanSheets":12,"yellow":1,"red":0,"labels":["CORN02","TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":679,"psid":"jinya30gk","nickname":"ジンペルシー","realName":null,"teamId":212,"teamName":"Team 212","number":"11","card":"-","overall":64,"apps":24,"winRate":29,"goals":8,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":680,"psid":"joe-ny0910","nickname":"ジョー","realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":8,"winRate":37,"goals":0,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":681,"psid":"joe1985sh","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":"4","card":"-","overall":54,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":682,"psid":"jogaGT","nickname":"ジョガ","realName":null,"teamId":154,"teamName":"Team 154","number":"14","card":"-","overall":54,"apps":14,"winRate":40,"goals":2,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":683,"psid":"jolazio","nickname":"ジョラジオ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":684,"psid":"jonny_chan3","nickname":null,"realName":null,"teamId":712,"teamName":"FC MATSUDO","number":"7","card":"-","overall":54,"apps":3,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":685,"psid":"juve3325","nickname":"こっしー","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":16,"winRate":43,"goals":4,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":686,"psid":"juvpd10","nickname":"ワッキー","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":5,"winRate":20,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":687,"psid":"jyobansen_norio","nickname":"あべ","realName":null,"teamId":544,"teamName":"Team 544","number":"43","card":"-","overall":54,"apps":1,"winRate":100,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":688,"psid":"k-kazu2828","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":"23","card":"-","overall":54,"apps":6,"winRate":33,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":689,"psid":"k_1nak0___","nickname":"きなこ","realName":null,"teamId":698,"teamName":"Team 698","number":"1","card":"-","overall":54,"apps":4,"winRate":50,"goals":0,"assists":1,"cleanSheets":1,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":690,"psid":"k_a_k_i_p_______","nickname":"カキピー","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"25","card":"-","overall":54,"apps":16,"winRate":25,"goals":1,"assists":1,"cleanSheets":1,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":691,"psid":"k_hikigatari","nickname":"ケーさん","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":null,"card":"-","overall":null,"apps":12,"winRate":75,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"FA退団"},
  {"id":692,"psid":"kaeoto1012","nickname":"クロ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":22,"winRate":22,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"移動"},
  {"id":693,"psid":"kai_omicron7","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":null,"card":"-","overall":null,"apps":3,"winRate":100,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":694,"psid":"kaito_anchan","nickname":"カイト","realName":null,"teamId":212,"teamName":"Team 212","number":"7","card":"-","overall":54,"apps":8,"winRate":37,"goals":8,"assists":20,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":695,"psid":"kaitomanX","nickname":"はやて","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":44,"winRate":50,"goals":1,"assists":0,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":696,"psid":"kaiyruu1173","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":"37","card":"-","overall":null,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":697,"psid":"kaka-3212","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":35,"winRate":45,"goals":1,"assists":2,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":698,"psid":"kamei2009","nickname":"シカマル","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":24,"winRate":45,"goals":5,"assists":12,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":699,"psid":"kanitama24","nickname":"かにたま","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":157,"winRate":41,"goals":8,"assists":8,"cleanSheets":55,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":700,"psid":"kanu72ton3me-u","nickname":"カヌ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"4","card":"-","overall":58,"apps":8,"winRate":12,"goals":1,"assists":8,"cleanSheets":37,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":701,"psid":"karu_2135","nickname":"カワ","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":null,"card":"-","overall":null,"apps":6,"winRate":50,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":702,"psid":"kata_kiba_ore","nickname":"カタキバ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":16,"winRate":37,"goals":1,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":703,"psid":"katsu_178_","nickname":"かっちゃん","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":16,"winRate":18,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":704,"psid":"kawausouso11","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":"13","card":"-","overall":null,"apps":8,"winRate":25,"goals":0,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":705,"psid":"kaze_oibito","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"6","card":"-","overall":54,"apps":22,"winRate":13,"goals":1,"assists":6,"cleanSheets":1,"yellow":1,"red":0,"labels":["EAFC17"],"specialCards":[],"status":"在籍"},
  {"id":706,"psid":"kazu321kazu","nickname":"kazu321kazu","realName":null,"teamId":546,"teamName":"Team 546","number":null,"card":"-","overall":null,"apps":9,"winRate":66,"goals":1,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":707,"psid":"kazuaki611527","nickname":"カズアキ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":30,"winRate":56,"goals":12,"assists":2,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":708,"psid":"kazuniwa","nickname":"マヤ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":36,"winRate":25,"goals":0,"assists":3,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":709,"psid":"kbq_orz_","nickname":"キョウヤ","realName":null,"teamId":146,"teamName":"Team 146","number":"1","card":"-","overall":72,"apps":10,"winRate":60,"goals":0,"assists":0,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":710,"psid":"kedabody","nickname":"けだ","realName":null,"teamId":544,"teamName":"Team 544","number":"3","card":"-","overall":54,"apps":18,"winRate":22,"goals":0,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":711,"psid":"kei-1456","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":8,"winRate":25,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":712,"psid":"keigreco16","nickname":"ケイゴ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":54,"winRate":40,"goals":3,"assists":3,"cleanSheets":13,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":713,"psid":"keiyouchan00","nickname":"ケイ","realName":null,"teamId":154,"teamName":"Team 154","number":"4","card":"-","overall":54,"apps":8,"winRate":37,"goals":10,"assists":2,"cleanSheets":2,"yellow":0,"red":0,"labels":["TOTW05"],"specialCards":[],"status":"在籍"},
  {"id":714,"psid":"ken0707svti","nickname":"ケン","realName":null,"teamId":76,"teamName":"MK BOMB","number":"18","card":"-","overall":61,"apps":14,"winRate":42,"goals":2,"assists":4,"cleanSheets":2,"yellow":0,"red":0,"labels":["TOTW02"],"specialCards":[],"status":"在籍"},
  {"id":715,"psid":"kentanosuke14","nickname":"ケンタ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"14","card":"-","overall":52,"apps":8,"winRate":12,"goals":43,"assists":17,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":716,"psid":"kenzemer","nickname":"けんぜま","realName":null,"teamId":545,"teamName":"Tesuryo","number":"11","card":"-","overall":54,"apps":4,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":717,"psid":"khideto0224","nickname":"ヒデ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":11,"winRate":9,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":718,"psid":"kid-22-04","nickname":"キッド","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":18,"winRate":72,"goals":1,"assists":3,"cleanSheets":11,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":719,"psid":"kid05_pol","nickname":"キッド","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"69","card":"-","overall":54,"apps":4,"winRate":25,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":720,"psid":"kiiro_03","nickname":"ダイスケ","realName":null,"teamId":481,"teamName":"Team 481","number":"3","card":"-","overall":54,"apps":19,"winRate":35,"goals":1,"assists":4,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":721,"psid":"killerma_2","nickname":"killerma_2","realName":null,"teamId":462,"teamName":"Team 462","number":"2","card":"-","overall":null,"apps":8,"winRate":12,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":722,"psid":"kim-jones","nickname":"朝青龍","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"30","card":"-","overall":54,"apps":29,"winRate":55,"goals":14,"assists":4,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW03"],"specialCards":[],"status":"在籍"},
  {"id":723,"psid":"kim09276636","nickname":"キム","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"14","card":"-","overall":54,"apps":10,"winRate":20,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":724,"psid":"kinchan527","nickname":"まるちゃん","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":12,"winRate":41,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":725,"psid":"kitadeeen18","nickname":"エンクンク","realName":null,"teamId":710,"teamName":"Team 710","number":"24","card":"-","overall":54,"apps":4,"winRate":75,"goals":2,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":726,"psid":"kivolly","nickname":"きぼり","realName":null,"teamId":430,"teamName":"Team 430","number":"18","card":"-","overall":54,"apps":6,"winRate":33,"goals":0,"assists":1,"cleanSheets":0,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":727,"psid":"kkroma_35","nickname":"けいけい","realName":null,"teamId":76,"teamName":"MK BOMB","number":"14","card":"-","overall":66,"apps":226,"winRate":49,"goals":68,"assists":31,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":728,"psid":"kkstlove","nickname":"KK","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"4","card":"-","overall":54,"apps":56,"winRate":32,"goals":5,"assists":4,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":729,"psid":"kkzette","nickname":"kkzette","realName":null,"teamId":511,"teamName":"Hookar","number":"18","card":"-","overall":54,"apps":66,"winRate":68,"goals":8,"assists":15,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":730,"psid":"klauser27","nickname":"クラウザー","realName":null,"teamId":361,"teamName":"Team 361","number":"17","card":"-","overall":82,"apps":22,"winRate":50,"goals":0,"assists":1,"cleanSheets":13,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":731,"psid":"ko-shi_depo","nickname":"エムティ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"9","card":"-","overall":82,"apps":22,"winRate":64,"goals":10,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"退団"},
  {"id":732,"psid":"ko03u20","nickname":"こう","realName":null,"teamId":76,"teamName":"MK BOMB","number":"22","card":"-","overall":68,"apps":20,"winRate":40,"goals":25,"assists":46,"cleanSheets":6,"yellow":0,"red":1,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":733,"psid":"komani24","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":"3","card":"-","overall":74,"apps":7,"winRate":28,"goals":3,"assists":4,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW02","TOTW03","TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":734,"psid":"komedawarakun","nickname":"ユンケル","realName":null,"teamId":73,"teamName":"Team 073","number":"2","card":"-","overall":84,"apps":22,"winRate":13,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":["TOTW04","CORN01"],"specialCards":[],"status":"移動"},
  {"id":735,"psid":"komeri360","nickname":null,"realName":null,"teamId":101,"teamName":"AKATUKI","number":"32","card":"-","overall":54,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":736,"psid":"komi221","nickname":"コミ","realName":null,"teamId":101,"teamName":"AKATUKI","number":null,"card":"-","overall":null,"apps":80,"winRate":28,"goals":22,"assists":4,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":737,"psid":"konko_n28","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":11,"winRate":54,"goals":5,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":738,"psid":"koronshima0301","nickname":"ぬん","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":14,"winRate":64,"goals":4,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":739,"psid":"kosuke4664","nickname":"こうすけ","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":740,"psid":"kou-pya-","nickname":"こうぴゃ","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"12","card":"-","overall":54,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":741,"psid":"kozasei","nickname":"こざせい","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":41,"winRate":34,"goals":0,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":742,"psid":"ks-mode","nickname":"オスズ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":11,"winRate":27,"goals":1,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":743,"psid":"kubotake14","nickname":"たけ","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"14","card":"-","overall":54,"apps":1,"winRate":100,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":744,"psid":"kurorname21","nickname":"ワンダモ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":57,"winRate":43,"goals":7,"assists":13,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":745,"psid":"kururu51","nickname":"クル","realName":null,"teamId":430,"teamName":"Team 430","number":"5","card":"-","overall":85,"apps":8,"winRate":37,"goals":1,"assists":1,"cleanSheets":20,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":746,"psid":"kusanagi_syousa","nickname":"クサナギショウサ","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":9,"winRate":44,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":747,"psid":"kusapan","nickname":"クサパン","realName":null,"teamId":101,"teamName":"AKATUKI","number":"1","card":"-","overall":54,"apps":4,"winRate":25,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW01","TOTW02","TOTW04"],"specialCards":[],"status":"在籍"},
  {"id":748,"psid":"kuwagata227","nickname":null,"realName":null,"teamId":545,"teamName":"Tesuryo","number":null,"card":"-","overall":null,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":["CORN01"],"specialCards":[],"status":"在籍"},
  {"id":749,"psid":"kuwagata_227","nickname":"くわがた","realName":null,"teamId":545,"teamName":"Tesuryo","number":"77","card":"-","overall":86,"apps":22,"winRate":50,"goals":3,"assists":0,"cleanSheets":9,"yellow":0,"red":0,"labels":["TOTW02","CORN01"],"specialCards":[],"status":"在籍"},
  {"id":750,"psid":"kyudo4001","nickname":"タケダ","realName":null,"teamId":694,"teamName":"Forza Perfetta Calcio","number":"66","card":"-","overall":null,"apps":4,"winRate":75,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":751,"psid":"kzk93i","nickname":"キノコ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":8,"winRate":37,"goals":1,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":752,"psid":"l-pochi-l","nickname":"ポチ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":30,"winRate":26,"goals":6,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":753,"psid":"lc_p0ker","nickname":"kento","realName":null,"teamId":511,"teamName":"Hookar","number":"44","card":"-","overall":85,"apps":16,"winRate":56,"goals":1,"assists":22,"cleanSheets":6,"yellow":0,"red":0,"labels":["CORN01"],"specialCards":[],"status":"退団"},
  {"id":754,"psid":"ld910710","nickname":"サニャン","realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":755,"psid":"least-region3","nickname":null,"realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":10,"winRate":20,"goals":0,"assists":2,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":756,"psid":"lemon-teajp","nickname":"レモンティー","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":3,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":757,"psid":"liber729","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":21,"winRate":28,"goals":0,"assists":1,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":758,"psid":"ll_Faraone92","nickname":null,"realName":null,"teamId":101,"teamName":"AKATUKI","number":null,"card":"-","overall":null,"apps":9,"winRate":11,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":759,"psid":"lljliijjiiillili","nickname":null,"realName":null,"teamId":626,"teamName":"OKUMURA KOUKI","number":null,"card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":760,"psid":"lmRqmos","nickname":"ラモス","realName":null,"teamId":546,"teamName":"Team 546","number":null,"card":"-","overall":null,"apps":10,"winRate":70,"goals":9,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":761,"psid":"lq7Pz","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":["CORN01"],"specialCards":[],"status":"在籍"},
  {"id":762,"psid":"lq7Pz_","nickname":"メンディ","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"26","card":"-","overall":84,"apps":4,"winRate":25,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":["CORN01"],"specialCards":[],"status":"退団"},
  {"id":763,"psid":"luis-garcia0624","nickname":"ルイス","realName":null,"teamId":213,"teamName":"Team 213","number":"6","card":"-","overall":54,"apps":22,"winRate":77,"goals":1,"assists":2,"cleanSheets":12,"yellow":0,"red":0,"labels":["TOTW08","TOTW09"],"specialCards":[],"status":"在籍"},
  {"id":764,"psid":"lzH4L","nickname":"はる","realName":null,"teamId":481,"teamName":"Team 481","number":null,"card":"-","overall":null,"apps":5,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":765,"psid":"m--52","nickname":"エム","realName":null,"teamId":511,"teamName":"Hookar","number":"52","card":"-","overall":54,"apps":6,"winRate":66,"goals":1,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":766,"psid":"m9yume_dura","nickname":"ユメ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":64,"winRate":40,"goals":21,"assists":7,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"移動"},
  {"id":767,"psid":"macchan0243","nickname":"まっちゃん","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":7,"winRate":14,"goals":3,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":768,"psid":"macchi1022","nickname":"マッチ","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":769,"psid":"madriii7","nickname":"ナトリ","realName":null,"teamId":146,"teamName":"Team 146","number":"11","card":"-","overall":74,"apps":22,"winRate":63,"goals":2,"assists":9,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW04","EAFC17"],"specialCards":[],"status":"在籍"},
  {"id":770,"psid":"mahu_min","nickname":"マフー","realName":null,"teamId":710,"teamName":"Team 710","number":"26","card":"-","overall":84,"apps":5,"winRate":100,"goals":1,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":771,"psid":"maleficent_n2","nickname":"ナノ","realName":null,"teamId":143,"teamName":"Team 143","number":null,"card":"-","overall":62,"apps":74,"winRate":50,"goals":1,"assists":2,"cleanSheets":35,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":772,"psid":"mamechan1001_","nickname":"マメ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":21,"winRate":57,"goals":3,"assists":3,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":773,"psid":"marumaru_yu56","nickname":"マル","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":5,"winRate":20,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":774,"psid":"maruo0x0","nickname":"マルオ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":42,"winRate":31,"goals":4,"assists":8,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":775,"psid":"marusyu0224","nickname":"マルシュ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"3","card":"-","overall":56,"apps":287,"winRate":49,"goals":2,"assists":11,"cleanSheets":122,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":776,"psid":"masasan-615","nickname":"マサ","realName":null,"teamId":212,"teamName":"Team 212","number":"9","card":"-","overall":86,"apps":8,"winRate":62,"goals":3,"assists":1,"cleanSheets":3,"yellow":1,"red":0,"labels":["TOTW08","TOTW09","CORN01","TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":777,"psid":"masashi-marinos","nickname":"ボンバー","realName":null,"teamId":213,"teamName":"Team 213","number":"22","card":"-","overall":54,"apps":49,"winRate":55,"goals":4,"assists":2,"cleanSheets":19,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":778,"psid":"masudatalk","nickname":"マッスー","realName":null,"teamId":73,"teamName":"Team 073","number":"41","card":"-","overall":67,"apps":22,"winRate":77,"goals":12,"assists":8,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW02","EAFC17"],"specialCards":[],"status":"退団"},
  {"id":779,"psid":"mate-cha0122","nickname":"マテ","realName":null,"teamId":481,"teamName":"Team 481","number":"88","card":"-","overall":84,"apps":22,"winRate":30,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":["CORN02"],"specialCards":[],"status":"在籍"},
  {"id":780,"psid":"matsu-jun-21","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":"21","card":"-","overall":84,"apps":6,"winRate":33,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":["CORN01"],"specialCards":[],"status":"在籍"},
  {"id":781,"psid":"may929","nickname":"メイ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":15,"winRate":6,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":782,"psid":"mayer-02-TSV","nickname":"DL-ambesten","realName":null,"teamId":546,"teamName":"Team 546","number":"8","card":"-","overall":85,"apps":20,"winRate":50,"goals":1,"assists":3,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":783,"psid":"mdd711","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":"21","card":"-","overall":85,"apps":6,"winRate":50,"goals":0,"assists":5,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW03","CORN01"],"specialCards":[],"status":"在籍"},
  {"id":784,"psid":"memel_aorin5","nickname":null,"realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":785,"psid":"microstar2011","nickname":null,"realName":null,"teamId":652,"teamName":"WAKAMONO","number":"77","card":"-","overall":54,"apps":12,"winRate":33,"goals":2,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":786,"psid":"might_17","nickname":"オールマイト","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"11","card":"-","overall":null,"apps":10,"winRate":10,"goals":3,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":787,"psid":"mikeystac","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":788,"psid":"mikken21","nickname":"ミッケン","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":15,"winRate":13,"goals":3,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":789,"psid":"milatletico","nickname":"がるる","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":97,"winRate":34,"goals":21,"assists":9,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":790,"psid":"milk9sai","nickname":"みるく","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":173,"winRate":50,"goals":18,"assists":17,"cleanSheets":16,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":791,"psid":"miltiades1192","nickname":"ノッティ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":4,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":792,"psid":"miniyumemama","nickname":"ミニ","realName":null,"teamId":213,"teamName":"Team 213","number":"23","card":"-","overall":54,"apps":42,"winRate":62,"goals":4,"assists":7,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":793,"psid":"mink0204","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":12,"winRate":50,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":794,"psid":"mirai-3-3","nickname":"ミライ","realName":null,"teamId":154,"teamName":"Team 154","number":"18","card":"-","overall":54,"apps":8,"winRate":37,"goals":6,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW01","TOTW08"],"specialCards":[],"status":"在籍"},
  {"id":795,"psid":"misaOGTueda","nickname":"オガチャン","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":4,"winRate":25,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":796,"psid":"missind","nickname":"りょー","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":797,"psid":"mituuroko_24","nickname":"ミツ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":798,"psid":"mmoon_03","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":14,"winRate":78,"goals":0,"assists":0,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":799,"psid":"mod_planet56","nickname":"ヒデキ","realName":null,"teamId":146,"teamName":"Team 146","number":"55","card":"-","overall":76,"apps":8,"winRate":75,"goals":9,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW09"],"specialCards":[],"status":"退団"},
  {"id":800,"psid":"mojambo-mojambo","nickname":"もじゃ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":23,"winRate":43,"goals":2,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":801,"psid":"mokimoki02","nickname":"もきもき","realName":null,"teamId":143,"teamName":"Team 143","number":"5","card":"-","overall":56,"apps":14,"winRate":71,"goals":0,"assists":0,"cleanSheets":5,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":802,"psid":"moku550","nickname":"モク","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"17","card":"-","overall":54,"apps":16,"winRate":18,"goals":0,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":803,"psid":"momo_jr709","nickname":"モモ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":14,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":804,"psid":"momo_kei","nickname":"モモ","realName":null,"teamId":101,"teamName":"AKATUKI","number":null,"card":"-","overall":null,"apps":31,"winRate":19,"goals":0,"assists":1,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":805,"psid":"momotaros_X","nickname":"もも","realName":null,"teamId":73,"teamName":"Team 073","number":"13","card":"-","overall":54,"apps":8,"winRate":51,"goals":7,"assists":5,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":806,"psid":"morisoba450","nickname":"そば","realName":null,"teamId":547,"teamName":"HANNARI FC","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":807,"psid":"moru_senbei","nickname":"もるるん","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"88","card":"-","overall":59,"apps":37,"winRate":37,"goals":3,"assists":2,"cleanSheets":9,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":808,"psid":"most_mews7","nickname":"ドログバ","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":12,"winRate":16,"goals":5,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":809,"psid":"moyashi_bab","nickname":"ポッスン","realName":null,"teamId":212,"teamName":"Team 212","number":"8","card":"-","overall":85,"apps":18,"winRate":21,"goals":0,"assists":2,"cleanSheets":3,"yellow":1,"red":0,"labels":["CORN01"],"specialCards":[],"status":"退団"},
  {"id":810,"psid":"muller_tore","nickname":"ヤヤ","realName":null,"teamId":545,"teamName":"Tesuryo","number":"42","card":"-","overall":54,"apps":20,"winRate":55,"goals":2,"assists":18,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":811,"psid":"mura-cojp","nickname":"むら","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"21","card":"-","overall":55,"apps":22,"winRate":13,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":812,"psid":"musa-14-35","nickname":"musa-14-35","realName":null,"teamId":462,"teamName":"Team 462","number":"63","card":"-","overall":81,"apps":22,"winRate":9,"goals":1,"assists":1,"cleanSheets":8,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":813,"psid":"musasiyaiekei","nickname":"むさしや","realName":null,"teamId":461,"teamName":"Team 461","number":"53","card":"-","overall":57,"apps":91,"winRate":39,"goals":1,"assists":4,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":814,"psid":"musuta12","nickname":"ムスタ","realName":null,"teamId":73,"teamName":"Team 073","number":"12","card":"-","overall":54,"apps":13,"winRate":7,"goals":0,"assists":0,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":815,"psid":"mw0055","nickname":"なべ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"17","card":"-","overall":55,"apps":8,"winRate":12,"goals":2,"assists":1,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":816,"psid":"n-7cp23","nickname":null,"realName":null,"teamId":154,"teamName":"Team 154","number":"8","card":"-","overall":54,"apps":7,"winRate":28,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":817,"psid":"nachtmusik924","nickname":"シバ","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":69,"winRate":30,"goals":1,"assists":4,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":818,"psid":"nak3lw","nickname":"たか","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"1","card":"-","overall":54,"apps":8,"winRate":37,"goals":0,"assists":0,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":819,"psid":"nakashi0315","nickname":"ナカシ","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":75,"winRate":69,"goals":11,"assists":26,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":820,"psid":"namazonjp","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":"6","card":"-","overall":54,"apps":34,"winRate":23,"goals":7,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":821,"psid":"napo_Linux","nickname":"なぽ","realName":null,"teamId":655,"teamName":"Ardwick","number":null,"card":"-","overall":null,"apps":24,"winRate":45,"goals":5,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":822,"psid":"naruto-1218_k","nickname":"ナルト","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":823,"psid":"natsumi514372","nickname":"なつみん","realName":null,"teamId":73,"teamName":"Team 073","number":"12","card":"-","overall":77,"apps":1,"winRate":29,"goals":12,"assists":6,"cleanSheets":49,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"移動"},
  {"id":824,"psid":"nekomae3","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":"19","card":"-","overall":54,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":825,"psid":"nekoshan7","nickname":"ネコシャン","realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":34,"winRate":29,"goals":2,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":826,"psid":"new-kazumagumi","nickname":"組長","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":26,"winRate":23,"goals":3,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":827,"psid":"new_souvenir777","nickname":"ハルカ","realName":null,"teamId":212,"teamName":"Team 212","number":"7","card":"-","overall":54,"apps":6,"winRate":66,"goals":4,"assists":8,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":828,"psid":"nikknakk","nickname":"ニックナック","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":142,"winRate":40,"goals":8,"assists":9,"cleanSheets":14,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":829,"psid":"nishi-1082005","nickname":"にし","realName":null,"teamId":545,"teamName":"Tesuryo","number":"93","card":"-","overall":54,"apps":4,"winRate":75,"goals":1,"assists":2,"cleanSheets":34,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":830,"psid":"noginogi_634","nickname":"ノギ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":15,"winRate":13,"goals":0,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":831,"psid":"nontaro1220","nickname":null,"realName":null,"teamId":101,"teamName":"AKATUKI","number":"35","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":832,"psid":"nonu_1200","nickname":"のぬ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":833,"psid":"nori_nu","nickname":"ノリ","realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":22,"winRate":27,"goals":1,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":834,"psid":"nyaburiburi","nickname":null,"realName":null,"teamId":547,"teamName":"HANNARI FC","number":"22","card":"-","overall":null,"apps":8,"winRate":25,"goals":1,"assists":2,"cleanSheets":0,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":835,"psid":"nyannyan199","nickname":null,"realName":null,"teamId":655,"teamName":"Ardwick","number":"66","card":"-","overall":54,"apps":10,"winRate":10,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":836,"psid":"o0r6c0a5","nickname":null,"realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"17","card":"-","overall":null,"apps":5,"winRate":60,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":837,"psid":"oSAMURAI-HEARTo","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":9,"winRate":44,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":838,"psid":"okaki31","nickname":"おかき","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":125,"winRate":26,"goals":7,"assists":6,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":839,"psid":"okaraj0802","nickname":"オカ","realName":null,"teamId":212,"teamName":"Team 212","number":"88","card":"-","overall":54,"apps":14,"winRate":14,"goals":1,"assists":1,"cleanSheets":1,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":840,"psid":"olo_45ZARU_olo","nickname":"カズー","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":22,"winRate":45,"goals":0,"assists":2,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":841,"psid":"onaka_yowaindayo","nickname":"ハラ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":842,"psid":"oncledub","nickname":null,"realName":null,"teamId":695,"teamName":"ArahatikJP","number":null,"card":"-","overall":null,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":843,"psid":"onepun_yukiyuki","nickname":"こっしー","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"22","card":"-","overall":54,"apps":10,"winRate":25,"goals":0,"assists":4,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":844,"psid":"onigiri2005","nickname":"おにぎり","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"6","card":"-","overall":54,"apps":12,"winRate":16,"goals":2,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":845,"psid":"onigirista9","nickname":"オニギリ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":16,"winRate":50,"goals":0,"assists":0,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":846,"psid":"orekurino","nickname":"クリノ","realName":null,"teamId":430,"teamName":"Team 430","number":"1","card":"-","overall":54,"apps":8,"winRate":37,"goals":12,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":847,"psid":"oreo0628","nickname":"oreo0628","realName":null,"teamId":511,"teamName":"Hookar","number":"3","card":"-","overall":84,"apps":3,"winRate":66,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":["CORN01"],"specialCards":[],"status":"在籍"},
  {"id":848,"psid":"osechin_akko","nickname":"ぼすにい","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"37","card":"-","overall":54,"apps":4,"winRate":50,"goals":3,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":849,"psid":"otastation","nickname":"おたすて","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"15","card":"-","overall":54,"apps":12,"winRate":8,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":850,"psid":"otsuka-re1na","nickname":"おつかれいな","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"19","card":"-","overall":54,"apps":20,"winRate":20,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":851,"psid":"p-HERME14","nickname":"エルメ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":11,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":852,"psid":"p-o-c-8","nickname":"ポチ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":853,"psid":"p6PhC2JQ5m","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"69","card":"-","overall":54,"apps":4,"winRate":100,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":854,"psid":"p_panther18","nickname":"パンサー","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":6,"winRate":16,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":855,"psid":"pa-cho-le","nickname":"ぱちょ","realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":10,"winRate":80,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":856,"psid":"pacifilla","nickname":"いけしお","realName":null,"teamId":710,"teamName":"Team 710","number":"11","card":"-","overall":64,"apps":8,"winRate":88,"goals":1,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW05"],"specialCards":[],"status":"在籍"},
  {"id":857,"psid":"pagu-daiou_","nickname":"パグ大王","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":18,"winRate":61,"goals":0,"assists":0,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":858,"psid":"panipanipupupu","nickname":"ぱに","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":38,"winRate":44,"goals":0,"assists":0,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":859,"psid":"parkingout_88","nickname":"パキン","realName":null,"teamId":101,"teamName":"AKATUKI","number":"88","card":"-","overall":85,"apps":8,"winRate":12,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":["TOTW03","CORN02"],"specialCards":[],"status":"在籍"},
  {"id":860,"psid":"paruwing","nickname":"ぱる","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":23,"winRate":56,"goals":0,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":861,"psid":"peindres_galbe","nickname":"みるぢい","realName":null,"teamId":710,"teamName":"Team 710","number":"27","card":"-","overall":null,"apps":2,"winRate":100,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":862,"psid":"penguin-mity","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":"38","card":"-","overall":54,"apps":5,"winRate":20,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":863,"psid":"peperon3113","nickname":"ドン","realName":null,"teamId":212,"teamName":"Team 212","number":"39","card":"-","overall":84,"apps":7,"winRate":57,"goals":1,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":864,"psid":"pi-----po-----","nickname":"ピーポー","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":8,"winRate":87,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":865,"psid":"pi-ton","nickname":"ピートン","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":114,"winRate":41,"goals":18,"assists":15,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":866,"psid":"poniki114514","nickname":"ぽにき","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":6,"winRate":66,"goals":0,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":867,"psid":"ponnnp28","nickname":"ポン","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":868,"psid":"ponyon_0506","nickname":"ポニョン","realName":null,"teamId":511,"teamName":"Hookar","number":"56","card":"-","overall":63,"apps":8,"winRate":75,"goals":1,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":["TOTW08","CORN02"],"specialCards":[],"status":"在籍"},
  {"id":869,"psid":"poryori0_0","nickname":"ぽりょり","realName":null,"teamId":545,"teamName":"Tesuryo","number":"10","card":"-","overall":54,"apps":22,"winRate":50,"goals":3,"assists":12,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW01","TOTW02","TOTW04","TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":870,"psid":"punpunmaru0","nickname":"プンプン","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":4,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":871,"psid":"r-xyy9","nickname":"レイ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":11,"winRate":27,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":872,"psid":"r6655rkirakira29","nickname":"モン","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":11,"winRate":27,"goals":4,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":873,"psid":"r_ir-i107","nickname":"ルーク","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":8,"winRate":62,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":874,"psid":"rackpot","nickname":"ラックポット","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":4,"winRate":50,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":875,"psid":"raion0711d","nickname":"ライオン","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":32,"winRate":21,"goals":11,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":876,"psid":"raisens1088","nickname":"ラムネ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":877,"psid":"rarary","nickname":"こっぷ","realName":null,"teamId":213,"teamName":"Team 213","number":"15","card":"-","overall":54,"apps":11,"winRate":54,"goals":2,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":["TOTW08"],"specialCards":[],"status":"退団"},
  {"id":878,"psid":"realnavy051910","nickname":"ネイビー","realName":null,"teamId":710,"teamName":"Team 710","number":"5","card":"-","overall":null,"apps":2,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":879,"psid":"redseabream23","nickname":null,"realName":null,"teamId":652,"teamName":"WAKAMONO","number":null,"card":"-","overall":null,"apps":5,"winRate":80,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":880,"psid":"rey_milkroll","nickname":"そると","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"39","card":"-","overall":83,"apps":6,"winRate":16,"goals":2,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":881,"psid":"rikopapa-333","nickname":null,"realName":null,"teamId":655,"teamName":"Ardwick","number":null,"card":"-","overall":null,"apps":9,"winRate":22,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":882,"psid":"riku438","nickname":null,"realName":null,"teamId":652,"teamName":"WAKAMONO","number":"12","card":"-","overall":54,"apps":2,"winRate":100,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":883,"psid":"rimessi26","nickname":"リミちゃん","realName":null,"teamId":626,"teamName":"OKUMURA KOUKI","number":"26","card":"-","overall":54,"apps":16,"winRate":0,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":884,"psid":"ringhio33","nickname":"リンギオ","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"3","card":"-","overall":84,"apps":16,"winRate":6,"goals":1,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":["CORN01"],"specialCards":[],"status":"在籍"},
  {"id":885,"psid":"riricheall7","nickname":"リリ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"9","card":"-","overall":54,"apps":49,"winRate":44,"goals":0,"assists":2,"cleanSheets":22,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":886,"psid":"rivoha1203","nickname":"リボ","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"19","card":"-","overall":54,"apps":4,"winRate":25,"goals":0,"assists":5,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":887,"psid":"rocky-_48","nickname":"ロッキー","realName":null,"teamId":511,"teamName":"Hookar","number":"21","card":"-","overall":73,"apps":48,"winRate":54,"goals":4,"assists":25,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":888,"psid":"rohgan7","nickname":"ろうがん","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":71,"winRate":39,"goals":0,"assists":1,"cleanSheets":25,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":889,"psid":"rolling_yoppi","nickname":"ベック","realName":null,"teamId":146,"teamName":"Team 146","number":"23","card":"-","overall":54,"apps":6,"winRate":33,"goals":1,"assists":10,"cleanSheets":21,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":890,"psid":"root1975","nickname":"ルート","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":54,"winRate":40,"goals":0,"assists":4,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":891,"psid":"rr0915","nickname":"rr3915","realName":null,"teamId":546,"teamName":"Team 546","number":"99","card":"-","overall":null,"apps":2,"winRate":50,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":892,"psid":"rukitu","nickname":"ルキツ","realName":null,"teamId":481,"teamName":"Team 481","number":"7","card":"-","overall":54,"apps":22,"winRate":37,"goals":3,"assists":2,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":893,"psid":"ryan_121_8","nickname":"レム","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":20,"winRate":40,"goals":5,"assists":6,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":894,"psid":"ryosuke30529","nickname":"リョウスケ","realName":null,"teamId":213,"teamName":"Team 213","number":"8","card":"-","overall":58,"apps":20,"winRate":75,"goals":15,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW03","TOTW04","TOTW08"],"specialCards":[],"status":"在籍"},
  {"id":895,"psid":"ryotama-","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":null,"card":"-","overall":null,"apps":11,"winRate":63,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":896,"psid":"ryouhei_1114","nickname":"りょうへい","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":null,"apps":80,"winRate":35,"goals":0,"assists":4,"cleanSheets":16,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":897,"psid":"s-ikkosan","nickname":"イッコー","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":49,"winRate":59,"goals":20,"assists":8,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":898,"psid":"s-y-o_naka","nickname":"アグ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":7,"winRate":57,"goals":2,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":899,"psid":"s_nbbbb2048","nickname":"のぶ","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":58,"winRate":51,"goals":1,"assists":8,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":900,"psid":"s_pulcelona12","nickname":"エスパ","realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"32","card":"-","overall":54,"apps":6,"winRate":66,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":901,"psid":"saiger-takuto","nickname":null,"realName":null,"teamId":695,"teamName":"ArahatikJP","number":"07","card":"-","overall":54,"apps":8,"winRate":25,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":902,"psid":"saint-akari11","nickname":"カイト","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":15,"winRate":46,"goals":10,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":903,"psid":"sakana310-","nickname":"サカナ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":9,"winRate":11,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":904,"psid":"sakasaka007","nickname":"かっぱ","realName":null,"teamId":461,"teamName":"Team 461","number":"25","card":"-","overall":56,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":905,"psid":"sakumayu121","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":null,"card":"-","overall":null,"apps":3,"winRate":33,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":906,"psid":"sakutor_","nickname":"ピピ","realName":null,"teamId":154,"teamName":"Team 154","number":"5","card":"-","overall":56,"apps":8,"winRate":37,"goals":0,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":907,"psid":"sasabeeey","nickname":"ささべぇ","realName":null,"teamId":461,"teamName":"Team 461","number":null,"card":"-","overall":null,"apps":9,"winRate":33,"goals":0,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":908,"psid":"satoyan_10","nickname":"さとやん","realName":null,"teamId":545,"teamName":"Tesuryo","number":"10","card":"-","overall":88,"apps":8,"winRate":75,"goals":7,"assists":10,"cleanSheets":6,"yellow":0,"red":0,"labels":["TOTW04","TOTW05","TOTW09"],"specialCards":[],"status":"退団"},
  {"id":909,"psid":"sdny1228","nickname":null,"realName":null,"teamId":655,"teamName":"Ardwick","number":"16","card":"-","overall":54,"apps":14,"winRate":57,"goals":1,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":910,"psid":"secret_potechi","nickname":"ぽてち","realName":null,"teamId":76,"teamName":"MK BOMB","number":"17","card":"-","overall":54,"apps":80,"winRate":42,"goals":2,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":911,"psid":"seru-san19","nickname":"モナカ","realName":null,"teamId":212,"teamName":"Team 212","number":"37","card":"-","overall":54,"apps":30,"winRate":33,"goals":1,"assists":2,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":912,"psid":"sh_araiba_se","nickname":"あらいば","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":913,"psid":"sherlock_486954","nickname":"ほーむず","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":156,"winRate":35,"goals":13,"assists":17,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"移動"},
  {"id":914,"psid":"shiba-chan-924","nickname":null,"realName":null,"teamId":154,"teamName":"Team 154","number":"2","card":"-","overall":54,"apps":22,"winRate":50,"goals":2,"assists":2,"cleanSheets":3,"yellow":0,"red":0,"labels":["TOTW03","TOTW04"],"specialCards":[],"status":"在籍"},
  {"id":915,"psid":"shibashun0110","nickname":"シバシュン","realName":null,"teamId":462,"teamName":"Team 462","number":"48","card":"-","overall":73,"apps":20,"winRate":10,"goals":3,"assists":14,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":916,"psid":"shigebis","nickname":"しげびす","realName":null,"teamId":544,"teamName":"Team 544","number":"1","card":"-","overall":54,"apps":10,"winRate":80,"goals":0,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":917,"psid":"shiina-47-","nickname":"しいな","realName":null,"teamId":544,"teamName":"Team 544","number":"47","card":"-","overall":64,"apps":12,"winRate":75,"goals":3,"assists":5,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":918,"psid":"shikaodao4010","nickname":null,"realName":null,"teamId":545,"teamName":"Tesuryo","number":null,"card":"-","overall":null,"apps":30,"winRate":77,"goals":0,"assists":2,"cleanSheets":18,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":919,"psid":"shinManUtd","nickname":"しん","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":30,"winRate":26,"goals":0,"assists":0,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":920,"psid":"shiromochirsk","nickname":null,"realName":null,"teamId":626,"teamName":"OKUMURA KOUKI","number":null,"card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":921,"psid":"shou0710","nickname":"ショウ","realName":null,"teamId":73,"teamName":"Team 073","number":"9","card":"-","overall":67,"apps":2,"winRate":50,"goals":2,"assists":9,"cleanSheets":4,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":922,"psid":"shou81","nickname":"ショウ","realName":null,"teamId":481,"teamName":"Team 481","number":"17","card":"-","overall":54,"apps":22,"winRate":36,"goals":5,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":["TOTW09"],"specialCards":[],"status":"在籍"},
  {"id":923,"psid":"shu----n22","nickname":null,"realName":null,"teamId":655,"teamName":"Ardwick","number":"10","card":"-","overall":54,"apps":32,"winRate":37,"goals":0,"assists":5,"cleanSheets":9,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":924,"psid":"shumai72","nickname":"ビート","realName":null,"teamId":101,"teamName":"AKATUKI","number":"8","card":"-","overall":57,"apps":8,"winRate":12,"goals":1,"assists":17,"cleanSheets":11,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":925,"psid":"shun-sk10","nickname":null,"realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":926,"psid":"shun-uver-8","nickname":"しゅん","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"28","card":"-","overall":54,"apps":12,"winRate":25,"goals":0,"assists":0,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":927,"psid":"shunta","nickname":"シュンタ","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":15,"winRate":66,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":928,"psid":"shuralate","nickname":null,"realName":null,"teamId":101,"teamName":"AKATUKI","number":"31","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":929,"psid":"siki428","nickname":"シキ","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":140,"winRate":46,"goals":7,"assists":13,"cleanSheets":18,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":930,"psid":"sin_hukanski83","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":10,"winRate":20,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":931,"psid":"sing_0224","nickname":"シングさん、しんぐめん","realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":10,"winRate":80,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":932,"psid":"siratama_YRN","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":18,"winRate":5,"goals":1,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":933,"psid":"sk--shun10","nickname":"シュン","realName":null,"teamId":462,"teamName":"Team 462","number":"13","card":"-","overall":73,"apps":22,"winRate":9,"goals":2,"assists":4,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":934,"psid":"sleepy_nekomuzZZ","nickname":"ねこむ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"30","card":"-","overall":60,"apps":102,"winRate":40,"goals":27,"assists":21,"cleanSheets":15,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":935,"psid":"snjdr19310","nickname":"スナ","realName":null,"teamId":143,"teamName":"Team 143","number":"6","card":"-","overall":58,"apps":20,"winRate":60,"goals":27,"assists":4,"cleanSheets":95,"yellow":2,"red":0,"labels":["TOTW08"],"specialCards":[],"status":"在籍"},
  {"id":936,"psid":"snow-yu-angel8","nickname":"ユキンコ","realName":null,"teamId":212,"teamName":"Team 212","number":"14","card":"-","overall":83,"apps":187,"winRate":31,"goals":4,"assists":19,"cleanSheets":20,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":937,"psid":"soccer-ba-ka1121","nickname":"すべてがださいマン","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"9","card":"-","overall":54,"apps":22,"winRate":18,"goals":5,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":938,"psid":"soksnry","nickname":"soksnry","realName":null,"teamId":546,"teamName":"Team 546","number":"16","card":"-","overall":54,"apps":12,"winRate":50,"goals":0,"assists":2,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":939,"psid":"sorararaaaaaaaan","nickname":"そらら","realName":null,"teamId":546,"teamName":"Team 546","number":"22","card":"-","overall":54,"apps":8,"winRate":50,"goals":1,"assists":3,"cleanSheets":11,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":940,"psid":"sore-mecha-eeyan","nickname":"カイザー","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":6,"winRate":66,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":941,"psid":"spoopy-ogachan","nickname":null,"realName":null,"teamId":695,"teamName":"ArahatikJP","number":"08","card":"-","overall":54,"apps":5,"winRate":40,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":942,"psid":"sqky","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":943,"psid":"sqky__","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"99","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":944,"psid":"srtrhjm","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":13,"winRate":53,"goals":4,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":945,"psid":"sss-nakata","nickname":"あきしょう","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"3","card":"-","overall":54,"apps":8,"winRate":37,"goals":0,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":946,"psid":"starcatch_Anya","nickname":"ボナ","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"1","card":"-","overall":54,"apps":22,"winRate":22,"goals":0,"assists":0,"cleanSheets":10,"yellow":0,"red":0,"labels":["TOTW02","TOTW05"],"specialCards":[],"status":"在籍"},
  {"id":947,"psid":"striking-force","nickname":"スト","realName":null,"teamId":146,"teamName":"Team 146","number":"54","card":"-","overall":61,"apps":12,"winRate":66,"goals":0,"assists":3,"cleanSheets":8,"yellow":0,"red":0,"labels":["EAFC17"],"specialCards":[],"status":"在籍"},
  {"id":948,"psid":"sumiredoon","nickname":"トレス","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":4,"winRate":25,"goals":0,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":949,"psid":"sumoto314","nickname":"スモト","realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":5,"winRate":80,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":950,"psid":"sunnasan10","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":6,"winRate":50,"goals":0,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":951,"psid":"syachiku-syatiku","nickname":"社畜","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":10,"winRate":70,"goals":0,"assists":0,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":952,"psid":"syoboonn117","nickname":null,"realName":null,"teamId":694,"teamName":"Forza Perfetta Calcio","number":"20","card":"-","overall":54,"apps":11,"winRate":45,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":953,"psid":"taakun-o-","nickname":"ターくん","realName":null,"teamId":73,"teamName":"Team 073","number":"14","card":"-","overall":60,"apps":16,"winRate":18,"goals":2,"assists":1,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"移動"},
  {"id":954,"psid":"tacci0528","nickname":"ひこし","realName":null,"teamId":73,"teamName":"Team 073","number":"5","card":"-","overall":70,"apps":3,"winRate":33,"goals":1,"assists":1,"cleanSheets":7,"yellow":0,"red":0,"labels":["TOTW08"],"specialCards":[],"status":"在籍"},
  {"id":955,"psid":"tagu0142mosa","nickname":null,"realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":4,"winRate":50,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":956,"psid":"tai_pon21","nickname":"たいぽん","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"21","card":"-","overall":85,"apps":8,"winRate":37,"goals":0,"assists":1,"cleanSheets":4,"yellow":0,"red":0,"labels":["TOTW03","CORN01","TOTW10"],"specialCards":[],"status":"在籍"},
  {"id":957,"psid":"tailup14","nickname":"まさ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"81","card":"-","overall":54,"apps":132,"winRate":52,"goals":6,"assists":6,"cleanSheets":40,"yellow":0,"red":0,"labels":["TOTW05"],"specialCards":[],"status":"退団"},
  {"id":958,"psid":"taitai_1214","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":22,"winRate":72,"goals":1,"assists":0,"cleanSheets":10,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":959,"psid":"tajima0102","nickname":"タジマ","realName":null,"teamId":146,"teamName":"Team 146","number":"99","card":"-","overall":54,"apps":2,"winRate":100,"goals":3,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW09"],"specialCards":[],"status":"退団"},
  {"id":960,"psid":"taka-one09","nickname":"たか","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":null,"card":"-","overall":null,"apps":14,"winRate":42,"goals":3,"assists":2,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":961,"psid":"taka37_3","nickname":"タカ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":22,"winRate":72,"goals":1,"assists":0,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":962,"psid":"takaharu01022718","nickname":"タカハル","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":13,"winRate":46,"goals":0,"assists":0,"cleanSheets":8,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":963,"psid":"takahero_14324","nickname":"タカヒロ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":7,"winRate":42,"goals":3,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":964,"psid":"takahiro1112-2","nickname":"たっちー","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":11,"winRate":72,"goals":0,"assists":1,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":965,"psid":"take-take50","nickname":"たけたけ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":8,"winRate":37,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":966,"psid":"take04dasilva","nickname":null,"realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":967,"psid":"takebeeam","nickname":"フナキ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":15,"winRate":60,"goals":1,"assists":3,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":968,"psid":"takkyukozou","nickname":"サンシロウ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":10,"winRate":40,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":969,"psid":"tako3-winna","nickname":"あつ","realName":null,"teamId":511,"teamName":"Hookar","number":"88","card":"-","overall":64,"apps":4,"winRate":100,"goals":2,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":970,"psid":"tako_yqki","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":"55","card":"-","overall":54,"apps":4,"winRate":25,"goals":4,"assists":7,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":971,"psid":"tallup14","nickname":"tallup14","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":5,"winRate":60,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":972,"psid":"tam_tam_land_","nickname":null,"realName":null,"teamId":655,"teamName":"Ardwick","number":null,"card":"-","overall":null,"apps":8,"winRate":12,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":973,"psid":"tama1250123","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":13,"winRate":76,"goals":0,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":974,"psid":"tamagoI7","nickname":"タマゴ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":12,"winRate":66,"goals":0,"assists":4,"cleanSheets":7,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":975,"psid":"taniko_1921","nickname":"たにこ","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":37,"winRate":54,"goals":0,"assists":1,"cleanSheets":15,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":976,"psid":"tarochang","nickname":"タロ","realName":null,"teamId":212,"teamName":"Team 212","number":"10","card":"-","overall":54,"apps":10,"winRate":30,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":977,"psid":"tatsunoko-soccer","nickname":"たつ","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":5,"winRate":20,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":978,"psid":"tatsuya-5656","nickname":"タツヤ","realName":null,"teamId":430,"teamName":"Team 430","number":"77","card":"-","overall":54,"apps":8,"winRate":37,"goals":1,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":979,"psid":"telac-","nickname":"テラ","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":980,"psid":"temp-69806327382","nickname":"クソボーズ","realName":null,"teamId":511,"teamName":"Hookar","number":"80","card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":981,"psid":"tensan103n","nickname":"てん","realName":null,"teamId":710,"teamName":"Team 710","number":"16","card":"-","overall":64,"apps":8,"winRate":88,"goals":6,"assists":5,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW05","JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":982,"psid":"teruterubouzu924","nickname":"テル","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"11","card":"-","overall":54,"apps":18,"winRate":11,"goals":5,"assists":1,"cleanSheets":1,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":983,"psid":"tetsu_ya86","nickname":"テツヤ","realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":4,"winRate":50,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":984,"psid":"the_legendwalker","nickname":null,"realName":null,"teamId":712,"teamName":"FC MATSUDO","number":"24","card":"-","overall":54,"apps":3,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":985,"psid":"ti-ga-na_take08","nickname":"ティガナ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"66","card":"-","overall":81,"apps":18,"winRate":44,"goals":1,"assists":6,"cleanSheets":4,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":986,"psid":"tigitigi3150","nickname":"ヒョウ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":8,"winRate":37,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":987,"psid":"tiramisu121","nickname":"ティラミス","realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":10,"winRate":20,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":988,"psid":"tktktk1996","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":5,"winRate":80,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":989,"psid":"tm_pay","nickname":"ペー","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":8,"winRate":50,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":990,"psid":"tmgreen36","nickname":"じゅにち","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":83,"winRate":69,"goals":6,"assists":16,"cleanSheets":14,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":991,"psid":"tmrm0607","nickname":"まっしゅ","realName":null,"teamId":73,"teamName":"Team 073","number":"25","card":"-","overall":64,"apps":20,"winRate":15,"goals":0,"assists":2,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":992,"psid":"tmy-chanel","nickname":"トミー","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":null,"card":"-","overall":null,"apps":24,"winRate":58,"goals":9,"assists":10,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":993,"psid":"tokorotenn1111","nickname":"たなてん","realName":null,"teamId":702,"teamName":"AKIYAMA CC","number":"83","card":"-","overall":54,"apps":7,"winRate":28,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":994,"psid":"tokuso1472","nickname":"トクソ","realName":null,"teamId":545,"teamName":"Tesuryo","number":null,"card":"-","overall":null,"apps":19,"winRate":74,"goals":1,"assists":3,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":995,"psid":"tolavis021","nickname":"トラヴィス","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"21","card":"-","overall":54,"apps":6,"winRate":33,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":996,"psid":"tom_takajp","nickname":null,"realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":15,"winRate":13,"goals":0,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":997,"psid":"toma-fly22","nickname":"toma-fly22","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":136,"winRate":63,"goals":20,"assists":11,"cleanSheets":51,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":998,"psid":"tomoki9519","nickname":"ともき","realName":null,"teamId":547,"teamName":"HANNARI FC","number":null,"card":"-","overall":null,"apps":14,"winRate":71,"goals":0,"assists":0,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":999,"psid":"tomoyaneymar0412","nickname":"トモチン","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":1,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1000,"psid":"tomwwwwwwwwww","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"8","card":"-","overall":54,"apps":41,"winRate":39,"goals":5,"assists":7,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1001,"psid":"toporyo","nickname":"トポ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"2","card":"-","overall":54,"apps":153,"winRate":27,"goals":1,"assists":2,"cleanSheets":33,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1002,"psid":"tori_silva88","nickname":null,"realName":null,"teamId":694,"teamName":"Forza Perfetta Calcio","number":"7","card":"-","overall":54,"apps":12,"winRate":50,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1003,"psid":"toririnpic","nickname":"トリクルマ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":62,"winRate":37,"goals":1,"assists":3,"cleanSheets":19,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1004,"psid":"toto_nmcd10","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":9,"winRate":77,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1005,"psid":"toto_wave","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"9","card":"-","overall":54,"apps":20,"winRate":15,"goals":4,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW08"],"specialCards":[],"status":"在籍"},
  {"id":1006,"psid":"truu-awaa","nickname":"でいすけ","realName":null,"teamId":73,"teamName":"Team 073","number":"51","card":"-","overall":63,"apps":4,"winRate":75,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1007,"psid":"tsumugi_08asuvell","nickname":"おくむらこうき27歳","realName":null,"teamId":626,"teamName":"OKUMURA KOUKI","number":null,"card":"-","overall":54,"apps":13,"winRate":0,"goals":3,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1008,"psid":"tuchel-chel","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":5,"winRate":60,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1009,"psid":"tukemono32","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":11,"winRate":27,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1010,"psid":"ty_rdmy_07","nickname":"せいや","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1011,"psid":"tyatya1101","nickname":"チャチャ","realName":null,"teamId":73,"teamName":"Team 073","number":"6","card":"-","overall":71,"apps":6,"winRate":16,"goals":1,"assists":1,"cleanSheets":2,"yellow":0,"red":0,"labels":["TOTW02","TOTW05"],"specialCards":[],"status":"在籍"},
  {"id":1012,"psid":"tyjhnbg640","nickname":"キヤマ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":9,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1013,"psid":"uevo_97","nickname":"うぇぼ","realName":null,"teamId":511,"teamName":"Hookar","number":null,"card":"-","overall":null,"apps":6,"winRate":50,"goals":0,"assists":1,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1014,"psid":"uikura0205","nickname":"奴隷","realName":null,"teamId":546,"teamName":"Team 546","number":"10","card":"-","overall":54,"apps":7,"winRate":14,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1015,"psid":"ultraman-style14","nickname":"レジ","realName":null,"teamId":212,"teamName":"Team 212","number":"78","card":"-","overall":54,"apps":4,"winRate":75,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1016,"psid":"unkind_plane669","nickname":null,"realName":null,"teamId":712,"teamName":"FC MATSUDO","number":"23","card":"-","overall":54,"apps":3,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1017,"psid":"uooikuk","nickname":"キクロウ","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":54,"winRate":55,"goals":2,"assists":5,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1018,"psid":"utiyuuji","nickname":"ゆうじ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"80","card":"-","overall":58,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1019,"psid":"uzunaruda","nickname":"ウズ","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":42,"winRate":28,"goals":14,"assists":2,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1020,"psid":"v11209","nickname":"ブイ","realName":null,"teamId":212,"teamName":"Team 212","number":"6","card":"-","overall":64,"apps":36,"winRate":38,"goals":3,"assists":2,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1021,"psid":"vault8828","nickname":"vault8828","realName":null,"teamId":462,"teamName":"Team 462","number":"25","card":"-","overall":54,"apps":6,"winRate":16,"goals":9,"assists":24,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1022,"psid":"vcf1216","nickname":"カミ","realName":null,"teamId":101,"teamName":"AKATUKI","number":"16","card":"-","overall":56,"apps":4,"winRate":25,"goals":1,"assists":2,"cleanSheets":18,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1023,"psid":"vdvgb11","nickname":"エバ","realName":null,"teamId":143,"teamName":"Team 143","number":"17","card":"-","overall":60,"apps":260,"winRate":70,"goals":5,"assists":26,"cleanSheets":148,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1024,"psid":"vip_Tako","nickname":"タコ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":3,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1025,"psid":"vxzw","nickname":"テンナナ","realName":null,"teamId":76,"teamName":"MK BOMB","number":"5","card":"-","overall":54,"apps":18,"winRate":27,"goals":0,"assists":1,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1026,"psid":"wani102417","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":null,"apps":51,"winRate":25,"goals":11,"assists":10,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1027,"psid":"wattka1995","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":13,"winRate":76,"goals":0,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1028,"psid":"wavecool","nickname":"wavecool","realName":null,"teamId":544,"teamName":"Team 544","number":null,"card":"-","overall":54,"apps":0,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1029,"psid":"whyorwhynot27","nickname":"ワイ","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":1,"winRate":100,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1030,"psid":"wiin117","nickname":"ウィーン","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":null,"card":"-","overall":72,"apps":28,"winRate":42,"goals":1,"assists":2,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1031,"psid":"wintosu17","nickname":"ショウタロ","realName":null,"teamId":430,"teamName":"Team 430","number":"8","card":"-","overall":54,"apps":6,"winRate":50,"goals":0,"assists":1,"cleanSheets":9,"yellow":0,"red":0,"labels":["TOTW04"],"specialCards":[],"status":"在籍"},
  {"id":1032,"psid":"wizonce_","nickname":"ハッシー","realName":null,"teamId":146,"teamName":"Team 146","number":null,"card":"-","overall":null,"apps":88,"winRate":52,"goals":5,"assists":14,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1033,"psid":"wjk-r","nickname":"ダブル","realName":null,"teamId":361,"teamName":"Team 361","number":null,"card":"-","overall":null,"apps":21,"winRate":57,"goals":18,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1034,"psid":"woldis764","nickname":"うぉるでぃす","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":6,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1035,"psid":"wt4ru-","nickname":"ワタル","realName":null,"teamId":213,"teamName":"Team 213","number":"5","card":"-","overall":91,"apps":22,"winRate":77,"goals":4,"assists":2,"cleanSheets":16,"yellow":0,"red":0,"labels":["TOTW03","TOTW04","EAFC17","TOTW08","CORN01"],"specialCards":[],"status":"在籍"},
  {"id":1036,"psid":"wwkk3737","nickname":"けんぽこ","realName":null,"teamId":626,"teamName":"OKUMURA KOUKI","number":"66","card":"-","overall":54,"apps":16,"winRate":0,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1037,"psid":"wwwwwwto91","nickname":null,"realName":null,"teamId":481,"teamName":"Team 481","number":null,"card":"-","overall":null,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1038,"psid":"x2basax","nickname":"ツバサ","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"10","card":"-","overall":74,"apps":31,"winRate":54,"goals":18,"assists":7,"cleanSheets":0,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":1039,"psid":"x77_k4dX","nickname":"べや","realName":null,"teamId":545,"teamName":"Tesuryo","number":"4","card":"-","overall":54,"apps":47,"winRate":68,"goals":1,"assists":2,"cleanSheets":22,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1040,"psid":"xDoctor_Wu","nickname":"だにえる","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"42","card":"-","overall":54,"apps":3,"winRate":33,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1041,"psid":"xMWAMx","nickname":"らっど","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":23,"winRate":35,"goals":0,"assists":0,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1042,"psid":"x_BUDSDELTA9_x","nickname":"猿猫","realName":null,"teamId":546,"teamName":"Team 546","number":"98","card":"-","overall":54,"apps":23,"winRate":43,"goals":3,"assists":1,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1043,"psid":"xceiaks","nickname":"むぎ","realName":null,"teamId":213,"teamName":"Team 213","number":"38","card":"-","overall":83,"apps":22,"winRate":77,"goals":1,"assists":8,"cleanSheets":16,"yellow":0,"red":0,"labels":["THUN17"],"specialCards":[],"status":"在籍"},
  {"id":1044,"psid":"xoxo__26","nickname":null,"realName":null,"teamId":76,"teamName":"MK BOMB","number":null,"card":"-","overall":null,"apps":13,"winRate":69,"goals":1,"assists":0,"cleanSheets":5,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1045,"psid":"xx-33-diablo","nickname":null,"realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":null,"card":"-","overall":null,"apps":8,"winRate":62,"goals":1,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1046,"psid":"y-t0920","nickname":"ターニー","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":51,"winRate":23,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1047,"psid":"y0120mon","nickname":"ばに","realName":null,"teamId":544,"teamName":"Team 544","number":"30","card":"-","overall":54,"apps":5,"winRate":40,"goals":1,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":["TOTW01"],"specialCards":[],"status":"在籍"},
  {"id":1048,"psid":"yaaaa956","nickname":"やざーる","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":110,"winRate":25,"goals":7,"assists":7,"cleanSheets":15,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1049,"psid":"yamikisiou","nickname":null,"realName":null,"teamId":544,"teamName":"Team 544","number":"10","card":"-","overall":null,"apps":8,"winRate":62,"goals":4,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1050,"psid":"yasmaru7979","nickname":"ヤスマル","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1051,"psid":"yasudaken330tomp","nickname":"トンピー","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":7,"winRate":42,"goals":2,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1052,"psid":"yasumaru7979","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":3,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1053,"psid":"yodamaru1207","nickname":"よだまる","realName":null,"teamId":71,"teamName":"SEED JAPAN 2026","number":"5","card":"-","overall":54,"apps":19,"winRate":15,"goals":1,"assists":2,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1054,"psid":"yoina78","nickname":null,"realName":null,"teamId":694,"teamName":"Forza Perfetta Calcio","number":"31","card":"-","overall":54,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1055,"psid":"yoko_chelsea","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":"11","card":"-","overall":54,"apps":33,"winRate":63,"goals":25,"assists":4,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1056,"psid":"yoshi_paris","nickname":"よし","realName":null,"teamId":73,"teamName":"Team 073","number":"3","card":"-","overall":54,"apps":4,"winRate":0,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"移動"},
  {"id":1057,"psid":"yottyan1135","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":25,"winRate":68,"goals":0,"assists":0,"cleanSheets":3,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1058,"psid":"youhei0603jp","nickname":"ヨウヘイ","realName":null,"teamId":146,"teamName":"Team 146","number":"15","card":"-","overall":58,"apps":22,"winRate":63,"goals":22,"assists":36,"cleanSheets":12,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1059,"psid":"youxme","nickname":"ユーミー","realName":null,"teamId":146,"teamName":"Team 146","number":"77","card":"-","overall":68,"apps":2,"winRate":0,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1060,"psid":"yu---0316","nickname":"ゆう","realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":3,"winRate":0,"goals":0,"assists":0,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"移動"},
  {"id":1061,"psid":"yuki23sw073","nickname":"ゆーき","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":5,"winRate":80,"goals":0,"assists":0,"cleanSheets":2,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1062,"psid":"yumpool","nickname":"ヤン","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":14,"winRate":0,"goals":1,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1063,"psid":"yuny87","nickname":null,"realName":null,"teamId":292,"teamName":"L'ultima Cena","number":"44","card":"-","overall":54,"apps":2,"winRate":42,"goals":1,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1064,"psid":"yutouver914","nickname":"ユートオーバー","realName":null,"teamId":213,"teamName":"Team 213","number":null,"card":"-","overall":null,"apps":119,"winRate":45,"goals":0,"assists":8,"cleanSheets":4,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1065,"psid":"yuu_wao","nickname":null,"realName":null,"teamId":430,"teamName":"Team 430","number":null,"card":"-","overall":null,"apps":24,"winRate":33,"goals":0,"assists":0,"cleanSheets":6,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1066,"psid":"yuushi0824","nickname":"ゆうし","realName":null,"teamId":212,"teamName":"Team 212","number":null,"card":"-","overall":null,"apps":33,"winRate":6,"goals":3,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1067,"psid":"yuuyuuu1214","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1068,"psid":"yuya-T-DIR","nickname":"ゆや","realName":null,"teamId":652,"teamName":"WAKAMONO","number":"18","card":"-","overall":54,"apps":30,"winRate":53,"goals":4,"assists":3,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1069,"psid":"yuyaaan46","nickname":null,"realName":null,"teamId":154,"teamName":"Team 154","number":null,"card":"-","overall":null,"apps":2,"winRate":50,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1070,"psid":"yuyu0224","nickname":"ゆゆ","realName":null,"teamId":547,"teamName":"HANNARI FC","number":"54","card":"-","overall":62,"apps":20,"winRate":50,"goals":3,"assists":1,"cleanSheets":0,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1071,"psid":"yxkxe","nickname":null,"realName":null,"teamId":698,"teamName":"Team 698","number":"8","card":"-","overall":54,"apps":6,"winRate":16,"goals":1,"assists":0,"cleanSheets":1,"yellow":1,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1072,"psid":"za-hi-bolt","nickname":"ザーヒー","realName":null,"teamId":73,"teamName":"Team 073","number":"33","card":"-","overall":83,"apps":5,"winRate":20,"goals":4,"assists":10,"cleanSheets":1,"yellow":0,"red":0,"labels":["JUDI17"],"specialCards":[],"status":"在籍"},
  {"id":1073,"psid":"zakio99","nickname":"ザッキー","realName":null,"teamId":101,"teamName":"AKATUKI","number":"39","card":"-","overall":58,"apps":53,"winRate":13,"goals":10,"assists":5,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1074,"psid":"zane0_0","nickname":"サネ","realName":null,"teamId":655,"teamName":"Ardwick","number":"44","card":"-","overall":54,"apps":8,"winRate":12,"goals":0,"assists":0,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"在籍"},
  {"id":1075,"psid":"zaq0304","nickname":"シム","realName":null,"teamId":462,"teamName":"Team 462","number":null,"card":"-","overall":null,"apps":15,"winRate":66,"goals":0,"assists":1,"cleanSheets":0,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1076,"psid":"zs7y7jkax","nickname":"クソマル","realName":null,"teamId":213,"teamName":"Team 213","number":"40","card":"-","overall":86,"apps":22,"winRate":77,"goals":1,"assists":1,"cleanSheets":16,"yellow":0,"red":0,"labels":["TOTW05","EAFC17"],"specialCards":[],"status":"在籍"},
  {"id":1077,"psid":"zu-si-hokki-","nickname":null,"realName":null,"teamId":73,"teamName":"Team 073","number":null,"card":"-","overall":null,"apps":36,"winRate":33,"goals":4,"assists":2,"cleanSheets":1,"yellow":0,"red":0,"labels":[],"specialCards":[],"status":"退団"},
  {"id":1078,"psid":"zuzuzunta0","nickname":"ズンタ","realName":null,"teamId":628,"teamName":"WIZARD OF OZ","number":"48","card":"-","overall":84,"apps":22,"winRate":22,"goals":0,"assists":0,"cleanSheets":10,"yellow":0,"red":0,"labels":["CORN01"],"specialCards":[],"status":"在籍"}
];
    window.defaultLeagueLabelMap = defaultLeagueLabelMap;
    window.leagueLabelMap = leagueLabelMap;
    console.log('[Phase 4.11.55] ✅ windowオブジェクトに登録');
}

// ========================================

// ========================================
// モーダル制御 API
// ========================================
window.appModal = {
  show: function(modalId) {
    console.log('[appModal] 表示:', modalId);
    const m = document.getElementById(modalId);
    if (m) {
      m.classList.remove('hidden');
      m.classList.add('flex');
      document.body.style.overflow = 'hidden';
      console.log('[appModal] ✅ 表示完了');
      return true;
    }
    console.error('[appModal] ❌ 要素なし:', modalId);
    return false;
  },
  hide: function(modalId) {
    const m = document.getElementById(modalId);
    if (m) {
      m.classList.remove('flex');
      m.classList.add('hidden');
      document.body.style.overflow = '';
      console.log('[appModal] ✅ 非表示完了');
      return true;
    }
    return false;
  }
};
console.log('✅ [appModal] API初期化完了');
</script>

</head>
<body>
<!-- ============================================================ -->
<!-- eS-League DB Pro パスワード認証 (generate_auth.py) -->
<!-- ============================================================ -->
<div id="auth-overlay" style="position:fixed;inset:0;background:linear-gradient(135deg,#0f172a 0%,#1e293b 100%);display:flex;align-items:center;justify-content:center;z-index:99999;font-family:'Inter',system-ui,sans-serif;">
  <div style="background:rgba(255,255,255,0.06);backdrop-filter:blur(24px);border:1px solid rgba(255,255,255,0.12);border-radius:24px;padding:52px 44px;max-width:390px;width:90%;text-align:center;box-shadow:0 32px 64px rgba(0,0,0,0.5);">
    <div style="font-size:3.2rem;margin-bottom:14px;">⚽</div>
    <h1 style="color:#f8fafc;font-size:1.35rem;font-weight:800;margin:0 0 6px;letter-spacing:-0.02em;">eS-League DB Pro</h1>
    <p style="color:#64748b;font-size:0.78rem;margin:0 0 36px;letter-spacing:0.08em;text-transform:uppercase;">Authenticated Access</p>
    <div style="position:relative;margin-bottom:12px;">
      <input id="es-auth-input" type="password" placeholder="パスワードを入力"
        autocomplete="current-password"
        style="width:100%;box-sizing:border-box;padding:15px 50px 15px 18px;background:rgba(255,255,255,0.09);border:2px solid rgba(255,255,255,0.18);border-radius:14px;color:#f1f5f9;font-size:1.05rem;outline:none;transition:border 0.2s;"
        onfocus="this.style.borderColor='rgba(16,185,129,0.7)'"
        onblur="this.style.borderColor='rgba(255,255,255,0.18)'"
        onkeydown="if(event.key==='Enter'){esAuthCheck();}"
      />
      <button
        onclick="(function(){const i=document.getElementById('es-auth-input');i.type=(i.type==='password'?'text':'password');})();"
        style="position:absolute;right:16px;top:50%;transform:translateY(-50%);background:none;border:none;color:#64748b;cursor:pointer;font-size:1.15rem;padding:0;line-height:1;">👁</button>
    </div>
    <div id="es-auth-msg" style="min-height:22px;margin-bottom:14px;font-size:0.8rem;"></div>
    <button onclick="esAuthCheck()"
      style="width:100%;padding:15px;background:linear-gradient(135deg,#10b981,#059669);border:none;border-radius:14px;color:white;font-weight:700;font-size:1.05rem;cursor:pointer;letter-spacing:0.02em;transition:opacity 0.2s;"
      onmouseover="this.style.opacity='0.9'" onmouseout="this.style.opacity='1'">
      🔓 ログイン
    </button>
    <p style="color:#334155;font-size:0.68rem;margin-top:22px;">セッションは24時間保持されます</p>
  </div>
</div>
<script>
/* eS-League Auth — generated by generate_auth.py */
(function() {
  var _H = 'e8b2c1cd9baaf329aaa84c891a3d77aedc2b5c8fa4dd26ad47fcf7d7ef55bc54';
  var _K = 'esLeagueAuth_v1';
  var _E = 86400000; /* 24h ms */

  function _sha256(str) {
    var buf = new TextEncoder().encode(str);
    return crypto.subtle.digest('SHA-256', buf).then(function(ab) {
      return Array.from(new Uint8Array(ab))
        .map(function(b) { return b.toString(16).padStart(2,'0'); })
        .join('');
    });
  }

  function _dismiss() {
    var el = document.getElementById('auth-overlay');
    if (el) el.style.display = 'none';
  }

  function _setMsg(txt, color) {
    var el = document.getElementById('es-auth-msg');
    if (el) { el.textContent = txt; el.style.color = color || '#f87171'; }
  }

  /* セッション確認 */
  try {
    var saved = JSON.parse(localStorage.getItem(_K) || 'null');
    if (saved && saved.h === _H && (Date.now() - saved.t) < _E) {
      _dismiss(); return;
    }
  } catch(e) {}

  /* グローバル公開 */
  window.esAuthCheck = function() {
    var pw = document.getElementById('es-auth-input');
    if (!pw || !pw.value.trim()) {
      _setMsg('パスワードを入力してください', '#fbbf24');
      return;
    }
    _setMsg('確認中...', '#94a3b8');
    _sha256(pw.value).then(function(h) {
      if (h === _H) {
        localStorage.setItem(_K, JSON.stringify({h: _H, t: Date.now()}));
        _dismiss();
      } else {
        _setMsg('パスワードが正しくありません ✗', '#f87171');
        pw.value = '';
        pw.focus();
      }
    });
  };

  /* 後方互換: window.authCheck も同じ関数に */
  window.authCheck = window.esAuthCheck;

  /* フォーカス */
  setTimeout(function() {
    var el = document.getElementById('es-auth-input');
    if (el) el.focus();
  }, 150);
})();
</script>


<script>
// ========== Phase 4.11.55 Modal Functions ==========
(function() {
    'use strict';
    
    window.openModal = function(modalId) {
        console.log('[Phase 4.11.55] 🔓 openModal呼び出し:', modalId);
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.add('active');
            console.log('[Phase 4.11.55] モーダル表示:', modalId);
        } else {
            console.error('[Phase 4.11.55] モーダル未検出:', modalId);
        }
    };
    
    window.closeModal = function(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.remove('active');
        }
    };
    
    

    
    window.openImportModal = function() {
        console.log('[Phase 4.11.55] インポートモーダル呼び出し');
        window.openModal('import-modal');
    };

    
    

// 🆕 v52.160: closeImportModal function

// ========== v52.162: ラベル自動生成ロジック ==========


// ========== v52.162: 日付ベース推奨ロジック ==========
function compareAndRecommendMerge(articleDate, dbDate, newTeam, oldTeam) {
  const artDate = new Date(articleDate);
  const regDate = new Date(dbDate);
  
  if (artDate > regDate && newTeam !== oldTeam) {
    console.log("[v52.162] 記事のほうが新しい→新チーム推奨:", {newTeam, oldTeam});
    return {
      recommended: "new",
      reason: `記事掲載日(${articleDate})がDB登録日(${dbDate})より新しいため、新チーム「${newTeam}」を推奨`
    };
  } else if (regDate >= artDate && newTeam !== oldTeam) {
    console.log("[v52.162] DBのほうが新しい→既存保持推奨");
    return {
      recommended: "keep",
      reason: `DB登録日(${dbDate})が記事掲載日(${articleDate})以降のため、既存チーム「${oldTeam}」を保持推奨`
    };
  }
  return { recommended: "new", reason: "日付同一またはチーム同一" };
}
// ========== v52.162: 日付ロジック終了 ==========

window.closeImportModal = function() {
    const modal = document.getElementById('import-modal');
    if (modal) {
        modal.classList.add('hidden');
        console.log('[v52.160] ✅ Import modal closed');
    }
};
// ========== Phase 4.11.55: Card Analysis Functions ==========
    
    // グローバル変数
    window.geminiApiKey = localStorage.getItem('geminiApiKey') || '';
    window.currentCardImage = null;
    
    // API キー保存
    window.saveGeminiApiKey = function() {
        const apiKey = document.getElementById('geminiApiKeyInput').value.trim();
        if (!apiKey) {
            alert('❌ APIキーを入力してください');
            return;
        }
        
        if (!apiKey.startsWith('AIzaSy')) {
            alert('❌ 無効なAPIキーです。"AIzaSy" で始まる必要があります。');
            return;
        }
        
        window.geminiApiKey = apiKey;
        localStorage.setItem('geminiApiKey', apiKey);
        console.log('✅ [Gemini API] APIキーを保存しました');
        console.info('💡 使用モデル: gemini-2.5-flash (安定版)');
        
        // 成功メッセージ
        const section = document.getElementById('apiKeySection');
        section.style.background = '#d1fae5';
        section.style.borderColor = '#10b981';
        setTimeout(() => {
            section.style.background = '#fef3c7';
            section.style.borderColor = '#fbbf24';
        }, 2000);
        
        console.log('[Card Analysis] API キー保存成功');
        alert('✅ APIキーを保存しました！');
    };
    
    // 画像アップロード処理
    window.handleCardImageUpload = function(event) {
        const file = event.target.files[0];
        if (!file) return;
        
        console.log('[Card Analysis] 画像選択:', file.name, file.size, 'bytes');
        
        // ファイルサイズチェック (10MB制限)
        if (file.size > 10 * 1024 * 1024) {
            alert('❌ 画像サイズが大きすぎます（最大10MB）');
            return;
        }
        
        // 画像を読み込み
        const reader = new FileReader();
        reader.onload = function(e) {
            window.currentCardImage = e.target.result;
            
            // プレビュー表示
            document.getElementById('dropZone').style.display = 'none';
            document.getElementById('imagePreview').style.display = 'block';
            document.getElementById('previewImage').src = e.target.result;
            
            console.log('[Card Analysis] 画像プレビュー表示');
        };
        reader.readAsDataURL(file);
    };
    
    // ドラッグ&ドロップ処理
    window.handleCardImageDrop = function(event) {
        event.preventDefault();
        event.stopPropagation();
        
        // スタイルをリセット
        event.target.style.borderColor = '#cbd5e1';
        event.target.style.background = '#f8fafc';
        
        const file = event.dataTransfer.files[0];
        if (!file) return;
        
        if (!file.type.startsWith('image/')) {
            alert('❌ 画像ファイルを選択してください');
            return;
        }
        
        // 既存の handleCardImageUpload を再利用
        const fakeEvent = { target: { files: [file] } };
        window.handleCardImageUpload(fakeEvent);
    };
    
    // カード解析実行
    window.analyzeCardImage = async function() {
        console.log('[Card Analysis] 解析開始');
        
        // API キーチェック
        if (!window.geminiApiKey) {
            alert('❌ Gemini APIキーが設定されていません\n\n' +
                  '1. Google AI Studio (https://aistudio.google.com/app/apikey) でAPIキーを取得\n' +
                  '2. 「Gemini APIキーを入力」欄にキーを貼り付け\n' +
                  '3. 「保存」ボタンをクリック');
            return;
        }
        
        if (!window.currentCardImage) {
            alert('❌ 画像をアップロードしてください');
            return;
        }
        
        // UI更新
        document.getElementById('imagePreview').style.display = 'none';
        document.getElementById('analysisLoading').style.display = 'block';
        document.getElementById('analysisResult').innerHTML = '<div style="text-align: center; padding: 40px;"><div style="font-size: 48px; margin-bottom: 10px;">⏳</div><p style="color: #8b5cf6;">解析中...</p></div>';
        
        try {
            // Base64画像からデータ部分を抽出
            const base64Data = window.currentCardImage.split(',')[1];
            
            // Gemini API リクエスト
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${window.geminiApiKey}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [
                            {
                                text: `この画像は「eS-League」の特殊カードです。以下の情報を抽出して、JSON形式で返してください：

【必須情報】
- カード名 (name): カードの正式名称
- カテゴリ (category): 「アイテム」「イベント」「スキル」のいずれか
- レアリティ (rarity): 「SR」「R」「N」のいずれか
- 効果 (effect): カードの効果説明（日本語）
- 使用タイミング (timing): 「試合前」「試合中」「試合後」のいずれか

【JSONフォーマット】
{
  "name": "カード名",
  "category": "カテゴリ",
  "rarity": "レアリティ",
  "effect": "効果説明",
  "timing": "使用タイミング"
}

画像から情報を読み取り、上記のJSON形式のみを返してください。説明文は不要です。`
                            },
                            {
                                inline_data: {
                                    mime_type: 'image/jpeg',
                                    data: base64Data
                                }
                            }
                        ]
                    }]
                })
            });
            
            // エラーハンドリング
            if (!response.ok) {
                const errorData = await response.json().catch(() => ({}));
                const errorMessage = errorData.error?.message || `HTTP ${response.status}: ${response.statusText}`;
                console.error('❌ [Gemini API] リクエスト失敗:', errorMessage);
                throw new Error(`Gemini API エラー: ${errorMessage}`);
            }
            
            
            const data = await response.json();
            console.log('[Card Analysis] API レスポンス:', data);
            
            // レスポンスからテキストを抽出
            const resultText = data.candidates[0].content.parts[0].text;
            
            // JSONを抽出（```json ... ``` または直接JSONの場合に対応）
            let cardData;
            const jsonMatch = resultText.match(/```json\s*([\s\S]*?)\s*```/) || resultText.match(/({[\s\S]*})/);
            if (jsonMatch) {
                cardData = JSON.parse(jsonMatch[1]);
            } else {
                throw new Error('JSONデータが見つかりません');
            }
            
            console.log('[Card Analysis] 抽出データ:', cardData);
            
            // 結果を表示
            window.displayAnalysisResult(cardData);
            
            // 履歴に追加
            window.addToHistory(cardData);
            
        } catch (error) {
            console.error('[Card Analysis] エラー:', error);
            
            document.getElementById('analysisResult').innerHTML = `
                <div style="text-align: center; padding: 40px; color: #ef4444;">
                    <div style="font-size: 48px; margin-bottom: 10px;">❌</div>
                    <h3 style="margin-bottom: 10px;">解析エラー</h3>
                    <p style="color: #94a3b8; font-size: 14px;">${error.message}</p>
                    <button onclick="window.resetCardAnalysis()" style="margin-top: 20px; padding: 10px 20px; background: #6366f1; color: white; border: none; border-radius: 8px; cursor: pointer;">
                        再試行
                    </button>
                </div>
            `;
        } finally {
            document.getElementById('analysisLoading').style.display = 'none';
            document.getElementById('imagePreview').style.display = 'block';
        }
    };
    
    // 解析結果表示
    window.displayAnalysisResult = function(cardData) {
        // 解析結果を一時保存（DB保存時に使用）
        window.currentAnalyzedCard = cardData;
        const rarityColors = {
            'SR': '#fbbf24',
            'R': '#8b5cf6',
            'N': '#64748b'
        };
        
        const rarityColor = rarityColors[cardData.rarity] || '#64748b';
        
        const resultHTML = `
            <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="font-size: 20px; color: #1e293b; margin: 0;">${cardData.name}</h3>
                    <span style="background: ${rarityColor}; color: white; padding: 4px 12px; border-radius: 6px; font-weight: bold; font-size: 14px;">
                        ${cardData.rarity}
                    </span>
                </div>
                
                <div style="margin-bottom: 12px;">
                    <span style="display: inline-block; background: #e0e7ff; color: #4338ca; padding: 4px 10px; border-radius: 6px; font-size: 12px; margin-right: 8px;">
                        📂 ${cardData.category}
                    </span>
                    <span style="display: inline-block; background: #ddd6fe; color: #6d28d9; padding: 4px 10px; border-radius: 6px; font-size: 12px;">
                        ⏰ ${cardData.timing}
                    </span>
                </div>
                
                <div style="background: #f1f5f9; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <h4 style="font-size: 14px; color: #64748b; margin-bottom: 8px;">💬 効果</h4>
                    <p style="color: #334155; line-height: 1.6; margin: 0;">${cardData.effect}</p>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <button onclick="window.saveCardToDatabase()" style="background: #10b981; color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        💾 保存
                    </button>
                    <button onclick="window.resetCardAnalysis()" style="background: #64748b; color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        🔄 新しいカード
                    </button>
                </div>
            </div>
        `;
        
        document.getElementById('analysisResult').innerHTML = resultHTML;
    };
    
    // 履歴に追加
    window.addToHistory = function(cardData) {
        const historyDiv = document.getElementById('analysisHistory');
        
        // 初回の場合、プレースホルダーを削除
        if (historyDiv.querySelector('p')) {
            historyDiv.innerHTML = '';
        }
        
        const timestamp = new Date().toLocaleString('ja-JP');
        const historyItem = document.createElement('div');
        historyItem.style.cssText = 'background: white; padding: 10px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;';
        historyItem.innerHTML = `
            <div>
                <strong style="color: #1e293b;">${cardData.name}</strong>
                <span style="color: #94a3b8; font-size: 12px; margin-left: 10px;">${timestamp}</span>
            </div>
            <span style="background: #e0e7ff; color: #4338ca; padding: 2px 8px; border-radius: 4px; font-size: 12px;">
                ${cardData.rarity}
            </span>
        `;
        
        historyDiv.insertBefore(historyItem, historyDiv.firstChild);
    };
    
    // リセット
    window.resetCardAnalysis = function() {
        document.getElementById('dropZone').style.display = 'block';
        document.getElementById('imagePreview').style.display = 'none';
        document.getElementById('analysisResult').innerHTML = `
            <div style="text-align: center; color: #94a3b8; padding: 60px 20px;">
                <div style="font-size: 64px; margin-bottom: 10px;">🎴</div>
                <p>画像をアップロードして<br>解析を開始してください</p>
            </div>
        `;
        window.currentCardImage = null;
        document.getElementById('cardImageInput').value = '';
    };
    
    // DB保存機能
    window.currentAnalyzedCard = null; // 解析結果を一時保存
    
    window.saveCardToDatabase = async function() {
        if (!window.currentAnalyzedCard) {
            alert('❌ 保存するデータがありません');
            return;
        }
        
        try {
            console.log('[Card Analysis] DB保存開始:', window.currentAnalyzedCard);
            
            // IndexedDB を開く
            const dbRequest = indexedDB.open('eS_League_DB', 4);
            
            dbRequest.onerror = function() {
                throw new Error('データベースを開けません');
            };
            
            // Phase 4.11.55: teams テーブル作成
    dbRequest.onupgradeneeded = function(event) {
        console.log('[Phase 4.11.55] 🔧 IndexedDB アップグレード開始');
        const db = event.target.result;
        
        // teams テーブルを作成（まだ存在しない場合）
        if (!db.objectStoreNames.contains('teams')) {
            const teamsStore = db.createObjectStore('teams', { keyPath: 'id' });
      // Phase 4.11.55: players ストア作成
      const playersStore = db.createObjectStore('players', { keyPath: 'id', autoIncrement: true });
      playersStore.createIndex('psid', 'psid', { unique: true });
      playersStore.createIndex('nickname', 'nickname', { unique: false });
      playersStore.createIndex('teamId', 'teamId', { unique: false });
      playersStore.createIndex('status', 'status', { unique: false });
      playersStore.createIndex('number', 'number', { unique: false });
      console.log('[Phase 4.11.55] ✅ players ストア作成完了');

            teamsStore.createIndex('name', 'name', { unique: false });
            teamsStore.createIndex('l1', 'l1', { unique: false });
            console.log('[Phase 4.11.55] ✅ teams テーブル作成完了');
        }
        
        // players テーブルも作成（将来のために）
        if (!db.objectStoreNames.contains('players')) {
            const playersStore = db.createObjectStore('players', { keyPath: 'id', autoIncrement: true });
            playersStore.createIndex('name', 'name', { unique: false });
            playersStore.createIndex('team', 'team', { unique: false });
            playersStore.createIndex('overall', 'overall', { unique: false });
            console.log('[Phase 4.11.55] ✅ players テーブル作成完了');
        }
        // v52.180 FIX-E: tournamentRankings ストア追加
        if (!db.objectStoreNames.contains('tournamentRankings')) {
            const trStore = db.createObjectStore('tournamentRankings', { keyPath: 'id' });
            trStore.createIndex('leagueId', 'leagueId', { unique: false });
            trStore.createIndex('date', 'date', { unique: false });
            console.log('[v52.180] ✅ tournamentRankings ストア作成完了');
        }
    };
            
            dbRequest.onsuccess = function(event) {
                const db = event.target.result;
                
                // トランザクション開始
                const transaction = db.transaction(['specialCards'], 'readwrite');
                const objectStore = transaction.objectStore('specialCards');
                
                // データに追加情報を付与
                const cardData = {
                    ...window.currentAnalyzedCard,
                    addedAt: new Date().toISOString(),
                    image: window.currentCardImage // 画像も保存
                };
                
                // データ追加
                const addRequest = objectStore.add(cardData);
                
                addRequest.onsuccess = function() {
                    console.log('[Card Analysis] DB保存成功:', addRequest.result);
                    alert(`✅ 「${cardData.name}」をデータベースに保存しました！`);
                    
                    // 保存成功の視覚的フィードバック
                    const resultDiv = document.getElementById('analysisResult');
                    resultDiv.style.border = '3px solid #10b981';
                    setTimeout(() => {
                        resultDiv.style.border = 'none';
                    }, 2000);
                };
                
                addRequest.onerror = function() {
                    throw new Error('データの保存に失敗しました');
                };
                
                transaction.oncomplete = function() {
                    db.close();
                };
            };
            
        } catch (error) {
            console.error('[Card Analysis] DB保存エラー:', error);
            alert(`❌ 保存エラー: ${error.message}`);
        }
    };
    
    
    console.log('[Phase 4.11.55] Card Analysis 関数初期化完了');
    console.info('💡 [Gemini API] 使用モデル: gemini-2.5-flash');

    
    // ========== Phase 4.11.55: Team Management Functions ==========
    
    window.allTeams = [];
    window.filteredTeams = [];
    window.currentPage = 1;
    window.teamsPerPage = 10;


    
    
    // Phase 4.11.55: 初期チームデータ投入
    window.initializeTeamsData = async function() {
        console.log('[Phase 4.11.55] 🚀 teams テーブル初期化開始');
        
        return new Promise((resolve, reject) => {
            const dbRequest = indexedDB.open('eS_League_DB', 4);
            
            let isUpgradeNeeded = false;
            
            dbRequest.onupgradeneeded = function(event) {
                console.log('[Phase 4.11.55] 🔧 データベース構造更新中...');
                isUpgradeNeeded = true;
                const db = event.target.result;
                
                // teams テーブルを作成（まだ存在しない場合）
                if (!db.objectStoreNames.contains('teams')) {
                    const teamsStore = db.createObjectStore('teams', { keyPath: 'id' });
      // Phase 4.11.55: players ストア作成
      const playersStore = db.createObjectStore('players', { keyPath: 'id', autoIncrement: true });
      playersStore.createIndex('psid', 'psid', { unique: true });
      playersStore.createIndex('nickname', 'nickname', { unique: false });
      playersStore.createIndex('teamId', 'teamId', { unique: false });
      playersStore.createIndex('status', 'status', { unique: false });
      playersStore.createIndex('number', 'number', { unique: false });
      console.log('[Phase 4.11.55] ✅ players ストア作成完了');

                    teamsStore.createIndex('name', 'name', { unique: false });
                    teamsStore.createIndex('l1', 'l1', { unique: false });
                    console.log('[Phase 4.11.55] ✅ teams テーブル作成完了');
                }
                
                // players テーブルも作成（将来のために）
                if (!db.objectStoreNames.contains('players')) {
                    const playersStore = db.createObjectStore('players', { keyPath: 'id', autoIncrement: true });
                    playersStore.createIndex('name', 'name', { unique: false });
                    playersStore.createIndex('team', 'team', { unique: false });
                    playersStore.createIndex('overall', 'overall', { unique: false });
                    console.log('[Phase 4.11.55] ✅ players テーブル作成完了');
                }
                // v52.180 FIX-E: tournamentRankings ストア追加
                if (!db.objectStoreNames.contains('tournamentRankings')) {
                    const trStore = db.createObjectStore('tournamentRankings', { keyPath: 'id' });
                    trStore.createIndex('leagueId', 'leagueId', { unique: false });
                    trStore.createIndex('date', 'date', { unique: false });
                    console.log('[v52.180] ✅ tournamentRankings ストア作成完了');
                }
            };
            
            dbRequest.onsuccess = function(event) {
                const db = event.target.result;
                
                // teams テーブルが存在するか確認
                if (!db.objectStoreNames.contains('teams')) {
                    console.error('[Phase 4.11.55] ❌ teams テーブルが存在しません');
                    db.close();
                    reject(new Error('teams テーブルが存在しません'));
                    return;
                }
                
                try {
                    // 既存データを確認
                    const transaction = db.transaction(['teams'], 'readonly');
                    const objectStore = transaction.objectStore('teams');
                    const countRequest = objectStore.count();
                    
                    countRequest.onsuccess = function() {
                        const existingCount = countRequest.result;
                        
                        if (existingCount > 0) {
                            console.log(`[Phase 4.11.55] ℹ️ 既存チームデータ: ${existingCount} 件`);
                            db.close();
                            resolve(existingCount);
                            return;
                        }
                        
                        // 初期データを投入
                        console.log('[Phase 4.11.55] 📥 初期チームデータ投入開始...');
                        
                        const writeTransaction = db.transaction(['teams'], 'readwrite');
                        const writeStore = writeTransaction.objectStore('teams');
                        
                        let successCount = 0;
                        let errorCount = 0;
                        
                        // defaultTeams からデータを投入
                        defaultTeams.forEach((team, index) => {
                            const teamData = {
                                id: team.id,
                                name: team.name,
                                l1: team.l1,
                                l2: team.l2 || "",
                                league: leagueLabelMap[team.l1] || "不明",
                                status: "アクティブ",
                                createdAt: new Date().toISOString(),
                                updatedAt: new Date().toISOString()
                            };
                            
                            const addRequest = writeStore.add(teamData);
                            
                            addRequest.onsuccess = function() {
                                successCount++;
                                if ((index + 1) % 10 === 0) {
                                    console.log(`[Phase 4.11.55] 進捗: ${index + 1}/${defaultTeams.length}`);
                                }
                            };
                            
                            addRequest.onerror = function(e) {
                                errorCount++;
                                console.error(`[Phase 4.11.55] ❌ チーム追加失敗: ${team.name}`, e);
                            };
                        });
                        
                        writeTransaction.oncomplete = function() {
                            console.log(`[Phase 4.11.55] ✅ 初期データ投入完了: 成功 ${successCount} 件, 失敗 ${errorCount} 件`);
                            db.close();
                            resolve(successCount);
                        };
                        
                        writeTransaction.onerror = function(e) {
                            console.error('[Phase 4.11.55] ❌ トランザクションエラー:', e);
                            db.close();
                            reject(new Error('初期データ投入失敗'));
                        };
                    };
                    
                    countRequest.onerror = function(e) {
                        console.error('[Phase 4.11.55] ❌ データ数確認エラー:', e);
                        db.close();
                        reject(new Error('データ数確認失敗'));
                    };
                    
                } catch (error) {
                    console.error('[Phase 4.11.55] ❌ トランザクション作成エラー:', error);
                    db.close();
                    reject(error);
                }
            };
            
            dbRequest.onerror = function(e) {
                console.error('[Phase 4.11.55] ❌ データベースオープンエラー:', e);
                reject(new Error('データベースオープン失敗'));
            };
        });
    };
            
    window.loadTeams = async function() {
        try {
            console.log('[Team Management] チーム一覧読み込み開始');
            
            const dbRequest = indexedDB.open('eS_League_DB', 4);
            
            dbRequest.onsuccess = function(event) {
                const db = event.target.result;
                
                // teams テーブルが存在するか確認
                if (!db.objectStoreNames.contains('teams')) {
                    console.log('[Team Management] teams テーブルが存在しません');
                    window.displayTeams([]);
                    db.close();
                    return;
                }
                
                const transaction = db.transaction(['teams'], 'readonly');
                const objectStore = transaction.objectStore('teams');
                const getAllRequest = objectStore.getAll();
                
                getAllRequest.onsuccess = function() {
                    window.allTeams = getAllRequest.result || [];
                    console.log('[Phase 4.11.55] 📊 取得したチーム数:', window.allTeams.length);
                    console.log('[Phase 4.11.55] 📊 チームデータサンプル:', window.allTeams.slice(0, 3));
                    window.filteredTeams = [...window.allTeams];
                    
                    console.log('[Team Management] チーム数:', window.allTeams.length);
                    
                    // 統計更新
                    window.updateTeamStats();
                    
                    // チーム一覧表示
                    window.displayTeams(window.filteredTeams);
                };

    // Phase 4.11.55: チームデータ更新関数
    window.refreshTeamData = async function() {
    console.log('[Phase 4.11.55] 🔄 手動更新開始');
    try {
        // ①データ読み込み
        await window.loadTeams();
        
        // ②統計再計算
        window.updateTeamStats();
        
        // ③一覧再表示
        window.displayTeams();
        
        // ④成功メッセージ（DOM直接操作、showMessage不要）
        const msg = document.createElement('div');
        msg.textContent = '✅ チームデータを更新しました';
        msg.style.cssText = 'position:fixed; top:20px; right:20px; background:#10b981; color:white; padding:12px 24px; border-radius:8px; z-index:10000; box-shadow:0 4px 6px rgba(0,0,0,0.1); font-weight:600;';
        document.body.appendChild(msg);
        setTimeout(() => msg.remove(), 3000);
        
        console.log('[Phase 4.11.55] ✅ 更新完了');
    } catch (error) {
        console.error('[Phase 4.11.55] ❌ 更新エラー:', error);
        alert('❌ チームデータの更新に失敗しました\n\nエラー: ' + error.message);
    }
};
    
                
                transaction.oncomplete = function() {
                    db.close();
                };
            };
            
        } catch (error) {
            console.error('[Team Management] 読み込みエラー:', error);
            alert('❌ チーム一覧の読み込みに失敗しました');
        }
    };
    
    // 統計更新
    window.updateTeamStats = function() {
        console.log('[Phase 4.11.55] 📈 統計更新開始');
        console.log('[Phase 4.11.55] 📈 window.allTeams:', window.allTeams ? window.allTeams.length : 'undefined');
        
        const totalTeams = window.allTeams.length;
        const activeTeams = window.allTeams.filter(t => t.status === 'アクティブ' || t.status === 'active').length;
        
        // 簡易的な選手数計算（実際のDBから取得するのが理想）
        const totalPlayers = 0;
        
        document.getElementById('teamCountStat').textContent = totalTeams;
        document.getElementById('activeTeamsStat').textContent = activeTeams;
        document.getElementById('totalPlayersStat').textContent = totalPlayers;
    };
    
    // チーム一覧表示
    window.displayTeams = function(teams) {
        const tbody = document.getElementById('teamListBody');
        
        if (!teams || teams.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="6" style="padding: 40px; text-align: center; color: #94a3b8;">
                        <div style="font-size: 48px; margin-bottom: 10px;">📭</div>
                        <p>チームがありません</p>
                    </td>
                </tr>
            `;
            return;
        }
        
        // ページネーション
        const startIndex = (window.currentPage - 1) * window.teamsPerPage;
        const endIndex = startIndex + window.teamsPerPage;
        const pageTeams = teams.slice(startIndex, endIndex);
        
        const rows = pageTeams.map(team => {
            const statusBadge = team.status === 'active' || team.status === 'アクティブ'
                ? '<span style="background: #d1fae5; color: #065f46; padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: 600;">アクティブ</span>'
                : '<span style="background: #fee2e2; color: #991b1b; padding: 4px 10px; border-radius: 6px; font-size: 12px; font-weight: 600;">非アクティブ</span>';
            
            const updatedDate = team.updatedAt 
                ? new Date(team.updatedAt).toLocaleString('ja-JP') 
                : '未設定';
            
            
            // リーグ表示（l1とl2を組み合わせ）
            let leagueDisplay = team.league || '不明';
            if (team.l2) {
                const l2Label = leagueLabelMap[team.l2] || team.l2;
                leagueDisplay = `<div style="font-size: 11px; color: #64748b;">${leagueDisplay}</div><div style="font-size: 10px; color: #10b981; font-weight: 600;">${l2Label}</div>`;
            }
            return `
                <tr style="border-bottom: 1px solid #f1f5f9; transition: background 0.2s;" 
                    onmouseover="this.style.background='#f8fafc'" 
                    onmouseout="this.style.background='white'">
                    <td style="padding: 12px; font-weight: 600; color: #1e293b;">${team.name || '名称未設定'}</td>
                    <td style="padding: 12px; text-align: center;">${statusBadge}</td>
                    <td style="padding: 12px; text-align: center; color: #64748b;">0</td>
                    <td style="padding: 12px; text-align: center; color: #1e293b; font-size: 11px;">${leagueDisplay}</td>
                    <td style="padding: 12px; color: #64748b; font-size: 12px;">${updatedDate}</td>
                    <td style="padding: 12px; text-align: center;">
                        <button onclick="window.editTeam('${team.id || team.name}')" 
                                style="background: #3b82f6; color: white; border: none; padding: 6px 12px; border-radius: 6px; margin-right: 5px; cursor: pointer; font-size: 12px;">
                            ✏️ 編集
                        </button>
                        <button onclick="window.deleteTeam('${team.id || team.name}')" 
                                style="background: #ef4444; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px;">
                            🗑️ 削除
                        </button>
                    </td>
                </tr>
            `;
        }).join('');
        
        tbody.innerHTML = rows;
        
        // ページネーション更新
        window.updatePagination(teams.length);
    };
    
    // ページネーション更新
    window.updatePagination = function(totalTeams) {
        const totalPages = Math.ceil(totalTeams / window.teamsPerPage);
        const paginationDiv = document.getElementById('teamPagination');
        
        if (totalPages <= 1) {
            paginationDiv.innerHTML = '';
            return;
        }
        
        let paginationHTML = '';
        
        // 前へボタン
        if (window.currentPage > 1) {
            paginationHTML += `<button onclick="window.goToPage(${window.currentPage - 1})" style="padding: 8px 12px; background: #f1f5f9; border: none; border-radius: 6px; cursor: pointer;">← 前へ</button>`;
        }
        
        // ページ番号
        for (let i = 1; i <= totalPages; i++) {
            if (i === window.currentPage) {
                paginationHTML += `<button style="padding: 8px 12px; background: #10b981; color: white; border: none; border-radius: 6px; font-weight: bold;">${i}</button>`;
            } else {
                paginationHTML += `<button onclick="window.goToPage(${i})" style="padding: 8px 12px; background: #f1f5f9; border: none; border-radius: 6px; cursor: pointer;">${i}</button>`;
            }
        }
        
        // 次へボタン
        if (window.currentPage < totalPages) {
            paginationHTML += `<button onclick="window.goToPage(${window.currentPage + 1})" style="padding: 8px 12px; background: #f1f5f9; border: none; border-radius: 6px; cursor: pointer;">次へ →</button>`;
        }
        
        paginationDiv.innerHTML = paginationHTML;
    };
    
    // ページ移動
    window.goToPage = function(page) {
        window.currentPage = page;
        window.displayTeams(window.filteredTeams);
    };
    
    // 検索フィルタ
    window.filterTeams = function() {
        const searchTerm = document.getElementById('teamSearchInput').value.toLowerCase();
        window.filteredTeams = window.allTeams.filter(team => 
            (team.name || '').toLowerCase().includes(searchTerm)
        );
        window.currentPage = 1;
        window.displayTeams(window.filteredTeams);
    };
    
    // 新規チーム追加フォーム表示
    window.showAddTeamForm = function() {
        document.getElementById('teamFormTitle').textContent = '新規チーム追加';
        document.getElementById('teamFormId').value = '';
        document.getElementById('teamNameInput').value = '';
        document.getElementById('teamStatusInput').value = 'active';
        document.getElementById('teamNotesInput').value = '';
        window.openModal('team-form-modal');
    };
    
    // チーム編集
    window.editTeam = async function(teamId) {
        try {
            const team = window.allTeams.find(t => (t.id || t.name) === teamId);
            if (!team) {
                alert('❌ チームが見つかりません');
                return;
            }
            
            document.getElementById('teamFormTitle').textContent = 'チーム編集';
            document.getElementById('teamFormId').value = team.id || team.name;
            document.getElementById('teamNameInput').value = team.name || '';
            document.getElementById('teamStatusInput').value = team.status === 'アクティブ' ? 'active' : (team.status || 'active');
            document.getElementById('teamNotesInput').value = team.notes || '';
            window.openModal('team-form-modal');
            
        } catch (error) {
            console.error('[Team Management] 編集エラー:', error);
            alert('❌ チームの編集に失敗しました');
        }
    };
    
    // チーム保存
    window.saveTeam = async function(event) {
        event.preventDefault();
        
        const teamId = document.getElementById('teamFormId').value;
        const teamName = document.getElementById('teamNameInput').value.trim();
        const teamStatus = document.getElementById('teamStatusInput').value;
        const teamNotes = document.getElementById('teamNotesInput').value.trim();
        
        if (!teamName) {
            alert('❌ チーム名を入力してください');
            return;
        }
        
        try {
            console.log('[Team Management] チーム保存:', teamName);
            
            const dbRequest = indexedDB.open('eS_League_DB', 4);
            
            // Phase 4.11.55: teams テーブル作成
    dbRequest.onupgradeneeded = function(event) {
        console.log('[Phase 4.11.55] 🔧 IndexedDB アップグレード開始');
        const db = event.target.result;
        
        // teams テーブルを作成（まだ存在しない場合）
        if (!db.objectStoreNames.contains('teams')) {
            const teamsStore = db.createObjectStore('teams', { keyPath: 'id' });
      // Phase 4.11.55: players ストア作成
      const playersStore = db.createObjectStore('players', { keyPath: 'id', autoIncrement: true });
      playersStore.createIndex('psid', 'psid', { unique: true });
      playersStore.createIndex('nickname', 'nickname', { unique: false });
      playersStore.createIndex('teamId', 'teamId', { unique: false });
      playersStore.createIndex('status', 'status', { unique: false });
      playersStore.createIndex('number', 'number', { unique: false });
      console.log('[Phase 4.11.55] ✅ players ストア作成完了');

            teamsStore.createIndex('name', 'name', { unique: false });
            teamsStore.createIndex('l1', 'l1', { unique: false });
            console.log('[Phase 4.11.55] ✅ teams テーブル作成完了');
        }
        
        // players テーブルも作成（将来のために）
        if (!db.objectStoreNames.contains('players')) {
            const playersStore = db.createObjectStore('players', { keyPath: 'id', autoIncrement: true });
            playersStore.createIndex('name', 'name', { unique: false });
            playersStore.createIndex('team', 'team', { unique: false });
            playersStore.createIndex('overall', 'overall', { unique: false });
            console.log('[Phase 4.11.55] ✅ players テーブル作成完了');
        }
        // v52.180 FIX-E: tournamentRankings ストア追加
        if (!db.objectStoreNames.contains('tournamentRankings')) {
            const trStore = db.createObjectStore('tournamentRankings', { keyPath: 'id' });
            trStore.createIndex('leagueId', 'leagueId', { unique: false });
            trStore.createIndex('date', 'date', { unique: false });
            console.log('[v52.180] ✅ tournamentRankings ストア作成完了');
        }
    };
            
            dbRequest.onsuccess = function(event) {
                const db = event.target.result;
                const transaction = db.transaction(['teams'], 'readwrite');
                const objectStore = transaction.objectStore('teams');
                
                const teamData = {
                    name: teamName,
                    status: teamStatus,
                    notes: teamNotes,
                    updatedAt: new Date().toISOString()
                };
                
                let request;
                if (teamId) {
                    // 編集
                    teamData.id = parseInt(teamId) || teamId;
                    request = objectStore.put(teamData);
                } else {
                    // 新規追加
                    request = objectStore.add(teamData);
                }
                
                request.onsuccess = function() {
                    console.log('[Team Management] 保存成功');
                    alert(`✅ 「${teamName}」を保存しました！`);
                    window.closeModal('team-form-modal');
                    window.loadTeams();
                };
                
                request.onerror = function() {
                    alert('❌ チームの保存に失敗しました');
                };
                
                transaction.oncomplete = function() {
                    db.close();
                };
            };
            
        } catch (error) {
            console.error('[Team Management] 保存エラー:', error);
            alert(`❌ 保存エラー: ${error.message}`);
        }
    };
    
    // チーム削除
    window.deleteTeam = async function(teamId) {
        const team = window.allTeams.find(t => (t.id || t.name) === teamId);
        if (!team) {
            alert('❌ チームが見つかりません');
            return;
        }
        
        if (!confirm(`「${team.name}」を削除してもよろしいですか？\n\nこの操作は取り消せません。`)) {
            return;
        }
        
        try {
            console.log('[Team Management] チーム削除:', team.name);
            
            const dbRequest = indexedDB.open('eS_League_DB', 4);
            
            dbRequest.onsuccess = function(event) {
                const db = event.target.result;
                const transaction = db.transaction(['teams'], 'readwrite');
                const objectStore = transaction.objectStore('teams');
                
                const deleteRequest = objectStore.delete(team.id || team.name);
                
                deleteRequest.onsuccess = function() {
                    console.log('[Team Management] 削除成功');
                    alert(`✅ 「${team.name}」を削除しました`);
                    window.loadTeams();
                };
                
                deleteRequest.onerror = function() {
                    alert('❌ チームの削除に失敗しました');
                };
                
                transaction.oncomplete = function() {
                    db.close();
                };
            };
            
        } catch (error) {
            console.error('[Team Management] 削除エラー:', error);
            alert(`❌ 削除エラー: ${error.message}`);
        }
    };
    
    
    console.log('[Phase 4.11.55] Team Management 関数初期化完了');

    // ========================================
    // Phase 4.11.55: データインポート機能
    // ========================================
    
    // グローバル変数
    window.importData = {
        csv: { parsed: null, errors: [] },
        json: { parsed: null, errors: [] }
    };
    
    /**
     * タブ切り替え
     */
    function initImportTabs() {
        const tabBtns = document.querySelectorAll('.import-tab-btn');
        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const tab = btn.dataset.tab;
                
                // タブボタン切り替え
                tabBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                // パネル切り替え
                document.querySelectorAll('.import-panel').forEach(p => {
                    p.classList.remove('active');
                });
                document.getElementById(`${tab}-import-panel`).classList.add('active');
                
                // リセット
                clearImportErrors();
            });
        });
    }
    
    /**
     * CSV ファイルハンドラ
     */
    function initCsvImport() {
        const dropZone = document.getElementById('csv-drop-zone');
        const fileInput = document.getElementById('csv-file-input');
        
        // クリックでファイル選択
        dropZone.addEventListener('click', () => fileInput.click());
        
        // ファイル選択
        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) handleCsvFile(file);
        });
        
        // ドラッグ&ドロップ
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = '#3b82f6';
            dropZone.style.background = '#eff6ff';
        });
        
        dropZone.addEventListener('dragleave', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = '#cbd5e0';
            dropZone.style.background = '#f7fafc';
        });
        
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = '#cbd5e0';
            dropZone.style.background = '#f7fafc';
            
            const file = e.dataTransfer.files[0];
            if (file && file.name.endsWith('.csv')) {
                handleCsvFile(file);
            } else {
                showImportError(['CSVファイルを選択してください']);
            }
        });
    }
    
    /**
     * CSVファイル処理
     */
    async function handleCsvFile(file) {
        try {
            const text = await file.text();
            const delimiter = document.getElementById('csv-delimiter').value;
            const hasHeader = document.getElementById('csv-has-header').checked;
            
            const parsed = parseCsv(text, delimiter, hasHeader);
            
            if (parsed.errors.length > 0) {
                showImportError(parsed.errors);
            }
            
            window.importData.csv.parsed = parsed.data;
            window.importData.csv.errors = parsed.errors;
            
            displayCsvPreview(parsed.data);
            
            document.getElementById('import-execute-btn').style.display = 'inline-block';
            document.getElementById('import-clear-btn').style.display = 'inline-block';
            
        } catch (error) {
            showImportError([`ファイル読み込みエラー: ${error.message}`]);
        }
    }
    
    /**
     * CSVパーサー (RFC 4180準拠)
     */
    function parseCsv(text, delimiter, hasHeader) {
        delimiter = delimiter || ',';
        hasHeader = hasHeader !== false;
        
        const lines = text.trim().split('\n');
        const data = [];
        const errors = [];
        
        let headers = ['name', 'category', 'rarity', 'effect', 'timing'];
        let startIdx = 0;
        
        if (hasHeader && lines.length > 0) {
            headers = lines[0].split(delimiter).map(h => h.trim().toLowerCase());
            startIdx = 1;
        }
        
        for (let i = startIdx; i < lines.length; i++) {
            const line = lines[i].trim();
            if (!line) continue;
            
            const values = line.split(delimiter).map(v => v.trim());
            
            if (values.length !== headers.length) {
                errors.push(`行${i + 1}: 列数不一致 (期待: ${headers.length}, 実際: ${values.length})`);
                continue;
            }
            
            const row = {};
            headers.forEach((header, idx) => {
                row[header] = values[idx];
            });
            
            // 必須フィールドチェック
            if (!row.name || !row.category || !row.rarity) {
                errors.push(`行${i + 1}: 必須フィールド不足 (name, category, rarity)`);
                continue;
            }
            
            data.push(row);
        }
        
        return { data, errors };
    }
    
    /**
     * CSVプレビュー表示
     */
    function displayCsvPreview(data) {
        const container = document.getElementById('csv-preview-container');
        const preview = document.getElementById('csv-preview');
        const stats = document.getElementById('csv-stats');
        
        if (!data || data.length === 0) {
            container.style.display = 'none';
            return;
        }
        
        // プレビュー表示 (最大10件)
        const displayData = data.slice(0, 10);
        const headers = Object.keys(displayData[0]);
        
        let html = '<table class="import-preview-table"><thead><tr>';
        headers.forEach(h => {
            html += `<th>${h}</th>`;
        });
        html += '</tr></thead><tbody>';
        
        displayData.forEach(row => {
            html += '<tr>';
            headers.forEach(h => {
                html += `<td>${row[h] || '-'}</td>`;
            });
            html += '</tr>';
        });
        html += '</tbody></table>';
        
        preview.innerHTML = html;
        
        // 統計情報
        stats.innerHTML = `
            <strong>📊 統計:</strong> 
            全${data.length}件 
            ${data.length > 10 ? `(上位10件を表示)` : ''}
        `;
        
        container.style.display = 'block';
    }
    
    /**
     * JSON ファイルハンドラ
     */
    function initJsonImport() {
        const dropZone = document.getElementById('json-drop-zone');
        const fileInput = document.getElementById('json-file-input');
        
        // クリックでファイル選択
        dropZone.addEventListener('click', () => fileInput.click());
        
        // ファイル選択
        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) handleJsonFile(file);
        });
        
        // ドラッグ&ドロップ
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = '#3b82f6';
            dropZone.style.background = '#eff6ff';
        });
        
        dropZone.addEventListener('dragleave', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = '#cbd5e0';
            dropZone.style.background = '#f7fafc';
        });
        
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.style.borderColor = '#cbd5e0';
            dropZone.style.background = '#f7fafc';
            
            const file = e.dataTransfer.files[0];
            if (file && file.name.endsWith('.json')) {
                handleJsonFile(file);
            } else {
                showImportError(['JSONファイルを選択してください']);
            }
        });
    }
    
    /**
     * JSONファイル処理
     */
    async function handleJsonFile(file) {
        try {
            const text = await file.text();
            const data = JSON.parse(text);
            
            if (!Array.isArray(data)) {
                showImportError(['JSON形式エラー: 配列である必要があります']);
                return;
            }
            
            const validateSchema = document.getElementById('json-validate-schema').checked;
            const errors = [];
            
            if (validateSchema) {
                data.forEach((item, idx) => {
                    if (!item.name || !item.category || !item.rarity) {
                        errors.push(`要素${idx}: 必須フィールド不足 (name, category, rarity)`);
                    }
                });
            }
            
            window.importData.json.parsed = data;
            window.importData.json.errors = errors;
            
            if (errors.length > 0) {
                showImportError(errors);
            }
            
            displayJsonPreview(data);
            
            document.getElementById('import-execute-btn').style.display = 'inline-block';
            document.getElementById('import-clear-btn').style.display = 'inline-block';
            
        } catch (error) {
            showImportError([`JSON解析エラー: ${error.message}`]);
        }
    }
    
    /**
     * JSONプレビュー表示
     */
    function displayJsonPreview(data) {
        const container = document.getElementById('json-preview-container');
        const preview = document.getElementById('json-preview');
        const stats = document.getElementById('json-stats');
        
        if (!data || data.length === 0) {
            container.style.display = 'none';
            return;
        }
        
        // プレビュー表示 (最大5件)
        const displayData = data.slice(0, 5);
        preview.innerHTML = `<pre style="margin:0; font-size:12px; overflow-x: auto;">${JSON.stringify(displayData, null, 2)}</pre>`;
        
        // 統計情報
        stats.innerHTML = `
            <strong>📊 統計:</strong> 
            全${data.length}件 
            ${data.length > 5 ? `(上位5件を表示)` : ''}
        `;
        
        container.style.display = 'block';
    }
    
    /**
     * インポート実行
     */
    async function executeImport() {
        const activeTab = document.querySelector('.import-tab-btn.active').dataset.tab;
        const skipDuplicates = document.getElementById(`${activeTab}-skip-duplicates`).checked;
        
        const data = activeTab === 'csv' ? window.importData.csv.parsed : window.importData.json.parsed;
        
        if (!data || data.length === 0) {
            showImportError(['インポートするデータがありません']);
            return;
        }
        
        try {
            // IndexedDB保存
            const db = await openDatabase();
            const tx = db.transaction('specialCards', 'readwrite');
            const store = tx.objectStore('specialCards');
            
            let successCount = 0;
            let skipCount = 0;
            
            for (const item of data) {
                if (skipDuplicates) {
                    // 重複チェック
                    const existing = await new Promise((resolve, reject) => {
                        const req = store.index('name').get(item.name);
                        req.onsuccess = () => resolve(req.result);
                        req.onerror = () => reject(req.error);
                    });
                    
                    if (existing) {
                        skipCount++;
                        continue;
                    }
                }
                
                await new Promise((resolve, reject) => {
                    const req = store.add({
                        name: item.name,
                        category: item.category,
                        rarity: item.rarity,
                        effect: item.effect || '',
                        timing: item.timing || '',
                        createdAt: new Date().toISOString()
                    });
                    req.onsuccess = () => resolve();
                    req.onerror = () => reject(req.error);
                });
                
                successCount++;
            }
            
            await tx.complete;
            
            alert(`✅ インポート完了\n成功: ${successCount}件\nスキップ: ${skipCount}件`);
            
            // リセット
            resetImport();
            window.closeModal('import-modal');
            
        } catch (error) {
            showImportError([`インポートエラー: ${error.message}`]);
        }
    }
    
    /**
     * リセット
     */
    function resetImport() {
        window.importData = {
            csv: { parsed: null, errors: [] },
            json: { parsed: null, errors: [] }
        };
        
        document.getElementById('csv-file-input').value = '';
        document.getElementById('json-file-input').value = '';
        
        document.getElementById('csv-preview-container').style.display = 'none';
        document.getElementById('json-preview-container').style.display = 'none';
        
        document.getElementById('import-execute-btn').style.display = 'none';
        document.getElementById('import-clear-btn').style.display = 'none';
        
        clearImportErrors();
    }
    
    /**
     * エラー表示
     */
    function showImportError(errors) {
        const container = document.getElementById('import-errors');
        const list = document.getElementById('import-error-list');
        
        list.innerHTML = errors.map(e => `<li>${e}</li>`).join('');
        container.style.display = 'block';
    }
    
    /**
     * エラークリア
     */
    function clearImportErrors() {
        document.getElementById('import-errors').style.display = 'none';
        document.getElementById('import-error-list').innerHTML = '';
    }
    
    // イベント登録
    
// v52.174: toggleDarkMode unified with data-theme system
function toggleDarkMode() {
  if (window.toggleTheme) {
    window.toggleTheme();
  } else {
    const html = document.documentElement;
    const cur = html.getAttribute('data-theme') || 'light';
    const next = cur === 'light' ? 'dark' : 'light';
    html.setAttribute('data-theme', next);
    localStorage.setItem('theme', next);
    const cb = document.getElementById('themeToggleCheckbox');
    if (cb) cb.checked = (next === 'dark');
  }
}

document.addEventListener('DOMContentLoaded', () => {
    // ========================================================================
    // Phase 4.11.41: Comprehensive Window Exposure (CRITICAL FIX)
    // ========================================================================
    // Expose all critical functions to window object for HTML onclick handlers
    if (typeof window !== 'undefined') {
      // Tab navigation
      
      // View updates
      window.updateView = updateView;
      
      // Card analysis
      window.startCardAnalysis = startCardAnalysis;
      window.startCardBatchProcessing = startCardBatchProcessing;
      window.startCardBatchMergeProcess = typeof startCardBatchMergeProcess !== 'undefined' ? startCardBatchMergeProcess : null;
      
      // Import/Export
      window.openImportModal = openImportModal;
      window.closeImportModal = closeImportModal;
window.saveCardMergeSelections = () => { document.querySelector('#cardMergeConfirmModal').saveCardMergeSelections(); };
      
      // Theme
      window.toggleDarkMode = toggleDarkMode;
      // window.initTheme = initTheme;  // v52.163.5: IIFEのためスコープ外から参照不可
      
      console.log('[v52.160] ✅ All critical functions exposed to window');
    }

        initImportTabs();
        initCsvImport();
        initJsonImport();
        
        document.getElementById('import-execute-btn').addEventListener('click', executeImport);
        document.getElementById('import-clear-btn').addEventListener('click', resetImport);
        
        console.log('[Phase 4.11.55] Data Import 関数初期化完了');
    });
    

    
    // モーダル外クリックで閉じる (DOMContentLoaded後に登録)
    
    console.log('[Phase 4.11.55] モーダル関数初期化完了');

// 背景クリックでモーダルを閉じる（完全版）
document.addEventListener('DOMContentLoaded', function() {
    console.log('[Phase 4.11.55] 背景クリックイベント登録開始');
    
    // すべてのモーダルに対してクリックイベントを設定
    const modals = document.querySelectorAll('.modal');
    modals.forEach(modal => {
        modal.addEventListener('click', function(e) {
            // modal-overlay（背景）がクリックされた場合
            if (e.target === this || e.target.classList.contains('modal-overlay')) {
                console.log('[Phase 4.11.55] 背景クリックでモーダルを閉じる: ' + this.id);
                this.classList.remove('active');
            }
        });
    });
    
    console.log('[Phase 4.11.55] 背景クリックイベント登録完了 (' + modals.length + ' モーダル)');
});
})();
</script>


<div class="max-w-[1600px] mx-auto p-4 md:p-8">
    
    <!-- ダークモードトグルボタン -->
    <div id="themeToggleContainer">
        <label id="themeToggleLabel" for="themeToggleCheckbox">ダークモード</label>
        <label class="toggle-switch">
            <input type="checkbox" id="themeToggleCheckbox" onchange="window.toggleTheme()">
            <span class="toggle-slider"></span>
        </label>
    </div>

    <header class="mb-10 flex flex-wrap justify-between items-center border-l-8 border-emerald-600 pl-6">
        <div>
            <div class="flex items-center gap-4">
                <h1 class="text-4xl tracking-tighter uppercase leading-none">eS League DB pro 2026</h1>
                <a href="https://www.seed-japan.info/league/s-league/" target="_blank" rel="noopener noreferrer" class="transition-transform hover:scale-105 active:scale-95">
                    <img src="https://es-league.games/es_new/img/logo.png" alt="S-League" class="h-10 object-contain drop-shadow-sm">
                </a>
            </div>
            <div class="flex items-center gap-3 mt-2">
                <span class="text-gray-400 uppercase tracking-widest text-[10px]">INTEGRATED MANAGEMENT CONSOLE</span>
                <span class="bg-emerald-600 text-white px-3 py-0.5 rounded-full text-[10px] tracking-widest uppercase">SYSTEM v52.182 Phase 4.26</span><span class="text-[9px] text-gray-300/40 tracking-wide ml-1 select-none">Produced by <a href="https://x.com/ryoryomaru99" target="_blank" rel="noopener" class="text-gray-300/40 hover:text-gray-400/60 transition-colors no-underline">@ryoryomaru99</a></span>
                <span id="syncStatus" class="text-[10px] text-gray-400 uppercase tracking-widest flex items-center gap-1"></span>
            </div>
        </div>
        <div id="statusMessage" class="hidden px-8 py-4 rounded-2xl shadow-2xl fixed top-6 right-6 z-[2000] transition-all text-sm border-2"></div>
    </header>

    <nav class="flex space-x-10 border-b-2 border-gray-100 mb-8 uppercase tracking-widest text-[11px] overflow-x-auto pb-1">
        <button onclick="window.switchTab('teams')" id="tab-teams" class="py-4 px-2 tab-active">チーム一覧</button>
        <button onclick="window.switchTab('players')" id="tab-players" class="py-4 px-2 text-gray-400 hover:text-emerald-600">選手データ & 分析・編集</button>
        <button onclick="window.switchTab('admin')" id="tab-admin" class="py-4 px-2 text-gray-400 hover:text-indigo-600">⚙️ DBAI解析</button>
        <button onclick="window.switchTab('card')" id="tab-card" class="py-4 px-2 text-gray-400 hover:text-indigo-600">🃏 特殊カード（ラベル）</button>
        <button onclick="window.openImportModal()" class="py-4 px-4 text-gray-400 hover:text-blue-600 transition-all hover:scale-105 active:scale-95" title="外部データをインポート">
            📥 データインポート
        </button>
        <button onclick="window.switchTab('db')" id="tab-db" class="py-4 px-2 text-gray-400 hover:text-indigo-600">💾 DB管理</button>
    </nav>

    <!-- Content: Teams -->
    <section id="content-teams" class="fade-in">
        <div class="grid grid-cols-1 md:grid-cols-5 gap-6 mb-8">
            <div class="md:col-span-2 bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                <p class="text-muted mb-2 text-slate-400 text-[10px]">SEARCH TEAM</p>
                <input type="text" id="teamSearch" onkeyup="window.updateView()" placeholder="チーム名またはID..." class="w-full bg-slate-50 border-2 border-slate-100 rounded-2xl p-4 text-sm outline-none focus:border-emerald-500">
            </div>
            <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200">
                <p class="text-muted mb-2 text-slate-400 text-[10px]">FILTER LEAGUE</p>
                <select id="leagueFilter" onchange="window.updateView()" class="w-full bg-slate-50 border-2 border-slate-100 rounded-2xl p-4 text-sm outline-none cursor-pointer"></select>
            </div>
            <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200 flex flex-col justify-center">
                <p class="text-muted mb-2 text-slate-400 text-[10px] text-center">MANAGE TEAMS</p>
                <button onclick="window.openTeamManager()" class="w-full bg-slate-800 text-white py-4 rounded-2xl text-xs uppercase shadow-md hover:bg-emerald-600 transition-all active:scale-95">⚙️ チーム＆リーグ管理</button>
            </div>
            <div class="bg-indigo-600 text-white p-6 rounded-3xl shadow-xl flex flex-col justify-center text-center">
                <p class="text-[10px] opacity-70 uppercase tracking-widest mb-1">Total Teams</p>
                <h4 id="statTotalTeams" class="text-3xl">0</h4>
            </div>
        </div>
        <div class="table-container custom-scrollbar shadow-sm overflow-hidden">
            <table class="w-full text-left">
                <thead class="bg-slate-50 text-slate-400 uppercase text-[10px] tracking-widest border-b border-slate-100">
                    <tr>
                        <th class="sortable" onclick="window.setTeamSort('l1')">カテゴリ (L1 / L2...) <span>▲▼</span></th>
                        <th class="sortable" onclick="window.setTeamSort('name')">チーム名 <span>▲▼</span></th>
                        <th class="text-center">所属数</th>
                        <th class="text-right sortable" onclick="window.setTeamSort('id')">個別ID <span>▲▼</span></th>
                        <th class="text-center">操作</th>
                    </tr>
                </thead>
                <tbody id="teamTableBody" class="divide-y divide-slate-50 text-sm"></tbody>
            </table>
        </div>
    </section>

    <!-- Content: Players -->
    <section id="content-players" class="hidden fade-in">
        <div class="flex flex-col gap-0">
            <!-- 1. パフォーマンス分析 & AIユニット -->
            <div id="performancePanel" class="bg-white p-8 rounded-t-[2.5rem] shadow-sm border border-slate-200 min-h-[350px] h-[500px] flex flex-col overflow-hidden">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-slate-800 uppercase tracking-widest text-sm">📈 パフォーマンス分析 & AI評価</h3>
                    <div id="chartMeta" class="text-[10px] text-emerald-600 px-4 py-2 bg-emerald-50 rounded-full border border-emerald-100">選手を選択してください</div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 flex-1 min-h-0">
                    <div class="lg:col-span-2 space-y-2">
                        <button onclick="window.setChartMetric('ai')" id="tab-ai" class="metric-tab inactive w-full p-3 rounded-xl text-[10px] uppercase font-bold border-2 border-indigo-200 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 transition-all">🤖 AI評価 & 質問</button>
                        <div class="border-t border-slate-200 my-1"></div>
                        <button onclick="window.setChartMetric('assists')" id="tab-assists" class="metric-tab active w-full p-3 rounded-xl text-[10px] uppercase">アシスト</button>
                        <button onclick="window.setChartMetric('goals')" id="tab-goals" class="metric-tab inactive w-full p-3 rounded-xl text-[10px] uppercase">ゴール</button>
                        <button onclick="window.setChartMetric('apps')" id="tab-apps" class="metric-tab inactive w-full p-3 rounded-xl text-[10px] uppercase">出場数</button>
                    </div>
                    <div class="lg:col-span-10 bg-slate-50 rounded-[2rem] p-6 relative h-full min-h-0 flex flex-col">
                        <div id="chartContainer" class="w-full h-full relative">
                             <canvas id="performanceChart" class="w-full h-full"></canvas>
                        </div>
                        
                        <!-- AI Container -->
                        <div id="aiContainer" class="hidden absolute inset-0 bg-white p-6 overflow-y-auto rounded-[2rem] border-2 border-indigo-50 flex flex-col z-20">
                             <!-- Mode Switch (v52.178 大型カード形式) -->
                             <div class="grid grid-cols-2 gap-3 mb-5">
                                <button onclick="window.switchAIMode('individual')" id="ai-mode-individual"
                                    class="ai-mode-btn active group flex flex-col items-center gap-1 p-3 rounded-2xl border-2 border-indigo-200 bg-indigo-50 hover:bg-indigo-100 transition-all text-indigo-700">
                                    <span class="text-2xl">👤</span>
                                    <span class="text-[10px] font-bold uppercase tracking-widest">個人分析</span>
                                    <span class="text-[8px] text-indigo-400">選手を選んでAI評価</span>
                                </button>
                                <button onclick="window.switchAIMode('query')" id="ai-mode-query"
                                    class="ai-mode-btn group flex flex-col items-center gap-1 p-3 rounded-2xl border-2 border-purple-200 bg-purple-50 hover:bg-purple-100 transition-all text-purple-700">
                                    <span class="text-2xl">🤖</span>
                                    <span class="text-[10px] font-bold uppercase tracking-widest">DB探究</span>
                                    <span class="text-[8px] text-purple-400">自由質問AIクエリ</span>
                                </button>
                             </div>

                             <!-- Individual Mode -->
                             <div id="ai-panel-individual" class="flex-1 flex flex-col">
                                <div class="flex justify-between items-center mb-4">
                                    <label class="text-[10px] uppercase tracking-widest text-indigo-400">Output Language</label>
                                    <select id="aiLanguageSelect" class="bg-indigo-50 border border-indigo-100 rounded-lg text-xs px-3 py-1">
                                        <option value="日本語">日本語 (JP)</option>
                                        <option value="English">English (EN)</option>
                                    </select>
                                </div>
                                <div id="aiTextDisplay" class="text-sm leading-loose flex-1 overflow-y-auto custom-scrollbar"></div>
                                
                                <div class="flex gap-2 mt-4">
                                    <button id="aiEvaluateBtn" onclick="window.generateAIEval()" class="flex-[2] bg-indigo-600 text-white px-6 py-3 rounded-xl text-xs shadow-lg active:scale-95 transition-all uppercase tracking-widest">プロアナリスト分析を実行</button>
                                    <button id="aiExportIndBtn" onclick="window.exportAIText('individual')" disabled class="flex-[1] bg-slate-800 text-white px-4 py-3 rounded-xl text-xs shadow-lg active:scale-95 transition-all uppercase tracking-widest disabled:opacity-50">📄 TXT出力</button>
                                </div>
                             </div>

                             <!-- Query Mode -->
                             <div id="ai-panel-query" class="hidden flex-1 flex flex-col">
                                <div class="bg-indigo-50 p-4 rounded-xl mb-4 border border-indigo-100">
                                    <p class="text-[10px] text-indigo-400 uppercase tracking-widest mb-2">対象データ範囲</p>
                                    <div class="flex gap-4">
                                        <label class="flex items-center gap-2 cursor-pointer">
                                            <input type="radio" name="aiQueryScope" value="all" checked class="text-indigo-600">
                                            <span class="text-xs">全データ (ALL)</span>
                                        </label>
                                        <label class="flex items-center gap-2 cursor-pointer">
                                            <input type="radio" name="aiQueryScope" value="filtered" class="text-indigo-600">
                                            <span class="text-xs">現在の絞り込み対象のみ</span>
                                        </label>
                                    </div>
                                </div>
                                <p class="text-[10px] text-slate-400 uppercase tracking-widest mb-1">質問を入力 (例: 背番号使用ランキングは？ / 得点率が高いFWは？)</p>
                                <textarea id="aiQueryInput" class="w-full bg-slate-50 border-2 border-slate-200 rounded-xl p-3 text-xs outline-none focus:border-indigo-500 mb-2 resize-y" style="min-height:120px;height:160px;" placeholder="質問を入力してください..."></textarea>
                                
                                <!-- Status/Progress Area -->
                                <div id="aiQueryProgressArea" class="hidden mb-4 bg-indigo-50 p-4 rounded-xl border border-indigo-100 shadow-inner">
                                    <div class="flex justify-between items-center mb-2">
                                        <div class="flex items-center gap-2">
                                            <div class="card-spinner text-indigo-600"></div>
                                            <span id="aiQueryStatusText" class="text-xs text-indigo-800 font-bold tracking-wider">AI思考中...</span>
                                        </div>
                                    </div>
                                    <div class="progress-bar-container h-1.5 bg-indigo-200">
                                        <div class="progress-bar-fill bg-indigo-600 w-full animate-pulse"></div>
                                    </div>
                                </div>

                                <div id="aiQueryOutput" class="flex-1 bg-white border border-slate-100 rounded-xl p-4 overflow-y-auto custom-scrollbar text-xs leading-loose text-slate-700"></div>
                                
                                <div class="flex gap-2 mt-4">
                                    <button id="aiQueryBtn" onclick="window.runAIQuery()" class="flex-[2] bg-indigo-600 text-white px-6 py-3 rounded-xl text-xs shadow-lg active:scale-95 transition-all w-full uppercase tracking-widest">🔍 データベースに質問する</button>
                                    <!-- Stop Button -->
                                    <button id="aiStopBtn" onclick="window.stopAIQuery()" class="hidden flex-[1] bg-red-500 text-white px-4 py-3 rounded-xl text-xs shadow-lg active:scale-95 transition-all uppercase tracking-widest font-bold">⛔ 中断</button>
                                    <!-- Clear Button -->
                                    <button id="aiClearBtn" onclick="window.clearAIQuery()" class="flex-[1] bg-white border-2 border-slate-200 text-slate-500 px-4 py-3 rounded-xl text-xs shadow-sm hover:text-red-500 hover:border-red-200 transition-all uppercase tracking-widest font-bold">🗑️ クリア</button>
                                    <button id="aiExportQueryBtn" onclick="window.exportAIText('query')" disabled class="flex-[1] bg-slate-800 text-white px-4 py-3 rounded-xl text-xs shadow-lg active:scale-95 transition-all uppercase tracking-widest disabled:opacity-50">📄 TXT出力</button>
                                </div>
                             </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="playersResizer" class="h-6 bg-slate-50 border-x border-slate-200 cursor-ns-resize flex items-center justify-center"></div>
            
            <!-- 2. 選手データ名鑑 & 管理機能 -->
            <div id="playerDirectoryPanel" class="bg-white p-8 rounded-b-[2.5rem] shadow-sm border border-slate-200">
                <div class="flex justify-between items-start mb-8">
                    <h3 class="text-2xl text-slate-800 tracking-tighter uppercase">選手名鑑 & プロ編集コンソール</h3>
                    <div class="flex gap-2">
                        <button onclick="window.openLabelManager()" class="px-6 py-2 bg-white border-2 border-slate-200 text-slate-700 rounded-xl text-[11px] uppercase hover:border-emerald-500 transition">🏷️ ラベル管理</button>
                        <button onclick="window.openAddModal()" class="px-6 py-2 bg-indigo-600 text-white rounded-xl text-[11px] uppercase shadow-lg shadow-indigo-100 hover:bg-indigo-700 transition">＋ 選手を手動追加</button>
                        <button onclick="window.exportDatabase()" class="px-4 py-2 bg-slate-900 text-white rounded-xl text-[10px] uppercase">Export CSV</button>
                        <div class="px-4 py-2 bg-emerald-50 text-emerald-700 rounded-xl text-[10px] uppercase flex gap-2 items-center">
                            登録：総数（<span id="statTotalPlayers" class="font-bold text-emerald-800">0</span>名）<span class="text-amber-600"> / FA（<span id="statFAPlayers" class="font-bold text-amber-700">0</span>名）</span>
                        </div>
                    </div>
                </div>
                <div class="bg-slate-50 p-6 rounded-3xl border border-slate-100 mb-8 space-y-6">
                    <div class="flex flex-wrap gap-4 items-end">
                        <div class="flex-1 min-w-[250px]">
                            <p class="text-muted mb-2">1. タブ切り替え</p>
                            <div class="flex bg-white p-1 rounded-2xl border border-slate-200 w-fit">
                                <button onclick="window.setDisplayType('latest')" id="typeBtnLatest" class="px-6 py-2 rounded-xl text-[11px] bg-emerald-600 text-white shadow-sm">最新記録</button>
                                <button onclick="window.setDisplayType('lifetime')" id="typeBtnLifetime" class="px-6 py-2 rounded-xl text-[11px] text-slate-400 hover:text-slate-600">生涯累計</button>
                            </div>
                        </div>
                        <div class="flex-1 min-w-[300px]">
                            <p class="text-muted mb-2">2. 表示・絞り込み設定</p>
                            <div class="flex gap-2">
                                <button onclick="window.toggleFilterPanel()" class="bg-white border-2 border-slate-200 px-6 py-3 rounded-xl text-xs flex items-center gap-2 hover:border-emerald-400 transition">
                                    項目・チームを指定して表示 <span id="filterCountBadge" class="bg-emerald-600 text-white px-2 py-0.5 rounded-full text-[10px]">0</span>
                                </button>
                                <div class="unified-search-wrap">
                                    <span class="search-icon">🔍</span>
                                    <input type="text" id="playerSearch"
                                        class="bg-white border-2 border-slate-200 rounded-xl text-sm outline-none focus:border-emerald-500 transition-all"
                                        placeholder="統合検索: 選手名・ニック・#背番号・!ラベル・@チーム..."
                                        oninput="window.onSearchInput(this.value)"
                                        onkeydown="window.onSearchKeydown(event)"
                                        autocomplete="off">
                                    <span class="search-kbd">⌘K</span>
                                    <button class="search-clear" id="searchClearBtn" onclick="window.clearSearch()" title="クリア">×</button>
                                </div>
                                <div class="search-hint hidden" id="searchHint">
                                    ヒント: <code>#23</code> 背番号 ／ <code>!ラベル名</code> ラベル ／ <code>@チーム名</code> チーム
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="filterPanel" class="hidden p-6 bg-white rounded-2xl border border-slate-200 animate-in fade-in slide-in-from-top-2">
                        <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">
                            <div class="lg:col-span-4 border-r border-slate-100 pr-4">
                                <p class="text-[10px] text-slate-400 uppercase mb-3">表示データ項目の選択</p>
                                <div id="columnVisibilityList" class="flex flex-wrap gap-2"></div>
                            </div>
                            <div class="lg:col-span-8 space-y-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <p class="text-[10px] text-slate-400 uppercase mb-3">リーグ・ラベル</p>
                                        <div id="playerLeagueFilterList" class="flex flex-wrap gap-2"></div>
                                    </div>
                                    <div>
                                        <p class="text-[10px] text-slate-400 uppercase mb-3">チームを個別選択</p>
                                        <div class="flex gap-2 mb-3">
                                            <select id="playerTeamMultiSelect" class="flex-1 bg-slate-50 border border-slate-200 rounded-xl p-3 text-xs outline-none"></select>
                                            <button onclick="window.addPlayerFilterTeam()" class="bg-slate-900 text-white px-4 py-2 rounded-xl text-[10px] hover:bg-emerald-600 transition">追加</button>
                                        </div>
                                        <div id="selectedTeamTags" class="flex flex-wrap gap-2"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mt-6 pt-4 border-t border-slate-100 flex justify-end gap-3">
                            <button onclick="window.clearPlayerFilters()" class="text-xs text-red-500 hover:underline">全設定クリア</button>
                            <button onclick="window.toggleFilterPanel()" class="bg-slate-900 text-white px-6 py-2 rounded-xl text-xs shadow-lg">設定を閉じる</button>
                        </div>
                    </div>
                </div>

                <div class="flex items-center gap-3 mb-2 px-1">
                    <span id="selectedPlayerCountBadge" class="text-xs text-indigo-600 font-bold bg-indigo-50 px-3 py-1 rounded-full border border-indigo-200"></span>
                    <span id="searchResultBreakdown" class="search-match-badge"></span>
                    <div id="bulkActionBar" class="hidden flex gap-2 ml-auto">
                        <button onclick="window.openTransferModal(window.getCheckedPsids())"
                            class="text-xs bg-amber-500 text-white px-4 py-1.5 rounded-lg hover:bg-amber-600 flex items-center gap-1 shadow-sm">
                            🔄 一括移籍
                        </button>
                        <button onclick="window.bulkAddLabel()"
                            class="text-xs bg-indigo-500 text-white px-4 py-1.5 rounded-lg hover:bg-indigo-600 flex items-center gap-1 shadow-sm">
                            🏷 ラベル一括追加
                        </button>
                        <button onclick="window.toggleSelectAllPlayers(false); window.onPlayerCheckChange()"
                            class="text-xs bg-slate-200 text-slate-600 px-3 py-1.5 rounded-lg hover:bg-slate-300">
                            ✕ 選択解除
                        </button>
                    </div>
                </div>
                <div class="table-container custom-scrollbar shadow-inner">
                    <table class="w-full text-left" id="mainStatTable">
                        <thead class="bg-slate-100 text-slate-500 uppercase tracking-tighter border-b-2 border-slate-200" id="playerTableHeader"></thead>
                        <tbody id="playerTableBody" class="divide-y divide-slate-100"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Content: Admin (DBAI解析) -->
    <section id="content-admin" class="hidden fade-in">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <div class="lg:col-span-4 space-y-6">
                <div class="flex gap-4 mb-4 border-b border-slate-200 pb-2">
                    <button onclick="window.switchAdminMode('auto')" id="admin-mode-auto" class="admin-tab-btn active uppercase text-[10px] tracking-widest pb-2">AI自動解析 (Batch Queue)</button>
                    <button onclick="window.switchAdminMode('manual')" id="admin-mode-manual" class="admin-tab-btn uppercase text-[10px] tracking-widest pb-2">AI手動解析 (画像UP)</button>
                </div>
                <div class="bg-white p-8 rounded-[2rem] shadow-sm border-4 border-emerald-100">
                    <!-- Manual Mode -->
                    <div id="admin-panel-manual" class="space-y-6 hidden">
                        <h3 class="text-xl text-emerald-800 mb-2 uppercase">AI 手動解析</h3>
                        <div>
                            <p class="text-muted mb-2 text-slate-400 text-[10px]">FILTER LEAGUE (絞り込み)</p>
                            <div id="manualLeagueList" class="flex flex-wrap gap-2 mb-2"></div>
                        </div>
                        <div>
                            <p class="text-muted mb-1 text-slate-400 text-[10px]">TARGET TEAM</p>
                            <select id="manualTeamSelect" class="w-full bg-slate-50 border-2 border-slate-100 rounded-xl p-3 text-xs outline-none focus:border-emerald-400"></select>
                        </div>
                        <div id="imageDropZone" class="drop-zone p-6 text-center" onclick="document.getElementById('manualImageInput').click()" ondragover="window.handleDragOver(event)" ondragleave="window.handleDragLeave(event)" ondrop="window.handleDrop(event)">
                            <input type="file" id="manualImageInput" class="hidden" multiple onchange="window.handleImageFile(event)">
                            <p class="text-[9px] uppercase tracking-widest text-slate-400">Drop Screens / Paste</p>
                            <div id="thumbContainer" class="thumb-grid"></div>
                        </div>

                        <!-- Progress Bar for Manual Analysis -->
                        <div id="adminManualProgressArea" class="hidden mb-6 bg-emerald-50 p-5 rounded-2xl border border-emerald-200 shadow-inner">
                            <div class="flex justify-between items-center mb-2">
                                <div class="flex items-center gap-3">
                                    <div class="card-spinner text-emerald-600"></div>
                                    <span id="adminManualProgressText" class="text-xs text-emerald-800 tracking-wider">準備中...</span>
                                </div>
                                <span id="adminManualProgressPercent" class="text-sm text-emerald-600">0%</span>
                            </div>
                            <div class="card-progress-container">
                                <div id="adminManualProgressBar" class="card-progress-bar bg-gradient-to-r from-emerald-600 to-emerald-400" style="width: 0%"></div>
                            </div>
                        </div>

                        <button onclick="window.startManualAnalysis()" id="manualAnalyzeBtn" class="w-full bg-emerald-600 text-white py-5 rounded-3xl shadow-xl text-sm uppercase active:scale-95 transition-all">🚀 解析を開始</button>
                    </div>
                    <!-- Auto Mode -->
                    <div id="admin-panel-auto" class="space-y-6">
                        <h3 class="text-xl text-indigo-800 mb-2 uppercase">AI 一括自動解析</h3>
                        <div class="bg-indigo-50 p-4 rounded-2xl border border-indigo-100 space-y-4">
                            <div>
                                <p class="text-muted text-indigo-400 mb-2 text-[10px]">FILTER LEAGUE (絞り込み)</p>
                                <div id="autoFilterLeagueList" class="flex flex-wrap gap-2"></div>
                            </div>
                            <div>
                                <p class="text-muted text-indigo-400 mb-2 text-[10px]">個別に追加</p>
                                <div class="flex gap-2">
                                    <select id="autoTeamSelect" class="flex-1 bg-white border border-indigo-200 rounded-xl p-2 text-[10px] outline-none"></select>
                                    <button onclick="window.addAutoQueueSingle()" class="bg-indigo-600 text-white px-3 py-2 rounded-xl text-[10px]">＋ 追加</button>
                                </div>
                            </div>
                            <button onclick="window.addAutoQueueFiltered()" class="w-full bg-indigo-500 text-white py-3 rounded-xl text-[10px] uppercase tracking-widest active:scale-95 transition-all shadow-lg shadow-indigo-200">⚡ 絞り込み中のチームを一括追加 (FILTERED)</button>
                            <button onclick="window.addAutoQueueAll()" class="w-full bg-slate-800 text-white py-3 rounded-xl text-[10px] uppercase tracking-widest active:scale-95 transition-all">📚 全登録チームを追加 (ALL DATA)</button>
                        </div>
                        
                        <!-- Progress Bar for Auto Analysis -->
                        <div id="adminAutoProgressArea" class="hidden mt-4 mb-2 bg-indigo-50 p-5 rounded-2xl border border-indigo-200 shadow-inner">
                            <div class="flex justify-between items-center mb-2">
                                <div class="flex items-center gap-3">
                                    <div class="card-spinner text-indigo-600"></div>
                                    <span id="adminAutoProgressText" class="text-xs text-indigo-800 tracking-wider">準備中...</span>
                                </div>
                                <span id="adminAutoProgressPercent" class="text-sm text-indigo-600">0%</span>
                            </div>
                            <div class="card-progress-container">
                                <div id="adminAutoProgressBar" class="card-progress-bar bg-gradient-to-r from-indigo-600 to-indigo-400" style="width: 0%"></div>
                            </div>
                        </div>

                        <div class="space-y-3">
                            <div class="flex gap-3">
                                <button onclick="window.startBatchProcessing()" id="autoBatchStartBtn" class="flex-[2] bg-indigo-600 text-white py-4 rounded-2xl shadow-xl text-sm uppercase active:scale-95 transition-all"><span id="batchConcurrencyLabel" class="parallel-badge">×1直列</span>🚀 解析を開始</button>
                                <button onclick="window.stopBatchProcessing()" id="autoBatchStopBtn" class="hidden flex-1 bg-red-500 text-white py-4 rounded-2xl shadow-xl text-[11px] uppercase active:scale-95 transition-all">⛔ 中断</button>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="window.retryErrors()" id="retryErrorsBtn" class="flex-1 bg-orange-500 text-white py-3 rounded-xl text-[9px] uppercase shadow-md active:scale-95 transition-all">⚠️ エラー再試行</button>
                                <button onclick="window.clearAutoQueue()" id="clearQueueBtn" class="flex-1 bg-white border-2 border-slate-200 text-slate-400 py-3 rounded-xl text-[9px] uppercase hover:text-red-500 transition">🗑️ 全クリア</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- API Key Widget Container (Admin) -->
                <div id="apiKeyContainerAdmin" class="bg-slate-50 p-6 rounded-[2rem] border-2 border-slate-200 relative overflow-hidden"></div>
            </div>
            <!-- Results Area -->
            <div class="lg:col-span-8 bg-white rounded-[2rem] border-2 border-slate-100 p-10 min-h-[600px] flex flex-col">
                <div id="resultHeaderArea" class="flex justify-between items-center mb-6 fade-in">
                    <div>
                        <h4 class="text-2xl uppercase">解析キュー & 結果</h4>
                        <div class="flex items-center gap-3 mt-2">
                            <p id="queueProgressText" class="text-[10px] text-slate-500 uppercase tracking-widest bg-slate-100 px-3 py-1 rounded-full border border-slate-200">WAITING...</p>
                            <div id="totalParsedBadge" class="hidden bg-emerald-100 text-emerald-800 border-2 border-emerald-200 px-4 py-1 rounded-xl items-center gap-2 shadow-sm">
                                <span class="text-[10px] uppercase tracking-widest">総合検出</span>
                                <span id="totalParsedCount" class="text-2xl">0</span>
                                <span class="text-[10px] uppercase tracking-widest">人</span>
                            </div>
                        </div>
                    </div>
                    <button id="batchApplyBtn" onclick="window.smartStartSaveProcess()" class="bg-slate-300 text-slate-500 px-10 py-4 rounded-2xl shadow-xl uppercase transition cursor-not-allowed" disabled title="AIで解析後にアクティブになります">📋 DB に反映（解析後にアクティブ）</button>
                <button onclick="window.openBulkImportModal()" class="px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-2xl shadow-xl uppercase hover:from-indigo-700 hover:to-purple-700 transition flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>
                    📥 選手データ一括インポート
                </button>
                </div>
                
                <!-- Progress Bar Container -->
                <div id="globalProgressBarContainer" class="hidden w-full mb-4">
                    <div class="flex justify-between text-[10px] text-slate-400 mb-1 uppercase tracking-widest">
                        <span>Progress</span>
                        <span id="globalProgressText">0%</span>
                    </div>
                    <div class="progress-bar-container">
                        <div id="globalProgressBar" class="progress-bar-fill" style="width: 0%"></div>
                    </div>
                </div>

                <div id="queueCardContainer" class="flex-1 overflow-y-auto custom-scrollbar space-y-3">
                <!-- Phase 4.11.55: ステップ進捗ログエリア -->
                <div id="stepProgressLog" class="hidden mt-4 bg-slate-50 rounded-xl border-2 border-slate-200 p-4 max-h-64 overflow-y-auto" style="font-family: 'Courier New', monospace; font-size: 11px;">
                    <div class="flex justify-between items-center mb-2">
                        <h4 class="text-xs font-bold text-slate-600 uppercase tracking-wider">📋 解析ステップログ</h4>
                        <button onclick="document.getElementById('stepProgressLog').classList.add('hidden')" class="text-xs text-slate-400 hover:text-red-500">✕ 閉じる</button>
                    </div>
                    <div id="stepLogContent" class="space-y-1 text-slate-700"></div>
                </div>
                    <div id="emptyQueueMsg" class="h-full flex flex-col items-center justify-center opacity-20">
                        <div class="text-7xl mb-4">📋</div>
                        <p>ADD TEAMS TO QUEUE</p>
                    </div>
                </div>

                <!-- ✅ Step Progress Log Window (Phase 4.11.55) -->
                <!-- stepLogArea removed (Phase 4.11.55) --><div id="stepLogContent" class="text-sm font-mono text-gray-700 space-y-2 overflow-y-auto bg-gray-50 p-4 rounded-lg" 
                       style="max-height: 500px; line-height: 1.8;">
                    <div class="text-gray-400 italic text-center py-4">ログはここに表示されます...</div>
                  </div>
                </div>
                <!-- End Step Log Window -->
                <div id="adminQueueList" class="hidden flex-1 overflow-y-auto custom-scrollbar pr-2"></div>
            </div>
        </div>
    </section>

    <!-- Content: Card Management -->
    <section id="content-card" class="hidden fade-in">
        <div class="max-w-4xl mx-auto">
            <div class="flex gap-4 mb-6 border-b border-slate-200 pb-2">
                <button onclick="window.switchCardMode('auto')" id="card-mode-auto" class="admin-tab-btn active text-lg uppercase pb-2 transition-all">自動割り振り (記事URL)</button>
                <button onclick="window.switchCardMode('manual')" id="card-mode-manual" class="admin-tab-btn text-lg uppercase pb-2 transition-all text-blue-600">手動割り振り (画像UP)</button>
            </div>

            <!-- 手動割り振りパネル -->
            <div id="card-panel-manual" class="bg-white p-8 rounded-[2rem] shadow-sm border-4 border-blue-100 mb-8 hidden">
                <h3 class="text-2xl text-blue-900 mb-2 uppercase">🃏 手動割り振り（画像解析）</h3>
                <p class="text-xs text-slate-500 mb-8 leading-relaxed">
                    過去のTOTWなどの特殊カード画像（Team of the Week等）をアップロードしてください。<br>
                    AIが画像から「イベント名」と「対象選手のPSID」を読み取り、データベースの選手に自動でラベルを付与します。
                </p>
                
                <div id="cardImageDropZone" class="drop-zone p-8 text-center mb-6 border-blue-200 bg-blue-50" onclick="document.getElementById('cardImageInput').click()" ondragover="window.handleCardDragOver(event)" ondragleave="window.handleCardDragLeave(event)" ondrop="window.handleCardDrop(event)">
                    <input type="file" id="cardImageInput" class="hidden" multiple accept="image/*" onchange="window.handleCardImageFile(event)">
                    <div class="text-4xl mb-4">🖼️</div>
                    <p class="text-xs uppercase tracking-widest text-blue-400">Drop Card Images Here / Or Paste</p>
                    <div id="cardThumbContainer" class="thumb-grid justify-center mt-6"></div>
                </div>
                
                <div id="cardManualProgressArea" class="hidden mb-6 bg-blue-50 p-5 rounded-2xl border border-blue-200 shadow-inner">
                    <div class="flex justify-between items-center mb-2">
                        <div class="flex items-center gap-3">
                            <div class="card-spinner text-blue-600"></div>
                            <span id="cardManualProgressText" class="text-xs text-blue-800 tracking-wider">準備中...</span>
                        </div>
                        <span id="cardManualProgressPercent" class="text-sm text-blue-600">0%</span>
                    </div>
                    <div class="card-progress-container">
                        <div id="cardManualProgressBar" class="card-progress-bar bg-gradient-to-r from-blue-600 to-blue-400" style="width: 0%"></div>
                    </div>
                </div>

                <button onclick="window.startCardAnalysis()" id="cardAnalyzeBtn" class="w-full bg-blue-600 text-white py-5 rounded-3xl shadow-xl text-sm uppercase active:scale-95 transition-all">🚀 画像解析を実行する</button>
            </div>

            <!-- 自動割り振りパネル -->
            <div id="card-panel-auto" class="bg-white p-8 rounded-[2rem] shadow-sm border-4 border-indigo-100 mb-8">
                <h3 class="text-2xl font-bold text-indigo-700 mb-2 uppercase bg-indigo-50 px-4 py-2 rounded-xl border-l-4 border-indigo-500">🤖 記事URLからの自動割り振り</h3>
                <p class="text-xs text-slate-500 mb-8 leading-relaxed">
                    公式サイトの記事ID（News No.）を指定して、AIに記事のテキストを自動フェッチ・解析させます。<br>
                    記事内の「選手名(所属チーム)」リストから、該当する選手に自動でイベントラベル（例: CNST01）を付与します。
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div class="bg-indigo-50 p-6 rounded-2xl border border-indigo-100">
                        <p class="text-muted text-indigo-400 mb-2 text-[10px]">1. 記事単体指定</p>
                        <div class="flex gap-2">
                            <input type="number" id="cardSingleId" placeholder="記事ID (例: 1032)" class="input-box flex-1 py-3 text-sm">
                            <button onclick="window.addCardQueueSingle()" class="bg-indigo-600 text-white px-6 py-3 rounded-xl text-xs active:scale-95 transition-all">追加</button>
                        </div>
                    </div>
                    <div class="bg-indigo-50 p-6 rounded-2xl border border-indigo-100">
                        <p class="text-muted text-indigo-400 mb-2 text-[10px]">2. 記事範囲指定</p>
                        <div class="flex gap-2 items-center">
                            <input type="number" id="cardRangeStart" placeholder="開始ID" class="input-box flex-1 py-3 text-sm">
                            <span class="text-indigo-400">～</span>
                            <input type="number" id="cardRangeEnd" placeholder="終了ID" class="input-box flex-1 py-3 text-sm">
                            <button onclick="window.addCardQueueRange()" class="bg-indigo-600 text-white px-4 py-3 rounded-xl text-xs active:scale-95 transition-all">一括追加</button>
                        </div>
                    </div>
                </div>

                <!-- キュー表示エリア -->
                <div class="mb-6">
                    <div class="flex justify-between items-end mb-2 px-2">
                        <p class="text-[10px] text-slate-400 uppercase tracking-widest">解析キュー</p>
                        <div class="bg-emerald-600 text-white px-4 py-1.5 rounded-full text-[10px] flex gap-2 items-center shadow-sm font-bold">
                            総合検出: <span id="cardTotalParsedCount" class="text-lg font-black">0</span> 人
                        </div>
                    </div>
                    <div id="cardQueueContainer" class="bg-slate-50 border border-slate-200 rounded-2xl p-4 min-h-[150px] max-h-[300px] overflow-y-auto space-y-2 custom-scrollbar">
                        <div class="text-center p-4 text-slate-400 text-xs">キューが空です。記事IDを追加してください。</div>
                    </div>
                </div>

                <div id="cardAutoProgressArea" class="hidden mb-6 bg-indigo-50 p-5 rounded-2xl border border-indigo-200 shadow-inner">
                    <div class="flex justify-between items-center mb-2">
                        <div class="flex items-center gap-3">
                            <div class="card-spinner text-indigo-600"></div>
                            <span id="cardAutoProgressText" class="text-xs text-indigo-800 tracking-wider">準備中...</span>
                        </div>
                        <span id="cardAutoProgressPercent" class="text-sm text-indigo-600">0%</span>
                    </div>
                    <div class="card-progress-container">
                        <div id="cardAutoProgressBar" class="card-progress-bar bg-gradient-to-r from-indigo-600 to-indigo-400" style="width: 0%"></div>
                    </div>
                </div>

                <div class="flex gap-4">
                    <button onclick="window.startCardBatchProcessing()" id="cardBatchStartBtn" class="flex-[2] bg-indigo-600 text-white py-4 rounded-2xl shadow-xl text-sm uppercase active:scale-95 transition-all">🚀 自動解析を開始</button>
                    <button onclick="window.clearCardQueue()" class="flex-1 bg-white border-2 border-slate-200 text-slate-400 py-4 rounded-2xl text-[11px] uppercase hover:text-red-500 transition-all active:scale-95">🗑️ クリア</button>
                </div>
                
                <button id="cardBatchApplyBtn" onclick="window.startCardBatchMergeProcess()" disabled class="w-full mt-4 bg-emerald-600 text-white py-5 rounded-2xl shadow-xl text-sm uppercase disabled:opacity-50 hover:bg-emerald-700 transition-all active:scale-95">✅ データベースへ一括反映 (紐付け確認へ)</button>
                    <!-- v52.170: エラーを一括再解析ボタン -->
                    <button id="cardBatchRetryBtn" 
                        onclick="window.retryAllErrors()" 
                        class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded shadow-md transition-all hover:shadow-lg font-bold disabled:opacity-50 disabled:cursor-not-allowed text-sm"
                        disabled>
                        🔄 エラーを一括再解析
                    </button>
            </div>
            
            <!-- API Key Widget Container (Card) -->
            <div id="apiKeyContainerCard" class="bg-slate-50 p-6 rounded-[2rem] border-2 border-slate-200 relative overflow-hidden"></div>
        </div>
    </section>

    <!-- Content: DB Management -->
    <section id="content-db" class="hidden fade-in">
        <div class="max-w-5xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                <div class="bg-white p-10 rounded-[2.5rem] shadow-sm border-2 border-slate-200 hover:border-slate-300 transition-colors flex flex-col justify-between">
                    <div>
                        <h3 class="text-2xl text-slate-800 mb-4 uppercase">📤 エクスポート</h3>
                        <p class="text-xs text-slate-500 mb-4 leading-loose">
                            現在のデータベースをエクスポートします。目的に応じて形式を選択してください。
                        </p>
                        
                        <div class="bg-slate-50 p-5 rounded-2xl border border-slate-200 mb-6 space-y-4">
                            <label class="flex items-start gap-3 cursor-pointer">
                                <input type="radio" name="exportFormat" value="json" checked class="w-5 h-5 text-emerald-600 focus:ring-emerald-500 mt-0.5">
                                <div>
                                    <span class="text-sm text-slate-800 block mb-1">JSON <span class="text-[10px] bg-emerald-100 text-emerald-800 px-2 py-0.5 rounded ml-2">完全バックアップ</span></span>
                                    <p class="text-[10px] text-slate-500 leading-relaxed">システムの復元用。すべての選手、チーム、ラベルの設定や履歴構造がそのまま含まれます。</p>
                                </div>
                            </label>
                            <label class="flex items-start gap-3 cursor-pointer">
                                <input type="radio" name="exportFormat" value="csv" class="w-5 h-5 text-emerald-600 focus:ring-emerald-500 mt-0.5">
                                <div>
                                    <span class="text-sm text-slate-800 block mb-1">CSV <span class="text-[10px] bg-blue-100 text-blue-800 px-2 py-0.5 rounded ml-2">スプレッドシート</span></span>
                                    <p class="text-[10px] text-slate-500 leading-relaxed">データ分析用。最新の全選手データをExcel等で開ける表形式で出力します。※復元には使えません。</p>
                                </div>
                            </label>
                        </div>
                    </div>
                    <button onclick="window.exportDatabase()" class="w-full bg-slate-900 text-white py-5 rounded-3xl shadow-xl text-sm uppercase hover:bg-slate-700 transition-all active:scale-95 flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                        全データをダウンロード
                    </button>
                </div>
                
                <div class="bg-rose-50 p-10 rounded-[2.5rem] shadow-sm border-2 border-rose-100 hover:border-rose-200 transition-colors flex flex-col justify-between">
                    <div>
                        <h3 class="text-2xl text-rose-800 mb-4 uppercase">📥 インポート (復元)</h3>
                        <p class="text-xs text-rose-600/80 mb-6 leading-loose">
                            保存しておいた<strong class="text-rose-800 border-b border-rose-400 pb-0.5">JSONファイル</strong>からデータを完全に復元します。<br>
                            <span class="text-[10px] text-rose-500">※CSVでのインポートはデータの整合性が保てないため非対応です。</span>
                        </p>
                        <div class="bg-red-100 border border-red-200 p-4 rounded-xl mb-6">
                            <p class="text-red-600 text-[10px] flex items-center gap-2">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>
                                警告: 現在のシステム上のデータはすべて消去され、上書きされます。
                            </p>
                        </div>
                    </div>
                    <input type="file" id="importDbInput" class="hidden" accept=".json" onchange="window.importDatabase(event)">
                    <button onclick="document.getElementById('importDbInput').click()" class="w-full bg-rose-600 text-white py-5 rounded-3xl shadow-xl text-sm uppercase hover:bg-rose-700 transition-all active:scale-95 flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 01-2 2z"></path></svg>
                        ファイルを選択して復元
                    </button>
                </div>
            </div>
            
            <!-- API Key Widget Container (DB) -->
            <div id="apiKeyContainerDb" class="bg-slate-50 p-6 rounded-[2rem] border-2 border-slate-200 relative overflow-hidden"></div>
        <div class="mt-3 border-t border-slate-200 pt-3">
            <div class="flex items-center justify-between mb-2">
                <span class="text-sm font-semibold text-slate-700">🔑 APIキープール</span>
                <span id="apiKeyCountBadge" class="parallel-badge">0キー有効</span>
            </div>
            <div id="apiKeyPoolContainer" class="space-y-2 mb-3"></div>
            <div class="flex gap-2">
                <input id="newApiKeyInput" type="password" placeholder="新しいAPIキーを入力..." 
                       class="flex-1 text-sm px-3 py-1.5 border border-slate-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-400">
                <input id="newApiKeyLabel" type="text" placeholder="ラベル(任意)" 
                       class="w-24 text-sm px-2 py-1.5 border border-slate-300 rounded-md">
                <button onclick="window.addApiKeyToPool()" 
                        class="text-sm bg-indigo-600 text-white px-3 py-1.5 rounded-md hover:bg-indigo-700 font-semibold">追加</button>
            </div>
        </div>

            <!-- v52.174: DB バージョン履歴 -->
            <div class="bg-white p-8 rounded-[2rem] shadow-sm border-2 border-indigo-100 mt-8">
                <div class="flex items-center justify-between mb-6">
                    <div>
                        <h3 class="text-2xl text-indigo-800 mb-1 uppercase">🕒 DBバージョン履歴</h3>
                        <p class="text-xs text-slate-500">インポートや保存のたびに自動記録。過去のバージョンの確認・復元・削除が可能です。</p>
                    </div>
                    <div class="flex gap-3">
                        <button onclick="window.returnToLatest()" class="px-4 py-2 bg-emerald-500 text-white rounded-xl text-xs hover:bg-emerald-600 transition">🔄 最新に戻る</button>
                        <button onclick="window.renderDbSnapshotList()" class="px-4 py-2 bg-slate-200 text-slate-700 rounded-xl text-xs hover:bg-slate-300 transition">↺ 更新</button>
                    </div>
                </div>
                <!-- 現在表示バージョンバナー -->
                <div id="activeSnapshotBanner" class="hidden bg-amber-50 border-2 border-amber-300 rounded-xl p-3 mb-4 flex items-center gap-3">
                    <span class="text-amber-700 text-xs font-bold">📅 現在表示中:</span>
                    <span id="activeSnapshotLabel" class="text-amber-900 text-xs"></span>
                    <button onclick="window.returnToLatest()" class="ml-auto px-3 py-1 bg-amber-500 text-white rounded-lg text-[10px] hover:bg-amber-600 transition">最新に戻る</button>
                </div>
                <div id="dbSnapshotList" class="space-y-2 max-h-[500px] overflow-y-auto custom-scrollbar">
                    <div class="text-center p-6 text-slate-400 text-xs">読み込み中...</div>
                </div>
                <p class="text-[10px] text-slate-400 mt-4 leading-relaxed">
                    💡 ヒント: 「この時点を表示」は一時的に過去データを閲覧するモードです。「復元」は実際にDBを上書きします。<br>
                    CSV出力時は現在表示しているバージョンのデータが使用されます。
                </p>
            </div>
        </div>
    </section>

    <!-- (Modals included) -->
    <!-- (Footer included) -->
    <footer class="mt-16 mb-8 text-center fade-in">
        <a href="https://es-league.games/japan/" target="_blank" rel="noopener noreferrer" class="inline-block transition-transform hover:scale-105 active:scale-95">
            <img src="https://es-league.games/es_new/img/logo.png" alt="eS League Official" class="h-16 mx-auto opacity-70 hover:opacity-100 transition-opacity duration-300 drop-shadow-md" onerror="this.src='https://placehold.co/200x64?text=eS+League';">
            <p class="text-[9px] text-slate-400 mt-3 tracking-[0.2em] uppercase">Visit Official Website</p>
        </a>
    </footer>
</div>

<!-- All Modals from v50.54 included (omitted for brevity in display, but preserved in output) -->
<div id="customConfirmModal" class="fixed inset-0 modal-overlay hidden items-center justify-center z-[1000] p-6">
    <div class="bg-white rounded-[2rem] w-full max-w-md overflow-hidden shadow-2xl animate-in zoom-in-95">
        <div class="p-6 bg-slate-900 text-white flex items-center gap-3">
            <svg class="w-6 h-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
            <h3 class="text-lg font-bold uppercase tracking-widest">確認</h3>
        </div>
        <div class="p-6">
            <p id="customConfirmMessage" class="text-sm text-slate-700 leading-relaxed font-bold whitespace-pre-wrap"></p>
        </div>
        <div class="p-4 bg-slate-50 flex justify-end gap-3 border-t border-slate-200">
            <button id="customConfirmCancelBtn" class="px-6 py-3 rounded-xl text-xs font-bold bg-white border-2 border-slate-200 text-slate-600 hover:bg-slate-100 hover:border-slate-300 transition-all active:scale-95">キャンセル</button>
            <button id="customConfirmOkBtn" class="px-6 py-3 rounded-xl text-xs font-bold bg-red-600 text-white shadow-md hover:bg-red-700 transition-all active:scale-95">実行する</button>
        </div>
    </div>
</div>

<div id="apiKeyHelpModal" class="fixed inset-0 modal-overlay hidden items-center justify-center z-[400] p-6">
    <div class="bg-white rounded-[2.5rem] w-full max-w-2xl overflow-hidden shadow-2xl animate-in zoom-in-95">
        <div class="p-8 bg-indigo-600 text-white flex justify-between items-center">
            <div><h2 class="text-2xl uppercase">APIキー（まほうの鍵）の取り方</h2><p class="text-[10px] opacity-70 mt-1">はじめてのひとも、これでだいじょうぶ！</p></div>
            <button onclick="window.closeHelpModal()" class="text-white/50 hover:text-white text-3xl">&times;</button>
        </div>
        <div class="p-8 overflow-y-auto custom-scrollbar max-h-[60vh] space-y-8">
            <!-- (Content unchanged) -->
            <div class="flex gap-6 items-start"><div class="w-12 h-12 rounded-full bg-indigo-50 text-indigo-600 flex items-center justify-center text-xl shrink-0">1</div><div><h4 class="text-lg text-slate-800 mb-2">AIのサイトに行こう！</h4><p class="text-xs text-slate-500 leading-relaxed mb-3">「Google AI Studio（グーグル・エーアイ・スタジオ）」というサイトにいきます。</p><a href="https://aistudio.google.com/app/apikey" target="_blank" class="inline-block bg-slate-900 text-white px-6 py-3 rounded-xl text-xs uppercase hover:bg-slate-700 shadow-lg">🔗 サイトをひらく (別の画面がでます)</a></div></div>
            <div class="flex gap-6 items-start"><div class="w-12 h-12 rounded-full bg-indigo-50 text-indigo-600 flex items-center justify-center text-xl shrink-0">2</div><div><h4 class="text-lg text-slate-800 mb-2">「まほうの鍵」を作ろう！</h4><p class="text-xs text-slate-500 leading-relaxed">画面の左上にある <strong>[Create API key（クリエイト・エーアイ・ピー・キー）]</strong> という青いボタンを押します。</p></div></div>
            <div class="flex gap-6 items-start"><div class="w-12 h-12 rounded-full bg-indigo-50 text-indigo-600 flex items-center justify-center text-xl shrink-0">3</div><div><h4 class="text-lg text-slate-800 mb-2">鍵をコピーして貼り付けよう！</h4><p class="text-xs text-slate-500 leading-relaxed">ボタンを押すと、長〜いパスワード（アルファベットと数字のまざったもの）が出てきます。これをコピーして、さっきの画面の「GEMINI API KEY」の四角い枠の中に貼り付けてね！</p></div></div>
        </div>
        <div class="p-6 border-t border-slate-100 bg-slate-50 flex justify-end"><button onclick="window.closeHelpModal()" class="bg-indigo-600 text-white px-8 py-3 rounded-xl text-xs shadow-lg">とじる</button></div>
    </div>
</div>

<div id="teamManagerModal" class="fixed inset-0 modal-overlay hidden items-center justify-center z-[300] p-6">
    <div class="bg-white rounded-[2.5rem] w-full max-w-5xl overflow-hidden shadow-2xl animate-in zoom-in-95 flex flex-col max-h-[90vh]">
        <div class="p-8 bg-slate-900 text-white flex justify-between items-center shrink-0">
            <h2 class="text-2xl uppercase">⚙️ チーム＆リーグ管理コンソール</h2>
            <button onclick="window.closeTeamManager()" class="text-white/50 hover:text-white text-3xl">&times;</button>
        </div>
        <div class="bg-slate-900 px-8 flex gap-6 border-t border-slate-700 shrink-0">
            <button onclick="window.switchManagerTab('teams')" id="mgr-tab-teams" class="py-4 text-emerald-400 border-b-2 border-emerald-400 font-bold tracking-widest uppercase text-sm transition-all">チーム管理</button>
            <button onclick="window.switchManagerTab('leagues')" id="mgr-tab-leagues" class="py-4 text-slate-400 border-b-2 border-transparent hover:text-slate-200 tracking-widest uppercase text-sm transition-all">リーグ(カテゴリ)管理</button>
        </div>
        <div class="p-8 flex-1 overflow-y-auto custom-scrollbar bg-slate-50 relative">
            <div id="mgr-sec-teams" class="flex flex-col lg:flex-row gap-8 h-full fade-in">
                <!-- (Teams manager content) -->
                <div class="lg:w-1/3 bg-white p-6 rounded-2xl border border-slate-200 h-fit shadow-sm">
<h4 class="text-indigo-800 font-bold mb-4 border-b pb-2">🆕 新規チーム追加</h4>
<div class="space-y-4">
  <div>
    <label class="text-[10px] text-slate-400 uppercase">チーム名 <span class="text-red-400">*</span></label>
    <input type="text" id="newTeamName" class="input-box py-2" placeholder="例: FC Tokyo">
  </div>
  <div>
    <label class="text-[10px] text-slate-400 uppercase">チームID (固有数字) <span class="text-red-400">*</span></label>
    <input type="text" id="newTeamId" class="input-box py-2" placeholder="例: 999">
  </div>
  <div>
    <label class="text-[10px] text-slate-400 uppercase block mb-1">メインカテゴリ (L1) <span class="text-red-400">*</span></label>
    <div class="flex gap-2 items-center">
      <select id="newTeamL1" class="input-box py-2 flex-1"></select>
      <button onclick="window.toggleQuickLeagueForm()" title="新規リーグをその場で追加"
        class="shrink-0 bg-indigo-50 border border-indigo-200 text-indigo-600 px-3 py-2 rounded-lg text-xs font-bold hover:bg-indigo-100 transition">＋</button>
    </div>
    <!-- Quick inline league add form -->
    <div id="quickLeagueForm" class="hidden mt-3 p-3 bg-indigo-50 border border-indigo-200 rounded-xl space-y-2">
      <p class="text-[9px] font-bold text-indigo-700 uppercase">新規リーグをその場で追加</p>
      <div class="flex gap-1">
        <input type="text" id="quickLeagueId" class="input-box py-1.5 text-xs font-mono w-20" placeholder="ID例:0500">
        <input type="text" id="quickLeagueYear" class="input-box py-1.5 text-xs league-year-input w-14 text-center" placeholder="年度" maxlength="6">
        <input type="text" id="quickLeagueSeason" class="input-box py-1.5 text-xs font-bold w-16 text-center" placeholder="17th">
      </div>
      <div class="flex gap-1">
        <input type="text" id="quickLeagueCategory" class="input-box py-1.5 text-xs flex-1" placeholder="eS-League" list="leagueCategoryList">
        <select id="quickLeagueDiv" class="input-box py-1.5 text-xs w-20">
          <option value="">DIV</option>
          <option value="01部">01部</option>
          <option value="02部">02部</option>
          <option value="03部">03部</option>
          <option value="04部">04部</option>
          <option value="05部">05部</option>
          <option value="OP">OP</option>
        </select>
        <input type="text" id="quickLeagueDivCustom" class="input-box py-1.5 text-xs w-20" placeholder="カスタム">
      </div>
      <button onclick="window.saveQuickLeague()"
        class="w-full bg-indigo-600 text-white py-2 rounded-lg text-xs font-bold">✓ リーグを追加してL1に設定</button>
    </div>
    <div id="newTeamL1Warning" class="text-amber-600 text-[10px] mt-1 hidden">⚠ メインカテゴリを設定してください</div>
  </div>
  <div>
    <label class="text-[10px] text-slate-400 uppercase mb-1 block">サブカテゴリ (L2)</label>
    <div class="l2-check-container custom-scrollbar" id="newTeamL2Checkboxes"></div>
  </div>
  <button onclick="window.saveNewTeam()" class="w-full bg-emerald-600 text-white py-3 rounded-xl text-xs uppercase shadow-md active:scale-95 transition-all">＋ 追加する</button>
</div>
</div>
                <div class="lg:w-2/3 bg-white p-6 rounded-2xl border border-slate-200 shadow-sm flex flex-col h-full min-h-[500px]"><h4 class="text-slate-800 font-bold mb-4 border-b pb-2 flex justify-between items-center"><div class="flex items-center gap-2"><input type="checkbox" onchange="window.toggleAllTeams(this.checked)" class="w-4 h-4 cursor-pointer text-indigo-600"><span>📋 登録済みチーム一覧</span></div><span class="text-[10px] text-slate-400">※IDは紐付けのため変更不可</span></h4><div class="mb-4 p-4 bg-indigo-50 rounded-xl border border-indigo-100 shadow-sm text-slate-800 shrink-0"><h5 class="text-[11px] text-indigo-800 font-bold mb-3 flex items-center gap-2"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> 選択したチームに一括設定</h5><div class="flex flex-wrap gap-4 items-end"><div class="flex-1 min-w-[140px]"><label class="text-[9px] text-slate-500 block mb-1">メイン(L1)変更</label><select id="batchL1" class="w-full bg-white border border-slate-200 rounded p-2 text-xs outline-none cursor-pointer"></select></div><div class="flex-1 min-w-[140px]"><label class="text-[9px] text-slate-500 block mb-1">サブ(L2)追加</label><select id="batchL2Add" class="w-full bg-white border border-slate-200 rounded p-2 text-xs outline-none cursor-pointer"></select></div><div class="flex-1 min-w-[140px]"><label class="text-[9px] text-slate-500 block mb-1">サブ(L2)削除</label><select id="batchL2Remove" class="w-full bg-white border border-slate-200 rounded p-2 text-xs outline-none cursor-pointer"></select></div><button onclick="window.applyBatchTeamUpdate()" class="bg-indigo-600 text-white px-6 py-2 rounded-lg text-[11px] font-bold hover:bg-indigo-700 active:scale-95 transition-transform shadow-md">一括適用</button></div></div><div id="teamManagerList" class="space-y-3 flex-1 overflow-y-auto custom-scrollbar pr-2"></div></div>
            </div>
            <div id="mgr-sec-leagues" class="hidden flex flex-col lg:flex-row gap-8 h-full fade-in">
                <!-- (Leagues manager content) -->
                <div class="lg:w-1/3 bg-white p-6 rounded-2xl border border-slate-200 h-fit shadow-sm">
<h4 class="text-indigo-800 font-bold mb-4 border-b pb-2">🆕 新規リーグ追加</h4>
<div class="space-y-3">
  <div>
    <label class="text-[10px] text-slate-400 uppercase block mb-1">リーグID <span class="text-red-400">*</span></label>
    <input type="text" id="newLeagueId" class="input-box py-2 font-mono" placeholder="例: 0500" oninput="window.updateLeaguePreview()">
  </div>
  <div class="league-form-grid">
    <div>
      <label class="text-[9px] text-indigo-500 font-bold uppercase block mb-1">年度 <span class="text-red-400">*</span></label>
      <input type="text" id="newLeagueYear" class="input-box py-2 text-center league-year-input" placeholder="26" maxlength="6" oninput="window.updateLeaguePreview()">
    </div>
    <div>
      <label class="text-[9px] text-slate-400 uppercase block mb-1">シーズン <span class="text-red-400">*</span></label>
      <input type="text" id="newLeagueSeason" class="input-box py-2 text-center font-bold" placeholder="17th" oninput="window.updateLeaguePreview()">
    </div>
    <div>
      <label class="text-[9px] text-slate-400 uppercase block mb-1">リーグカテゴリ <span class="text-red-400">*</span></label>
      <input type="text" id="newLeagueCategory" class="input-box py-2" placeholder="eS-League" list="leagueCategoryList" oninput="window.updateLeaguePreview()">
      <datalist id="leagueCategoryList">
        <option value="eS-League">
        <option value="GrowthLeague">
        <option value="Judith CUP">
      </datalist>
    </div>
    <div>
      <label class="text-[9px] text-slate-400 uppercase block mb-1">DIV <span class="text-red-400">*</span></label>
      <select id="newLeagueDiv" class="input-box py-2 text-center" onchange="window.updateLeaguePreview()">
        <option value="">選択</option>
        <option value="01部">01部</option>
        <option value="02部">02部</option>
        <option value="03部">03部</option>
        <option value="04部">04部</option>
        <option value="05部">05部</option>
        <option value="OP">OP</option>
      </select>
    </div>
  </div>
  <div>
    <label class="text-[9px] text-slate-400 uppercase block mb-1">DIV カスタム入力 (上記に該当なし)</label>
    <input type="text" id="newLeagueDivCustom" class="input-box py-1.5 text-xs" placeholder="例: 02部B、カップ戦 など" oninput="window.updateLeaguePreview()">
  </div>
  <div>
    <label class="text-[9px] text-slate-500 uppercase block mb-1">プレビュー</label>
    <div class="league-form-preview" id="newLeaguePreview">
      <span class="text-slate-400 text-xs">各項目を入力するとプレビューが表示されます</span>
    </div>
  </div>
  <div id="newLeagueWarning" class="text-amber-600 text-[10px] hidden"></div>
  <button onclick="window.saveNewLeague()" class="w-full bg-emerald-600 text-white py-3 rounded-xl text-xs uppercase shadow-md active:scale-95 transition-all">＋ 追加する</button>
</div>
</div>
                <div class="lg:w-2/3 bg-white p-6 rounded-2xl border border-slate-200 shadow-sm flex flex-col h-full min-h-[400px]"><h4 class="text-slate-800 font-bold mb-4 border-b pb-2 flex justify-between items-center"><span>📋 登録済みリーグ一覧</span></h4><div id="leagueManagerList" class="space-y-3 flex-1 overflow-y-auto custom-scrollbar pr-2"></div></div>
            </div>
        </div>
    </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc, collection } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

const appId = typeof __app_id !== 'undefined' ? __app_id : 'es-league-db-integrated';

// [Phase 4.11.55] defaultTeams moved to global scope
// [Phase 4.11.55] defaultLeagueLabelMap moved to global scope

let teamMaster = defaultTeams.map(t => ({ ...t, l2: t.l2 ? (Array.isArray(t.l2) ? t.l2 : [t.l2]) : [] }));
leagueLabelMap = { ...defaultLeagueLabelMap };

const COLUMN_DEFS = {
    latest: [
        {id:'number',name:'背番号',default:true},{id:'card',name:'カード',default:true},{id:'overall',name:'総合',default:true},
        {id:'name',name:'PSID',default:true},{id:'nickname',name:'ニックネーム',default:true},{id:'labels',name:'ラベル',default:true},{id:'special_cards',name:'特殊カード',default:true},
        {id:'team',name:'チーム',default:true},{id:'apps',name:'出場',default:true},{id:'winRate',name:'勝率',default:true},
        {id:'goals',name:'得点',default:true},{id:'assists',name:'アシスト',default:true},{id:'cleanSheets',name:'完封',default:true},
        {id:'yellow',name:'警告',default:true},{id:'red',name:'退場',default:true},{id:'status',name:'状況',default:true}
    ],
    lifetime: [
        {id:'number',name:'背番号',default:true},{id:'card',name:'カード',default:true},{id:'overall',name:'総合',default:true},
        {id:'name',name:'PSID',default:true},{id:'nickname',name:'ニックネーム',default:true},{id:'labels',name:'ラベル',default:true},{id:'special_cards',name:'特殊カード',default:true},
        {id:'team',name:'チーム',default:true},{id:'apps',name:'生涯出場',default:true},{id:'winRate',name:'生涯勝率',default:true},
        {id:'goals',name:'生涯ゴール',default:true},{id:'assists',name:'生涯アシスト',default:true},{id:'cleanSheets',name:'完封',default:true},
        {id:'yellow',name:'警告',default:true},{id:'red',name:'退場',default:true},{id:'status',name:'状況',default:true}
    ]
};
const FILTER_JERSEY_YES = "背番号あり"; 
const FILTER_JERSEY_NO = "背番号なし";
const FILTER_STATUS_ACTIVE = "在籍"; 
const FILTER_STATUS_LEFT = "退団";
const FILTER_FREE_AGENT = "FA(未所属)";

let playerMaster = [], customLabels = []; 
let user = null, auth, db, currentTab = 'teams', displayType = 'latest', chartMetric = 'assists';
let chartInstance = null, selectedPlayerForChart = null;
let playerSortCol = 'overall', playerSortDir = 'desc', teamSortCol = 'l1', teamSortDir = 'asc';
let playerViewSelectedLeagues = [], playerViewSelectedTeams = [];
let manualSelectedLeagues = [], autoSelectedLeagues = [];
let manualImages = [], manualPendingResults = { latest: [], lifetime: [] };
let columnVisibility = {
    latest: COLUMN_DEFS.latest.reduce((acc, col) => ({ ...acc, [col.id]: col.default }), {}),
    lifetime: COLUMN_DEFS.lifetime.reduce((acc, col) => ({ ...acc, [col.id]: col.default }), {})
};
let currentAdminMode = 'auto';
let dbSnapshots = []; // v52.174: DBバージョン履歴
let activeSnapshotIndex = -1; // -1 = 現在の最新データ

let autoAnalysisQueue = []; let isBatchProcessing = false; let isStopRequested = false;
let batchPendingResults = { latest: [], lifetime: [] };
let targetAutoTeamId = "";
let currentConflicts = [];
let currentAIIndividualText = ""; 
let currentAIQueryText = ""; 
let currentAIQueryController = null;

let cardImages = [];
let currentCardBatchConflicts = [];
let cardAutoQueue = [];
let isCardBatchProcessing = false;
let cardBatchResults = [];
window.cardMergeSelectSortMode = 'az';
let currentAbortController = null; 
// v50.66 Add: Global Time Info
let currentBatchTimeInfo = "";

// v50.65 Add: Time formatter helper
function formatTime(ms) {
    if (ms < 0) ms = 0;
    const totalSec = Math.floor(ms / 1000);
    const min = Math.floor(totalSec / 60);
    const sec = totalSec % 60;
    return `${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
}

function parseGeminiJSON(text) {
    // v52.182 BUG-2 Fix: 堅牢なJSON解析 (不正レスポンス対応)
    if (!text) return null;
    let raw = text.replace(/```json/gi, '').replace(/```/g, '').trim();

    // 試行1: そのままパース
    try { return JSON.parse(raw); } catch(e1) { /* continue */ }

    // 試行2: 先頭の { ... } を抽出してパース
    try {
        const m = raw.match(/\{[\s\S]*\}/);
        if (m) return JSON.parse(m[0]);
    } catch(e2) { /* continue */ }

    // 試行3: 末尾の切れた文字列を修復して再試行
    try {
        let repaired = raw;
        // 未閉じ文字列を閉じる
        repaired = repaired.replace(/([^\\])"([^"\n\r]*$)/m, '$1"$2"');
        // 末尾の不完全なオブジェクト/配列を閉じる
        const opens = (repaired.match(/\{/g)||[]).length - (repaired.match(/\}/g)||[]).length;
        const aopens = (repaired.match(/\[/g)||[]).length - (repaired.match(/\]/g)||[]).length;
        for(let i=0;i<aopens;i++) repaired += ']';
        for(let i=0;i<opens;i++) repaired += '}';
        // 末尾のカンマを除去
        repaired = repaired.replace(/,([\s]*[\}\]])/g, '$1');
        return JSON.parse(repaired);
    } catch(e3) { /* continue */ }

    // 試行4: latest/lifetime 配列だけを抽出して構築
    try {
        const latestMatch = raw.match(/"latest"\s*:\s*(\[[\s\S]*?\])/);
        const lifetimeMatch = raw.match(/"lifetime"\s*:\s*(\[[\s\S]*?\])/);
        const result = {};
        if (latestMatch) {
            try { result.latest = JSON.parse(latestMatch[1]); } catch(e) { result.latest = []; }
        } else { result.latest = []; }
        if (lifetimeMatch) {
            try { result.lifetime = JSON.parse(lifetimeMatch[1]); } catch(e) { result.lifetime = []; }
        } else { result.lifetime = []; }
        if (result.latest.length > 0 || result.lifetime.length > 0) return result;
    } catch(e4) { /* continue */ }

    // すべて失敗 → null を返す (呼び出し元で !res チェック)
    console.error('[parseGeminiJSON] すべての修復試行が失敗しました。生テキスト(先頭500文字):', text.substring(0,500));
    return null;
}

const delay = (ms, signal) => new Promise((resolve, reject) => {
    const timer = setTimeout(resolve, ms);
    if (signal) {
        signal.addEventListener('abort', () => {
            clearTimeout(timer);
            reject(new DOMException('Aborted', 'AbortError'));
        }, { once: true });
    }
});

window.toHalfWidthNumbers = function(str) {
    if (!str) return str;
    return str.replace(/[０-９]/g, function(s) {
        return String.fromCharCode(s.charCodeAt(0) - 0xFEE0);
    });
};

window.customConfirm = function(message) {
    return new Promise((resolve) => {
        const modal = document.getElementById('customConfirmModal');
        const msgEl = document.getElementById('customConfirmMessage');
        const okBtn = document.getElementById('customConfirmOkBtn');
        const cancelBtn = document.getElementById('customConfirmCancelBtn');
        msgEl.innerText = message;
        modal.classList.replace('hidden', 'flex');
        const cleanup = () => {
            modal.classList.replace('flex', 'hidden');
            okBtn.removeEventListener('click', onOk);
            cancelBtn.removeEventListener('click', onCancel);
        };
        const onOk = () => { cleanup(); resolve(true); };
        const onCancel = () => { cleanup(); resolve(false); };
        okBtn.addEventListener('click', onOk);
        cancelBtn.addEventListener('click', onCancel);
    });
};

const getSpecialCardStyle = (label) => {
  if (label.startsWith('TOTW')) return 'bg-yellow-100 text-yellow-800 border-yellow-300';
  if (label.startsWith('CORN')) return 'bg-green-100 text-green-800 border-green-300';
  if (label.startsWith('POTM')) return 'bg-purple-100 text-purple-800 border-purple-300';
  if (label === 'HERO' || label === 'ICON') return 'bg-blue-100 text-blue-800 border-blue-300';
  return 'bg-gray-100 text-gray-800 border-gray-300';
};

const getSpecialCardIcon = (label) => {
    if (label.startsWith('TOTW')) return `<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>`;
    if (label.startsWith('CORN')) return `<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1"><polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline></svg>`;
    if (label.startsWith('POTM')) return `<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path><path d="M4 22h16"></path><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path></svg>`;
    if (label === 'HERO' || label === 'ICON') return `<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>`;
    return `<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1"><path d="M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l5 5a2 2 0 0 0 2.828 0l7.172-7.172a2 2 0 0 0 0-2.828l-5-5z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>`;
}

const isSpecialLabel = (l) => {
    const def = customLabels.find(cl => cl.name === l);
    if (def) return def.type === 'special';
    return /^(TOTW|CORN|POTM|HERO|ICON|CSTN)[0-9]*$/.test(l);
};

window.renderSharedComponents = function() {
    const renderApiKeyWidget = (containerId, inputId) => {
        const container = document.getElementById(containerId);
        if (!container) return;
        const currentVal = window.getApiKey ? window.getApiKey() : "";
        container.innerHTML = `
            <div class="flex items-center justify-between mb-2">
                <p class="text-muted text-slate-500 text-[10px]">GEMINI API KEY</p>
                <button onclick="window.openHelpModal()" class="flex items-center gap-1 bg-white border border-slate-200 rounded-full pl-3 pr-4 py-1 hover:border-indigo-400 group transition shadow-sm help-pulse">
                    <div class="w-4 h-4 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-[10px] font-bold">?</div>
                    <span class="text-[9px] text-slate-400">取得ガイド</span>
                </button>
            </div>
            <input type="password" id="${inputId}" value="${currentVal}" oninput="window.syncApiKey(this.value)" class="w-full bg-white border-2 border-slate-300 rounded-xl p-3 text-xs outline-none focus:border-indigo-500">
            <button onclick="window.checkApiKey()" class="w-full mt-3 py-3 bg-slate-800 text-white rounded-xl text-[10px] uppercase shadow-lg active:scale-95 transition-all">🔑 Test API & Save</button>
        `;
    };
    renderApiKeyWidget('apiKeyContainerAdmin', 'geminiApiKey_admin');
    renderApiKeyWidget('apiKeyContainerCard', 'geminiApiKey_card');
    renderApiKeyWidget('apiKeyContainerDb', 'geminiApiKey_db');
    // v52.179b: localStorage から APIキーを復元してinputに反映
    const _savedKey = localStorage.getItem('geminiApiKey') || '';
    if (_savedKey) {
        const _inputs = ['geminiApiKey_admin','geminiApiKey_card','geminiApiKey_db'];
        _inputs.forEach(id => { const el = document.getElementById(id); if(el) el.value = _savedKey; });
        window.geminiApiKey = _savedKey;
    }
}

window.changeCardMergeSortMode = function(mode) {
    window.cardMergeSelectSortMode = mode;
    window.renderCardMergeModal();
};

window.generateCardMergeOptionsHtml = function(selectedVal = 'new', filterText = '') {
    let html = `<option value="new">🆕 別人物として新規登録</option>`;
    let players = [...playerMaster];
    if (filterText) {
        const lowerFilter = filterText.toLowerCase();
        players = players.filter(p => {
            const teamName = teamMaster.find(t => t.id === p.teamId)?.name || '未所属';
            const labels = p.labels && p.labels.length > 0 ? p.labels.join(' ') : '';
            const searchTarget = `${p.name} ${teamName} ${labels}`.toLowerCase();
            return searchTarget.includes(lowerFilter);
        });
    }
    if (window.cardMergeSelectSortMode === 'az') {
        players.sort((a, b) => a.name.localeCompare(b.name, 'en', { sensitivity: 'base' }));
        players.forEach(p => {
            const teamName = teamMaster.find(t => t.id === p.teamId)?.name || '未所属';
            const labels = p.labels && p.labels.length > 0 ? ` [${p.labels.join(', ')}]` : '';
            const isSelected = p.name === selectedVal ? 'selected' : '';
            html += `<option value="${p.name}" ${isSelected}>${p.name} (${teamName})${labels}</option>`;
        });
    } else if (window.cardMergeSelectSortMode === 'team') {
        let teamsObj = {};
        teamsObj['フリー・未所属'] = [];
        teamMaster.forEach(t => teamsObj[t.name] = []);
        players.forEach(p => {
            const teamName = teamMaster.find(t => t.id === p.teamId)?.name || 'フリー・未所属';
            if (!teamsObj[teamName]) teamsObj[teamName] = [];
            teamsObj[teamName].push(p);
        });
        const sortedTeamNames = Object.keys(teamsObj).sort((a, b) => a.localeCompare(b, 'ja'));
        sortedTeamNames.forEach(tName => {
            if (teamsObj[tName].length > 0) {
                html += `<optgroup label="■ ${tName}">`;
                teamsObj[tName].sort((a, b) => a.name.localeCompare(b.name, 'en', { sensitivity: 'base' })).forEach(p => {
                    const labels = p.labels && p.labels.length > 0 ? ` [${p.labels.join(', ')}]` : '';
                    const isSelected = p.name === selectedVal ? 'selected' : '';
                    html += `<option value="${p.name}" ${isSelected}>${p.name}${labels}</option>`;
                });
                html += `</optgroup>`;
            }
        });
    }
    return html;
};

window.filterMergeSelectOptions = function(inputEl, selectId) {
    const select = document.getElementById(selectId);
    if (!select) return;
    const filterText = inputEl.value;
    const currentVal = select.value; 
    select.innerHTML = window.generateCardMergeOptionsHtml(currentVal, filterText);
};

function updateProgress(idPrefix, percent, text) {
    const area = document.getElementById(`${idPrefix}ProgressArea`);
    const textEl = document.getElementById(`${idPrefix}ProgressText`);
    const percentEl = document.getElementById(`${idPrefix}ProgressPercent`);
    const barEl = document.getElementById(`${idPrefix}ProgressBar`);
    if (area) area.classList.remove('hidden');
    if (textEl) textEl.innerText = text;
    if (percentEl) percentEl.innerText = `${percent}%`;
    if (barEl) barEl.style.width = `${percent}%`;
}

function hideProgress(idPrefix) {
    const area = document.getElementById(`${idPrefix}ProgressArea`);
    if (area) area.classList.add('hidden');
}

function syncApiKey(value) {
    const inputs = ['geminiApiKey_admin', 'geminiApiKey_card', 'geminiApiKey_db'];
    inputs.forEach(id => {
        const el = document.getElementById(id);
        if (el && el.value !== value) el.value = value;
    });
}
window.syncApiKey = syncApiKey;

function getApiKey() {
    return document.getElementById('geminiApiKey_admin')?.value 
        || document.getElementById('geminiApiKey_card')?.value 
        || document.getElementById('geminiApiKey_db')?.value 
        || "";
}
window.getApiKey = getApiKey;

// [Phase 4.11.55] showMessage moved to global scope`; el.classList.remove('hidden'); setTimeout(() => el.classList.add('hidden'), 4000); } }
function setSyncStatus(s) { const el = document.getElementById('syncStatus'); if(el) el.innerHTML = s === 'syncing' ? `<span class="w-2 h-2 rounded-full bg-indigo-50 animate-pulse"></span> 同期中` : s === 'synced' ? `<span class="w-2 h-2 rounded-full bg-emerald-500"></span> Ready` : `<span class="w-2 h-2 rounded-full bg-red-500"></span> 接続エラー`; }
function createFallbackStats(t) { return { goals: 0, assists: 0, apps: 0, winRate: 0, rating: 0, number: '-', status: '在籍', cleanSheets: 0, yellow: 0, red: 0, overall: 0, dataType: t }; }

function updateTotalParsedCount() {
    const uniqueNewNames = [...new Set([ ...(batchPendingResults.latest || []).map(x=>x.name), ...(batchPendingResults.lifetime || []).map(x=>x.name) ])];
    const count = uniqueNewNames.length;
    const badge = document.getElementById('totalParsedBadge');
    const countEl = document.getElementById('totalParsedCount');
    if (badge && countEl) {
        if (count > 0) { badge.classList.remove('hidden'); badge.classList.add('flex'); countEl.innerText = count; } else { badge.classList.add('hidden'); badge.classList.remove('flex'); countEl.innerText = '0'; }
    }
}

function formatMarkdown(text) {
    if (!text) return "";
    let html = '';
    let inTable = false;
    let inList = false;
    const lines = text.split('\n');
    for (let i = 0; i < lines.length; i++) {
        let line = lines[i].trim();
        line = line.replace(/\*\*(.*?)\*\*/g, '<strong class="text-slate-900">$1</strong>');
        const headingMatch = line.match(/^(#{1,6})\s+(.*)$/);
        if (headingMatch) {
            if (inList) { html += '</ul>'; inList = false; } 
            if (inTable) { html += '</tbody></table></div>'; inTable = false; } 
            const level = headingMatch[1].length;
            const content = headingMatch[2];
            if (level === 1 || level === 2) { html += `<h2 class="text-xl text-slate-800 mt-6 mb-3 pb-2 border-b-2 border-slate-200">【${content}】</h2>`; } else if (level === 3) { html += `<h3 class="text-lg text-emerald-700 mt-5 mb-2 border-l-4 border-emerald-500 pl-3">【${content}】</h3>`; } else { html += `<h4 class="text-base text-indigo-700 mt-4 mb-1 pl-1">■ ${content}</h4>`; }
            continue;
        }
        const listMatch = line.match(/^[-*]\s+(.*)$/);
        const isTableSeparator = line.split('|').length > 2 && line.split('|').map(c=>c.trim()).filter(c=>c!=="").every(c=>c.match(/^[:\-]+$/));
        if (listMatch && !isTableSeparator && !line.startsWith('|')) {
            if (inTable) { html += '</tbody></table></div>'; inTable = false; } 
            if (!inList) { html += '<ul class="list-disc list-inside ml-2 mb-3 text-slate-700 space-y-1">'; inList = true; }
            html += `<li>${listMatch[1]}</li>`; continue;
        } else if (inList && line === "") { html += '</ul>'; inList = false; continue; }
        if ((line.startsWith('|') && line.endsWith('|')) || (line.split('|').length > 2 && !isTableSeparator)) {
            if (inList) { html += '</ul>'; inList = false; } 
            if (!inTable) { html += '<div class="table-container custom-scrollbar"><table class="ai-markdown-table">'; inTable = true; }
            const cells = line.split('|').map(c => c.trim()).filter((c, idx, arr) => !(c === "" && (idx === 0 || idx === arr.length - 1)));
            if (cells.every(c => c.match(/^[:\-]+$/))) continue; 
            const isHeader = lines[i + 1] && lines[i + 1].trim().split('|').map(c => c.trim()).filter((c, idx, arr) => !(c === "" && (idx === 0 || idx === arr.length - 1))).every(c => c.match(/^[:\-]+$/));
            if (isHeader) { html += '<thead><tr>'; cells.forEach(cell => html += `<th>${cell}</th>`); html += '</tr></thead><tbody>'; } else { html += '<tr>'; cells.forEach(cell => html += `<td>${cell}</td>`); html += '</tr>'; }
        } else {
            if (inTable) { html += '</tbody></table></div>'; inTable = false; }
            if (line !== "") { html += `<p class="mb-2 leading-relaxed text-slate-700">${line}</p>`; } else { html += `<div class="h-2"></div>`; }
        }
    }
    if (inTable) html += '</tbody></table></div>';
    if (inList) html += '</ul>';
    return html;
}

function setDisplayType(t) {
    displayType = t;
    const btnLatest = document.getElementById('typeBtnLatest');
    const btnLifetime = document.getElementById('typeBtnLifetime');
    if (btnLatest && btnLifetime) {
        if (t === 'latest') { btnLatest.className = 'px-6 py-2 rounded-xl text-[11px] bg-emerald-600 text-white shadow-sm'; btnLifetime.className = 'px-6 py-2 rounded-xl text-[11px] text-slate-400 hover:text-slate-600'; } else { btnLatest.className = 'px-6 py-2 rounded-xl text-[11px] text-slate-400 hover:text-slate-600'; btnLifetime.className = 'px-6 py-2 rounded-xl text-[11px] bg-emerald-600 text-white shadow-sm'; }
    }
    renderFilterChips(); updateView();
}

function initResizer() {
    const resizer = document.getElementById('playersResizer');
    const topPanel = document.getElementById('performancePanel');
    if (!resizer || !topPanel) return;
    let isResizing = false;
    resizer.addEventListener('mousedown', (e) => { isResizing = true; document.body.classList.add('resizing'); document.body.style.cursor = 'ns-resize'; });
    window.addEventListener('mousemove', (e) => { if (!isResizing) return; const offsetTop = topPanel.getBoundingClientRect().top; const newHeight = e.clientY - offsetTop; if (newHeight > 300 && newHeight < window.innerHeight * 0.8) topPanel.style.height = `${newHeight}px`; });
    window.addEventListener('mouseup', () => { if (isResizing) { isResizing = false; document.body.classList.remove('resizing'); document.body.style.cursor = ''; if (chartInstance) chartInstance.resize(); } });
}

function switchTab(t) {
    currentTab = t;
    ['teams', 'players', 'admin', 'card', 'db'].forEach(x => {
        const el = document.getElementById(`content-${x}`), btn = document.getElementById(`tab-${x}`);
        if(el) el.classList.toggle('hidden', x !== t);
        if(btn) { btn.classList.toggle('tab-active', x === t); btn.classList.toggle('text-gray-400', x !== t); }
    });
    if (t === 'admin') { renderManualLeagues(); renderAutoFilterLeagues(); }
    if (['admin', 'card', 'db'].includes(t)) { window.renderSharedComponents(); }
    updateView();
}
window.switchTab = switchTab;  // グローバルに公開
window.updateView = updateView;  // グローバルに公開

function updateView() {
    const q = (document.getElementById('teamSearch')?.value || '').toLowerCase();
    const lFilter = document.getElementById('leagueFilter')?.value || "";
    document.getElementById('statTotalTeams').innerText = teamMaster.length;
    document.getElementById('statTotalPlayers').innerText = playerMaster.length;
    // FIX-9: Update FA count
    const faPlayerCount = playerMaster.filter(p => isFA(p)).length;
    const faEl = document.getElementById('statFAPlayers');
    if (faEl) faEl.innerText = faPlayerCount;
    if (currentTab === 'teams') {
        let f = teamMaster.filter(t => t.name.toLowerCase().includes(q) || t.id.includes(q));
        if(lFilter) f = f.filter(t => t.l1 === lFilter || (t.l2 && t.l2.includes(lFilter)));
        f.sort((a,b) => { let va = a[teamSortCol] || "", vb = b[teamSortCol] || ""; return teamSortDir === 'asc' ? va.localeCompare(vb, 'ja') : vb.localeCompare(va, 'ja'); });
        document.getElementById('teamTableBody').innerHTML = f.map(t => {
            let l2Text = "";
            if (t.l2 && Array.isArray(t.l2) && t.l2.length > 0) { l2Text = t.l2.map(id => leagueLabelMap[id]).filter(n => n).join(' / ') + ' / '; }
            // FIX-5: Count active members only (don't rely on mutated _isPastMember)
            const memberCount = playerMaster.filter(p => p.teamId === t.id).length;
            // FIX-10b: Highlight active team filter
            const isActiveFilter = playerViewSelectedTeams.includes(t.id);
            const rowBg = isActiveFilter ? 'bg-yellow-50 ring-2 ring-yellow-400' : 'hover:bg-slate-50';
            const nameCls = isActiveFilter ? 'font-bold text-yellow-800' : '';
            return `<tr class="${rowBg} cursor-pointer transition-all" onclick="window.viewTeamPlayers('${t.id}')"><td>${l2Text}${leagueLabelMap[t.l1] || t.l1}</td><td class="${nameCls}">${t.name}${isActiveFilter ? ' <span class=\"text-[10px] bg-yellow-300 text-yellow-900 px-1 rounded\">絞込中</span>' : ''}</td><td class="text-center"><span class="bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded-full text-xs font-bold">${memberCount}人</span></td><td class="text-right font-mono">${t.id}</td><td class="text-center"><div class="flex gap-1 justify-center items-center"><button onclick="window.viewTeamPlayers('${t.id}')" class="bg-slate-900 hover:bg-slate-700 text-white px-3 py-1.5 rounded-xl text-[9px] uppercase transition-colors">詳細</button><button onclick="event.stopPropagation();window.openTournamentRanking('${t.l1}')" class="bg-amber-500 hover:bg-amber-600 text-white px-2.5 py-1.5 rounded-xl text-[11px] font-bold transition-colors" title="🏆 大会ランキング">🏆</button></div></td></tr>`;
        }).join('') + (() => {
            // FIX-6: FA = teamId empty or FA label
            const faCount = playerMaster.filter(p => isFA(p)).length;
            if (faCount === 0) return '';
            return `<tr class="hover:bg-amber-50 cursor-pointer bg-amber-25 border-t-2 border-amber-200" onclick="window.viewFAPlayers()">
                <td colspan="2"><span class="text-amber-700 font-bold">⚽ 無所属選手（FA / Free Agent）</span></td>
                <td class="text-center"><span class="bg-amber-100 text-amber-700 px-2 py-0.5 rounded-full text-xs font-bold">${faCount}人</span></td>
                <td class="text-right font-mono text-amber-600 text-[10px]">FA</td>
                <td class="text-center"><span class="text-[10px] text-amber-500">→ 選手一覧</span></td>
            </tr>`;
        })();
    } else if (currentTab === 'players') { renderPlayerTable(); }
}


// ─────────────────────────────────────────────────────────────────────────────
// FIX-6: 在籍/退団/FA ステータス判定ヘルパー
// FA条件: (1) teamId='' かつ ラベルにFAがある
//         (2) teamId='' かつ 最新スタッツの status が '退団'
//         (3) teamId='' のみ（未所属）→ FA扱い
// 退団条件: teamId が存在し、最新スタッツの status が '退団'
// 在籍条件: teamId が存在し、最新スタッツの status が '在籍'（またはデフォルト）
// ─────────────────────────────────────────────────────────────────────────────
function getPlayerStatus(p) {
    // Explicit FA label takes highest priority
    if (p.labels && p.labels.includes('FA')) return 'FA';
    // No team → FA
    if (p.teamId === '' || p.teamId === null || p.teamId === undefined) return 'FA';
    // Has team: check latest stats status
    const hL = p.history || [];
    const latestRec = hL.filter(h => h.dataType === 'latest').sort((a,b) => new Date(b.date)-new Date(a.date))[0];
    if (latestRec && latestRec.status) {
        const s = String(latestRec.status);
        if (s.includes('退団')) return '退団';
        if (s.includes('FA')) return 'FA';
    }
    return '在籍';
}
window.getPlayerStatus = getPlayerStatus;

// FA判定: チームに所属していない (teamId が空)
function isFA(p) {
    // FIX-E: Enhanced FA detection
    // Priority 1: explicit FA label
    if (p.labels && p.labels.includes('FA')) return true;
    // Priority 2: no teamId → FA
    if (!p.teamId) return true;
    // Priority 3: has teamId but status=退団 in latest record AND no jersey number
    const hL = p.history || [];
    const latestRec = hL.filter(h => h.dataType === 'latest').sort((a,b) => new Date(b.date)-new Date(a.date))[0];
    const hasNumber = latestRec && latestRec.number !== undefined && latestRec.number !== null
                      && latestRec.number !== '' && latestRec.number !== '-';
    const isRetired = latestRec && String(latestRec.status || '').includes('退団');
    if (isRetired && !hasNumber) return true;
    return false;
}

// Sprint 2: Integrated search state
let _lastSearchQuery = '';
let _selectedPlayerPsid = null; // FIX-C: Track selected player for row highlight
let _lastSearchBreakdown = null;
let _pastMemberSet = new Set(); // FIX-3: Replace _isPastMember mutation

function parseSearchQuery(raw) {
    // Returns {mode, term} where mode is 'num'|'label'|'team'|'all'
    if (!raw) return { mode: 'all', term: '' };
    if (raw.startsWith('#')) return { mode: 'num',   term: raw.slice(1).trim() };
    if (raw.startsWith('!')) return { mode: 'label', term: raw.slice(1).trim() };
    if (raw.startsWith('@')) return { mode: 'team',  term: raw.slice(1).trim() };
    return { mode: 'all', term: raw };
}

function getFilteredPlayers() {
    // FIX-3: Reset past member set (never mutate playerMaster objects)
    _pastMemberSet = new Set();
    // Reset _isPastMember on all players before each filter run
    playerMaster.forEach(p => { delete p._isPastMember; });

    const rawQ = (document.getElementById('playerSearch')?.value || '');
    const { mode, term } = parseSearchQuery(rawQ);
    const pq = term.toLowerCase();
    _lastSearchQuery = rawQ;
    const specialFilters = [FILTER_JERSEY_YES, FILTER_JERSEY_NO, FILTER_STATUS_ACTIVE, FILTER_STATUS_LEFT, FILTER_FREE_AGENT];
    const selectedAttributes = playerViewSelectedLeagues.filter(l => specialFilters.includes(l));
    const selectedCategories = playerViewSelectedLeagues.filter(l => !specialFilters.includes(l));

    // Breakdown counters for match hints
    const breakdown = { psid:0, nick:0, num:0, label:0, team:0 };

    const result = playerMaster.filter(p => {
        if (pq) {
            const team = teamMaster.find(t => t.id === p.teamId);
            const hL = p.history || [];
            const latestRecord = hL.filter(h => h.dataType === 'latest').pop() || {};
            const jerseyNum = String(latestRecord.number ?? '').toLowerCase();

            let textMatch = false;
            if (mode === 'num') {
                textMatch = jerseyNum && jerseyNum !== '-' && jerseyNum.includes(pq);
                if (textMatch) breakdown.num++;
            } else if (mode === 'label') {
                textMatch = (p.labels || []).some(l => l.toLowerCase().includes(pq));
                if (textMatch) breakdown.label++;
            } else if (mode === 'team') {
                textMatch = !!(team && team.name.toLowerCase().includes(pq));
                if (textMatch) breakdown.team++;
            } else {
                // mode === 'all': search across PSID, nickname, jersey, labels
                const matchPsid  = p.name.toLowerCase().includes(pq);
                const matchNick  = (p.nickname || '').toLowerCase().includes(pq);
                const matchNum   = jerseyNum && jerseyNum !== '-' && jerseyNum.includes(pq);
                const matchLabel = (p.labels || []).some(l => l.toLowerCase().includes(pq));
                const matchTeam  = !!(team && team.name.toLowerCase().includes(pq));
                if (matchPsid)  breakdown.psid++;
                if (matchNick)  breakdown.nick++;
                if (matchNum)   breakdown.num++;
                if (matchLabel) breakdown.label++;
                if (matchTeam)  breakdown.team++;
                textMatch = matchPsid || matchNick || matchNum || matchLabel || matchTeam;
            }
            if (!textMatch) return false;
        }
        let matchesTeamOrLeague = false;
        const currentTeam = teamMaster.find(t => t.id === p.teamId);
        if (selectedCategories.length === 0 && playerViewSelectedTeams.length === 0) { matchesTeamOrLeague = true; } else {
            if (currentTeam && (selectedCategories.includes(currentTeam.l1) || (currentTeam.l2 && Array.isArray(currentTeam.l2) && currentTeam.l2.some(l => selectedCategories.includes(l))))) matchesTeamOrLeague = true;
            if (p.labels && p.labels.some(lbl => selectedCategories.includes(lbl))) matchesTeamOrLeague = true;
            if (playerViewSelectedTeams.includes(p.teamId)) matchesTeamOrLeague = true;
            if (!matchesTeamOrLeague && playerViewSelectedTeams.length > 0) {
                const pastMatch = (p.past_teams || []).some(pt => playerViewSelectedTeams.includes(pt.id));
                if (pastMatch) { _pastMemberSet.add(p.name); matchesTeamOrLeague = true; }
            }
        }
        if (!matchesTeamOrLeague) return false;
        if (selectedAttributes.length > 0) {
            const hL = p.history || [];
            const latestRecord = hL.filter(h => h.dataType === 'latest').pop() || createFallbackStats('latest');
            const jerseyVal = latestRecord.number;
            const hasJersey = jerseyVal && jerseyVal !== '-' && jerseyVal !== '0' && jerseyVal !== 0;
            const isActive = (latestRecord.status||'在籍').includes('在籍');
            let passed = true;
            if (selectedAttributes.includes(FILTER_JERSEY_YES) && !hasJersey) passed = false;
            if (selectedAttributes.includes(FILTER_JERSEY_NO) && hasJersey) passed = false;
            if (selectedAttributes.includes(FILTER_STATUS_ACTIVE) && !isActive) passed = false;
            if (selectedAttributes.includes(FILTER_STATUS_LEFT) && isActive) passed = false;
            if (selectedAttributes.includes(FILTER_FREE_AGENT)) { passed = isFA(p); }
            if (!passed) return false;
        }
        return true;
    });

    _lastSearchBreakdown = breakdown;
    // FIX-3: Assign _isPastMember AFTER filtering (never mutate during filter)
    result.forEach(p => { if (_pastMemberSet.has(p.name)) p._isPastMember = true; });
    // Update breakdown badge asynchronously
    setTimeout(() => window.updateSearchBreakdown(breakdown, result.length), 0);
    return result;
}

window.updateSearchBreakdown = function(bd, total) {
    const el = document.getElementById('searchResultBreakdown');
    if (!el) return;
    const rawQ = (document.getElementById('playerSearch')?.value || '');
    if (!rawQ) { el.innerHTML = ''; return; }
    const parts = [];
    if (bd.psid)  parts.push(`<span class="smb-psid">PSID: ${bd.psid}</span>`);
    if (bd.nick)  parts.push(`<span class="smb-nick">ニック: ${bd.nick}</span>`);
    if (bd.num)   parts.push(`<span class="smb-num">#背番号: ${bd.num}</span>`);
    if (bd.label) parts.push(`<span class="smb-label">!ラベル: ${bd.label}</span>`);
    if (bd.team)  parts.push(`<span class="smb-team">@チーム: ${bd.team}</span>`);
    el.innerHTML = parts.join('');
};

function renderPlayerTable() {
    const f = getFilteredPlayers();
    const tbody = document.getElementById('playerTableBody');
    const header = document.getElementById('playerTableHeader');
    const getPlayerSpecialCards = (p) => { return (p.labels || []).filter(l => isSpecialLabel(l)); };
    f.sort((a, b) => { 
        if (a._isPastMember && !b._isPastMember) return 1;
        if (!a._isPastMember && b._isPastMember) return -1;
        let va, vb; 
        if (['name','nickname','team','labels'].includes(playerSortCol)) {
            if (playerSortCol === 'team') { va = teamMaster.find(t=>t.id===a.teamId)?.name||(a.teamId===""?"FA":""); vb = teamMaster.find(t=>t.id===b.teamId)?.name||(b.teamId===""?"FA":""); } 
            else if (playerSortCol === 'labels') { va = (a.labels||[]).join(""); vb = (b.labels||[]).join(""); } 
            else { va = a[playerSortCol]||""; vb = b[playerSortCol]||""; }
            return playerSortDir === 'asc' ? va.localeCompare(vb,'ja') : vb.localeCompare(va,'ja');
        } else if (playerSortCol === 'special_cards') {
            va = getPlayerSpecialCards(a).length; vb = getPlayerSpecialCards(b).length;
            return playerSortDir === 'asc' ? va - vb : vb - va;
        } else {
            const getStat = (p) => {
                const hL = p.history || [];
                let val = 0;
                if (playerSortCol === 'number') { const lat = hL.filter(h => h.dataType === 'latest').pop(); val = lat?.number; } 
                else { const rec = hL.filter(h=>h.dataType===displayType).pop(); if (playerSortCol === 'overall') val = rec?.overall || rec?.rating; else val = rec?.[playerSortCol]; }
                return Number(val) || 0;
            };
            va = getStat(a); vb = getStat(b);
            return playerSortDir === 'asc' ? va - vb : vb - va;
        }
    });
    const sortIcon = (col) => playerSortCol === col ? (playerSortDir === 'asc' ? '▲' : '▼') : '↕';
    let hH = `<tr><th class="w-10 text-center"><input type="checkbox" id="selectAllPlayers" onchange="window.toggleSelectAllPlayers(this.checked)" class="w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500" title="全選択"></th>`;
    COLUMN_DEFS[displayType].forEach(col => { if (columnVisibility[displayType][col.id]) { hH += `<th class="sortable ${col.id === 'name' ? 'text-indigo-600' : ''}" onclick="window.setPlayerSort('${col.id}')">${col.name} ${sortIcon(col.id)}</th>`; } });
    hH += `<th>操作</th></tr>`;
    header.innerHTML = hH;
    tbody.innerHTML = f.map(p => {
        const team = teamMaster.find(t=>t.id===p.teamId);
        const hL = p.history || [];
        const cur = hL.filter(h=>h.dataType===displayType).pop() || createFallbackStats(displayType);
        const latestRecord = hL.filter(h => h.dataType === 'latest').pop() || createFallbackStats('latest');
        const jerseyVal = latestRecord.number;
        const showJersey = (jerseyVal !== undefined && jerseyVal !== null && jerseyVal !== '' && jerseyVal !== '-') ? jerseyVal : ((jerseyVal === 0 || jerseyVal === '0') ? '0' : '-');
        const noJersey = showJersey === '-';
        const _isSelectedRow = (_selectedPlayerPsid && _selectedPlayerPsid === p.name);
        let rowClass = _isSelectedRow ? "player-row-selected cursor-pointer" : "hover:bg-emerald-50 cursor-pointer";
        let statusBadge = '';
        if (_pastMemberSet && _pastMemberSet.has(p.name)) { p._isPastMember = true; rowClass = "row-left-player cursor-pointer"; statusBadge = `<span class="badge-past-team">過去在籍</span>`; }
        const isFA = p.teamId === "";
        let rH = `<tr class="${rowClass}" onclick="window.selectPlayerForChart('${p.name}')"><td class="w-10 text-center" onclick="event.stopPropagation()"><input type="checkbox" class="player-select-cb w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500" data-psid="${p.name}" onchange="window.onPlayerCheckChange()"></td>`;
        const generalLabels = (p.labels || []).filter(l => !isSpecialLabel(l));
        const specialLabels = (p.labels || []).filter(l => isSpecialLabel(l));
        COLUMN_DEFS[displayType].forEach(col => {
            if (columnVisibility[displayType][col.id]) {
                switch(col.id) {
                    case 'number': rH += `<td class="font-mono text-center">${showJersey}</td>`; break;
                    case 'card': rH += `<td><div class="w-8 h-10 bg-slate-100 rounded border flex items-center justify-center text-[8px] mx-auto ${p.labels && p.labels.length > 0 ? 'border-emerald-400 bg-emerald-50 text-emerald-600' : ''}">CARD</div></td>`; break;
                    case 'overall': rH += `<td><span class="bg-slate-900 text-white px-2 py-1 rounded text-xs font-bold">${cur.overall || cur.rating || latestRecord.overall || latestRecord.rating || 0}</span></td>`; break;
                    case 'name': rH += `<td class="font-bold ${p._isPastMember ? 'text-slate-500' : 'text-indigo-600'} underline">${window.hlText(p.name, _lastSearchQuery)} ${statusBadge}</td>`; break;
                    case 'nickname': rH += `<td class="text-slate-500">${window.hlText(p.nickname || '', _lastSearchQuery)}</td>`; break;
                    case 'team': 
                        let tName = team?.name || (isFA ? 'FA(未所属)' : '-');
                        if (_pastMemberSet && _pastMemberSet.has(p.name)) { const pastT = (p.past_teams||[]).find(pt => playerViewSelectedTeams.includes(pt.id)); if(pastT) tName += ` <span class="text-[9px] text-red-400">(元 ${pastT.name})</span>`; }
                        rH += `<td class="text-[10px]">${tName}</td>`; 
                        break;
                    case 'labels': 
                        let tags = generalLabels.map(l => `<span class="label-tag">${l}</span>`).join("");
                        const _pStatus = getPlayerStatus(p);
                        if (_pStatus === 'FA') tags = `<span class="label-tag system-fa">FA / Free Agent</span>` + tags;
                        else if (noJersey && _pStatus !== '退団' && !(_pastMemberSet && _pastMemberSet.has(p.name))) tags = `<span class="label-tag system-no-jersey">背番号なし</span>` + tags;
                        rH += `<td>${tags}</td>`; 
                        break;
                    case 'special_cards':
                        let scTags = specialLabels.map(l => { const styleClass = getSpecialCardStyle(l); const iconSvg = getSpecialCardIcon(l); return `<div class="flex items-center px-2 py-1 rounded border text-xs font-bold shadow-sm italic ${styleClass}">${iconSvg}${l}</div>`; }).join("");
                        rH += `<td style="white-space: normal !important; min-width: 250px;"><div class="tag-container">${scTags}</div></td>`;
                        break;
                    case 'apps': rH += `<td>${cur.apps || 0}</td>`; break;
                    case 'winRate': rH += `<td>${cur.winRate || 0}%</td>`; break;
                    case 'goals': rH += `<td class="text-orange-600 font-bold">${cur.goals || 0}</td>`; break;
                    case 'assists': rH += `<td class="text-emerald-600 font-bold">${cur.assists || 0}</td>`; break;
                    case 'cleanSheets': rH += `<td>${cur.cleanSheets || 0}</td>`; break;
                    case 'yellow': rH += `<td><div class="flex items-center gap-1 justify-center"><div class="w-2.5 h-4 bg-yellow-400"></div>${cur.yellow || 0}</div></td>`; break;
                    case 'red': rH += `<td><div class="flex items-center gap-1 justify-center"><div class="w-2.5 h-4 bg-red-500"></div>${cur.red || 0}</div></td>`; break;
                    case 'status':
                        // FIX-6b: Use getPlayerStatus() for consistent status display
                        { const pStatus = getPlayerStatus(p);
                        let sTxt, sClass;
                        if (pStatus === 'FA') { sTxt = 'FA'; sClass = 'status-fa'; }
                        else if (pStatus === '退団') { sTxt = '退団'; sClass = 'status-left'; }
                        else { sTxt = '在籍'; sClass = 'status-active'; }
                        rH += `<td><span class="status-badge ${sClass}">${sTxt}</span></td>`; }
                        break;
                }
            }
        });
        rH += `<td>
            <div class="flex gap-1 justify-center" onclick="event.stopPropagation()">
                <button onclick="window.openEditModal('${p.name}')" class="p-2 bg-white border border-slate-200 rounded-lg hover:bg-emerald-500 hover:text-white transition"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button>
                <button onclick="window.openHistoryModal('${p.name}')" class="p-2 bg-white border border-slate-200 rounded-lg hover:bg-blue-500 hover:text-white transition"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></button>
            <button onclick="window.openTransferModal(['${p.name}'])" class="p-2 bg-white border border-amber-200 rounded-lg hover:bg-amber-500 hover:text-white transition" title="移籍処理"><svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path d="M8 5a1 1 0 000 2h5.586l-1.293 1.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L13.586 5H8zM12 15a1 1 0 100-2H6.414l1.293-1.293a1 1 0 10-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L6.414 15H12z"/></svg></button>
            </div>
        </td></tr>`;
        return rH;
    }).join('') || '<tr><td colspan="15" class="text-center p-10 opacity-30">NO DATA MATCHING FILTERS</td></tr>';
}

function renderManualLeagues() { const c = document.getElementById('manualLeagueList'); if(!c) return; c.innerHTML = Object.entries(leagueLabelMap).filter(([id]) => id !== "").map(([id, name]) => `<div onclick="window.toggleManualLeague('${id}')" class="league-label-chip px-3 py-1.5 rounded-xl border text-[9px] ${manualSelectedLeagues.includes(id) ? 'selected bg-emerald-600 text-white' : 'text-slate-400 border-slate-100'}">${name}</div>`).join(''); }
function renderAutoFilterLeagues() { const c = document.getElementById('autoFilterLeagueList'); if(!c) return; c.innerHTML = Object.entries(leagueLabelMap).filter(([id]) => id !== "").map(([id, name]) => `<div onclick="window.toggleAutoFilterLeague('${id}')" class="league-label-chip px-3 py-1.5 rounded-xl border text-[9px] ${autoSelectedLeagues.includes(id) ? 'selected bg-indigo-600 text-white' : 'text-slate-400 border-slate-100'}">${name}</div>`).join(''); }
function renderAdminTeamSelector() { const sel = document.getElementById('manualTeamSelect'); if (!sel) return; let ft = teamMaster; if (manualSelectedLeagues.length > 0) ft = teamMaster.filter(t => manualSelectedLeagues.includes(String(t.l1)) || (t.l2 && Array.isArray(t.l2) && manualSelectedLeagues.some(ml => t.l2.includes(String(ml))))); ft.sort((a, b) => (a.name || "").localeCompare((b.name || ""), 'ja')); sel.innerHTML = '<option value="all">チームを選択...</option>' + ft.map(t => `<option value="${t.id}">${t.name}</option>`).join(''); }
function renderAutoTeamSelector() { const sel = document.getElementById('autoTeamSelect'); if (!sel) return; let ft = teamMaster; if (autoSelectedLeagues.length > 0) ft = teamMaster.filter(t => autoSelectedLeagues.includes(String(t.l1)) || (t.l2 && Array.isArray(t.l2) && autoSelectedLeagues.some(al => t.l2.includes(String(al))))); ft.sort((a, b) => (a.name || "").localeCompare((b.name || ""), 'ja')); sel.innerHTML = '<option value="">▼ チームを選択...</option>' + ft.map(t => `<option value="${t.id}">${t.name} (ID:${t.id})</option>`).join(''); }

function renderFilterChips() {
    const colList = document.getElementById('columnVisibilityList'); if (colList) colList.innerHTML = COLUMN_DEFS[displayType].map(col => `<div onclick="window.toggleColumn('${displayType}', '${col.id}')" class="column-chip px-3 py-1.5 rounded-xl border text-[9px] ${columnVisibility[displayType][col.id] ? 'active' : 'bg-white text-slate-300 border-slate-100'}">${col.name}</div>`).join('');
    const leagueList = document.getElementById('playerLeagueFilterList');
    if(leagueList) {
        let h = Object.entries(leagueLabelMap).filter(([id])=>id!=="").map(([id, name]) => `<div onclick="window.togglePlayerViewLeague('${id}')" class="league-label-chip px-3 py-1.5 rounded-xl border text-[9px] ${playerViewSelectedLeagues.includes(id) ? 'selected' : 'text-slate-500'}">${name}</div>`).join('');
        h += customLabels.map(obj => `<div onclick="window.togglePlayerViewLeague('${obj.name}')" class="custom-label-chip px-3 py-1.5 rounded-xl border text-[9px] ${obj.type === 'special' ? 'bg-yellow-50 text-yellow-700 border-yellow-200' : 'bg-blue-50 text-blue-500 border-blue-200'} ${playerViewSelectedLeagues.includes(obj.name) ? 'selected' : ''}">${obj.type === 'special' ? '🃏 ' : ''}${obj.name}</div>`).join('');
        [FILTER_JERSEY_YES, FILTER_JERSEY_NO].forEach(f => { h += `<div onclick="window.togglePlayerViewLeague('${f}')" class="custom-label-chip px-3 py-1.5 rounded-xl border text-[9px] bg-gray-50 ${playerViewSelectedLeagues.includes(f) ? 'selected' : 'text-gray-500 border-gray-200'}">${f}</div>`; });
        [FILTER_STATUS_ACTIVE, FILTER_STATUS_LEFT].forEach(f => { h += `<div onclick="window.togglePlayerViewLeague('${f}')" class="custom-label-chip px-3 py-1.5 rounded-xl border text-[9px] bg-green-50 ${playerViewSelectedLeagues.includes(f) ? 'selected' : 'text-green-600 border-green-200'}">${f}</div>`; });
        h += `<div onclick="window.togglePlayerViewLeague('${FILTER_FREE_AGENT}')" class="custom-label-chip px-3 py-1.5 rounded-xl border text-[9px] bg-slate-100 ${playerViewSelectedLeagues.includes(FILTER_FREE_AGENT) ? 'selected' : 'text-slate-500 border-slate-300'}">${FILTER_FREE_AGENT}</div>`;
        leagueList.innerHTML = h;
    }
    document.getElementById('filterCountBadge').innerText = playerViewSelectedLeagues.length + playerViewSelectedTeams.length;
    const tags = document.getElementById('selectedTeamTags'); if(tags) tags.innerHTML = playerViewSelectedTeams.map(tid => { const t = teamMaster.find(x => x.id === tid); return `<div class="bg-slate-900 text-white px-3 py-1 rounded-lg text-[9px] flex gap-2 items-center">${t?.name} <span class="cursor-pointer" onclick="window.removePlayerFilterTeam('${tid}')">&times;</span></div>`; }).join(''); 
}

function renderLabelManagerList() { 
    const list = document.getElementById('customLabelsList'); 
    list.innerHTML = customLabels.map((lbl, idx) => {
        const typeBadge = lbl.type === 'special' ? '<span class="bg-yellow-100 text-yellow-800 text-[9px] px-2 py-0.5 rounded border border-yellow-200">🃏 Special</span>' : '<span class="bg-blue-100 text-blue-800 text-[9px] px-2 py-0.5 rounded border border-blue-200">General</span>';
        return `
        <div class="flex items-center justify-between bg-slate-50 p-4 rounded-xl border border-slate-200">
            <div class="flex items-center gap-2 flex-1">
                ${typeBadge}
                <input type="text" value="${lbl.name}" onblur="window.editCustomLabelName(${idx}, this.value)" class="bg-transparent border-none outline-none text-sm font-bold text-slate-700 w-full">
            </div>
            <div class="flex items-center gap-2">
                <button onclick="window.toggleCustomLabelType(${idx})" class="text-xs text-slate-400 hover:text-slate-600 bg-white border border-slate-200 px-2 py-1 rounded">切替</button>
                <button onclick="window.deleteCustomLabel(${idx})" class="text-red-500 hover:text-red-700 text-xs uppercase px-2">削除</button>
            </div>
        </div>`;
    }).join('') || '<p class="text-center text-slate-300 py-6">ラベルがありません</p>'; 
}

// v50.62 Fix: Include unregistered labels that player has
function renderEditPlayerLabelCheckboxes(selected) { 
    const con = document.getElementById('editPlayerLabelsContainer'); 
    // Existing labels from manager
    let html = customLabels.map(lbl => {
        const isSpecial = lbl.type === 'special';
        const styleClass = isSpecial ? "border-yellow-200 bg-yellow-50 text-yellow-800" : "border-slate-200 bg-white";
        return `<label class="flex items-center gap-2 px-3 py-1.5 rounded-lg border cursor-pointer hover:border-emerald-500 transition shadow-sm ${styleClass}"><input type="checkbox" value="${lbl.name}" class="w-4 h-4 rounded" ${selected.includes(lbl.name) ? 'checked' : ''}><span class="text-[10px]">${isSpecial ? '🃏 ' : ''}${lbl.name}</span></label>`;
    }).join('');

    // Detect labels that player has but not in customLabels list
    const registeredNames = customLabels.map(l => l.name);
    const unknownLabels = selected.filter(l => !registeredNames.includes(l));
    
    if (unknownLabels.length > 0) {
        const unknownHtml = unknownLabels.map(l => {
            return `<label class="flex items-center gap-2 px-3 py-1.5 rounded-lg border cursor-pointer border-slate-300 bg-slate-100 hover:border-slate-400 transition shadow-sm" title="未登録のラベル"><input type="checkbox" value="${l}" class="w-4 h-4 rounded text-slate-500 focus:ring-slate-400" checked><span class="text-[10px] text-slate-600 italic">? ${l}</span></label>`;
        }).join('');
        html += unknownHtml;
    }

    con.innerHTML = html || '<p class="text-xs text-slate-300">ラベルを作成してください</p>'; 
}

function addAnalysisLog(msg, status = 'active') { const list = document.getElementById('adminQueueList'); if(!list) return; const log = document.createElement('div'); const isScan = status === 'scanning'; log.className = `log-item ${isScan ? 'scanning' : status}`; log.innerHTML = `<span class="mr-3">${new Date().toLocaleTimeString()}</span> ${msg}`; list.appendChild(log); list.scrollTop = list.scrollHeight; }
function processFile(f) { const r = new FileReader(); r.onload = e => { manualImages.push({ id: crypto.randomUUID(), data: e.target.result.split(',')[1], src: e.target.result }); renderThumbs(); }; r.readAsDataURL(f); }
function renderThumbs() { const c = document.getElementById('thumbContainer'); if(!c) return; c.innerHTML = manualImages.map(i => `<div class="thumb-item" onclick="event.stopPropagation()"><img src="${i.src}" class="w-full h-full object-cover"><div class="thumb-remove" onclick="window.removeManualImage('${i.id}')">×</div></div>`).join(''); }
function processCardFile(f) { const r = new FileReader(); r.onload = e => { cardImages.push({ id: crypto.randomUUID(), data: e.target.result.split(',')[1], src: e.target.result }); renderCardThumbs(); }; r.readAsDataURL(f); }
function renderCardThumbs() { const c = document.getElementById('cardThumbContainer'); if(!c) return; c.innerHTML = cardImages.map(i => `<div class="thumb-item" onclick="event.stopPropagation()"><img src="${i.src}" class="w-full h-full object-cover"><div class="thumb-remove" onclick="window.removeCardImage('${i.id}')">×</div></div>`).join(''); }
// ═══════════════════════════════════════════════════════════
// FIX-B (v52.180): 金曜08:00前の最新データ選択ロジック
// ─ 毎週金曜 08:00 を基準として、その時刻より前のデータを使用
// ─ 08:00以降のデータは翌週の基準点として扱わない
// ═══════════════════════════════════════════════════════════
function getFridayWeeklyHistory(historyArr) {
  // 1. 全 'latest' データをdateで昇順ソート
  const allLatest = (historyArr || [])
    .filter(x => x.dataType === 'latest' && x.date)
    .sort((a, b) => new Date(a.date) - new Date(b.date));

  if (allLatest.length === 0) return [];

  // 2. 各エントリのdateから「その週の金曜08:00」を計算
  //    金曜 = 5 (0=日, 1=月, ... 5=金, 6=土)
  //    基準: データのdateが含まれる週(月-日)の金曜08:00
  function getWeeklyFridayKey(dateStr) {
    const d = new Date(dateStr);
    // 日曜起点 → 月曜起点に調整
    const day = d.getDay(); // 0=Sun...6=Sat
    // その週の金曜を算出 (day=5→+0, day=6→+6, day=0→+5, day=1→+4...)
    const daysToFriday = (5 - day + 7) % 7;
    const fri = new Date(d);
    fri.setDate(d.getDate() + daysToFriday);
    fri.setHours(8, 0, 0, 0);
    return fri.getTime();
  }

  // 3. 各エントリを「対応する金曜08:00の週キー」でグループ化
  //    ルール: エントリのdateが金曜08:00 **より前** なら当週、以降なら翌週へ
  const weekBuckets = {};
  for (const entry of allLatest) {
    const d = new Date(entry.date);
    const fridayTs = getWeeklyFridayKey(entry.date);
    let weekKey;
    if (d.getTime() < fridayTs) {
      // 金曜08:00より前 → 当週バケット
      weekKey = fridayTs;
    } else {
      // 金曜08:00以降 → 翌週バケット (7日後の金曜)
      weekKey = fridayTs + 7 * 24 * 60 * 60 * 1000;
    }
    if (!weekBuckets[weekKey]) weekBuckets[weekKey] = [];
    weekBuckets[weekKey].push(entry);
  }

  // 4. 各バケットから「金曜08:00直前の最新エントリ」を1件選択
  const sortedKeys = Object.keys(weekBuckets).map(Number).sort((a, b) => a - b);
  const result = [];
  for (const wk of sortedKeys) {
    const bucket = weekBuckets[wk];
    const fridayTs = wk;
    // 金曜08:00より前のデータから最も遅い (=直前の) ものを選択
    const candidates = bucket.filter(x => new Date(x.date).getTime() < fridayTs);
    if (candidates.length > 0) {
      const best = candidates.reduce((a, b) =>
        new Date(a.date).getTime() > new Date(b.date).getTime() ? a : b
      );
      const fridayDate = new Date(fridayTs);
      result.push({
        ...best,
        _weekLabel: fridayDate.toLocaleDateString('ja-JP', { month:'2-digit', day:'2-digit' }) + '(金)'
      });
    }
  }
  return result;
}

function renderChart() {
  const cvs = document.getElementById('performanceChart');
  if(!cvs || !selectedPlayerForChart) return;
  if (chartMetric === 'ai') return;
  const ctx = cvs.getContext('2d');
  const p = playerMaster.find(x => x.name === selectedPlayerForChart);

  // 金曜08:00前の週次データを取得
  const weeklyData = getFridayWeeklyHistory(p.history || []);
  // フォールバック: 週次データがなければ全 latest データを使用
  const h = weeklyData.length > 0
    ? weeklyData
    : (p.history||[]).filter(x => x.dataType === 'latest');

  const labels = h.map(x => x._weekLabel || x.date);
  const values = h.map(x => x[chartMetric] || 0);

  if(chartInstance) chartInstance.destroy();
  chartInstance = new Chart(ctx, {
    type: 'line',
    data: {
      labels,
      datasets: [{
        label: chartMetric,
        data: values,
        borderColor: '#10b981',
        backgroundColor: 'rgba(16,185,129,0.08)',
        tension: 0.4,
        pointRadius: 4,
        pointHoverRadius: 6
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        tooltip: {
          callbacks: {
            title: (items) => {
              const idx = items[0].dataIndex;
              const entry = h[idx];
              return entry._weekLabel
                ? `週次 ${entry._weekLabel}\n(${entry.date})`
                : entry.date;
            }
          }
        }
      }
    }
  });
}


// キューカード詳細表示トグル (Phase 4.11.55)
window.toggleQueueCardDetail = function(index) {
  const detailDiv = document.getElementById('queueDetail' + index);
  if (!detailDiv) return;
  
  const isHidden = detailDiv.classList.contains('hidden');
  detailDiv.classList.toggle('hidden');
  
  // アイコン変更
  const icon = document.getElementById('queueDetailIcon' + index);
  if (icon) {
    icon.textContent = isHidden ? '▼' : '▶';
  }
};

function renderAutoQueueCards() { const container = document.getElementById('queueCardContainer'); if (!container) return; const processedCount = autoAnalysisQueue.filter(x => x.status === 'done' || x.status === 'error' || x.status === 'aborted').length; const totalCount = autoAnalysisQueue.length; const percent = totalCount > 0 ? Math.round((processedCount / totalCount) * 100) : 0; const progressBar = document.getElementById('globalProgressBarContainer'); const progressBarFill = document.getElementById('globalProgressBar'); const progressText = document.getElementById('globalProgressText'); const progressLabel = document.getElementById('queueProgressText'); 
// v50.66 Fix: Use global time info
const timeLabel = currentBatchTimeInfo ? ` (${currentBatchTimeInfo})` : "";

if (isBatchProcessing || processedCount > 0) { progressBar.classList.remove('hidden'); progressBarFill.style.width = `${percent}%`; progressText.innerText = `${percent}% (${processedCount}/${totalCount})${timeLabel}`; progressLabel.innerText = isBatchProcessing ? "PROCESSING..." : (isStopRequested ? "ABORTED" : "COMPLETED"); } else { progressBar.classList.add('hidden'); progressLabel.innerText = "WAITING..."; } const startBtn = document.getElementById('autoBatchStartBtn'); const stopBtn = document.getElementById('autoBatchStopBtn'); if (isBatchProcessing) { startBtn.classList.add('hidden'); stopBtn.classList.remove('hidden'); if (!isStopRequested) { stopBtn.innerText = "⛔ 中断"; stopBtn.disabled = false; } } else { startBtn.classList.remove('hidden'); stopBtn.classList.add('hidden'); } if(autoAnalysisQueue.length === 0) { container.innerHTML = `<div class="h-full flex flex-col items-center justify-center opacity-20"><div class="text-7xl mb-4">📋</div><p>EMPTY QUEUE</p></div>`; } else { container.innerHTML = autoAnalysisQueue.map((item, i) => {
    if (!item.logs) item.logs = [];
    const statusBadge = item.status === 'done' ? '<span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-bold">✅ 完了</span>' :
                        item.status === 'processing' ? '<span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-bold animate-pulse">⏳ 処理中</span>' :
                        item.status === 'error' ? '<span class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-xs font-bold">❌ エラー</span>' :
                        item.status === 'aborted' ? '<span class="px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-xs font-bold">⏹️ 中止</span>' :
                        '<span class="px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-xs font-bold">⏸️ 待機中</span>';
    const retryBtnHtml = (item.status === 'error' || item.status === 'aborted') && !isBatchProcessing ? `<button onclick="window.retryAdminQueueItem(${autoAnalysisQueue.indexOf(item)})" class="mt-2 text-xs bg-orange-500 hover:bg-orange-600 text-white px-3 py-1 rounded shadow-sm font-bold transition-all">🔄 再解析</button>` : '';
    const playerCountDisplay = item.players && item.players.length > 0 ? `<div class="text-sm text-indigo-600 font-semibold mt-2">登録選手: ${item.players.length}人</div>` : '';
    const logsHtml = item.logs.length > 0 ? item.logs.map(log => `<div class="${log.colorClass} py-2 px-4 border-l-4 rounded text-xs leading-relaxed mb-2"><span class="text-gray-500">${log.time}</span> ${log.icon} ${log.message}</div>`).join('') : '<div class="text-center text-gray-400 text-xs py-4">ログはまだありません</div>';
    return `<div class="queue-card bg-white rounded-xl shadow-md border border-gray-200 overflow-hidden transition-all duration-300 hover:shadow-xl mb-3"><div class="p-5 cursor-pointer hover:bg-gray-50 transition-colors" onclick="window.toggleQueueCardDetail(${i})"><div class="flex justify-between items-center"><div class="flex items-center gap-3"><span id="queueDetailIcon${i}" class="text-gray-400 text-lg transition-transform duration-300" style="display: inline-block;">▶</span><h3 class="text-lg font-bold text-gray-800">${item.name}</h3></div>${statusBadge}</div>${playerCountDisplay}${retryBtnHtml}</div><div id="queueDetail${i}" class="hidden border-t border-gray-200 bg-gray-50"><div class="p-5"><h4 class="text-sm font-bold text-gray-700 mb-3 flex items-center gap-2"><span class="text-indigo-600">📋</span> 処理ログ</h4><div class="space-y-1 max-h-80 overflow-y-auto custom-scrollbar">${logsHtml}</div></div></div></div>`;
  }).join(''); } const isFinished = !isBatchProcessing && autoAnalysisQueue.some(x => x.status === 'done'); const saveBtn = document.getElementById('batchApplyBtn'); if (saveBtn) {   if (isFinished || batchPendingResults.latest.length > 0) {     saveBtn.disabled = false;     saveBtn.className = 'bg-emerald-600 hover:bg-emerald-700 text-white px-10 py-4 rounded-2xl shadow-xl uppercase transition cursor-pointer animate-pulse';     saveBtn.title = '解析完了！クリックしてDBに反映してください';     saveBtn.innerHTML = '✅ DB に反映';   } else {     saveBtn.disabled = true;     saveBtn.className = 'bg-slate-300 text-slate-500 px-10 py-4 rounded-2xl shadow-xl uppercase transition cursor-not-allowed';     saveBtn.title = 'AIで解析後にアクティブになります';     saveBtn.innerHTML = '📋 DB に反映（解析後にアクティブ）';   } } updateTotalParsedCount(); }

// Phase 4.11.55: カード展開/折りたたみ機能
window.toggleQueueCardDetail = function(index) {
  const detailDiv = document.getElementById('queueDetail' + index);
  const iconSpan = document.getElementById('queueDetailIcon' + index);
  
  if (!detailDiv) return;
  
  detailDiv.classList.toggle('hidden');
  
  if (iconSpan) {
    if (detailDiv.classList.contains('hidden')) {
      iconSpan.textContent = '▶';
      iconSpan.style.transform = 'rotate(0deg)';
    } else {
      iconSpan.textContent = '▼';
      iconSpan.style.transform = 'rotate(90deg)';
    }
  }
};

window.renderAutoQueueCards = renderAutoQueueCards;
function switchAIMode(mode) { document.getElementById('ai-mode-individual').classList.toggle('active', mode === 'individual'); document.getElementById('ai-mode-query').classList.toggle('active', mode === 'query'); document.getElementById('ai-panel-individual').classList.toggle('hidden', mode !== 'individual'); document.getElementById('ai-panel-query').classList.toggle('hidden', mode !== 'query'); }

async function runAIQuery() {
    const q = document.getElementById('aiQueryInput').value.trim();
    if(!q) return;
    const key = window.getApiKey();
    if(!key) return showMessage("API Key Missing", "error");
    const scope = document.querySelector('input[name="aiQueryScope"]:checked').value;
    const targetPlayers = scope === 'filtered' ? getFilteredPlayers() : playerMaster;
    if(targetPlayers.length === 0) return showMessage("対象データがありません", "error");
    const btn = document.getElementById('aiQueryBtn'); const stopBtn = document.getElementById('aiStopBtn'); const out = document.getElementById('aiQueryOutput'); const progressArea = document.getElementById('aiQueryProgressArea'); const statusText = document.getElementById('aiQueryStatusText');
    btn.disabled = true; btn.classList.add('hidden'); stopBtn.classList.remove('hidden'); progressArea.classList.remove('hidden'); statusText.innerText = 'AI思考中...'; out.innerHTML = ''; 
    currentAIQueryController = new AbortController();
    const contextData = targetPlayers.map(p => {
        const l = (p.history||[]).filter(h=>h.dataType==='latest').pop() || {};
        const lf = (p.history||[]).filter(h=>h.dataType==='lifetime').pop() || {};
        const team = teamMaster.find(t=>t.id===p.teamId)?.name || "未所属";
        return { name: p.name, nick: p.nickname || "", team: team, labels: p.labels || [], latest: { n: l.number, r: l.overall||l.rating||0, g: l.goals||0, a: l.assists||0, app: l.apps||0, wr: l.winRate||0, cs: l.cleanSheets||0, y: l.yellow||0, rd: l.red||0, st: l.status||"在籍" }, life: { g: lf.goals||0, a: lf.assists||0, app: lf.apps||0, cs: lf.cleanSheets||0, y: lf.yellow||0, rd: lf.red||0 } };
    });
    try {
        const rankingCtx = await window.getTournamentRankingContext().catch(()=>'');
        const payload = { contents: [{ parts: [ { text: `あなたはeスポーツリーグのデータベースアナリストです。以下のJSONデータ（選手リスト）を分析し、ユーザーの質問に答えてください。${rankingCtx ? '\\n\\n' + rankingCtx : ''}\n\n【重要：用語定義】\n・「特殊カード」や「カード」という質問は、Yellow/Redカードではなく、必ず「labels (例: TOTW, POTM)」を指すものとして回答せよ。\n\nデータキー説明: n:背番号(Number), r:総合(Rating), g:得点(Goals), a:アシスト(Assists), app:出場数, wr:勝率(WinRate), cs:完封(CleanSheets), y:警告(YellowCards), rd:退場(RedCards), st:在籍状況, nick:ニックネーム, labels:特殊カード\n\n質問: "${q}". 回答は簡潔かつ専門的に。ランキングを出力する場合は、必ずMarkdownのテーブル記法（| 列 | 列 |...）を使用してください。` }, { text: JSON.stringify(contextData).substring(0, 900000) } ] }] };
        statusText.innerText = '回答生成中...';
        const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${key}`, { method: 'POST', body: JSON.stringify(payload), headers: { 'Content-Type': 'application/json' }, signal: currentAIQueryController.signal });
        const json = await res.json();
        const ans = json.candidates?.[0]?.content?.parts?.[0]?.text || "回答を生成できませんでした。";
        currentAIQueryText = ans; document.getElementById('aiExportQueryBtn').disabled = false; out.innerHTML = formatMarkdown(ans);
    } catch(e) { if (e.name === 'AbortError') { out.innerHTML = `<span class="text-orange-500 font-bold">⚠️ 処理が中断されました。</span>`; } else { out.innerHTML = `<span class="text-red-500">Error: ${e.message}</span>`; } } finally { btn.disabled = false; btn.classList.remove('hidden'); stopBtn.classList.add('hidden'); progressArea.classList.add('hidden'); currentAIQueryController = null; }
}

function stopAIQuery() { if (currentAIQueryController) { currentAIQueryController.abort(); const statusText = document.getElementById('aiQueryStatusText'); if(statusText) statusText.innerText = "中断処理中..."; } }
function clearAIQuery() { document.getElementById('aiQueryInput').value = ''; document.getElementById('aiQueryOutput').innerHTML = ''; currentAIQueryText = ""; document.getElementById('aiExportQueryBtn').disabled = true; document.getElementById('aiQueryProgressArea').classList.add('hidden'); document.getElementById('aiQueryBtn').classList.remove('hidden'); document.getElementById('aiStopBtn').classList.add('hidden'); if (currentAIQueryController) { currentAIQueryController.abort(); currentAIQueryController = null; } }

async function startManualAnalysis() { 
    const key = window.getApiKey(); const tid = document.getElementById('manualTeamSelect').value; 
    if (!key || manualImages.length === 0 || !tid || tid === 'all') return showMessage("項目不足です", "error"); 
    const btn = document.getElementById('manualAnalyzeBtn'); btn.disabled = true; btn.classList.add('btn-analyzing'); btn.innerHTML = '🤖 画像解析を実行中...'; addAnalysisLog("🤖 手動画像解析を実行中...", "scanning"); 
    try { 
        updateProgress('adminManual', 10, "1/4: 画像データの最適化と送信準備中..."); await delay(600); 
        const prompt = '画像内の選手スタッツを全て抽出せよ。JSON形式、スキーマ: { "latest": [ {"name": "PSID", "nickname": "表示名(カカシ等)", "number": 0, "rating": 0, "apps": 0, "winRate": 0, "goals": 0, "assists": 0, "cleanSheets": 0, "yellow": 0, "red": 0} ], "lifetime": [ {"name": "PSID", "nickname": "表示名", "apps": 0, "winRate": 0, "goals": 0, "assists": 0, "cleanSheets": 0, "yellow": 0, "red": 0, "status": "在籍 or 退団"} ] }。Rules: 1. If number is missing, use "-".'; 
        const payload = { contents: [{ parts: [{ text: prompt }, ...manualImages.map(img => ({ inlineData: { mimeType: "image/png", data: img.data } }))] }], generationConfig: { responseMimeType: "application/json" } }; 
        updateProgress('adminManual', 40, "2/4: Gemini AIモデルへ画像データを送信中..."); await delay(400); 
        updateProgress('adminManual', 75, "3/4: AIが高度な画像解析と文字認識を実行中..."); 
        const resp = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${key}`, { method: 'POST', body: JSON.stringify(payload), headers: { 'Content-Type': 'application/json' } }); 
        updateProgress('adminManual', 90, "4/4: 解析完了。データの抽出とUI構築中..."); 
        const data = await resp.json(), text = data.candidates?.[0]?.content?.parts?.[0]?.text; await delay(500); 
        updateProgress('adminManual', 100, "処理完了！"); 
        if (text) { 
            manualPendingResults = parseGeminiJSON(text); // Fix v50.60
            targetAutoTeamId = tid; batchPendingResults = manualPendingResults; 
            document.getElementById('resultHeaderArea').classList.remove('hidden'); updateTotalParsedCount(); 
            const saveBtn = document.getElementById('batchApplyBtn'); if(saveBtn) { saveBtn.disabled = false; saveBtn.className = 'bg-emerald-600 hover:bg-emerald-700 text-white px-10 py-4 rounded-2xl shadow-xl uppercase transition cursor-pointer animate-pulse'; saveBtn.title = '解析完了！クリックしてDBに反映してください'; saveBtn.innerHTML = `✅ DB に反映`; } addAnalysisLog("画像解析完了", "done"); 
        } 
    } catch (e) { showMessage("解析エラー: " + e.message, "error"); addAnalysisLog("解析失敗", "error"); updateProgress('adminManual', 0, "エラーが発生しました"); } finally { btn.disabled = false; btn.classList.remove('btn-analyzing'); btn.innerHTML = '🚀 解析を開始'; setTimeout(() => hideProgress('adminManual'), 2000); } 
}

async function generateAIEval() { 
    if (!selectedPlayerForChart) return showMessage("選手を選択してください", "error"); const p = playerMaster.find(x => x.name === selectedPlayerForChart); const display = document.getElementById('aiTextDisplay'); const btn = document.getElementById('aiEvaluateBtn'); const lang = document.getElementById('aiLanguageSelect').value; const key = window.getApiKey(); if(!key) return showMessage("API Key Missing", "error"); 
    display.innerHTML = '<div class="flex items-center justify-center h-full"><span class="animate-bounce">⚽ 分析ユニット稼働中...</span></div>'; btn.disabled = true; 
    try { 
        const payload = { contents: [{ parts: [{ text: `eスポーツ選手「${p.name}」の分析をプロの視点で行え。言語:${lang}。履歴: ${JSON.stringify(p.history)}。データを示す場合はMarkdownのテーブルを使ってください。` }] }] }; 
        const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${key}`, { method: 'POST', body: JSON.stringify(payload), headers: { 'Content-Type': 'application/json' } }); 
        const json = await res.json(); const text = json.candidates[0].content.parts[0].text; currentAIIndividualText = text; document.getElementById('aiExportIndBtn').disabled = false; display.innerHTML = `<div class="fade-in leading-loose">${formatMarkdown(text)}</div>`; 
    } catch (e) { display.innerHTML = `<p class="text-red-500">エラー発生: ${e.message}</p>`; } finally { btn.disabled = false; } 
}

async function startCardAnalysis() { 
    const key = window.getApiKey(); if (!key || cardImages.length === 0) return showMessage("画像とAPIキーが必要です", "error"); 
    const btn = document.getElementById('cardAnalyzeBtn'); btn.disabled = true; btn.classList.add('btn-analyzing'); btn.innerHTML = '🤖 画像解析を実行中...'; 
    try { 
        updateProgress('cardManual', 10, "1/4: 画像データの最適化と送信準備中..."); await delay(600); 
        const prompt = `画像から記事タイトル(rawTitle)と選手IDリスト(players)を抽出してください。

【抽出ルール】
1. **rawTitle**: 画像内に表示されているイベント名やタイトルをそのまま抽出（例: "EAFC26 eS-League JAPAN 17th TOTW11"）
2. **players**: カード下部の太字のプレイヤーID（PSID）を漏れなく配列に格納

【出力JSONスキーマ】
{
  "rawTitle": "画像内のイベント名/タイトル（必須）",
  "players": ["id1", "id2", "id3"]
}

【重要】eventName（略称）は生成しないでください。rawTitleをそのまま返してください。`; 
        const payload = { contents: [{ parts: [{ text: prompt }, ...cardImages.map(img => ({ inlineData: { mimeType: "image/png", data: img.data } }))] }], generationConfig: { responseMimeType: "application/json" } }; 
        updateProgress('cardManual', 40, "2/4: Gemini AIモデルへ画像データを送信中..."); await delay(400); 
        updateProgress('cardManual', 75, "3/4: AIが高度な画像解析と文字認識を実行中..."); 
        const resp = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${key}`, { method: 'POST', body: JSON.stringify(payload), headers: { 'Content-Type': 'application/json' } }); 
        updateProgress('cardManual', 90, "4/4: 解析完了。データの抽出とUI構築中..."); 
        const data = await resp.json(); const text = data.candidates?.[0]?.content?.parts?.[0]?.text; await delay(500); 
        updateProgress('cardManual', 100, "処理完了！"); 
        if (text) { 
            const res = parseGeminiJSON(text); // Fix v50.60
            await processCardAnalysisResult(res); 
        } 
    } catch (e) { showMessage("解析エラー: " + e.message, "error"); updateProgress('cardManual', 0, "エラーが発生しました"); } finally { btn.disabled = false; btn.classList.remove('btn-analyzing'); btn.innerHTML = '🚀 画像解析を実行する'; setTimeout(() => hideProgress('cardManual'), 2000); } 
}

async function processCardAnalysisResult(res) { 
    const rawTitle = res.rawTitle || res.eventName;
  const publishDate = res.publishDate || new Date().toISOString().split('T')[0];
  const label = generateCardLabel(rawTitle, publishDate);
  console.log("[v52.162] Auto-generated label:", label); 
    if (!label || !res.players || res.players.length === 0) return showMessage("データが抽出できませんでした", "error"); 
    currentCardBatchConflicts = []; let conflicts = []; 
    res.players.forEach(psid => { 
        let exactMatch = playerMaster.find(p => p.name === psid); 
        if (exactMatch) conflicts.push({ newPsid: psid, simMatch: exactMatch, isExact: true }); 
        else { let simMatch = playerMaster.find(p => window.normalizeString(p.name) === window.normalizeString(psid)); conflicts.push({ newPsid: psid, simMatch: simMatch || null, isExact: false }); } 
    }); 
    currentCardBatchConflicts.push({ eventName: label, conflicts: conflicts }); 
    if (conflicts.length > 0) { document.getElementById('cardDetectCountBadge').innerText = `検出: ${conflicts.length}人`; window.renderCardMergeModal(); document.getElementById('cardMergeConfirmModal').classList.replace('hidden', 'flex'); } else { showMessage(`検出結果が空です`, "error"); } 
}

window.renderCardMergeModal = function() { 
    const container = document.getElementById('cardMergeConflictList'); const headerDiv = document.getElementById('cardMergeModalHeaderLeft'); 
    if (headerDiv && !document.getElementById('cardMergeGlobalSort')) { const sortUI = document.createElement('div'); sortUI.className = "flex items-center gap-2 mt-4 bg-blue-600/30 px-3 py-1.5 rounded-lg w-fit border border-blue-400/30"; sortUI.innerHTML = ` <span class="text-[10px] text-blue-100 font-bold uppercase tracking-widest">プルダウン表示順:</span> <select id="cardMergeGlobalSort" onchange="window.changeCardMergeSortMode(this.value)" class="text-xs text-blue-900 bg-white px-2 py-1 rounded outline-none cursor-pointer"> <option value="az" ${window.cardMergeSelectSortMode === 'az' ? 'selected' : ''}>アルファベット順 (A-Z)</option> <option value="team" ${window.cardMergeSelectSortMode === 'team' ? 'selected' : ''}>チーム別グループ化</option> </select> `; headerDiv.appendChild(sortUI); } 
    container.innerHTML = currentCardBatchConflicts.map((batch, eIdx) => { 
        // v50.63: Added Link Button
        const linkBtn = batch.newsId ? `<a href="https://es-league.games/japan/news/data.php?newsno=${batch.newsId}" target="_blank" class="ml-auto text-[10px] bg-white text-blue-600 px-3 py-1.5 rounded-lg border border-blue-200 hover:bg-blue-50 flex items-center gap-1 font-bold shadow-sm">📄 記事を確認</a>` : '';
        // FIX6: 記事日付 vs DB日付の比較バッジを生成
        const articleDateRaw = batch.publishDate || '';
        const articleDateDisp = articleDateRaw ? articleDateRaw.replace(/-/g, '.') : '日付不明';
        // batch.conflicts から最初のマッチした選手のDB更新日を取得
        const firstMatch = batch.conflicts.find(c => c.simMatch);
        const dbPlayer = firstMatch ? firstMatch.simMatch : null;
        const dbDateRaw = dbPlayer ? (dbPlayer.updatedAt || dbPlayer.createdAt || '') : '';
        const dbDateDisp = dbDateRaw ? dbDateRaw.substring(0, 10).replace(/-/g, '.') : 'DB未登録';
        const dateBadge = `<div class="flex items-center gap-2 mt-1">
            <span class="text-[9px] bg-blue-100 text-blue-700 px-2 py-1 rounded-full border border-blue-200 font-bold">記事: ${articleDateDisp}</span>
            ${dbDateRaw ? `<span class="text-[9px] text-slate-400 font-bold">vs</span><span class="text-[9px] bg-slate-100 text-slate-600 px-2 py-1 rounded-full border border-slate-200 font-bold">DB: ${dbDateDisp}</span>` : '<span class="text-[9px] bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full border border-yellow-200">DB未登録</span>'}
        </div>`;
        
        const conflictHtml = batch.conflicts.map((c, pIdx) => { 
            const simName = c.simMatch ? c.simMatch.name : 'new'; 
            const bgClass = c.isExact ? 'bg-emerald-50 border-emerald-100' : 'bg-blue-50 border-blue-100'; 
            const badgeColor = c.isExact ? 'bg-emerald-500' : 'bg-blue-500'; 
            const textColor = c.isExact ? 'text-emerald-900' : 'text-blue-900'; 
            const teamHint = c.teamInfo ? `<div class="text-[9px] text-slate-500 mt-1">抽出チーム: ${c.teamInfo}</div>` : ''; 
            // v50.63: Added Checkbox for partial execution
            const isChecked = c.isExact ? 'checked' : ''; 
            
            return ` <div class="bg-white border-2 ${c.isExact ? 'border-emerald-200' : 'border-blue-200'} rounded-2xl p-6 shadow-sm flex flex-col gap-4 relative"> 
                <div class="absolute top-4 right-4 flex flex-col gap-2">
                    <label class="flex items-center gap-2 cursor-pointer bg-slate-50 px-3 py-1 rounded-lg border border-slate-200 hover:border-blue-400 transition">
                        <input type="checkbox" id="cardMergeCheck_${eIdx}_${pIdx}" class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500" ${isChecked}>
                        <span class="text-[10px] font-bold text-slate-600">この項目を適用</span>
                    </label>
                    ${c.teamInfo ? `
                    <label class="flex items-center gap-2 cursor-pointer bg-emerald-50 px-3 py-1 rounded-lg border border-emerald-200 hover:border-emerald-400 transition">
                        <input type="checkbox" id="updateTeamCheck_${eIdx}_${pIdx}" class="w-4 h-4 text-emerald-600 rounded focus:ring-emerald-500" checked>
                        <span class="text-[10px] font-bold text-emerald-700">チーム更新</span>
                    </label>
                    ` : ''}
                </div>
                <div class="flex items-center justify-between mt-6"> <div class="${bgClass} p-4 rounded-xl border flex-1 relative"> <span class="absolute -top-3 left-4 ${badgeColor} text-white text-[9px] px-2 py-1 rounded">カード検出PSID</span> <div class="font-bold text-lg ${textColor} mt-2">${c.newPsid}</div> ${teamHint} </div> <div class="mx-6 text-2xl text-slate-300 font-bold">➡</div> <div class="flex-1"> <div class="flex justify-between items-end mb-2"> <label class="text-[10px] text-slate-500 block uppercase font-bold tracking-widest">紐付ける既存の選手を選択</label> <div class="relative"> <span class="absolute left-2 top-1/2 -translate-y-1/2 text-slate-400 text-xs">🔍</span> <input type="text" placeholder="名前・チーム・ラベルで検索..." class="text-[10px] pl-6 pr-2 py-1.5 border-2 border-slate-200 rounded-lg outline-none focus:border-blue-500 transition shadow-sm w-48" oninput="window.filterMergeSelectOptions(this, 'cardMergeSelect_${eIdx}_${pIdx}')"> </div> </div> <select id="cardMergeSelect_${eIdx}_${pIdx}" class="w-full bg-slate-50 border-2 border-slate-200 rounded-xl p-3 text-sm outline-none focus:border-blue-500 transition-colors cursor-pointer"> ${window.generateCardMergeOptionsHtml(simName)} </select> </div> </div> </div> `; 
        }).join(''); 
        return ` <div class="mb-8 border-4 border-blue-100 rounded-[2rem] overflow-hidden shadow-sm"> <div class="bg-blue-100 px-8 py-4 flex flex-col gap-2 border-b border-blue-200"> <div class="flex items-center gap-4"><span class="text-[11px] text-blue-800 font-bold truncate max-w-xs">${batch.rawTitle || batch.eventName || '記事'}</span>${dateBadge}</div><div class="flex items-center gap-4"><label class="text-xs text-blue-800 uppercase tracking-widest whitespace-nowrap">付与するラベル名:</label>
      <div style="margin: 10px 0; padding: 10px; background: #f0f0f0; border-radius: 5px;">
        <strong>紐付け方法を選択:</strong>
        <div style="margin-top: 8px;">
          <label style="display: block; margin: 5px 0;">
            <input type="radio" name="mergeOption_${eIdx}" value="new" checked>
            新しく発見した選手データを優先 <span style="color: blue;">(推奨: 記事が新しい場合)</span>
          </label>
          <label style="display: block; margin: 5px 0;">
            <input type="radio" name="mergeOption_${eIdx}" value="keep">
            過去に登録されている選手データを保持
          </label>
          <label style="display: block; margin: 5px 0;">
            <input type="radio" name="mergeOption_${eIdx}" value="add">
            新しい選手として追加 (同姓同名の別人)
          </label>
          <label style="display: block; margin: 5px 0; background:#fff0f0; padding:4px 8px; border-radius:4px; border:1px solid #ffcccc;">
            <input type="radio" name="mergeOption_${eIdx}" value="ignore">
            <span style="color:#c0392b; font-weight:bold;">❌ 無視してマージしない（この選手をスキップ）</span>
          </label>
        </div>
        <div id="mergeRecommend_${eIdx}" style="margin-top: 5px; font-size: 0.9em; color: #666;"></div>
      </div> <input type="text" id="pendingCardLabelInput_${eIdx}" value="${generateCardLabel(batch.rawTitle || batch.eventName, batch.publishDate || '')}" class="flex-1 bg-white border-2 border-blue-200 rounded-xl p-3 text-sm outline-none focus:border-blue-500 text-blue-900 shadow-sm" placeholder="例: TOTW04"> ${linkBtn} </div> 
        
        <!-- v50.65 Add Select All -->
        <div class="flex justify-end px-8 pt-4 bg-white">
            <label class="flex items-center gap-2 cursor-pointer bg-slate-50 px-3 py-1.5 rounded-lg border border-slate-200 hover:border-blue-400 transition shadow-sm">
                <input type="checkbox" onchange="window.toggleCardMergeBatchChecks(${eIdx}, this.checked)" class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500">
                <span class="text-xs font-bold text-slate-600">このブロックをすべて選択 / 解除</span>
            </label>
        </div>

        <div class="p-6 bg-slate-50 space-y-4"> ${conflictHtml} </div> </div> `; 
    }).join(''); 
};

// v50.63 Fix: Logic for partial execution (Save & Continue)
async function executeCardMergeSave() {
    let addedLabels = 0; let addedPlayers = 0; let hasError = false;
    let processedIndices = []; // To track which items to remove
    
    // v52.166.1: チーム更新カウンターをローカル変数として初期化
    let teamUpdateCount = {success: 0, skip: 0, fail: 0};

    // Team finding helper
    const findTeam = (name) => {
        if (!name) return null;
        const nName = window.normalizeString(name);
        let t = teamMaster.find(tm => window.normalizeString(tm.name) === nName);
        if (t) return t;
        if (nName.length >= 3) {
            t = teamMaster.find(tm => {
                const tmNorm = window.normalizeString(tm.name);
                return tmNorm.startsWith(nName) || nName.startsWith(tmNorm);
            });
            if (t) return t;
            t = teamMaster.find(tm => {
                const tmNorm = window.normalizeString(tm.name);
                return tmNorm.includes(nName) || nName.includes(tmNorm);
            });
            if (t) return t;
        }
        return null;
    };

    // Iterate through batches
    for (let eIdx = 0; eIdx < currentCardBatchConflicts.length; eIdx++) {
        const batch = currentCardBatchConflicts[eIdx];
        const finalLabelInput = document.getElementById(`pendingCardLabelInput_${eIdx}`);
        const finalLabel = finalLabelInput ? finalLabelInput.value.trim() : 
        generateCardLabel(batch.rawTitle || batch.eventName, batch.publishDate || '');
        
        // Identify processed conflicts in this batch
        const conflictsToRemove = [];
        const activeConflicts = [];

        for (let pIdx = 0; pIdx < batch.conflicts.length; pIdx++) {
            const checkbox = document.getElementById(`cardMergeCheck_${eIdx}_${pIdx}`);
            if (checkbox && checkbox.checked) {
                if (!finalLabel) { hasError = true; break; } // Validation
                
                // Process Item
                let existingLabel = customLabels.find(l => l.name === finalLabel);
                if (!existingLabel) { customLabels.push({ name: finalLabel, type: 'special' }); addedLabels++; } 
                else if (existingLabel.type !== 'special') { existingLabel.type = 'special'; }

                const c = batch.conflicts[pIdx];
                const select = document.getElementById(`cardMergeSelect_${eIdx}_${pIdx}`); 
                const selectedVal = select.value;

                if (selectedVal === 'new') {
                    let tid = ""; 
                    if (c.teamInfo) { 
                        const teamObj = findTeam(c.teamInfo); 
                        if (teamObj) tid = teamObj.id; 
                    }
                    playerMaster.push({ name: c.newPsid, nickname: "", teamId: tid, history: [], labels: [finalLabel] }); addedPlayers++;
                } else { 
                    const existP = playerMaster.find(p => p.name === selectedVal); 
                    if (existP) { 
                        if (!existP.labels) existP.labels = []; 
                        if (!existP.labels.includes(finalLabel)) existP.labels.push(finalLabel); 
                        
                        // v52.166.1: 個別チェックボックスでチーム更新（ローカルカウンター使用）
                        const updateTeamCheck = document.getElementById(`updateTeamCheck_${eIdx}_${pIdx}`);
                        if (updateTeamCheck && updateTeamCheck.checked) {
                            if (c.teamInfo) {
                                const detectedTeam = findTeam(c.teamInfo);
                                if (detectedTeam) {
                                    const oldTeam = existP.team || '(未設定)';
                                    existP.team = detectedTeam.name;
                                    existP.teamId = detectedTeam.id;
                                    teamUpdateCount.success++;
                                    console.log(`[v52.166.1] チーム更新: ${existP.name} | ${oldTeam} → ${detectedTeam.name}`);
                                } else {
                                    teamUpdateCount.fail++;
                                    console.warn(`[v52.166.1] チーム未発見: ${c.teamInfo}`);
                                }
                            } else {
                                teamUpdateCount.skip++;
                                console.log(`[v52.166.1] チーム情報なし: ${existP.name} (スキップ)`);
                            }
                        }
                    } 
                }
                conflictsToRemove.push(pIdx);
            } else {
                activeConflicts.push(batch.conflicts[pIdx]);
            }
        }
        
        if (hasError) break;

        // Update batch conflicts (keep only unchecked ones)
        batch.conflicts = activeConflicts;
    }

    if (hasError) return showMessage("空白のラベル名があります", "error");

    // Remove empty batches
    currentCardBatchConflicts = currentCardBatchConflicts.filter(b => b.conflicts.length > 0);

    if (addedLabels > 0) { renderLabelManagerList(); renderFilterChips(); }
    
    await saveToCloud();
    
    if (currentCardBatchConflicts.length === 0) {
        document.getElementById('cardMergeConfirmModal').classList.replace('flex', 'hidden'); 
        // v52.166.1: チーム更新結果を追加（ローカルカウンター使用）
        let completeMsg = `全件処理完了 (新規ラベル:${addedLabels}, 新規選手:${addedPlayers})`;
        if (teamUpdateCount.success > 0 || teamUpdateCount.skip > 0 || teamUpdateCount.fail > 0) {
            completeMsg += ` | チーム更新: ${teamUpdateCount.success}名`;
            if (teamUpdateCount.skip > 0) completeMsg += ` (スキップ: ${teamUpdateCount.skip}名)`;
            if (teamUpdateCount.fail > 0) completeMsg += ` (失敗: ${teamUpdateCount.fail}名)`;
        }
        showMessage(completeMsg, "success"); 
        cardImages = []; renderCardThumbs(); window.clearCardQueue();
    } else {
        // Re-render modal with remaining items
        window.renderCardMergeModal();
        showMessage(`選択項目を保存しました。残り: ${currentCardBatchConflicts.reduce((a,b)=>a+b.conflicts.length,0)}件`, "success");
    }
    updateView(); 
}

async function startCardBatchProcessing() {
    const key = window.getApiKey(); if (!key) return showMessage("APIキーがありません", "error");
    const totalItems = cardAutoQueue.filter(x => x.status === 'waiting').length;
    if (totalItems === 0) return showMessage("解析キューに記事IDが追加されていません", "error");
    isCardBatchProcessing = true; isStopRequested = false; currentAbortController = new AbortController(); let processed = 0;
    
    // v50.65 Add: Total Time Tracking
    const batchStartTime = performance.now();

    for (let i = 0; i < cardAutoQueue.length; i++) {
        if (isStopRequested) break; if (cardAutoQueue[i].status !== 'waiting') continue;
        cardAutoQueue[i].status = 'processing'; window.renderCardAutoQueue();
        const baseProgress = Math.floor((processed / totalItems) * 100); const stepRatio = 100 / totalItems;
        
        // v50.65 Add: Estimate Calculation
        const elapsed = performance.now() - batchStartTime;
        const avgTimePerItem = elapsed / (processed + 1); 
        const remainingItems = totalItems - processed;
        const estimatedRemaining = avgTimePerItem * remainingItems;
        const timeInfo = `Elapsed: ${formatTime(elapsed)} | Est. Remaining: ${formatTime(estimatedRemaining)}`;
        
        // v50.66 Fix: Store global time info for main UI update
        currentBatchTimeInfo = timeInfo;

        try {
            updateProgress('cardAuto', baseProgress + Math.floor(stepRatio * 0.1), `[${processed+1}/${totalItems}] 1/4: 外部サイトから記事データを取得中... (${timeInfo})`);
            const url = `https://es-league.games/japan/news/data.php?newsno=${cardAutoQueue[i].id}`;
            const html = await fetchHtmlWithFallback(url, currentAbortController.signal);
            const bodyMatch = html.match(/<body[^>]*>([\s\S]*)<\/body>/i);
            const contentToAnalyze = bodyMatch ? bodyMatch[1] : html;
            updateProgress('cardAuto', baseProgress + Math.floor(stepRatio * 0.3), `[${processed+1}/${totalItems}] 2/4: データを整形しAIへ送信準備中... (${timeInfo})`); await delay(400, currentAbortController.signal);
            const prompt = `以下のHTMLから、記事タイトル(rawTitle)、公開日(publishDate)、選手リストを抽出してください。

【抽出ルール】
1. **rawTitle**: "NEWS"セクションの下にある完全な記事タイトルをそのまま抽出（例: "EAFC26 eS-League Cornerstones1"）
2. **publishDate**: 記事の公開日をYYYY-MM-DD形式で抽出（見つからない場合は空文字）
3. **players**: 「選手名(チーム名)」形式のテキストから"psid"と"team"を分離

【出力JSONスキーマ】
{
  "rawTitle": "記事の完全なタイトル（必須）",
  "publishDate": "YYYY-MM-DD形式の日付（任意）",
  "players": [
    { "psid": "選手ID文字列", "team": "チーム名文字列" }
  ]
}

【重要】eventNameは生成しないでください。rawTitleをそのまま返してください。`;
            updateProgress('cardAuto', baseProgress + Math.floor(stepRatio * 0.5), `[${processed+1}/${totalItems}] 3/4: AIが記事内容を高度解析・選手情報を抽出中... (${timeInfo})`);
            const payload = { contents: [{ parts: [{ text: prompt }, { text: contentToAnalyze.substring(0, 300000) }] }], generationConfig: { responseMimeType: "application/json" } }; 
            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${key}`, { method: 'POST', body: JSON.stringify(payload), headers: { 'Content-Type': 'application/json' }, signal: currentAbortController.signal }); 
            const data = await res.json(); const text = data.candidates?.[0]?.content?.parts?.[0]?.text;
            updateProgress('cardAuto', baseProgress + Math.floor(stepRatio * 0.9), `[${processed+1}/${totalItems}] 4/4: 抽出データの検証とキューへの登録中... (${timeInfo})`); await delay(400, currentAbortController.signal);
            if (text) {
                const result = parseGeminiJSON(text); // Fix v50.60
                // v50.63: Pass newsId to results
                if ((result.rawTitle || result.eventName) && result.players) { 
                    result.newsId = cardAutoQueue[i].id;
                    cardBatchResults.push(result); 
                    // ✅ v52.163.1: generateCardLabel()でラベル生成
                    const rawTitle = result.rawTitle || '未分類イベント';
                    const publishDate = result.publishDate || '';
                    const generatedLabel = generateCardLabel(rawTitle, publishDate);
                    cardAutoQueue[i].eventName = generatedLabel;
                    cardAutoQueue[i].rawTitle = rawTitle;
                    cardAutoQueue[i].publishDate = publishDate;
                    console.log('[v52.163.1] ラベル生成:', {rawTitle, publishDate, generatedLabel}); cardAutoQueue[i].count = result.players.length; cardAutoQueue[i].status = 'done'; 
                } else throw new Error("Invalid format");
            } else throw new Error("Empty response");
        } catch (e) { if (e.name === 'AbortError') { cardAutoQueue[i].status = 'aborted'; break; } else { console.error(e); cardAutoQueue[i].status = 'error'; } }
        processed++; window.renderCardAutoQueue(); if(!isStopRequested) await delay(1000, currentAbortController.signal);
    }
    
    // v50.65 Add: Total Time Calculation
    const totalTime = ((performance.now() - batchStartTime) / 1000).toFixed(1);
    currentBatchTimeInfo = `Total: ${totalTime}s`; // Update global info for final state

    if (isStopRequested) { updateProgress('cardAuto', 0, "解析が中断されました"); showMessage("解析を中断しました", "error"); } else { updateProgress('cardAuto', 100, `全てのバッチ処理が完了しました！ (Total: ${totalTime}s)`); showMessage(`カード自動解析完了 (Total: ${totalTime}s)`, "success"); setTimeout(() => hideProgress('cardAuto'), 5000); }
    isCardBatchProcessing = false; currentAbortController = null; window.renderCardAutoQueue();
}

function startCardBatchMergeProcess() {
    console.log('[v52.160] 🔍 startCardBatchMergeProcess called');
    console.log('[v52.160] cardBatchResults:', cardBatchResults.length, 'items');
    console.log('[v52.160] window.renderCardMergeModal:', typeof window.renderCardMergeModal);
    currentCardBatchConflicts = []; let totalPlayers = 0;
    cardBatchResults.forEach(res => {
        let conflicts = [];
        res.players.forEach(pl => {
            let exactMatch = playerMaster.find(p => p.name === pl.psid);
            if (exactMatch) conflicts.push({ newPsid: pl.psid, simMatch: exactMatch, isExact: true, teamInfo: pl.team });
            else { 
                // Fix v50.61: Correctly use pl.psid inside find callback
                let simMatch = playerMaster.find(p => window.normalizeString(p.name) === window.normalizeString(pl.psid)); 
                conflicts.push({ newPsid: pl.psid, simMatch: simMatch || null, isExact: false, teamInfo: pl.team }); 
            }
            totalPlayers++;
        });
        // v50.63: Pass newsId
        // v52.163.5: rawTitleから生成されたラベルを使用
        const conflictLabel = res.rawTitle ? window.generateCardLabel(res.rawTitle, res.publishDate || '') : (res.eventName || '未分類');
        currentCardBatchConflicts.push({ eventName: conflictLabel, conflicts: conflicts, newsId: res.newsId, rawTitle: res.rawTitle, publishDate: res.publishDate });
    });
    if (currentCardBatchConflicts.length > 0) { document.getElementById('cardDetectCountBadge').innerText = `検出: ${totalPlayers}人 (${currentCardBatchConflicts.length}記事)`; window.renderCardMergeModal(); document.getElementById('cardMergeConfirmModal').classList.replace('hidden', 'flex'); } else showMessage("反映するデータがありません", "error");
}

function addCardQueueSingle() { const id = document.getElementById('cardSingleId').value.trim(); if (!id) return; if (cardAutoQueue.find(q => q.id === id)) return showMessage("既に追加されています", "error"); cardAutoQueue.push({ id, status: 'waiting', name: `News ID: ${id}` }); window.renderCardAutoQueue(); document.getElementById('cardSingleId').value = ''; }
function addCardQueueRange() { const start = parseInt(document.getElementById('cardRangeStart').value); const end = parseInt(document.getElementById('cardRangeEnd').value); if (!start || !end || start > end) return showMessage("有効な範囲を指定してください", "error"); let count = 0; for (let i = start; i <= end; i++) { const id = String(i); if (!cardAutoQueue.find(q => q.id === id)) { cardAutoQueue.push({ id, status: 'waiting', name: `News ID: ${id}` }); count++; } } window.renderCardAutoQueue(); showMessage(`${count}件をキューに追加しました`, "success"); }
function clearCardQueue() { cardAutoQueue = []; cardBatchResults = []; window.renderCardAutoQueue(); }
function removeCardQueueItem(idx) { if(!isCardBatchProcessing) { cardAutoQueue.splice(idx, 1); window.renderCardAutoQueue(); } }
// v52.170: エラー/中断カードの再解析機能
function retryCardAnalysis(idx) {
    if (isCardBatchProcessing) {
        return showMessage("解析中は再解析できません", "error");
    }
    
    if (idx < 0 || idx >= cardAutoQueue.length) {
        return showMessage("無効なインデックスです", "error");
    }
    
    const item = cardAutoQueue[idx];
    
    // エラーまたは中断状態のみ再解析可能
    if (item.status !== 'error' && item.status !== 'aborted') {
        return showMessage("再解析できるのはエラー/中断状態のカードのみです", "error");
    }
    
    // ステータスをwaitingに戻す
    item.status = 'waiting';
    item.count = undefined;
    item.eventName = undefined;
    item.rawTitle = undefined;
    item.publishDate = undefined;
    
    // cardBatchResultsから該当のIDの結果を削除
    cardBatchResults = cardBatchResults.filter(res => res.newsId !== item.id);
    
    console.log(`[v52.170] 再解析対象: ${item.name} (ID: ${item.id})`);
    
    renderCardAutoQueue();
    showMessage(`${item.name} を再解析キューに追加しました`, "success");
}

// v52.170: グローバルに登録
window.retryCardAnalysis = retryCardAnalysis;
// v52.170: エラー/中断カードを一括再解析
function retryAllErrors() {
    if (isCardBatchProcessing) {
        return showMessage("解析中は再解析できません", "error");
    }
    
    let retryCount = 0;
    
    cardAutoQueue.forEach(item => {
        if (item.status === 'error' || item.status === 'aborted') {
            item.status = 'waiting';
            item.count = undefined;
            item.eventName = undefined;
            item.rawTitle = undefined;
            item.publishDate = undefined;
            
            // cardBatchResultsから削除
            cardBatchResults = cardBatchResults.filter(res => res.newsId !== item.id);
            
            retryCount++;
        }
    });
    
    if (retryCount === 0) {
        return showMessage("再解析可能なカードがありません", "error");
    }
    
    console.log(`[v52.170] 一括再解析: ${retryCount}件をキューに追加`);
    
    renderCardAutoQueue();
    showMessage(`${retryCount}件を再解析キューに追加しました`, "success");
}

// v52.170: グローバルに登録
window.retryAllErrors = retryAllErrors;




function renderCardAutoQueue() {
    const container = document.getElementById('cardQueueContainer'); if (!container) return;
    const processedCount = cardAutoQueue.filter(x => x.status === 'done' || x.status === 'error' || x.status === 'aborted').length;
    const totalCount = cardAutoQueue.length; const percent = totalCount > 0 ? Math.round((processedCount / totalCount) * 100) : 0;
    const progressBarArea = document.getElementById('cardAutoProgressArea');
    if (isCardBatchProcessing || processedCount > 0) { if(progressBarArea) progressBarArea.classList.remove('hidden'); updateProgress('cardAuto', percent, `${percent}% (${processedCount}/${totalCount}) - ${isCardBatchProcessing ? "PROCESSING..." : "COMPLETED"}`); } else { if(progressBarArea) progressBarArea.classList.add('hidden'); }
    let totalDetected = 0; cardBatchResults.forEach(res => { if(res.players) totalDetected += res.players.length; });
    const countEl = document.getElementById('cardTotalParsedCount'); if(countEl) countEl.innerText = totalDetected;
    if(cardAutoQueue.length === 0) { container.innerHTML = `<div class="text-center p-4 text-slate-400 text-xs">キューが空です。記事IDを追加してください。</div>`; return; }
    container.innerHTML = cardAutoQueue.map((item, idx) => {
        let statusClass = ''; let icon = ''; let countBadge = '';
        if (item.status === 'done') { statusClass = 'border-l-4 border-emerald-500 bg-emerald-50'; icon='✅'; if (item.count !== undefined) { countBadge = `<span class="bg-blue-100 text-blue-800 text-[10px] px-2 py-1 rounded-full font-bold ml-2 shadow-sm">検出: ${item.count}名</span>`; } } else { switch(item.status) { case 'waiting': statusClass = 'border-l-4 border-slate-300 bg-white'; icon='⏳'; break; case 'processing': statusClass = 'border-l-4 border-indigo-500 bg-indigo-50 animate-pulse'; icon='🔄'; break; case 'error': statusClass = 'border-l-4 border-red-500 bg-red-50'; icon='❌'; break; case 'aborted': statusClass = 'border-l-4 border-orange-500 bg-orange-50'; icon='⚠️'; break; } }
        return `<div class="flex items-center justify-between p-3 rounded-lg shadow-sm mb-2 text-xs ${statusClass}"><div class="flex items-center gap-2"><span class="text-lg">${icon}</span><div><div class="font-bold text-slate-700 flex items-center">${item.name} ${countBadge}</div><div class="text-[10px] text-slate-400">Status: ${item.status} ${item.eventName ? `(${item.eventName})` : ''}</div></div></div>${(item.status === 'waiting' || item.status === 'error' || item.status === 'aborted') ? 
            (item.status === 'waiting' ? 
                `<button onclick="window.removeCardQueueItem(${idx})" class="text-slate-400 hover:text-red-500 font-bold px-2">&times;</button>` : 
                `<div class="flex gap-2">
                    <button onclick="window.retryCardAnalysis(${idx})" 
                        class="text-xs bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded shadow-sm transition-all hover:shadow-md font-bold" 
                        title="再解析">
                        🔄 再解析
                    </button>
                    <button onclick="window.removeCardQueueItem(${idx})" 
                        class="text-slate-400 hover:text-red-500 font-bold px-2">&times;</button>
                </div>`
            ) : ''}</div>`;
    }).join('');
    // 🆕 v52.160: Enable both batchApplyBtn and cardBatchApplyBtn
    const applyBtn = document.getElementById('batchApplyBtn'); 
    if(applyBtn) { 
        const hasResults = cardBatchResults.length > 0; 
        applyBtn.disabled = !hasResults && isCardBatchProcessing; 
    }
    // 🆕 v52.160: Enable cardBatchApplyBtn when analysis is complete
    const cardApplyBtn = document.getElementById('cardBatchApplyBtn');
    if(cardApplyBtn) {
        const hasCardResults = cardBatchResults.length > 0;
        const allDone = cardAutoQueue.length > 0 && cardAutoQueue.every(x => x.status === 'done' || x.status === 'error' || x.status === 'aborted');
        cardApplyBtn.disabled = !(hasCardResults && allDone);
        console.log('[v52.160] cardBatchApplyBtn enabled:', !(hasCardResults && allDone), '| results:', cardBatchResults.length, '| allDone:', allDone);
    // v52.170: 一括再解析ボタンの制御
    const retryBtn = document.getElementById('cardBatchRetryBtn');
    if (retryBtn) {
        const hasErrors = cardAutoQueue.some(x => x.status === 'error' || x.status === 'aborted');
        retryBtn.disabled = !hasErrors || isCardBatchProcessing;
        console.log('[v52.170] cardBatchRetryBtn enabled:', hasErrors && !isCardBatchProcessing, '| errors:', hasErrors, '| processing:', isCardBatchProcessing);
    }
    }
}

function switchCardMode(mode) {
    const btnManual = document.getElementById('card-mode-manual'); const btnAuto = document.getElementById('card-mode-auto'); const panelManual = document.getElementById('card-panel-manual'); const panelAuto = document.getElementById('card-panel-auto');
    if (mode === 'manual') { btnManual.classList.add('active', 'text-blue-600'); btnAuto.classList.remove('active', 'text-blue-600'); panelManual.classList.remove('hidden'); panelAuto.classList.add('hidden'); } else { btnManual.classList.remove('active', 'text-blue-600'); btnAuto.classList.add('active', 'text-blue-600'); panelManual.classList.add('hidden'); panelAuto.classList.remove('hidden'); window.renderCardAutoQueue(); }
}

function exportToCSV() { if(playerMaster.length === 0) return showMessage("データがありません", "error"); let csvContent = "\uFEFFPSID,Nickname,Team,Goals,Assists,Rating\n" + playerMaster.map(p => { const cur = (p.history||[]).filter(h=>h.dataType===displayType).pop() || {}; const team = teamMaster.find(t=>t.id===p.teamId)?.name || ""; return `"${p.name}","${p.nickname||""}","${team}",${cur.goals||0},${cur.assists||0},${cur.overall||cur.rating||0}`; }).join("\n"); const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' }); const url = URL.createObjectURL(blob); const link = document.createElement("a"); link.href = url; link.setAttribute("download", `es_league_data_${new Date().toISOString().slice(0,10)}.csv`); document.body.appendChild(link); link.click(); document.body.removeChild(link); setTimeout(() => URL.revokeObjectURL(url), 100); }
async function exportDatabase() { const formatInput = document.querySelector('input[name="exportFormat"]:checked'); if (!formatInput) return showMessage("出力形式を選択してください", "error"); const format = formatInput.value; const _now = new Date(); const dateStr = _now.toISOString().slice(0,10) + '_' + _now.toTimeString().slice(0,8).replace(/:/g,''); let fileContent = ""; let mimeType = ""; let defaultFileName = ""; if (format === 'json') { const data = { playerMaster, teamMaster, customLabels, columnVisibility, leagueLabelMap }; fileContent = JSON.stringify(data, null, 2); mimeType = "application/json"; defaultFileName = `es_league_db_backup_${dateStr}.json`; } else if (format === 'csv') { if(playerMaster.length === 0) return showMessage("データがありません", "error"); fileContent = '\uFEFF' + "PSID,Nickname,Team,Number,Rating,Apps,WinRate,Goals,Assists,CleanSheets,Yellow,Red,Status,Labels\n"; fileContent += playerMaster.map(p => { const latestRec = (p.history||[]).filter(h=>h.dataType==='latest').pop() || {}; const team = teamMaster.find(t=>t.id===p.teamId)?.name || ""; const labelsStr = (p.labels || []).join(" | "); return `"${p.name}","${p.nickname||""}","${team}","${latestRec.number||'-'}",${latestRec.overall||latestRec.rating||0},${latestRec.apps||0},${latestRec.winRate||0},${latestRec.goals||0},${latestRec.assists||0},${latestRec.cleanSheets||0},${latestRec.yellow||0},${latestRec.red||0},"${latestRec.status||'在籍'}","${labelsStr}"`; }).join("\n"); mimeType = "text/csv;charset=utf-8"; defaultFileName = `es_league_data_${dateStr}.csv`; } try { const blob = new Blob([fileContent], { type: mimeType }); const url = URL.createObjectURL(blob); const link = document.createElement("a"); link.href = url; link.download = defaultFileName; document.body.appendChild(link); link.click(); document.body.removeChild(link); showMessage(`ダウンロードしました (${format.toUpperCase()})`, "success"); setTimeout(() => URL.revokeObjectURL(url), 100); } catch (err) { console.error(err); showMessage("保存に失敗しました", "error"); } }
function importDatabase(event) {
    const file = event.target.files[0];
    if (!file) return;
    if (!file.name.toLowerCase().endsWith('.json')) {
        showMessage('JSONファイル以外はインポートできません', 'error');
        event.target.value = '';
        return;
    }
    const reader = new FileReader();
    reader.onload = async (e) => {
        try {
            const imported = JSON.parse(e.target.result);
            if (!imported.playerMaster || !Array.isArray(imported.playerMaster)) {
                showMessage('有効なDBファイルではありません（playerMaster が見つかりません）', 'error');
                return;
            }

            // FIX-13: Ask user about accumulation mode
            const hasExisting = playerMaster.length > 0;
            let mode = 'overwrite';
            if (hasExisting) {
                const choice = await window.showImportChoiceDialog(imported);
                if (!choice) return; // cancelled
                mode = choice;
            }

            if (mode === 'overwrite') {
                // Simple overwrite (original behavior)
                playerMaster = imported.playerMaster;
                if (imported.teamMaster) teamMaster = imported.teamMaster;
                if (imported.leagueLabelMap) leagueLabelMap = imported.leagueLabelMap;
                if (imported.customLabels) customLabels = imported.customLabels;
                if (imported.columnVisibility) columnVisibility = imported.columnVisibility;
                await saveToCloud();
                showMessage(`インポート完了 (上書き): ${playerMaster.length}名`, 'success');

            } else if (mode === 'accumulate') {
                // FIX-13: Accumulate — create snapshot of current, then merge
                // Save current state as snapshot BEFORE merging
                const snapTs = new Date().toISOString();
                const snapData = {
                    ts: snapTs,
                    label: `インポート前バックアップ (${new Date(snapTs).toLocaleString('ja-JP')})`,
                    playerCount: playerMaster.length,
                    playerMaster: JSON.stringify(playerMaster),
                    teamMaster: JSON.stringify(teamMaster)
                };
                if (!dbSnapshots) dbSnapshots = [];
                dbSnapshots.push(snapData);
                if (dbSnapshots.length > 50) dbSnapshots.shift();

                // Also save the imported data as a separate snapshot for comparison
                const importedSnapTs = imported.exportedAt || imported.savedAt || snapTs;
                dbSnapshots.push({
                    ts: importedSnapTs,
                    label: `📥 インポートDB (${file.name}) - ${imported.playerMaster.length}名`,
                    playerCount: imported.playerMaster.length,
                    isImported: true,
                    playerMaster: JSON.stringify(imported.playerMaster),
                    teamMaster: JSON.stringify(imported.teamMaster || teamMaster)
                });

                // Merge: add new players (by PSID), update existing if imported record is newer
                let addedCount = 0, updatedCount = 0;
                for (const imp of imported.playerMaster) {
                    const existing = playerMaster.find(p => p.name === imp.name);
                    if (!existing) {
                        playerMaster.push(imp);
                        addedCount++;
                    } else {
                        // Merge history (add records not already present by date+dataType)
                        const existingKeys = new Set((existing.history||[]).map(h => h.date + '_' + h.dataType));
                        let merged = false;
                        for (const hRec of (imp.history||[])) {
                            const key = hRec.date + '_' + hRec.dataType;
                            if (!existingKeys.has(key)) {
                                existing.history = existing.history || [];
                                existing.history.push(hRec);
                                merged = true;
                            }
                        }
                        // Merge labels
                        for (const lbl of (imp.labels||[])) {
                            if (!existing.labels) existing.labels = [];
                            if (!existing.labels.includes(lbl)) existing.labels.push(lbl);
                        }
                        // Update nickname if missing
                        if (!existing.nickname && imp.nickname) existing.nickname = imp.nickname;
                        if (merged) updatedCount++;
                    }
                }
                // Merge teams (add new teams)
                if (imported.teamMaster) {
                    for (const t of imported.teamMaster) {
                        if (!teamMaster.find(x => x.id === t.id)) teamMaster.push(t);
                    }
                }
                await saveToCloud();
                showMessage(
                    `累積インポート完了: 新規追加 ${addedCount}名 / 履歴更新 ${updatedCount}名 (過去スナップショット保存済み)`,
                    'success'
                );
                // Show DB tab with snapshots
                setTimeout(() => {
                    window.switchTab('db');
                    if (typeof renderDbSnapshotList === 'function') renderDbSnapshotList();
                }, 500);
            }
            initAdminUI();
            updateView();
        } catch (err) {
            showMessage('インポートエラー: ' + err.message, 'error');
            console.error('[importDatabase]', err);
        }
    };
    reader.readAsText(file);
    event.target.value = '';
}

// FIX-13: Import choice dialog
window.showImportChoiceDialog = function(imported) {
    return new Promise((resolve) => {
        const existing = playerMaster.length;
        const incoming = imported.playerMaster?.length || 0;
        const modal = document.getElementById('importChoiceModal');
        if (!modal) { resolve('overwrite'); return; }
        document.getElementById('importChoiceExisting').textContent = existing + '名';
        document.getElementById('importChoiceIncoming').textContent = incoming + '名';
        document.getElementById('importChoiceFile').textContent = imported.exportedAt || '不明';
        modal.classList.remove('hidden');
        modal.classList.add('flex');
        window._importChoiceResolve = resolve;
    });
};
window.resolveImportChoice = function(choice) {
    const modal = document.getElementById('importChoiceModal');
    if (modal) { modal.classList.add('hidden'); modal.classList.remove('flex'); }
    if (window._importChoiceResolve) { window._importChoiceResolve(choice); window._importChoiceResolve = null; }
};


function openAddModal() { document.getElementById('modalTitle').innerText="新規登録"; document.getElementById('editPlayerId').value=""; document.getElementById('editPlayerName').value=""; document.getElementById('editPlayerName').disabled=false; document.getElementById('editPlayerNickname').value=""; document.getElementById('editPlayerTeamId').innerHTML = `<option value="">所属なし</option>` + teamMaster.map(t=>`<option value="${t.id}">${t.name}</option>`).join(''); renderEditPlayerLabelCheckboxes([]); document.getElementById('editPlayerModal').classList.replace('hidden','flex'); }
// v50.62 Fix: Allow PSID edit (removed disabled=true)
function openEditModal(name) { 
    const p = playerMaster.find(x => x.name === name); if(!p) return; 
    const cur = (p.history||[]).filter(h=>h.dataType===displayType).pop()||createFallbackStats(displayType); 
    document.getElementById('modalTitle').innerText="選手編集"; 
    document.getElementById('editPlayerId').value=p.name; 
    document.getElementById('editPlayerName').value=p.name; 
    document.getElementById('editPlayerName').disabled=false; // Allow edit
    document.getElementById('editPlayerNickname').value=p.nickname||""; 
    document.getElementById('editPlayerTeamId').innerHTML = `<option value="">所属なし (FA)</option>` + teamMaster.map(t=>`<option value="${t.id}" ${t.id===p.teamId?'selected':''}>${t.name}</option>`).join(''); 
    document.getElementById('editPlayerNumber').value=cur.number||''; 
    document.getElementById('editPlayerRating').value=cur.overall||cur.rating||''; 
    document.getElementById('editPlayerApps').value=cur.apps||0; 
    document.getElementById('editPlayerWinRate').value=cur.winRate||0; 
    document.getElementById('editPlayerGoals').value=cur.goals||0; 
    document.getElementById('editPlayerAssists').value=cur.assists||0; 
    renderEditPlayerLabelCheckboxes(p.labels||[]);
    // FIX-7b: Set status dropdown from getPlayerStatus()
    const _pStat = getPlayerStatus(p);
    const statSel = document.getElementById('editPlayerStatus');
    if (statSel) statSel.value = _pStat;
    document.getElementById('editPlayerModal').classList.replace('hidden','flex');
}

// v50.62 Fix: Handle PSID change
async function commitPlayerEdit() { 
    const originalId = document.getElementById('editPlayerId').value;
    const newId = document.getElementById('editPlayerName').value.trim();
    
    if(!newId) return showMessage("PSIDは必須です", "error"); 
    
    let p;
    // Check if ID changed
    if (originalId && newId !== originalId) {
        if (playerMaster.find(x => x.name === newId)) {
            return showMessage("そのPSIDは既に使用されています", "error");
        }
        // Find by original ID and update
        p = playerMaster.find(x => x.name === originalId);
        if (p) {
            p.name = newId;
        } else {
            // Should not happen unless concurrent delete
            p = { name: newId, history: [], labels: [] };
            playerMaster.push(p);
        }
    } else {
        // No change or new player
        p = playerMaster.find(x => x.name === newId);
        if(!p) { 
            p = { name: newId, history: [], labels: [] }; 
            playerMaster.push(p); 
        }
    }

    p.nickname = document.getElementById('editPlayerNickname').value.trim(); 
    p.teamId = document.getElementById('editPlayerTeamId').value; 
    const checked = document.querySelectorAll('#editPlayerLabelsContainer input:checked'); 
    p.labels = Array.from(checked).map(c => c.value); 
    const today = new Date().toLocaleDateString('ja-JP').replace(/\//g, '-');
    const rawNumber = document.getElementById('editPlayerNumber').value.trim();
    const numberVal = rawNumber === "" ? "-" : rawNumber;
    const editedStatus = document.getElementById('editPlayerStatus').value;
    // FIX-7c: Handle FA/退団 status changes
    if (editedStatus === 'FA') {
        if (p.teamId) {
            const oldTeam = teamMaster.find(t => t.id === p.teamId);
            if (!p.past_teams) p.past_teams = [];
            if (!p.past_teams.find(pt => pt.id === p.teamId)) {
                p.past_teams.push({ id: p.teamId, name: oldTeam?.name || 'Unknown', leftDate: today, joinType: '退団・FA' });
            }
            p.teamId = '';
            document.getElementById('editPlayerTeamId').value = '';
        }
        if (!p.labels) p.labels = [];
        if (!p.labels.includes('FA')) p.labels.push('FA');
    } else if (editedStatus === '在籍') {
        if (p.labels) p.labels = p.labels.filter(l => l !== 'FA');
    }
    const newData = {
        date: today, dataType: displayType, number: numberVal,
        overall: parseInt(document.getElementById('editPlayerRating').value)||0,
        apps: parseInt(document.getElementById('editPlayerApps').value)||0,
        winRate: parseFloat(document.getElementById('editPlayerWinRate').value)||0,
        goals: parseInt(document.getElementById('editPlayerGoals').value)||0,
        assists: parseInt(document.getElementById('editPlayerAssists').value)||0,
        cleanSheets: parseInt(document.getElementById('editPlayerCleanSheets')?.value)||0,
        yellow: parseInt(document.getElementById('editPlayerYellow')?.value)||0,
        red: parseInt(document.getElementById('editPlayerRed')?.value)||0,
        status: editedStatus
    };
    p.history = p.history.filter(h => !(h.date === today && h.dataType === displayType));
    p.history.push(newData);
    await saveToCloud();
    document.getElementById('editPlayerModal').classList.replace('flex','hidden');
    updateView();
    showMessage(originalId ? "更新完了" : "新規登録完了", "success"); 
}

async function moveToFreeAgent() { const psid = document.getElementById('editPlayerName').value.trim(); if(!psid) return; const isOk = await window.customConfirm(`選手「${psid}」を現在のチームから退団させ、FA（フリーエージェント）として登録しますか？\n（現在のチームは「過去所属」として履歴に残ります）`); if(!isOk) return; let p = playerMaster.find(x => x.name === psid); if(p) { if(p.teamId) { const oldTeam = teamMaster.find(t => t.id === p.teamId); const leaveDate = new Date().toLocaleDateString('ja-JP').replace(/\//g, '-'); if(!p.past_teams) p.past_teams = []; p.past_teams.push({ id: p.teamId, name: oldTeam?.name || "Unknown", leftDate: leaveDate }); } p.teamId = ""; if(!p.labels) p.labels = []; if(!p.labels.includes("FA")) p.labels.push("FA"); await saveToCloud(); document.getElementById('editPlayerModal').classList.replace('flex','hidden'); updateView(); showMessage("FA登録しました", "success"); } }
function openHistoryModal(n) { const p = playerMaster.find(x => x.name === n); if (!p) return; let html = ''; if (p.past_teams && p.past_teams.length > 0) { html += `<div class="mb-4 p-4 bg-slate-50 rounded-xl border border-slate-200"><h4 class="text-xs font-bold text-slate-500 mb-2">所属履歴 (Past Teams)</h4><div class="space-y-1">`; p.past_teams.forEach(pt => { html += `<div class="text-xs text-slate-700 flex justify-between"><span>${pt.name}</span> <span class="text-slate-400">(${pt.leftDate || 'Unknown'} 退団)</span></div>`; }); html += `</div></div>`; } const h = (p.history || []).filter(x => x.dataType === displayType).sort((a, b) => new Date(b.date) - new Date(a.date)); html += h.length < 2 ? '<p class="text-center text-slate-400 py-4">データ履歴不足 (NO HISTORY)</p>' : h.map((c, i) => { if (i === h.length - 1) return ''; const pr = h[i + 1]; const diffG = (c.goals || 0) - (pr.goals || 0); const diffR = (c.overall || 0) - (pr.overall || 0); return ` <div class="history-card bg-white p-4 rounded-xl border-l-4 border-indigo-500 shadow-sm mb-4"> <div class="flex justify-between mb-2 text-xs"> <span class="text-indigo-600">${c.date}</span> <span class="text-slate-400">vs ${pr.date}</span> </div> <div class="grid grid-cols-2 gap-4 text-sm"> <div>総合: ${c.overall || 0} <span class="${diffR >= 0 ? 'text-emerald-500' : 'text-red-500'} text-xs">(${diffR >= 0 ? '+' : ''}${diffR})</span></div> <div>G: ${c.goals || 0} <span class="${diffG >= 0 ? 'text-emerald-500' : 'text-red-500'} text-xs">(${diffG >= 0 ? '+' : ''}${diffG})</span></div> </div> </div>`; }).join(''); document.getElementById('historyContent').innerHTML = html; document.getElementById('historyModal').classList.replace('hidden', 'flex'); }
function closeHistoryModal() { document.getElementById('historyModal').classList.replace('flex', 'hidden'); }

async function fetchHtmlWithFallback(targetUrl, signal) { try { const res = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(targetUrl)}`, { signal }); if (!res.ok) throw new Error(); const data = await res.json(); return data.contents; } catch (e) { if (e.name === 'AbortError') throw e; } try { const res = await fetch(`https://corsproxy.io/?${encodeURIComponent(targetUrl)}`, { signal }); if (!res.ok) throw new Error(); return await res.text(); } catch (e) { throw e; } }
// Phase 4.11.55: ログ追加関数
function addStepLog(batchIndex, message, type = 'info') {
  // カードごとのログを記録
  if (batchIndex >= 0 && batchIndex < autoAnalysisQueue.length) {
    if (!autoAnalysisQueue[batchIndex].logs) autoAnalysisQueue[batchIndex].logs = [];
    
    const time = new Date().toLocaleTimeString('ja-JP', { hour12: false });
    const icon = type === 'success' ? '✅' : type === 'error' ? '❌' : type === 'warning' ? '⚠️' : '▶️';
    const colorClass = type === 'success' ? 'text-green-700 bg-green-50 border-green-300' :
                       type === 'error' ? 'text-red-700 bg-red-50 border-red-300' :
                       type === 'warning' ? 'text-yellow-700 bg-yellow-50 border-yellow-300' :
                       'text-blue-700 bg-blue-50 border-blue-300';
    
    autoAnalysisQueue[batchIndex].logs.push({
      time: time,
      icon: icon,
      message: message,
      colorClass: colorClass
    });
    
    // カードを再描画
    renderAutoQueueCards();
  } else {
    console.warn('[addStepLog] Invalid batchIndex:', batchIndex);
  }
}


async function startBatchProcessing() { const key = window.getApiKey(); if (!key) return showMessage("APIキーがありません", "error"); const totalItems = autoAnalysisQueue.filter(x => x.status === 'waiting').length; if (totalItems === 0) return showMessage("解析キューにチームが追加されていません", "error"); isBatchProcessing = true; isStopRequested = false; currentAbortController = new AbortController(); renderAutoQueueCards(); let processed = 0; 
    
    // v50.65 Add: Total Time Tracking
    const batchStartTime = performance.now();

    for (let i = 0; i < autoAnalysisQueue.length; i++) {
    if (!autoAnalysisQueue[i].logs) autoAnalysisQueue[i].logs = []; if (isStopRequested) break; if (autoAnalysisQueue[i].status !== 'waiting') continue; const startT = performance.now(); autoAnalysisQueue[i].status = 'processing'; autoAnalysisQueue[i].step = '🌍 接続中...'; renderAutoQueueCards(); const baseProgress = Math.floor((processed / totalItems) * 100); const stepRatio = 100 / totalItems; 
    
    // v50.65: Calculate Estimate
    const elapsed = performance.now() - batchStartTime;
    const avgTimePerItem = elapsed / (processed + 1); // rough estimate
    const remainingItems = totalItems - processed;
    const estimatedRemaining = avgTimePerItem * remainingItems;
    const timeInfo = `Elapsed: ${formatTime(elapsed)} | Est. Remaining: ${formatTime(estimatedRemaining)}`;
    
    // v50.66 Fix: Store global time info for main UI update
    currentBatchTimeInfo = timeInfo;

    try { 
        console.log(`[Batch ${i+1}] 📍 Step 1/5: URL アクセス開始`);
        addStepLog(i, 'Step 1/6: URL生成完了 - ${autoAnalysisQueue[i].name}', 'info');
        updateProgress('adminAuto', baseProgress + Math.floor(stepRatio * 0.1), `[${processed+1}/${totalItems}] 1/5: 外部サイトから選手データを取得中... (${timeInfo})`); 
        const html = await fetchHtmlWithFallback(`https://es-league.games/japan/fifa/club/member.php?clubno=${autoAnalysisQueue[i].id}`, currentAbortController.signal); 
        console.log(`[Batch ${i+1}] ✅ Step 2/5: HTML取得完了 (${html.length} 文字)`);
        addStepLog(i, 'Step 2/6: URLにアクセス完了・HTML取得成功 (${html.length.toLocaleString()} 文字)', 'success');
        updateProgress('adminAuto', baseProgress + Math.floor(stepRatio * 0.3), `[${processed+1}/${totalItems}] 2/5: データを整形しAIへ送信準備中... (${timeInfo})`); 
        autoAnalysisQueue[i].step = '🤖 AI解析中...'; renderAutoQueueCards(); 
        const bodyMatch = html.match(/<body[^>]*>([\s\S]*)<\/body>/i); const contentToAnalyze = bodyMatch ? bodyMatch[1] : html; 
        const prompt = ` Extract soccer player stats from this HTML table. Ignore navigation or footer text. Return ONLY valid JSON. Schema: { "latest": [ { "name": "PSID String", "nickname": "DisplayName", "number": String/Integer, "rating": Integer, "apps": Integer, "winRate": Integer, "goals": Integer, "assists": Integer, "cleanSheets": Integer, "yellow": Integer, "red": Integer } ], "lifetime": [ {"name": "PSID", "nickname": "DisplayName", "apps": 0, "winRate": 0, "goals": 0, "assists": 0, "cleanSheets": 0, "yellow": 0, "red": 0, "status": "在籍 or 退団"} ] } Rules: 1. If number is missing/image, use "-". 2. Convert numeric strings to Integers (except number). 3. Ignore empty rows. 4. "latest" array is mandatory. `; 
        addStepLog(i, 'Step 3/6: Gemini API へ送信開始 (モデル: gemini-2.5-flash)', 'info');
        console.log(`[Batch ${i+1}] 📤 Step 3/5: Gemini API へ送信中...`);
        updateProgress('adminAuto', baseProgress + Math.floor(stepRatio * 0.5), `[${processed+1}/${totalItems}] 3/5: AIがHTMLテーブルを高度解析・選手情報を抽出中... (${timeInfo})`); 
        const payload = { contents: [{ parts: [{ text: prompt }, { text: contentToAnalyze.substring(0, 500000) }] }], generationConfig: { responseMimeType: "application/json" } }; 
        const gRes = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${key}`, { method: 'POST', body: JSON.stringify(payload), headers: { 'Content-Type': 'application/json' }, signal: currentAbortController.signal }); 
        const gData = await gRes.json();
        console.log(`[Batch ${i+1}] 🔍 Gemini API Full Response:`, gData);
        console.log(`[Batch ${i+1}] 🔍 Response Status:`, gRes.status); const text = gData.candidates?.[0]?.content?.parts?.[0]?.text;
        if (!text) {
            addStepLog(i, 'Step 4/6: ❌ Gemini API エラー - 空レスポンス', 'error');
            console.error(`[Batch ${i+1}] ❌ Empty text - Full gData:`, JSON.stringify(gData, null, 2));
            console.error(`[Batch ${i+1}] ❌ candidates:`, gData.candidates);
            console.error(`[Batch ${i+1}] ❌ error:`, gData.error);
        } 
        console.log(`[Batch ${i+1}] ✅ Step 4/5: AI解析完了`);
        addStepLog(i, 'Step 4/6: Gemini API 解析完了・選手データ抽出成功', 'success');
        updateProgress('adminAuto', baseProgress + Math.floor(stepRatio * 0.9), `[${processed+1}/${totalItems}] 4/5: 抽出データの検証とキューへの登録中... (${timeInfo})`); 
        await delay(400, currentAbortController.signal); 
        if (text) {
            const res = parseGeminiJSON(text); // v52.182: 堅牢化済み
            console.log(`[Batch ${i+1}] AI Response:`, res);

            // v52.182 BUG-2 Fix: res が null (解析失敗) の場合をスキップ
            if (!res) {
                console.error(`[Batch ${i+1}] ❌ JSON解析失敗 - スキップして次のチームへ`);
                autoAnalysisQueue[i].status = 'error';
                autoAnalysisQueue[i].step = '❌ JSON解析失敗';
                addStepLog(i, 'JSON解析失敗: Gemini APIのレスポンスを解析できませんでした', 'error');
                processed++;
                renderAutoQueueCards();
                continue;
            }

            // Add _teamId to each player
            if(res.latest && Array.isArray(res.latest)) {
                res.latest.forEach(r => r._teamId = autoAnalysisQueue[i].id);
                console.log(`[Batch ${i+1}] Latest players:`, res.latest.length);
            }
            if(res.lifetime && Array.isArray(res.lifetime)) {
                res.lifetime.forEach(r => r._teamId = autoAnalysisQueue[i].id);
                console.log(`[Batch ${i+1}] Lifetime players:`, res.lifetime.length);
            }
            
            // Push to batchPendingResults
            batchPendingResults.latest.push(...(res.latest || []));
            batchPendingResults.lifetime.push(...(res.lifetime || []));
            
            // Calculate unique player count
            const uniqueTeamPlayers = [...new Set([...(res.latest || []).map(x=>x.name), ...(res.lifetime || []).map(x=>x.name)])];
            autoAnalysisQueue[i].count = uniqueTeamPlayers.length;
          autoAnalysisQueue[i].players = uniqueTeamPlayers.slice(0, 50); // 最大50人まで保存
            
            console.log(`[Batch ${i+1}] Unique players: ${uniqueTeamPlayers.length}`, uniqueTeamPlayers);
            console.log(`[Batch ${i+1}] Total pending - Latest: ${batchPendingResults.latest.length}, Lifetime: ${batchPendingResults.lifetime.length}`);
            
            console.log(`[Batch ${i+1}] ✅ Step 5/5: データ登録完了 (選手数: ${uniqueTeamPlayers.length})`);
        addStepLog(i, 'Step 6/6: データベース登録完了 (選手数: ${uniqueTeamPlayers.length}人)', 'success');
            autoAnalysisQueue[i].status = 'done'; 
            autoAnalysisQueue[i].step = '✅ 完了'; 
        } else { 
            console.error(`[Batch ${i+1}] Empty AI Response`);
            throw new Error("Empty AI Response"); 
        } 
        autoAnalysisQueue[i].duration = ((performance.now() - startT) / 1000).toFixed(1); 
    } catch (e) { if (e.name === 'AbortError') { autoAnalysisQueue[i].status = 'aborted'; autoAnalysisQueue[i].step = '⚠️ 中断'; break; } else { console.error(e); autoAnalysisQueue[i].status = 'error'; autoAnalysisQueue[i].step = '❌ エラー'; } } processed++; renderAutoQueueCards(); if (!isStopRequested) await delay(1200, currentAbortController.signal); 
} 
const finalElapsed = performance.now() - batchStartTime;
if (isStopRequested) { updateProgress('adminAuto', 0, `解析が中断されました (Total Time: ${formatTime(finalElapsed)})`); showMessage("解析を中断しました", "error"); } else { updateProgress('adminAuto', 100, `全てのバッチ処理が完了しました！ (Total Time: ${formatTime(finalElapsed)})`); showMessage(`バッチ解析終了 (Total Time: ${formatTime(finalElapsed)})`, "success"); setTimeout(() => hideProgress('adminAuto'), 5000); } isBatchProcessing = false; currentAbortController = null; renderAutoQueueCards(); }

function updateUIForLeagueChange() { const filterEl = document.getElementById('leagueFilter'); if(filterEl) filterEl.innerHTML = `<option value="">全カテゴリ</option>` + Object.entries(leagueLabelMap).filter(([id])=>id).map(([id, name]) => `<option value="${id}">${name}</option>`).join(''); renderManualLeagues(); renderAutoFilterLeagues(); renderFilterChips(); let l1Options = ''; Object.entries(leagueLabelMap).forEach(([id, name]) => { if (id) l1Options += `<option value="${id}">${name}</option>`; }); const nL1 = document.getElementById('newTeamL1'); if(nL1) nL1.innerHTML = l1Options; const nL2Container = document.getElementById('newTeamL2Checkboxes'); if(nL2Container) { nL2Container.innerHTML = Object.entries(leagueLabelMap).filter(([id])=>id).map(([id,name]) => `<label class="flex items-center gap-1 text-[9px] w-full hover:bg-slate-100 p-1 rounded cursor-pointer transition-colors"><input type="checkbox" value="${id}" class="new-team-l2-check w-3 h-3 text-emerald-600 focus:ring-emerald-500 rounded border-slate-300"> <span>${name}</span></label>` ).join(''); } const batchL1 = document.getElementById('batchL1'); const batchL2Add = document.getElementById('batchL2Add'); const batchL2Remove = document.getElementById('batchL2Remove'); if(batchL1) batchL1.innerHTML = '<option value="">変更しない</option>' + l1Options; if(batchL2Add) batchL2Add.innerHTML = '<option value="">追加しない</option>' + l1Options; if(batchL2Remove) batchL2Remove.innerHTML = '<option value="">削除しない</option><option value="ALL">すべて削除 (クリア)</option>' + l1Options; renderAdminTeamSelector(); renderAutoTeamSelector(); const ptmSelect = document.getElementById('playerTeamMultiSelect'); if (ptmSelect) { let sortedTeams = [...teamMaster].sort((a, b) => (a.name || "").localeCompare((b.name || ""), 'ja')); ptmSelect.innerHTML = '<option value="">▼ チームを選択...</option>' + sortedTeams.map(t => `<option value="${t.id}">${t.name}</option>`).join(''); } window.renderTeamManagerList(); window.updateView(); }
function initAdminUI() { window.renderSharedComponents(); updateUIForLeagueChange(); initResizer(); renderAutoQueueCards(); }
async function saveToCloud() {
    if(!user) return; setSyncStatus('syncing');
    // v52.174: Create snapshot before saving
    const snapTs = new Date().toISOString();
    const snapData = { ts: snapTs, playerMaster: JSON.stringify(playerMaster), teamMaster: JSON.stringify(teamMaster), customLabels: JSON.stringify(customLabels) };
    if (!dbSnapshots) dbSnapshots = [];
    // Avoid duplicate within 5s
    if (dbSnapshots.length === 0 || (new Date(snapTs) - new Date(dbSnapshots[dbSnapshots.length-1].ts)) > 5000) {
        dbSnapshots.push(snapData);
        if (dbSnapshots.length > 50) dbSnapshots.shift(); // Keep max 50 snapshots
    }
    try { await setDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'data', 'masterData'), { playerMaster: JSON.stringify(playerMaster), teamMaster: JSON.stringify(teamMaster), customLabels: JSON.stringify(customLabels), columnVisibility: JSON.stringify(columnVisibility), leagueLabelMap: JSON.stringify(leagueLabelMap), leagueMeta: JSON.stringify(leagueMeta), geminiKey: window.getApiKey() }, { merge: true }); setSyncStatus('synced'); } catch(e) { setSyncStatus('error'); } }
async function loadFromCloud(uid) { 
    const s = await getDoc(doc(db, 'artifacts', appId, 'users', uid, 'data', 'masterData')); 
    if(s.exists()) { 
        const d = s.data(); 
        playerMaster = d.playerMaster ? JSON.parse(d.playerMaster) : []; 
        if (d.teamMaster) { teamMaster = JSON.parse(d.teamMaster).map(t => ({ ...t, l2: Array.isArray(t.l2) ? t.l2 : (t.l2 ? [t.l2] : []) })); }
        leagueLabelMap = d.leagueLabelMap ? JSON.parse(d.leagueLabelMap) : { ...defaultLeagueLabelMap };
        if (d.leagueMeta) { try { leagueMeta = JSON.parse(d.leagueMeta); window.leagueMeta = leagueMeta; } catch(e) {} }
        if (d.customLabels) {
            const loaded = JSON.parse(d.customLabels);
            if (Array.isArray(loaded) && typeof loaded[0] === 'string') { customLabels = loaded.map(l => ({ name: l, type: 'general' })); } else { customLabels = loaded; }
        }
        if (d.columnVisibility) columnVisibility = JSON.parse(d.columnVisibility);
        if (d.geminiKey) window.syncApiKey(d.geminiKey);
        if (d.dbSnapshots) { try { dbSnapshots = JSON.parse(d.dbSnapshots); } catch(e) { dbSnapshots = []; } }
    } 
    activeSnapshotIndex = -1;
    initAdminUI(); updateView(); 
    setTimeout(() => { if(typeof renderDbSnapshotList === 'function') renderDbSnapshotList(); }, 200);
}
function removeManualImage(id) { manualImages = manualImages.filter(x => x.id !== id); renderThumbs(); }
window.normalizeString = function(str) { return String(str || "").toLowerCase().replace(/[^a-z0-9\u3040-\u309f\u30a0-\u30ff\u4e00-\u9faf]/g, ""); };
// v50.64 Fix: Enhanced similarity check
function checkSimilarity(newP, existP) { 
    const normNew = window.normalizeString(newP.name); 
    const normExist = window.normalizeString(existP.name); 
    if(normNew && normExist && normNew === normExist) return true; 
    
    // Check if team ID matches (same team)
    const newTeam = newP._teamId || targetAutoTeamId; 
    if (newTeam && existP.teamId && newTeam === existP.teamId) { 
        let matchCount = 0; 
        const existLat = (existP.history||[]).filter(h=>h.dataType==='latest').pop() || {}; 
        
        // Criteria 1: Number (Strong indicator)
        if (newP.number && existLat.number && String(newP.number) === String(existLat.number) && newP.number != 0 && newP.number != '-') matchCount++; 
        
        // Criteria 2: Rating/Overall
        if (newP.rating && existLat.overall && parseInt(newP.rating) === parseInt(existLat.overall) && newP.rating != 0) matchCount++; 
        
        // Criteria 3: Goals
        if (newP.goals !== undefined && existLat.goals !== undefined && parseInt(newP.goals) === parseInt(existLat.goals)) matchCount++; 
        
        // Criteria 4: Assists
        if (newP.assists !== undefined && existLat.assists !== undefined && parseInt(newP.assists) === parseInt(existLat.assists)) matchCount++; 
        
        // Criteria 5: Apps (Appearances)
        if (newP.apps !== undefined && existLat.apps !== undefined && parseInt(newP.apps) === parseInt(existLat.apps)) matchCount++; 
        
        // If 3 or more stats match within the same team, assume same player
        if (matchCount >= 3) return true; 
    } 
    return false; 
}

async function startSaveProcess() { currentConflicts = []; const uniqueNewNames = [...new Set([...batchPendingResults.latest.map(x=>x.name), ...batchPendingResults.lifetime.map(x=>x.name)])]; uniqueNewNames.forEach(newName => { if (!newName) return; if (playerMaster.find(p => p.name === newName)) return; const newP = batchPendingResults.latest.find(x => x.name === newName) || batchPendingResults.lifetime.find(x => x.name === newName); if(!newP) return; let similarMatch = null; for (let i=0; i<playerMaster.length; i++) { if (checkSimilarity(newP, playerMaster[i])) { similarMatch = playerMaster[i]; break; } } if (similarMatch) currentConflicts.push({ newName, newData: newP, existPlayer: similarMatch }); }); if (currentConflicts.length > 0) { renderMergeModal(); document.getElementById('mergeConfirmModal').classList.replace('hidden', 'flex'); } else { await executeFinalSave(); } }
function renderMergeModal() {
    const container = document.getElementById('mergeConflictList');
    const tooltipStyle = `
        position:relative; display:inline-flex; align-items:center;
    `;
    // Tooltip HTML helper
    const tip = (text) => `<span style="position:relative;display:inline-block;cursor:help;" class="merge-tooltip-wrap">
        <span style="display:inline-flex;align-items:center;justify-content:center;width:14px;height:14px;background:#94a3b8;border-radius:50%;color:white;font-size:9px;font-weight:bold;line-height:1;margin-left:4px;">?</span>
        <span class="merge-tooltip-box" style="
            visibility:hidden;opacity:0;position:absolute;left:50%;transform:translateX(-50%);bottom:calc(100% + 6px);
            background:#1e293b;color:#f1f5f9;border:1px solid #475569;
            padding:6px 10px;border-radius:8px;font-size:10px;white-space:nowrap;
            z-index:9999;pointer-events:none;transition:opacity .15s;min-width:220px;text-align:left;line-height:1.6;
        ">${text}</span>
    </span>`;

    container.innerHTML = currentConflicts.map((c, idx) => {
        const existLat = (c.existPlayer.history||[]).filter(h=>h.dataType==='latest').pop() || {};
        const isSameName = c.newName === c.existPlayer.name;
        const isChecked = isSameName ? 'checked' : '';
        // 記事掲載日
        const articleDate = c.articleDate || c.publishDate || '日付不明';
        const existTeam = teamMaster.find(t => t.id === c.existPlayer?.teamId)?.name || '不明';
        const newTeam = teamMaster.find(t => t.id === c._teamId || t.id === c.newTeamId)?.name || '不明';

        return `<div class="bg-white border-2 border-orange-200 rounded-2xl p-6 shadow-sm flex flex-col gap-4 relative">
            <!-- ヘッダー: チェックボックス + 記事日付 -->
            <div class="flex items-center justify-between mb-2">
                <div class="flex items-center gap-3">
                    <label class="flex items-center gap-2 cursor-pointer">
                        <input type="checkbox" id="mergeCheck_${idx}" class="w-5 h-5 text-emerald-600 rounded focus:ring-emerald-500" ${isChecked}>
                        <span class="text-xs font-bold text-slate-700">この項目を処理対象にする</span>
                    </label>
                </div>
                <div class="flex items-center gap-2 bg-amber-50 px-3 py-1 rounded-lg border border-amber-200">
                    <span class="text-[10px] text-amber-700">📅 記事掲載日:</span>
                    <span class="text-[10px] font-bold text-amber-900">${articleDate}</span>
                </div>
            </div>

            <!-- 選手データ比較 -->
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-blue-50 p-4 rounded-xl border border-blue-200">
                    <div class="text-[9px] font-bold text-blue-600 uppercase tracking-widest mb-2">📰 記事データ（新）</div>
                    <div class="text-sm font-bold text-blue-900">${c.newName}</div>
                    <div class="text-[10px] text-blue-600 mt-1">チーム: ${newTeam}</div>
                </div>
                <div class="bg-slate-50 p-4 rounded-xl border border-slate-200">
                    <div class="text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-2">💾 DBデータ（既存）</div>
                    <div class="text-sm font-bold text-slate-800">${c.existPlayer.name}</div>
                    <div class="text-[10px] text-slate-500 mt-1">チーム: ${existTeam}</div>
                    <div class="text-[10px] text-slate-400">OVR: ${existLat.overall||existLat.rating||'-'} / Apps: ${existLat.apps||'-'}</div>
                </div>
            </div>

            <!-- 処理方法選択 A/B/C/D/E -->
            <div class="flex flex-col gap-2 border-t border-slate-100 pt-3">
                <div class="text-[9px] font-bold text-slate-500 uppercase tracking-widest mb-1">処理方法を選択してください</div>

                <!-- A: 全変更 -->
                <label class="flex items-start gap-3 cursor-pointer bg-blue-50 px-4 py-3 rounded-xl border-2 border-blue-200 hover:border-blue-400 transition">
                    <input type="radio" name="merge_${idx}" value="existing" checked class="w-5 h-5 text-blue-600 focus:ring-blue-500 mt-0.5">
                    <div class="flex-1">
                        <div class="flex items-center gap-1">
                            <span class="text-xs font-bold text-blue-900">A. 全変更</span>
                            ${tip('PSIDと所属チームを記事通りに変更した上でラベルを追加します。\n記事の情報で全上書き。移籍が確定している場合に使用。')}
                        </div>
                        <span class="text-[9px] text-blue-600 mt-0.5 block">PSID + 所属チーム → 記事通りに変更 → ラベル追加</span>
                    </div>
                </label>

                <!-- B: ラベルのみ -->
                <label class="flex items-start gap-3 cursor-pointer bg-emerald-50 px-4 py-3 rounded-xl border-2 border-emerald-200 hover:border-emerald-400 transition">
                    <input type="radio" name="merge_${idx}" value="label_only" class="w-5 h-5 text-emerald-600 focus:ring-emerald-500 mt-0.5">
                    <div class="flex-1">
                        <div class="flex items-center gap-1">
                            <span class="text-xs font-bold text-emerald-900">B. ラベルのみ追加</span>
                            ${tip('IDとチームは変更しません。\nラベル（特殊カード）の追加のみ行います。\n選手情報は現在のDBを維持したい場合に使用。')}
                        </div>
                        <span class="text-[9px] text-emerald-600 mt-0.5 block">PSID・チームはDB保持 → ラベルのみ追加</span>
                    </div>
                </label>

                <!-- C: PSIDのみ更新 -->
                <label class="flex items-start gap-3 cursor-pointer bg-purple-50 px-4 py-3 rounded-xl border-2 border-purple-200 hover:border-purple-400 transition">
                    <input type="radio" name="merge_${idx}" value="rename" class="w-5 h-5 text-purple-600 focus:ring-purple-500 mt-0.5">
                    <div class="flex-1">
                        <div class="flex items-center gap-1">
                            <span class="text-xs font-bold text-purple-900">C. PSIDのみ更新</span>
                            ${tip('PSIDを記事通りに変更してラベルを追加。\n所属チームはDBデータを保持します。\n改名が確認できてもチーム移籍が未確定の場合に。')}
                        </div>
                        <span class="text-[9px] text-purple-600 mt-0.5 block">PSID → 記事通りに更新 → ラベル追加 / チームはDB保持</span>
                    </div>
                </label>

                <!-- D: 所属チームのみ更新 -->
                <label class="flex items-start gap-3 cursor-pointer bg-orange-50 px-4 py-3 rounded-xl border-2 border-orange-200 hover:border-orange-400 transition">
                    <input type="radio" name="merge_${idx}" value="team_only" class="w-5 h-5 text-orange-600 focus:ring-orange-500 mt-0.5">
                    <div class="flex-1">
                        <div class="flex items-center gap-1">
                            <span class="text-xs font-bold text-orange-900">D. 所属チームのみ更新</span>
                            ${tip('所属チームを記事通りに変更してラベルを追加。\nPSIDはDBデータを保持します。\nチーム移籍は確定だがPSIDは変更なしの場合に。')}
                        </div>
                        <span class="text-[9px] text-orange-600 mt-0.5 block">チーム → 記事通りに更新 → ラベル追加 / PSIDはDB保持</span>
                    </div>
                </label>

                <!-- E: 一切変更しない -->
                <label class="flex items-start gap-3 cursor-pointer bg-red-50 px-4 py-3 rounded-xl border-2 border-red-200 hover:border-red-400 transition">
                    <input type="radio" name="merge_${idx}" value="ignore" class="w-5 h-5 text-red-500 focus:ring-red-400 mt-0.5">
                    <div class="flex-1">
                        <div class="flex items-center gap-1">
                            <span class="text-xs font-bold text-red-800">E. 一切変更しない</span>
                            ${tip('DBデータをすべて保持します。\nラベルも追加されません。\nこの検出結果を完全に無視する場合に使用。')}
                        </div>
                        <span class="text-[9px] text-red-600 mt-0.5 block">DBデータ完全保持 → ラベルも追加しない</span>
                    </div>
                </label>
            </div>
        </div>`;
    }).join('');

    // Activate tooltip hover events
    setTimeout(() => {
        document.querySelectorAll('.merge-tooltip-wrap').forEach(el => {
            const box = el.querySelector('.merge-tooltip-box');
            if (box) {
                el.addEventListener('mouseenter', () => { box.style.visibility = 'visible'; box.style.opacity = '1'; });
                el.addEventListener('mouseleave', () => { box.style.visibility = 'hidden'; box.style.opacity = '0'; });
            }
        });
    }, 50);
}

// v50.64 Fix: Logic for 3-way merge options (Existing, Rename, New)
async function executeFinalSave() { 
    let mergeDecisions = {}; 
    const activeConflicts = []; // To keep in UI
    let processedCount = 0;

    // Iterate through conflicts to see which are checked
    if (currentConflicts.length > 0) { 
        currentConflicts.forEach((c, idx) => { 
            const checkbox = document.getElementById(`mergeCheck_${idx}`);
            if (checkbox && checkbox.checked) {
                // Process this one
                const radio = document.querySelector(`input[name="merge_${idx}"]:checked`); 
                if (radio) {
                    // Store decision: 'new', 'existing', or 'rename'
                    mergeDecisions[c.newName] = { action: radio.value, existName: c.existPlayer.name };
                }
                processedCount++;
            } else {
                // Keep this one in UI
                activeConflicts.push(c);
            }
        }); 
    }

    const itemsToProcess = [];
    const remainingLatest = [];
    const remainingLifetime = [];

    // Helper to check if an item was processed
    const isConflictAndChecked = (name) => {
        const conflictIndex = currentConflicts.findIndex(c => c.newName === name);
        if (conflictIndex === -1) return true; // Not a conflict (safe to add directly)
        const checkbox = document.getElementById(`mergeCheck_${conflictIndex}`);
        return checkbox && checkbox.checked;
    };

    // Filter Latest
    batchPendingResults.latest.forEach(item => {
        if (isConflictAndChecked(item.name)) {
            itemsToProcess.push({ ...item, type: 'latest' });
        } else {
            remainingLatest.push(item);
        }
    });

    // Filter Lifetime
    batchPendingResults.lifetime.forEach(item => {
        if (isConflictAndChecked(item.name)) {
            itemsToProcess.push({ ...item, type: 'lifetime' });
        } else {
            remainingLifetime.push(item);
        }
    });

    const today = new Date().toLocaleDateString('ja-JP').replace(/\//g, '-'); 
    
    // Apply changes
    itemsToProcess.forEach(s => { 
        if(!s.name) return; 
        const newTeamId = s._teamId || targetAutoTeamId; 
        let targetName = s.name;
        const decision = mergeDecisions[s.name];

        // v52.174: Handle conflict decisions (A/B/C/D/E options)
        if (decision) {
            if (decision.action === 'existing') {
                // A: 全変更 - PSIDとチームを記事通りに
                targetName = decision.existName;
            } else if (decision.action === 'label_only') {
                // B: ラベルのみ - IDもチームも変更しない
                targetName = decision.existName;
                decision._labelOnly = true;
            } else if (decision.action === 'rename') {
                // C: PSIDのみ更新 - チームはDB保持
                const existP = playerMaster.find(p => p.name === decision.existName);
                if (existP) {
                    existP.name = s.name;
                    targetName = s.name;
                }
                decision._keepTeam = true;
            } else if (decision.action === 'team_only') {
                // D: 所属チームのみ更新 - PSIDはDB保持
                targetName = decision.existName;
                decision._teamOnly = true;
            } else if (decision.action === 'new') {
                targetName = s.name;
            } else if (decision.action === 'ignore') {
                return; // E: 🚫 一切変更しない
            }
        }

        let p = playerMaster.find(x => x.name === targetName); 
        
        // If decision was 'new', force new creation even if similar exist (but name must differ)
        if (!p) { 
            p = { name: targetName, nickname: s.nickname || "", teamId: newTeamId, history: [], labels: [] }; 
            playerMaster.push(p); 
        } else { 
            if (s.nickname) p.nickname = s.nickname; 
            
            // v52.174: respect merge decision flags
            const skipTeamUpdate = decision && (decision._labelOnly || decision._keepTeam);
            
            // Handle Transfer Logic
            if (!skipTeamUpdate) {
                if (newTeamId && p.teamId && p.teamId !== newTeamId) { 
                    const oldTeam = teamMaster.find(t => t.id === p.teamId); 
                    if (!p.past_teams) p.past_teams = []; 
                    if (!p.past_teams.find(pt => pt.id === p.teamId)) { 
                        p.past_teams.push({ id: p.teamId, name: oldTeam?.name || "Unknown", leftDate: today }); 
                    } 
                    p.teamId = newTeamId; 
                } else if (!p.teamId && newTeamId) { 
                    p.teamId = newTeamId; 
                }
            }
        } 
        
        // Add History
        p.history = p.history.filter(h => !(h.date === today && h.dataType === s.type)); 
        const { _teamId, type, ...cleanData } = s; 
        p.history.push({ date: today, dataType: type, ...cleanData }); 
    }); 

    await saveToCloud(); 

    // Update State
    batchPendingResults.latest = remainingLatest;
    batchPendingResults.lifetime = remainingLifetime;
    currentConflicts = activeConflicts;

    if (currentConflicts.length === 0 && batchPendingResults.latest.length === 0 && batchPendingResults.lifetime.length === 0) {
        document.getElementById('mergeConfirmModal').classList.replace('flex', 'hidden'); 
        showMessage("全データ反映完了", "success"); 
        switchTab('players'); 
        autoAnalysisQueue = autoAnalysisQueue.filter(x => x.status !== 'done'); 
        renderAutoQueueCards(); 
    } else {
        renderMergeModal();
        showMessage(`選択項目を保存しました。残り: ${currentConflicts.length}件`, "success");
    }
}

// Define Manager Functions before Object.assign
function renderTeamManagerList() { const listContainer = document.getElementById('teamManagerList'); const sortedTeams = [...teamMaster].sort((a,b) => a.name.localeCompare(b.name, 'ja')); listContainer.innerHTML = sortedTeams.map((t) => { const l1Opt = Object.entries(leagueLabelMap).filter(([id])=>id).map(([id,name]) => `<option value="${id}" ${t.l1 === id ? 'selected' : ''}>${name}</option>`).join(''); const l2Checkboxes = Object.entries(leagueLabelMap).filter(([id])=>id).map(([id,name]) => `<label class="flex items-center gap-1 text-[9px] w-full hover:bg-slate-100 p-1 rounded cursor-pointer transition-colors"><input type="checkbox" value="${id}" ${Array.isArray(t.l2) && t.l2.includes(id)?'checked':''} class="edit-team-l2-check-${t.id} w-3 h-3 text-emerald-600 focus:ring-emerald-500 rounded border-slate-300"> <span>${name}</span></label>` ).join(''); return ` <div class="flex items-center gap-3 bg-slate-50 p-3 rounded-xl border border-slate-200"> <div class="w-16 shrink-0 text-center flex flex-col items-center"> <input type="checkbox" class="team-batch-check w-4 h-4 text-indigo-600 rounded border-slate-300 cursor-pointer" value="${t.id}"> <span class="text-[9px] text-slate-400 block mt-2 mb-1">ID</span> <span class="font-mono text-xs font-bold text-slate-700">${t.id}</span> </div> <div class="flex-1"> <input type="text" id="editTeamName_${t.id}" value="${t.name}" class="w-full bg-white border border-slate-200 rounded px-2 py-1.5 text-xs outline-none focus:border-indigo-400 mb-2" placeholder="チーム名"> <div class="grid grid-cols-2 gap-3"> <div> <span class="text-[9px] text-slate-500 mb-1 block">メイン (L1)</span> <select id="editTeamL1_${t.id}" class="w-full bg-white border border-slate-200 rounded px-1 py-1.5 text-[10px] outline-none cursor-pointer">${l1Opt}</select> </div> <div> <span class="text-[9px] text-slate-500 mb-1 block">サブ (L2/複数可)</span> <div class="l2-check-container custom-scrollbar"> ${l2Checkboxes} </div> </div> </div> </div> <div class="flex flex-col gap-2 shrink-0"> <button onclick="window.updateTeam('${t.id}')" class="bg-indigo-600 text-white px-4 py-2 rounded-lg text-[10px] hover:bg-indigo-700 active:scale-95 transition-transform shadow-md font-bold">更新</button> <button onclick="window.deleteTeam('${t.id}')" class="bg-red-50 text-red-500 border border-red-200 px-4 py-2 rounded-lg text-[10px] hover:bg-red-100 active:scale-95 transition-transform font-bold">削除</button> </div> </div>`; }).join(''); }
// ─────────────────────────────────────────────────────────────────
// v52.181: リーグ構造化フォーム ヘルパー
// ─────────────────────────────────────────────────────────────────
window.buildLeagueLabel = function(meta) {
  if (!meta) return '';
  const parts = [meta.year, meta.season, meta.category, meta.div].filter(Boolean);
  return parts.join(' ');
};

window.updateLeaguePreview = function() {
  const year   = document.getElementById('newLeagueYear')?.value.trim()    || '';
  const season = document.getElementById('newLeagueSeason')?.value.trim()  || '';
  const cat    = document.getElementById('newLeagueCategory')?.value.trim()|| '';
  const divSel = document.getElementById('newLeagueDiv')?.value             || '';
  const divCst = document.getElementById('newLeagueDivCustom')?.value.trim()|| '';
  const div    = divCst || divSel;
  const prev   = document.getElementById('newLeaguePreview');
  if (!prev) return;
  if (!year && !season && !cat && !div) {
    prev.innerHTML = '<span class="text-slate-400 text-xs">各項目を入力するとプレビューが表示されます</span>';
    return;
  }
  const isOp = div === 'OP';
  prev.innerHTML = [
    year   ? `<span class="league-year-badge">${year}</span>`                        : '<span class="text-slate-300 text-xs">年度?</span>',
    season ? `<span class="league-season-badge">${season}</span>`                    : '',
    cat    ? `<span class="league-cat-badge">${cat}</span>`                          : '',
    div    ? `<span class="league-div-badge${isOp?' op':''}">${div}</span>`          : ''
  ].filter(Boolean).join('');
};

window.toggleQuickLeagueForm = function() {
  const f = document.getElementById('quickLeagueForm');
  if (f) f.classList.toggle('hidden');
};

window.saveQuickLeague = async function() {
  let id      = document.getElementById('quickLeagueId')?.value.trim()       || '';
  id          = window.toHalfWidthNumbers(id);
  const year  = document.getElementById('quickLeagueYear')?.value.trim()     || '';
  const season= document.getElementById('quickLeagueSeason')?.value.trim()   || '';
  const cat   = document.getElementById('quickLeagueCategory')?.value.trim() || '';
  const divSel= document.getElementById('quickLeagueDiv')?.value              || '';
  const divCst= document.getElementById('quickLeagueDivCustom')?.value.trim() || '';
  const div   = divCst || divSel;
  if (!id || !year || !season || !cat || !div) {
    showMessage('⚠ すべての項目を入力してください (ID・年度・シーズン・カテゴリ・DIV)', 'warning');
    return;
  }
  if (leagueLabelMap[id] !== undefined) {
    showMessage('このリーグIDは既に存在します', 'error'); return;
  }
  const meta = { year, season, category: cat, div };
  leagueMeta[id] = meta;
  leagueLabelMap[id] = window.buildLeagueLabel(meta);
  await saveToCloud();
  updateUIForLeagueChange();
  // 追加したリーグをL1セレクトに反映して選択状態にする
  const l1Sel = document.getElementById('newTeamL1');
  if (l1Sel) l1Sel.value = id;
  // quickフォームをリセット&閉じる
  ['quickLeagueId','quickLeagueYear','quickLeagueSeason','quickLeagueCategory','quickLeagueDivCustom'].forEach(elId => {
    const el = document.getElementById(elId); if(el) el.value = '';
  });
  const qDiv = document.getElementById('quickLeagueDiv'); if(qDiv) qDiv.value = '';
  const qForm = document.getElementById('quickLeagueForm'); if(qForm) qForm.classList.add('hidden');
  showMessage(`リーグ「${window.buildLeagueLabel(meta)}」を追加してL1に設定しました`, 'success');
};

function renderLeagueManagerList() {
  const listContainer = document.getElementById('leagueManagerList');
  const sortedLeagues = Object.entries(leagueLabelMap).filter(([id])=>id!=="").sort(([a],[b])=>a.localeCompare(b));
  const DIV_OPTIONS = ['01部','02部','03部','04部','05部','OP'].map(v=>`<option value="${v}">${v}</option>`).join('');
  listContainer.innerHTML = sortedLeagues.map(([id, name]) => {
    const m = leagueMeta[id] || {};
    const yearVal    = m.year     || '';
    const seasonVal  = m.season   || '';
    const catVal     = m.category || '';
    const divVal     = m.div      || '';
    const isPreset   = ['01部','02部','03部','04部','05部','OP'].includes(divVal);
    const divSel     = ['01部','02部','03部','04部','05部','OP'].map(v=>`<option value="${v}"${v===divVal?' selected':''}>${v}</option>`).join('');
    return `
    <div class="bg-white border-2 border-slate-100 rounded-2xl p-4 mb-3 hover:border-indigo-200 transition">
      <div class="flex items-center justify-between mb-3">
        <div class="league-label-display">
          <span class="league-year-badge">${yearVal||'??'}</span>
          <span class="league-season-badge">${seasonVal||'?th'}</span>
          <span class="league-cat-badge">${catVal||'カテゴリ未設定'}</span>
          <span class="league-div-badge${(divVal==='OP')?' op':''}">${divVal||'DIV未設定'}</span>
        </div>
        <span class="text-[9px] font-mono text-slate-400 bg-slate-100 px-2 py-1 rounded">ID: ${id}</span>
      </div>
      <div class="grid gap-2" style="grid-template-columns:60px 70px 1fr 80px">
        <div>
          <label class="text-[8px] text-indigo-500 font-bold uppercase block mb-1">年度</label>
          <input type="text" id="editLeagueYear_${id}" value="${yearVal}"
            class="w-full bg-slate-50 border border-slate-200 rounded px-1 py-1.5 text-xs outline-none focus:border-indigo-400 league-year-input text-center" maxlength="6">
        </div>
        <div>
          <label class="text-[8px] text-slate-400 uppercase block mb-1">シーズン</label>
          <input type="text" id="editLeagueSeason_${id}" value="${seasonVal}"
            class="w-full bg-slate-50 border border-slate-200 rounded px-1 py-1.5 text-xs outline-none focus:border-indigo-400 font-bold text-center">
        </div>
        <div>
          <label class="text-[8px] text-slate-400 uppercase block mb-1">リーグカテゴリ</label>
          <input type="text" id="editLeagueCategory_${id}" value="${catVal}"
            class="w-full bg-slate-50 border border-slate-200 rounded px-2 py-1.5 text-xs outline-none focus:border-indigo-400"
            list="leagueCategoryList">
        </div>
        <div>
          <label class="text-[8px] text-slate-400 uppercase block mb-1">DIV</label>
          <select id="editLeagueDiv_${id}"
            class="w-full bg-slate-50 border border-slate-200 rounded px-1 py-1.5 text-xs outline-none focus:border-indigo-400 text-center"
            onchange="document.getElementById('editLeagueDivCustom_${id}').value=''">
            <option value="">選択</option>${divSel}
          </select>
        </div>
      </div>
      <div class="mt-2">
        <label class="text-[8px] text-slate-400 uppercase block mb-1">DIV カスタム (任意)</label>
        <input type="text" id="editLeagueDivCustom_${id}" value="${isPreset?'':divVal}"
          class="w-full bg-slate-50 border border-slate-200 rounded px-2 py-1.5 text-xs outline-none focus:border-indigo-400"
          placeholder="例: 02部B、カップ戦 など">
      </div>
      <div class="mt-2">
        <label class="text-[8px] text-slate-400 uppercase block mb-1">ID変更 (慎重に)</label>
        <input type="text" id="editLeagueId_${id}" value="${id}"
          class="w-full bg-slate-50 border border-slate-200 rounded px-1 py-1.5 text-xs outline-none focus:border-red-400 font-mono font-bold text-center">
      </div>
      <div class="flex gap-2 mt-3">
        <button onclick="window.updateLeague('${id}')"
          class="flex-1 bg-indigo-600 text-white py-2 rounded-lg text-[10px] hover:bg-indigo-700 active:scale-95 transition-transform font-bold">✏️ 更新</button>
        <button onclick="window.deleteLeague('${id}')"
          class="bg-red-50 text-red-500 border border-red-200 px-4 py-2 rounded-lg text-[10px] hover:bg-red-100 active:scale-95 transition-transform font-bold">🗑 削除</button>
      </div>
    </div>`;
  }).join('');
}
function openTeamManager() { window.switchManagerTab('teams'); document.getElementById('teamManagerModal').classList.replace('hidden', 'flex'); }
function closeTeamManager() { document.getElementById('teamManagerModal').classList.replace('flex', 'hidden'); }


// ================================================================
// v52.174: DB バージョン履歴管理
// ================================================================
function renderDbSnapshotList() {
    const container = document.getElementById('dbSnapshotList');
    if (!container) return;
    if (!dbSnapshots || dbSnapshots.length === 0) {
        container.innerHTML = `<div class="text-center p-6 text-slate-400 text-xs">スナップショットがありません。<br>データを保存すると自動的に記録されます。</div>`;
        return;
    }
    const sorted = [...dbSnapshots].reverse(); // 新しい順
    container.innerHTML = sorted.map((snap, i) => {
        const realIdx = dbSnapshots.length - 1 - i;
        const isActive = activeSnapshotIndex === realIdx || (activeSnapshotIndex === -1 && i === 0);
        const dt = new Date(snap.ts);
        const dateStr = dt.toLocaleDateString('ja-JP', {year:'numeric',month:'2-digit',day:'2-digit'});
        const timeStr = dt.toLocaleTimeString('ja-JP', {hour:'2-digit',minute:'2-digit',second:'2-digit'});
        const pm = (() => { try { return JSON.parse(snap.playerMaster || '[]'); } catch(e) { return []; } })();
        const tm = (() => { try { return JSON.parse(snap.teamMaster || '[]'); } catch(e) { return []; } })();
        const statusColor = isActive ? 'border-emerald-400 bg-emerald-50' : 'border-slate-200 bg-white';
        const badge = isActive
            ? `<span class="px-2 py-0.5 bg-emerald-500 text-white rounded-full text-[9px] font-bold">● 最新</span>`
            : `<span class="px-2 py-0.5 bg-red-100 text-red-600 rounded-full text-[9px] font-bold">◉ 過去</span>`;
        return `<div class="db-snapshot-card border-2 rounded-xl p-4 mb-3 transition-all cursor-default ${statusColor} ${isActive ? 'is-active' : 'is-past'}"
                     title="このバージョンを表示中: ${dateStr} ${timeStr}">
            <div class="flex items-center justify-between mb-2">
                <div class="flex items-center gap-2">
                    ${badge}
                    <span class="text-xs font-bold text-slate-700">${dateStr} ${timeStr}</span>
                </div>
                <div class="flex gap-2">
                    ${!isActive ? `<button onclick="window.loadSnapshot(${realIdx})" class="px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-[10px] hover:bg-blue-200 transition">🔍 この時点を表示</button>` : ''}
                    ${!isActive ? `<button onclick="window.restoreSnapshot(${realIdx})" class="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-lg text-[10px] hover:bg-emerald-200 transition">♻️ 復元</button>` : ''}
                    <button onclick="window.deleteSnapshot(${realIdx})" class="px-3 py-1 bg-red-100 text-red-600 rounded-lg text-[10px] hover:bg-red-200 transition">🗑️ 削除</button>
                </div>
            </div>
            <div class="text-[10px] text-slate-500">選手: ${pm.length}人 / チーム: ${tm.length}チーム</div>
        </div>`;
    }).join('');
}

function loadSnapshot(idx) {
    // Temporarily view data from a past snapshot without overwriting current
    if (idx < 0 || idx >= dbSnapshots.length) return;
    const snap = dbSnapshots[idx];
    try {
        playerMaster = JSON.parse(snap.playerMaster || '[]');
        teamMaster = JSON.parse(snap.teamMaster || '[]');
        if (snap.customLabels) customLabels = JSON.parse(snap.customLabels);
        activeSnapshotIndex = idx;
        updateView();
        renderDbSnapshotList();
        const dt = new Date(snap.ts);
        showMessage(`📅 ${dt.toLocaleDateString('ja-JP')} ${dt.toLocaleTimeString('ja-JP')} のバージョンを表示中（保存はされていません）`, 'info');
    } catch(e) {
        showMessage('スナップショットの読み込みに失敗しました', 'error');
    }
}

function restoreSnapshot(idx) {
    if (idx < 0 || idx >= dbSnapshots.length) return;
    if (!confirm('このバージョンで現在のDBを上書きします。続けますか？')) return;
    loadSnapshot(idx);
    activeSnapshotIndex = -1;
    saveToCloud();
    showMessage('✅ 指定バージョンに復元して保存しました', 'success');
    renderDbSnapshotList();
}

function deleteSnapshot(idx) {
    if (idx < 0 || idx >= dbSnapshots.length) return;
    const snap = dbSnapshots[idx];
    const dt = new Date(snap.ts);
    if (!confirm(`${dt.toLocaleDateString('ja-JP')} ${dt.toLocaleTimeString('ja-JP')} のスナップショットを削除しますか？`)) return;
    dbSnapshots.splice(idx, 1);
    if (activeSnapshotIndex === idx) {
        activeSnapshotIndex = -1;
        // Reload current data from Cloud
        if (user) loadFromCloud(user.uid);
    }
    saveToCloud();
    renderDbSnapshotList();
    showMessage('スナップショットを削除しました', 'success');
}

function returnToLatest() {
    if (activeSnapshotIndex === -1) return;
    activeSnapshotIndex = -1;
    if (user) loadFromCloud(user.uid);
    else { updateView(); renderDbSnapshotList(); }
    showMessage('最新データに戻りました', 'success');
}


// ─────────────────────────────────────────────────────────────────────────────
// Sprint 2: Integrated Search Functions (parseSearchQuery defined at L~4786)
// ─────────────────────────────────────────────────────────────────────────────


window.hlText = function(text, query) {
    if (!text || !query) return text || '';
    const { term } = parseSearchQuery(query);
    if (!term) return text;
    const escaped = term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    return text.replace(new RegExp(`(${escaped})`, 'gi'), '<mark class="sh">$1</mark>');
};

window.onSearchInput = function(val) {
    const clearBtn = document.getElementById('searchClearBtn');
    const hint = document.getElementById('searchHint');
    if (clearBtn) clearBtn.classList.toggle('visible', val.length > 0);
    if (hint) hint.classList.toggle('visible', val.startsWith('#') || val.startsWith('!') || val.startsWith('@'));
    updateView();
};

window.clearSearch = function() {
    const inp = document.getElementById('playerSearch');
    if (inp) { inp.value = ''; inp.focus(); }
    window.onSearchInput('');
};
// ── 検索ヒント表示制御 (v52.179b) ─────────────────────────────
(function() {
  function setupSearchHint() {
    const inp = document.getElementById('playerSearch');
    const hint = document.getElementById('searchHint');
    if (!inp || !hint) return;
    inp.addEventListener('focus', () => hint.classList.remove('hidden'));
    inp.addEventListener('blur',  () => setTimeout(() => hint.classList.add('hidden'), 200));
    document.addEventListener('keydown', (e) => {
      if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
        e.preventDefault(); inp.focus(); inp.select();
      }
    });
  }
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', setupSearchHint);
  } else { setupSearchHint(); }
})();
// ─────────────────────────────────────────────────────────────


window.onSearchKeydown = function(e) {
    if (e.key === 'Escape') window.clearSearch();
    if (e.key === 'Enter') {
        const val = e.target.value.trim();
        if (val) {
            const recent = JSON.parse(localStorage.getItem('esdb_recent_search') || '[]');
            const filtered = recent.filter(r => r !== val).slice(0, 7);
            localStorage.setItem('esdb_recent_search', JSON.stringify([val, ...filtered]));
        }
    }
};

window.updateSearchBreakdown = function(bd, total) {
    const el = document.getElementById('searchResultBreakdown');
    if (!el) return;
    const rawQ = (document.getElementById('playerSearch')?.value || '');
    if (!rawQ) { el.innerHTML = ''; return; }
    const parts = [];
    if (bd.psid)  parts.push('<span class="smb-psid">PSID: ' + bd.psid + '</span>');
    if (bd.nick)  parts.push('<span class="smb-nick">ニック: ' + bd.nick + '</span>');
    if (bd.num)   parts.push('<span class="smb-num">#背番号: ' + bd.num + '</span>');
    if (bd.label) parts.push('<span class="smb-label">!ラベル: ' + bd.label + '</span>');
    if (bd.team)  parts.push('<span class="smb-team">@チーム: ' + bd.team + '</span>');
    el.innerHTML = parts.join('');
};

window.getCheckedPsids = function() {
    return Array.from(document.querySelectorAll('.player-select-cb:checked')).map(cb => cb.dataset.psid);
};

window.bulkAddLabel = function() {
    const psids = window.getCheckedPsids();
    if (psids.length === 0) return;
    const allLabels = [...new Set(playerMaster.flatMap(p => p.labels || []))].sort();
    const label = prompt(psids.length + '人に追加するラベルを入力してください:\n(既存: ' + allLabels.slice(0,10).join(', ') + (allLabels.length > 10 ? '...' : '') + ')');
    if (!label || !label.trim()) return;
    psids.forEach(psid => {
        const p = playerMaster.find(x => x.name === psid);
        if (p) { if (!p.labels) p.labels = []; if (!p.labels.includes(label.trim())) p.labels.push(label.trim()); }
    });
    saveToCloud().then(() => { updateView(); showMessage(psids.length + '人に「' + label.trim() + '」を追加しました', 'success'); });
};

// ─────────────────────────────────────────────────────────────────────────────
// Sprint 2: Team Transfer Modal
// ─────────────────────────────────────────────────────────────────────────────

var _transferTargetPsids = [];

window.openTransferModal = function(psids) {
    if (!psids || psids.length === 0) return;
    _transferTargetPsids = psids;
    const modal = document.getElementById('transferModal');
    if (!modal) { console.warn('[Transfer] Modal not found'); return; }

    const players = psids.map(id => playerMaster.find(p => p.name === id)).filter(Boolean);
    const teamSet = [...new Set(players.map(p => p.teamId))];
    const fromTeamNames = teamSet.map(tid => {
        if (tid === '' || tid === undefined || tid === null) return 'FA (未所属)';
        return teamMaster.find(t => t.id === tid)?.name || tid;
    }).join(', ');

    const fromEl = document.getElementById('transferFromTeam');
    const listEl = document.getElementById('transferPlayerList');
    if (fromEl) fromEl.textContent = fromTeamNames;
    if (listEl) listEl.innerHTML = players.map(p =>
        '<span class="text-xs bg-slate-100 px-2 py-1 rounded-lg">' + p.name + (p.nickname ? ' (' + p.nickname + ')' : '') + '</span>'
    ).join('');

    const dateEl = document.getElementById('transferDate');
    if (dateEl) dateEl.value = new Date().toISOString().slice(0,10);

    const toSel = document.getElementById('transferToTeam');
    if (toSel) {
        toSel.innerHTML = '<option value="">-- 移籍先チームを選択 --</option>'
            + '<option value="__FA__">🚫 FA（フリーエージェント）</option>'
            + teamMaster.slice().sort((a,b) => (a.name||'').localeCompare(b.name||'')).map(t =>
                '<option value="' + t.id + '">' + t.name + '</option>'
            ).join('');
    }

    modal.classList.remove('hidden');
    modal.classList.add('flex');
};

window.closeTransferModal = function() {
    const modal = document.getElementById('transferModal');
    if (modal) { modal.classList.add('hidden'); modal.classList.remove('flex'); }
};

window.executeTransfer = async function() {
    const toTeamIdEl = document.getElementById('transferToTeam');
    const transferDateEl = document.getElementById('transferDate');
    const transferTypeEl = document.getElementById('transferType');
    const notesEl = document.getElementById('transferNotes');

    const toTeamId = toTeamIdEl ? toTeamIdEl.value : '';
    const transferDate = (transferDateEl && transferDateEl.value) ? transferDateEl.value : new Date().toLocaleDateString('ja-JP').replace(/\//g,'-');
    const transferType = transferTypeEl ? transferTypeEl.value : '完全移籍';
    const notes = notesEl ? notesEl.value.trim() : '';

    if (!toTeamId) { showMessage('移籍先チームを選択してください', 'error'); return; }

    const toTeamName = toTeamId === '__FA__' ? 'FA' : (teamMaster.find(t => t.id === toTeamId)?.name || toTeamId);
    const newTeamId = toTeamId === '__FA__' ? '' : toTeamId;

    let count = 0;
    for (const psid of _transferTargetPsids) {
        const p = playerMaster.find(x => x.name === psid);
        if (!p) continue;

        if (p.teamId !== newTeamId) {
            const oldTeam = teamMaster.find(t => t.id === p.teamId);
            if (!p.past_teams) p.past_teams = [];
            const alreadyHas = p.past_teams.find(pt => pt.id === p.teamId && pt.leftDate === transferDate);
            if (!alreadyHas) {
                p.past_teams.push({
                    id: p.teamId,
                    name: (p.teamId === '' || p.teamId === undefined) ? 'FA' : (oldTeam?.name || 'Unknown'),
                    leftDate: transferDate,
                    joinType: transferType,
                    notes: notes || undefined
                });
            }
        }

        p.teamId = newTeamId;
        p.joinDate = transferDate;

        if (!p.labels) p.labels = [];
        if (newTeamId === '') {
            if (!p.labels.includes('FA')) p.labels.push('FA');
        } else {
            p.labels = p.labels.filter(l => l !== 'FA');
        }
        count++;
    }

    await saveToCloud();
    window.closeTransferModal();
    if (window.toggleSelectAllPlayers) window.toggleSelectAllPlayers(false);
    if (window.onPlayerCheckChange) window.onPlayerCheckChange();
    updateView();
    showMessage(count + '人の移籍処理が完了しました → ' + toTeamName, 'success');
};

// ─────────────────────────────────────────────────────────────────────────────
// Sprint 2: Enhanced openHistoryModal with Transfer Timeline
// ─────────────────────────────────────────────────────────────────────────────

window.openHistoryModal = function(n) {
    const p = playerMaster.find(x => x.name === n);
    if (!p) return;
    let html = '';

    const pastTeams = (p.past_teams || []).slice().sort((a,b) => new Date(a.leftDate||0) - new Date(b.leftDate||0));
    const curTeam = teamMaster.find(t => t.id === p.teamId);
    if (pastTeams.length > 0 || curTeam || p.teamId === '') {
        html += '<div class="mb-5 p-4 bg-slate-50 rounded-2xl border border-slate-200">'
            + '<h4 class="text-xs font-bold text-slate-500 mb-3 uppercase tracking-wider">🔄 移籍タイムライン</h4>'
            + '<div class="transfer-timeline">';
        pastTeams.forEach(function(pt) {
            const typeLabel = pt.joinType ? ' <span class="text-[10px] text-slate-400">(' + pt.joinType + ')</span>' : '';
            html += '<div class="transfer-timeline-item">'
                + '<div class="text-xs font-semibold text-slate-700">' + (pt.name || 'Unknown') + typeLabel + '</div>'
                + '<div class="text-[10px] text-slate-400">退団: ' + (pt.leftDate || '不明') + (pt.notes ? ' — ' + pt.notes : '') + '</div>'
                + '</div>';
        });
        if (curTeam) {
            html += '<div class="transfer-timeline-item current">'
                + '<div class="text-xs font-semibold text-emerald-700">🟢 ' + curTeam.name + ' <span class="text-[10px] text-slate-400">(現在)</span></div>'
                + (p.joinDate ? '<div class="text-[10px] text-slate-400">加入: ' + p.joinDate + '</div>' : '')
                + '</div>';
        } else if (p.teamId === '') {
            html += '<div class="transfer-timeline-item fa">'
                + '<div class="text-xs font-semibold text-amber-600">🟡 FA / フリーエージェント <span class="text-[10px] text-slate-400">(現在)</span></div>'
                + '</div>';
        }
        html += '</div></div>';
    }

    const displayTypeSafe = (typeof displayType !== 'undefined') ? displayType : 'latest';
    const h = (p.history || []).filter(function(x) { return x.dataType === displayTypeSafe; }).sort(function(a, b) { return new Date(b.date) - new Date(a.date); });
    if (h.length < 2) {
        html += '<p class="text-center text-slate-400 py-4">データ履歴不足 (NO HISTORY)</p>';
    } else {
        html += h.map(function(c, i) {
            if (i === h.length - 1) return '';
            const pr = h[i + 1];
            const diffG = (c.goals || 0) - (pr.goals || 0);
            const diffR = (c.overall || 0) - (pr.overall || 0);
            return '<div class="history-card bg-white p-4 rounded-xl border-l-4 border-indigo-500 shadow-sm mb-4">'
                + '<div class="flex justify-between mb-2 text-xs">'
                + '<span class="text-indigo-600">' + c.date + '</span>'
                + '<span class="text-slate-400">vs ' + pr.date + '</span>'
                + '</div>'
                + '<div class="grid grid-cols-2 gap-4 text-sm">'
                + '<div>総合: ' + (c.overall || 0) + ' <span class="' + (diffR >= 0 ? 'text-emerald-500' : 'text-red-500') + ' text-xs">(' + (diffR >= 0 ? '+' : '') + diffR + ')</span></div>'
                + '<div>G: ' + (c.goals || 0) + ' <span class="' + (diffG >= 0 ? 'text-emerald-500' : 'text-red-500') + ' text-xs">(' + (diffG >= 0 ? '+' : '') + diffG + ')</span></div>'
                + '</div></div>';
        }).join('');
    }

    const histContent = document.getElementById('historyContent');
    const histModal = document.getElementById('historyModal');
    if (histContent) histContent.innerHTML = html;
    if (histModal) histModal.classList.replace('hidden', 'flex');
};

// Sprint 2: Ctrl+K / Cmd+K shortcut
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
        e.preventDefault();
        const inp = document.getElementById('playerSearch');
        if (inp) { inp.focus(); inp.select(); window.switchTab && window.switchTab('players'); }
    }
});


// Assign to Window using explicit function references to ensure scope safety

// ═══════════════════════════════════════════════════════════════════
// FIX-B: Delete Player Dialog Functions
// ═══════════════════════════════════════════════════════════════════
let _deleteTargetPsid = null;

function openDeletePlayerDialog(psid) {
    if (!psid) return;
    _deleteTargetPsid = psid;
    const p = playerMaster.find(x => x.name === psid);
    const displayName = (p && p.nickname) ? `${p.nickname} (${psid})` : psid;
    const nameEl = document.getElementById('deletePlayerName');
    if (nameEl) nameEl.textContent = displayName;
    const modal = document.getElementById('deletePlayerModal');
    if (modal) { modal.classList.remove('hidden'); modal.classList.add('flex'); }
}
window.openDeletePlayerDialog = openDeletePlayerDialog;

function closeDeletePlayerDialog() {
    const modal = document.getElementById('deletePlayerModal');
    if (modal) { modal.classList.add('hidden'); modal.classList.remove('flex'); }
    _deleteTargetPsid = null;
}
window.closeDeletePlayerDialog = closeDeletePlayerDialog;

async function confirmDeletePlayer(mode) {
    closeDeletePlayerDialog();
    const psid = _deleteTargetPsid;
    if (!psid) return;
    const pIdx = playerMaster.findIndex(x => x.name === psid);
    if (pIdx < 0) { showMessage('選手が見つかりません', 'error'); return; }
    const p = playerMaster[pIdx];

    if (mode === 'full') {
        // 完全削除: remove from playerMaster
        const ok = await window.customConfirm(
            `「${p.nickname || psid}」をDBから完全削除します。
この操作は取り消せません。よろしいですか？`
        );
        if (!ok) return;
        playerMaster.splice(pIdx, 1);
        await saveToCloud();
        if (typeof window.closeEditModal === 'function') window.closeEditModal();
        showMessage(`「${p.nickname || psid}」を完全削除しました`, 'success');

    } else if (mode === 'fa') {
        // 完全無所属(FA): record as 退団 + FA label, clear teamId
        const oldTeamId = p.teamId || '';
        const oldTeam = teamMaster.find(t => t.id === oldTeamId);
        // Record in past_teams
        if (!p.past_teams) p.past_teams = [];
        if (oldTeamId) {
            p.past_teams.push({
                id: oldTeamId,
                name: oldTeam ? oldTeam.name : oldTeamId,
                leftDate: new Date().toISOString().slice(0,10),
                joinType: 'depart_fa',
                notes: '完全無所属処理'
            });
        }
        p.teamId = '';
        // Add FA label
        if (!p.labels) p.labels = [];
        if (!p.labels.includes('FA')) p.labels.push('FA');
        // Add 退団 to latest history status
        const latestRec = (p.history || []).filter(h => h.dataType === 'latest').pop();
        if (latestRec) {
            latestRec.status = '退団';
        } else {
            // Create a latest record with 退団 status
            const today = new Date().toISOString().slice(0,10);
            if (!p.history) p.history = [];
            p.history.push({ dataType: 'latest', date: today, status: '退団', number: '' });
        }
        await saveToCloud();
        if (typeof window.closeEditModal === 'function') window.closeEditModal();
        showMessage(`「${p.nickname || psid}」をFAとして記録しました`, 'success');
    }
    updateView();
}
window.confirmDeletePlayer = confirmDeletePlayer;

Object.assign(window, {
    switchTab, updateView, updateUIForLeagueChange,
    setTeamSort: (c) => { if(teamSortCol===c) teamSortDir=teamSortDir==='asc'?'desc':'asc'; else { teamSortCol=c; teamSortDir='asc'; } updateView(); },
    viewTeamPlayers: (id) => {
        playerViewSelectedTeams = [id];
        window.switchTab('players');
        // FIX-10: Update filter chips to reflect team selection
        setTimeout(() => { if (typeof renderFilterChips === 'function') renderFilterChips(); }, 50);
    },
    viewFAPlayers: () => { playerViewSelectedLeagues=[FILTER_FREE_AGENT]; playerViewSelectedTeams=[]; window.switchTab('players'); },
    switchAdminMode: (mode) => { currentAdminMode = mode; document.getElementById('admin-mode-manual').classList.toggle('active', mode === 'manual'); document.getElementById('admin-mode-auto').classList.toggle('active', mode === 'auto'); document.getElementById('admin-panel-manual').classList.toggle('hidden', mode !== 'manual'); document.getElementById('admin-panel-auto').classList.toggle('hidden', mode !== 'auto'); if(mode === 'auto') { document.getElementById('adminQueueList').classList.add('hidden'); document.getElementById('queueCardContainer').classList.remove('hidden'); document.getElementById('resultHeaderArea').classList.remove('hidden'); } else { document.getElementById('adminQueueList').classList.remove('hidden'); document.getElementById('queueCardContainer').classList.add('hidden'); } },
    setDisplayType: (t) => setDisplayType(t),
    toggleManualLeague: (id) => { if(manualSelectedLeagues.includes(id)) manualSelectedLeagues = manualSelectedLeagues.filter(x => x !== id); else manualSelectedLeagues.push(id); renderManualLeagues(); renderAdminTeamSelector(); },
    toggleAutoFilterLeague: (id) => { if(autoSelectedLeagues.includes(id)) autoSelectedLeagues = autoSelectedLeagues.filter(x => x !== id); else autoSelectedLeagues.push(id); renderAutoFilterLeagues(); renderAutoTeamSelector(); },
    switchAIMode, runAIQuery, stopAIQuery, clearAIQuery, startManualAnalysis, startBatchProcessing, 
    stopBatchProcessing: () => { isStopRequested = true; if (currentAbortController) { currentAbortController.abort(); } const btn = document.getElementById('autoBatchStopBtn'); if(btn) { btn.innerText = "⚠️ 中断処理中..."; btn.disabled = true; btn.classList.add('opacity-50', 'cursor-not-allowed'); } },
    addAutoQueueSingle: () => { const id = document.getElementById('autoTeamSelect').value; const t = teamMaster.find(x=>x.id===id); if(t && !autoAnalysisQueue.find(x=>x.id===id)) { autoAnalysisQueue.push({id:t.id, name:t.name, status:'waiting', players:[], logs:[]}); renderAutoQueueCards(); } },
    addAutoQueueAll: () => { teamMaster.forEach(t => { if(!autoAnalysisQueue.find(x=>x.id===t.id)) autoAnalysisQueue.push({id:t.id, name:t.name, status:'waiting', players:[], logs:[]}); }); renderAutoQueueCards(); },
    addAutoQueueFiltered: () => { const targetLeagues = autoSelectedLeagues; let targets = []; if (targetLeagues.length === 0) targets = teamMaster; else targets = teamMaster.filter(t => targetLeagues.includes(String(t.l1)) || (t.l2 && Array.isArray(t.l2) && t.l2.some(l => targetLeagues.includes(String(l))))); let count = 0; targets.forEach(t => { if (!autoAnalysisQueue.find(x => x.id === t.id)) { autoAnalysisQueue.push({ id: t.id, name: t.name, status: 'waiting', players:[], logs:[] }); count++; } }); renderAutoQueueCards(); if(count > 0) showMessage(`${count}チームを追加`, "success"); else showMessage("追加対象がありません", "error"); },
    removeAutoQueueItem: (idx) => { if(!isBatchProcessing) { autoAnalysisQueue.splice(idx, 1); renderAutoQueueCards(); } },
    clearAutoQueue: () => { if(!isBatchProcessing) { autoAnalysisQueue = []; batchPendingResults = { latest: [], lifetime: [] }; renderAutoQueueCards(); } },
    retryAdminQueueItem: (idx) => { if(isBatchProcessing) return; const item = autoAnalysisQueue[idx]; if(item && (item.status==='error'||item.status==='aborted')){ item.status='waiting'; item.step='⏸️ 待機中'; item.logs=[]; renderAutoQueueCards(); showMessage(`[${item.name}] を再解析キューに追加しました`, 'success'); } },
    retryErrors: () => { autoAnalysisQueue.forEach(x => { if(x.status==='error' || x.status==='aborted') x.status='waiting'; }); renderAutoQueueCards(); },
    startSaveProcess, executeFinalSave,
    // v52.182 BUG-1 Fix: モジュールスコープ変数をグローバルに公開するアクセサ
    getBatchPendingResults: () => batchPendingResults,
    setBatchPendingResults: (v) => { batchPendingResults = v; },
    getAutoAnalysisQueue: () => autoAnalysisQueue,
    setAutoAnalysisQueue: (v) => { autoAnalysisQueue = v; },
    ignoreAllMergeConflicts: () => {
        // すべての競合を無視 - データ変更なし
        currentConflicts = [];
        batchPendingResults = { latest: [], lifetime: [] };
        document.getElementById('mergeConfirmModal').classList.replace('flex', 'hidden');
        showMessage('すべての競合を無視しました（データ変更なし）', 'info');
        renderAutoQueueCards();
    },
    closeMergeModal: () => { document.getElementById('mergeConfirmModal').classList.replace('flex', 'hidden'); currentConflicts = []; },
    checkApiKey: async () => {
        const inputKey = document.getElementById('geminiApiKey_admin')?.value
                      || document.getElementById('geminiApiKey_card')?.value
                      || document.getElementById('geminiApiKey_db')?.value
                      || '';
        if (!inputKey) { showMessage('❌ APIキーを入力してください', 'error'); return; }

        // ボタンにローディング表示
        const btns = document.querySelectorAll('button[onclick*="checkApiKey"]');
        btns.forEach(b => { b.disabled = true; b.textContent = '⏳ 検証中...'; });
        showMessage('🔍 APIキーを検証中...', 'info');

        try {
            // 実際にGemini APIへ最小リクエストを送って検証
            const testPayload = {
                contents: [{ parts: [{ text: 'Hi' }] }],
                generationConfig: { maxOutputTokens: 5 }
            };
            const res = await fetch(
                `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${inputKey}`,
                { method: 'POST', body: JSON.stringify(testPayload), headers: { 'Content-Type': 'application/json' } }
            );
            const json = await res.json();

            if (res.ok && json.candidates) {
                // ✅ 有効なキー → localStorage & poolに保存
                localStorage.setItem('geminiApiKey', inputKey);
                window.geminiApiKey = inputKey;
                window.syncApiKey(inputKey);

                // プールにも追加（重複チェック）
                if (window._apiKeyPool) {
                    const exists = window._apiKeyPool.keys.find(k => k.key === inputKey);
                    if (!exists) {
                        const label = 'Key #' + (window._apiKeyPool.keys.length + 1);
                        window._apiKeyPool.keys.push({ key: inputKey, label, active: true });
                    } else {
                        exists.active = true;
                    }
                    window._apiKeyPool.save();
                    if (window.renderApiKeyPool) window.renderApiKeyPool();
                }
                showMessage('✅ APIキー認証OK！localStorageに保存しました', 'success');
                // ボタン色を一時的に緑に
                btns.forEach(b => { b.style.background='#059669'; b.textContent='✅ 認証OK & 保存済み'; });
                setTimeout(() => btns.forEach(b => { b.disabled=false; b.style.background=''; b.textContent='🔑 Test API & Save'; }), 3000);
            } else {
                // ❌ 無効なキー
                const errMsg = json.error?.message || '不明なエラー';
                const status = res.status;
                if (status === 400 || status === 401 || status === 403) {
                    showMessage(`❌ APIキーが無効です (${status})`, 'error');
                } else if (status === 429) {
                    showMessage('⚠️ レート制限中ですが、キーは有効です。保存します。', 'warning');
                    localStorage.setItem('geminiApiKey', inputKey);
                    window.geminiApiKey = inputKey;
                    window.syncApiKey(inputKey);
                } else {
                    showMessage(`❌ API エラー: ${errMsg}`, 'error');
                }
                btns.forEach(b => { b.disabled=false; b.style.background=''; b.textContent='🔑 Test API & Save'; });
            }
        } catch(e) {
            showMessage('❌ ネットワークエラー: ' + e.message, 'error');
            btns.forEach(b => { b.disabled=false; b.style.background=''; b.textContent='🔑 Test API & Save'; });
        }
    },
    openHelpModal: () => document.getElementById('apiKeyHelpModal')?.classList.remove('hidden'),
    closeHelpModal: () => document.getElementById('apiKeyHelpModal')?.classList.add('hidden'),
    openLabelManager: () => document.getElementById('labelManagerModal')?.classList.remove('hidden'), 
    closeLabelManager: () => document.getElementById('labelManagerModal')?.classList.add('hidden'), 
    openAddModal, openEditModal, closeEditModal: () => document.getElementById('editPlayerModal').classList.replace('flex','hidden'), commitPlayerEdit, exportToCSV, generateAIEval, moveToFreeAgent,
    selectPlayerForChart: (n) => {
        selectedPlayerForChart = n;
        _selectedPlayerPsid = n; // FIX-C: track for row highlight
        renderChart();
        const chartMeta = document.getElementById('chartMeta');
        if (chartMeta) chartMeta.innerText = n;
        // Re-render player table to apply highlight (cheap since already filtered)
        if (currentTab === 'players') renderPlayerTable();
    },
    setChartMetric: (m) => { chartMetric = m; document.querySelectorAll('.metric-tab').forEach(b => { const isMatch = b.id === `tab-${m}`; b.classList.toggle('active', isMatch); b.classList.toggle('inactive', !isMatch); }); const chartContainer = document.getElementById('chartContainer'); const aiContainer = document.getElementById('aiContainer'); if (m === 'ai') { chartContainer.classList.add('hidden'); aiContainer.classList.remove('hidden'); } else { chartContainer.classList.remove('hidden'); aiContainer.classList.add('hidden'); if (selectedPlayerForChart) renderChart(); } },
    handleDragOver: e => { e.preventDefault(); e.currentTarget.classList.add('drag-over') },
    handleDragLeave: e => { e.currentTarget.classList.remove('drag-over') },
    handleDrop: e => { e.preventDefault(); e.currentTarget.classList.remove('drag-over'); Array.from(e.dataTransfer.files).forEach(f => processFile(f)) },
    handleCardImageFile: e => { Array.from(e.target.files).forEach(f => processCardFile(f)); e.target.value = ''; },
    removeCardImage: (id) => { cardImages = cardImages.filter(x => x.id !== id); renderCardThumbs(); },
    handleImageFile: e => { Array.from(e.target.files).forEach(f => processFile(f)); e.target.value = ''; },
    handleCardDragOver: e => { e.preventDefault(); e.currentTarget.classList.add('drag-over'); },
    handleCardDragLeave: e => { e.currentTarget.classList.remove('drag-over'); },
    handleCardDrop: e => { e.preventDefault(); e.currentTarget.classList.remove('drag-over'); Array.from(e.dataTransfer.files).forEach(f => processCardFile(f)); },
    removeManualImage,
    startCardAnalysis, renderCardMergeModal: window.renderCardMergeModal, executeCardMergeSave,
        // ========== v52.163: 3選択保存ロジック ==========
    saveCardMergeSelections: async function() {
      console.log("[v52.163] 3選択保存開始");
      
      const conflicts = currentCardBatchConflicts;
      if (!conflicts || conflicts.length === 0) {
        alert("保存する紐付けデータがありません");
        return;
      }
      
      let successCount = 0;
      let failCount = 0;
      
      for (let batchIdx = 0; batchIdx < conflicts.length; batchIdx++) {
        const batch = conflicts[batchIdx];
        const eventName = batch.eventName;
        
        // ラベル入力欄から最終ラベルを取得
        const labelInput = document.getElementById(`pendingCardLabelInput_${batchIdx}`);
        const finalLabel = labelInput ? labelInput.value.trim() : eventName;
        
        if (!batch.conflicts || batch.conflicts.length === 0) continue;
        
        for (let cIdx = 0; cIdx < batch.conflicts.length; cIdx++) {
          const conflict = batch.conflicts[cIdx];
          
          // 選択されたマージオプションを取得
          const radioName = `mergeOption_${batchIdx}`;
          const selectedRadio = document.querySelector(`input[name="${radioName}"]:checked`);
          const mergeOption = selectedRadio ? selectedRadio.value : "new";
          
          console.log(`[v52.163] ${conflict.simName}: ${mergeOption}`);
          
          try {
            if (mergeOption === "new") {
              // 新データ優先: 既存選手を更新
              if (conflict.existingPlayer) {
                conflict.existingPlayer.team = conflict.detectedTeam || conflict.existingPlayer.team;
                conflict.existingPlayer.updatedAt = new Date().toISOString();
              }
              // カード追加
              if (conflict.detectedPsid) {
                const player = players.find(p => p.id === conflict.existingPlayer.id);
                if (player) {
                  if (!player.cards) player.cards = [];
                  player.cards.push({ label: finalLabel, psid: conflict.detectedPsid, addedAt: new Date().toISOString() });
                }
              }
              successCount++;
            } else if (mergeOption === "keep") {
              // 既存データ保持: チーム情報は変更しない
              if (conflict.detectedPsid && conflict.existingPlayer) {
                const player = players.find(p => p.id === conflict.existingPlayer.id);
                if (player) {
                  if (!player.cards) player.cards = [];
                  player.cards.push({ label: finalLabel, psid: conflict.detectedPsid, addedAt: new Date().toISOString() });
                }
              }
              successCount++;
            } else if (mergeOption === "add") {
              // 新選手として追加
              const newPlayer = {
                id: 'P' + Date.now() + Math.random().toString(36).substring(2,7),
                simName: conflict.simName,
                team: conflict.detectedTeam,
                psid: conflict.detectedPsid,
                registeredDate: new Date().toISOString(),
                cards: [{ label: finalLabel, psid: conflict.detectedPsid, addedAt: new Date().toISOString() }]
              };
              players.push(newPlayer);
              successCount++;
            } else if (mergeOption === "ignore") {
              // 無視: 何もしない
              successCount++;
            }
          } catch (err) {
            console.error("[v52.163] 保存エラー:", err);
            failCount++;
          }
        }
      }
      
      saveToLocalStorage();
      alert(`保存完了: 成功 ${successCount}件, 失敗 ${failCount}件`);
      this.closeCardMergeModal();
      updateView();
    },
    // ========== v52.163: 保存ロジック終了 ==========
    
    ignoreAllCardMergeConflicts: () => {
        currentCardBatchConflicts = [];
        document.getElementById('cardMergeConfirmModal').classList.replace('flex', 'hidden');
        showMessage('特殊カード競合をすべて無視しました（データ変更なし）', 'info');
    },
    closeCardMergeModal: () => { document.getElementById('cardMergeConfirmModal').classList.replace('flex', 'hidden'); currentCardBatchConflicts = []; },
    exportDatabase, importDatabase,
    renderDbSnapshotList, loadSnapshot, restoreSnapshot, deleteSnapshot, returnToLatest,
    openDeletePlayerDialog: openDeletePlayerDialog,
    closeDeletePlayerDialog: closeDeletePlayerDialog,
    confirmDeletePlayer: confirmDeletePlayer,
    // v50.37 New Label Logic
    addNewCustomLabel: async () => { 
        const name = document.getElementById('newLabelName').value.trim();
        const type = document.querySelector('input[name="newLabelType"]:checked').value;
        if(!name || customLabels.some(l => l.name === name)) return;
        customLabels.push({ name, type });
        await saveToCloud(); renderLabelManagerList(); renderFilterChips(); 
    },
    deleteCustomLabel: async (i) => { 
        const tgt = customLabels[i].name; 
        const isOk = await window.customConfirm(`ラベル「${tgt}」を削除しますか？\n（既に付与されている選手からも取り消されます）`);
        if (!isOk) return;
        customLabels.splice(i,1); 
        playerMaster.forEach(p=>{if(p.labels) p.labels=p.labels.filter(l=>l!==tgt)}); 
        await saveToCloud(); renderLabelManagerList(); updateView(); 
    },
    editCustomLabelName: async (idx, newName) => {
        const lbl = customLabels[idx];
        if (!newName || lbl.name === newName) return;
        const oldName = lbl.name;
        lbl.name = newName;
        // Update all players who had the old label
        playerMaster.forEach(p => {
            if (p.labels && p.labels.includes(oldName)) {
                p.labels = p.labels.map(l => l === oldName ? newName : l);
            }
        });
        await saveToCloud(); renderLabelManagerList(); updateView();
    },
    toggleCustomLabelType: async (idx) => {
        const lbl = customLabels[idx];
        lbl.type = lbl.type === 'general' ? 'special' : 'general';
        await saveToCloud(); renderLabelManagerList(); updateView();
    },
    toggleColumn: (t, id) => { columnVisibility[t][id] = !columnVisibility[t][id]; renderFilterChips(); updateView(); },
    togglePlayerViewLeague: (id) => { if(playerViewSelectedLeagues.includes(id)) playerViewSelectedLeagues = playerViewSelectedLeagues.filter(x => x !== id); else playerViewSelectedLeagues.push(id); updateView(); renderFilterChips(); },
    toggleFilterPanel: () => document.getElementById('filterPanel').classList.toggle('hidden'),
    addPlayerFilterTeam: () => { const id = document.getElementById('playerTeamMultiSelect').value; if(id && !playerViewSelectedTeams.includes(id)) { playerViewSelectedTeams.push(id); updateView(); renderFilterChips(); } },
    removePlayerFilterTeam: (id) => { playerViewSelectedTeams = playerViewSelectedTeams.filter(x => x !== id); updateView(); renderFilterChips(); },
    clearPlayerFilters: () => { playerViewSelectedTeams = []; playerViewSelectedLeagues = []; updateView(); renderFilterChips(); },
    setPlayerSort: (c) => { if(playerSortCol===c) playerSortDir = playerSortDir==='asc'?'desc':'asc'; else { playerSortCol=c; playerSortDir='asc'; } updateView(); },
    openHistoryModal: (n) => openHistoryModal(n),
    closeHistoryModal: () => closeHistoryModal(),
    toggleSelectAllPlayers: (checked) => {
        document.querySelectorAll('.player-select-cb').forEach(cb => { cb.checked = checked; });
        window.onPlayerCheckChange();
    },
    onPlayerCheckChange: () => {
        const cbs = document.querySelectorAll('.player-select-cb');
        const allCb = document.getElementById('selectAllPlayers');
        const checkedCount = [...cbs].filter(c => c.checked).length;
        if (allCb) allCb.indeterminate = checkedCount > 0 && checkedCount < cbs.length;
        if (allCb) allCb.checked = checkedCount === cbs.length && cbs.length > 0;
        window.selectedPlayerPSIDs = [...cbs].filter(c => c.checked).map(c => c.dataset.psid);
        const badge = document.getElementById('selectedPlayerCountBadge');
        if (badge) badge.innerText = checkedCount > 0 ? `${checkedCount}人選択中` : '';
        // Sprint 2: show/hide bulk action bar
        const bulkBar = document.getElementById('bulkActionBar');
        if (bulkBar) bulkBar.classList.toggle('hidden', checkedCount === 0);
    },
    getSelectedPlayerPSIDs: () => window.selectedPlayerPSIDs || [],
    exportAIText: (mode) => { let text = ""; let filename = ""; const dateStr = new Date().toISOString().slice(0, 10); if (mode === 'individual') { text = currentAIIndividualText; if (!text) return showMessage("出力データなし", "error"); filename = `AI_Analysis_${selectedPlayerForChart||"Unknown"}_${dateStr}.txt`; } else { text = currentAIQueryText; if (!text) return showMessage("出力データなし", "error"); filename = `AI_Query_Result_${dateStr}.txt`; } const blob = new Blob([text], { type: "text/plain;charset=utf-8" }); const link = document.createElement("a"); link.href = URL.createObjectURL(blob); link.download = filename; document.body.appendChild(link); link.click(); document.body.removeChild(link); },
    // Team & League Managers
    openTeamManager, closeTeamManager, renderTeamManagerList, renderLeagueManagerList,
    switchManagerTab: (tab) => { 
        const btnTeams = document.getElementById('mgr-tab-teams'); const btnLeagues = document.getElementById('mgr-tab-leagues'); const secTeams = document.getElementById('mgr-sec-teams'); const secLeagues = document.getElementById('mgr-sec-leagues'); 
        if (tab === 'teams') { btnTeams.className = "py-4 text-emerald-400 border-b-2 border-emerald-400 font-bold tracking-widest uppercase text-sm transition-all"; btnLeagues.className = "py-4 text-slate-400 border-b-2 border-transparent hover:text-slate-200 tracking-widest uppercase text-sm transition-all"; secTeams.classList.remove('hidden'); secLeagues.classList.add('hidden'); window.renderTeamManagerList(); } 
        else { btnTeams.className = "py-4 text-slate-400 border-b-2 border-transparent hover:text-slate-200 tracking-widest uppercase text-sm transition-all"; btnLeagues.className = "py-4 text-emerald-400 border-b-2 border-emerald-400 font-bold tracking-widest uppercase text-sm transition-all"; secTeams.classList.add('hidden'); secLeagues.classList.remove('hidden'); window.renderLeagueManagerList(); } 
    },
    toggleAllTeams: (checked) => { document.querySelectorAll('.team-batch-check').forEach(cb => cb.checked = checked); },
    applyBatchTeamUpdate: async () => { const checkboxes = document.querySelectorAll('.team-batch-check:checked'); if(checkboxes.length === 0) return showMessage("チームが選択されていません", "error"); const l1 = document.getElementById('batchL1').value; const l2Add = document.getElementById('batchL2Add').value; const l2Remove = document.getElementById('batchL2Remove').value; if(!l1 && !l2Add && !l2Remove) return showMessage("変更内容を選択してください", "error"); const isOk = await window.customConfirm(`選択した ${checkboxes.length} チームに一括設定を適用します。よろしいですか？`); if(!isOk) return; checkboxes.forEach(cb => { const id = cb.value; const t = teamMaster.find(x => x.id === id); if(t) { if(l1) t.l1 = l1; if(l2Remove === "ALL") { t.l2 = []; } else if (l2Remove) { t.l2 = t.l2.filter(x => x !== l2Remove); } if(l2Add && !t.l2.includes(l2Add)) { t.l2.push(l2Add); } } }); await saveToCloud(); window.renderTeamManagerList(); updateUIForLeagueChange(); showMessage("一括更新を適用しました", "success"); document.getElementById('batchL1').value = ""; document.getElementById('batchL2Add').value = ""; document.getElementById('batchL2Remove').value = ""; },
    
    // Team CRUD
    saveNewTeam: async () => {
        let id = document.getElementById('newTeamId').value.trim(); id = window.toHalfWidthNumbers(id);
        const name = document.getElementById('newTeamName').value.trim();
        const l1 = document.getElementById('newTeamL1').value;
        const l2Checks = document.querySelectorAll('.new-team-l2-check:checked');
        const l2 = Array.from(l2Checks).map(c => c.value);
        if (!id || !name) return showMessage("IDとチーム名は必須です", "error");
        if (teamMaster.find(t => t.id === id)) return showMessage("このIDは既に存在します", "error");
        // L1 未設定時の警告 (保存は可能)
        if (!l1) {
            const warnEl = document.getElementById('newTeamL1Warning');
            if (warnEl) { warnEl.classList.remove('hidden'); }
            showMessage("⚠ メインカテゴリ(L1)が未設定です。後で設定できます。", "warning");
        }
        teamMaster.push({ id, name, l1, l2 });
        await saveToCloud(); window.renderTeamManagerList(); updateUIForLeagueChange(); showMessage("チームを追加しました", "success");
        document.getElementById('newTeamId').value = ""; document.getElementById('newTeamName').value = "";
        const warnEl = document.getElementById('newTeamL1Warning'); if(warnEl) warnEl.classList.add('hidden');
    },
    updateTeam: async (id) => {
        const t = teamMaster.find(x => x.id === id); if(!t) return;
        const name = document.getElementById(`editTeamName_${id}`).value.trim();
        const l1 = document.getElementById(`editTeamL1_${id}`).value;
        const l2Checks = document.querySelectorAll(`.edit-team-l2-check-${id}:checked`);
        const l2 = Array.from(l2Checks).map(c => c.value);
        if(!name) return showMessage("チーム名は必須です", "error");
        t.name = name; t.l1 = l1; t.l2 = l2;
        await saveToCloud(); window.renderTeamManagerList(); updateUIForLeagueChange(); showMessage("更新しました", "success");
    },
    deleteTeam: async (id) => {
        const isOk = await window.customConfirm("本当にこのチームを削除しますか？\n（所属選手はFAになります）"); if(!isOk) return;
        teamMaster = teamMaster.filter(t => t.id !== id);
        playerMaster.forEach(p => { if(p.teamId === id) { p.teamId = ""; if(!p.labels.includes("FA")) p.labels.push("FA"); } });
        await saveToCloud(); window.renderTeamManagerList(); updateUIForLeagueChange(); showMessage("削除しました", "success");
    },

    // League CRUD
    saveNewLeague: async () => {
        let id = document.getElementById('newLeagueId').value.trim();
        id = window.toHalfWidthNumbers(id);
        const year    = document.getElementById('newLeagueYear').value.trim();
        const season  = document.getElementById('newLeagueSeason').value.trim();
        const cat     = document.getElementById('newLeagueCategory').value.trim();
        const divSel  = document.getElementById('newLeagueDiv').value;
        const divCust = document.getElementById('newLeagueDivCustom').value.trim();
        const div     = divCust || divSel;
        const missing = [];
        if (!id)     missing.push('リーグID');
        if (!year)   missing.push('年度');
        if (!season) missing.push('シーズン');
        if (!cat)    missing.push('リーグカテゴリ');
        if (!div)    missing.push('DIVカテゴリ');
        if (missing.length > 0) {
            const warnEl = document.getElementById('newLeagueWarning');
            if (warnEl) { warnEl.textContent = `⚠ 未入力: ${missing.join(' / ')}`; warnEl.classList.remove('hidden'); }
            showMessage(`未入力項目があります: ${missing.join(', ')}`, "warning");
        }
        if (!id) return;
        if (leagueLabelMap[id] !== undefined) return showMessage("このリーグIDは既に存在します", "error");
        const meta = { year, season, category: cat, div };
        leagueMeta[id] = meta;
        leagueLabelMap[id] = window.buildLeagueLabel(meta);
        ['newLeagueId','newLeagueYear','newLeagueSeason','newLeagueCategory','newLeagueDivCustom'].forEach(elId => {
            const el = document.getElementById(elId); if(el) el.value = '';
        });
        const divEl = document.getElementById('newLeagueDiv'); if(divEl) divEl.value = '';
        const warnEl = document.getElementById('newLeagueWarning'); if(warnEl) warnEl.classList.add('hidden');
        const prevEl = document.getElementById('newLeaguePreview');
        if(prevEl) prevEl.innerHTML = '<span class="text-slate-400 text-xs">各項目を入力するとプレビューが表示されます</span>';
        await saveToCloud();
        window.renderLeagueManagerList();
        updateUIForLeagueChange();
        showMessage("リーグを追加しました", "success");
    },
    updateLeague: async (oldId) => {
        let newId = document.getElementById(`editLeagueId_${oldId}`).value.trim();
        newId = window.toHalfWidthNumbers(newId);
        const year    = document.getElementById(`editLeagueYear_${oldId}`)?.value.trim()    || '';
        const season  = document.getElementById(`editLeagueSeason_${oldId}`)?.value.trim()  || '';
        const cat     = document.getElementById(`editLeagueCategory_${oldId}`)?.value.trim()|| '';
        const divSel  = document.getElementById(`editLeagueDiv_${oldId}`)?.value            || '';
        const divCust = document.getElementById(`editLeagueDivCustom_${oldId}`)?.value.trim()|| '';
        const div     = divCust || divSel;
        if (!newId) return showMessage("リーグIDは必須です", "error");
        const missing = [];
        if (!year)   missing.push('年度');
        if (!season) missing.push('シーズン');
        if (!cat)    missing.push('リーグカテゴリ');
        if (!div)    missing.push('DIVカテゴリ');
        if (missing.length > 0) showMessage(`⚠ 未入力: ${missing.join(' / ')}`, "warning");
        const meta = { year, season, category: cat, div };
        const name = window.buildLeagueLabel(meta);
        if (newId !== oldId && leagueLabelMap[newId] !== undefined) return showMessage("変更後のIDは既に存在します", "error");
        if (newId !== oldId) {
            teamMaster.forEach(t => {
                if (t.l1 === oldId) t.l1 = newId;
                if (t.l2 && t.l2.includes(oldId)) t.l2 = t.l2.map(l => l === oldId ? newId : l);
            });
            leagueMeta[newId] = meta; delete leagueMeta[oldId];
            leagueLabelMap[newId] = name; delete leagueLabelMap[oldId];
        } else {
            leagueMeta[oldId] = meta;
            leagueLabelMap[oldId] = name;
        }
        await saveToCloud();
        window.renderLeagueManagerList();
        updateUIForLeagueChange();
        showMessage("リーグ情報を更新しました", "success");
    },
    deleteLeague: async (id) => { 
        const inUse = teamMaster.some(t => t.l1 === id || (t.l2 && t.l2.includes(id))); 
        let msg = "本当にこのリーグを削除しますか？"; 
        if (inUse) { msg = "このリーグ(カテゴリ)に紐付いているチームが存在します。\n削除するとそれらチームのカテゴリが「設定なし」になりますが、本当に削除しますか？"; } 
        const isOk = await window.customConfirm(msg); 
        if (!isOk) return; 
        delete leagueLabelMap[id]; 
        teamMaster.forEach(t => { if (t.l1 === id) t.l1 = ""; if (t.l2 && t.l2.includes(id)) t.l2 = t.l2.filter(l => l !== id); }); 
        await saveToCloud(); 
        window.renderLeagueManagerList(); 
        updateUIForLeagueChange(); 
        showMessage("リーグを削除しました", "success"); 
    },
    
    // Checkbox toggles for Bulk Operations
    toggleAllMergeChecks: (checked) => {
        document.querySelectorAll('#mergeConflictList input[type="checkbox"]').forEach(cb => cb.checked = checked);
    },
    toggleAllCardMergeChecks: (checked) => {
        document.querySelectorAll('#cardMergeConflictList input[type="checkbox"]').forEach(cb => cb.checked = checked);
    },
    toggleCardMergeBatchChecks: (batchIdx, checked) => {
        const batchDiv = document.querySelectorAll('#cardMergeConflictList > div')[batchIdx];
        if(batchDiv) {
            batchDiv.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = checked);
        }
    },

    startCardBatchMergeProcess, addCardQueueSingle, addCardQueueRange, clearCardQueue, renderCardAutoQueue, removeCardQueueItem, switchCardMode, startCardBatchProcessing,
});

window.addEventListener('paste', e => { 
    try {
        const items = (e.clipboardData || window.clipboardData).items; 
        let foundImage = false; 
        for (const item of items) { 
            if (item.kind === 'file' && item.type.startsWith('image/')) { 
                const blob = item.getAsFile(); 
                if (currentTab === 'card') processCardFile(blob); 
                else processFile(blob); 
                foundImage = true; 
            } 
        } 
        if (foundImage) { 
            showMessage("画像を貼り付けました", "success"); 
            if (currentTab === 'admin' && currentAdminMode !== 'manual') { window.switchAdminMode('manual'); } else if (currentTab !== 'card' && currentTab !== 'admin') { window.switchTab('admin'); window.switchAdminMode('manual'); } 
        } 
    } catch(err) {
        console.error("Paste error:", err);
    }
});

    // ===== Firebase設定 =====
    // 環境に応じた設定を使用（デフォルトはデモ用設定）
    let firebaseConfig;
    
    try {
        // 外部から設定が提供されている場合は使用
        if (typeof __firebase_config !== 'undefined') {
            firebaseConfig = JSON.parse(__firebase_config);
            console.log('✅ [Firebase] 外部設定を使用');
        } else {
            // デフォルト設定（デモ用・読み取り専用）
            firebaseConfig = {
                apiKey: "AIzaSyDemoKey_eS_League_DB_Pro_2026",
                authDomain: "es-league-db-demo.firebaseapp.com",
                projectId: "es-league-db-demo",
                storageBucket: "es-league-db-demo.appspot.com",
                messagingSenderId: "123456789012",
                appId: "1:123456789012:web:demo-es-league-db-2026",
                databaseURL: "https://es-league-db-demo.firebaseio.com"
            };
            console.warn('⚠️ [Firebase] デフォルト設定を使用（デモモード）');
            console.info('💡 本番環境では __firebase_config を設定してください');
        }
    } catch (error) {
        console.error('❌ [Firebase] 設定の読み込みに失敗:', error);
        // フォールバック: ローカルストレージのみ使用
        firebaseConfig = null;
    }
    
    // Firebase初期化
    // auth, db, user は行2732で既に宣言済み
    
    // デモモードかどうかを検出
    const isDemoMode = firebaseConfig && firebaseConfig.apiKey && firebaseConfig.apiKey.includes('Demo');
    
    if (firebaseConfig && !isDemoMode) {
        // 本番モード: Firebase認証を使用
        try {
            const appInstance = initializeApp(firebaseConfig);
            auth = getAuth(appInstance);
            db = getFirestore(appInstance);
            
            console.log('✅ [Firebase] 初期化成功（本番モード）');
            
            // 認証状態の監視
            onAuthStateChanged(auth, (u) => {
                if (u) {
                    user = u;
                    console.log('✅ [Firebase Auth] ユーザー認証済み:', u.uid);
                    loadFromCloud(u.uid);
                } else {
                    console.log('🔄 [Firebase Auth] 匿名ログイン実行中...');
                    signInAnonymously(auth).catch(err => {
                        console.error('❌ [Firebase Auth] 匿名ログイン失敗:', err);
                        console.warn('⚠️ ローカルストレージモードに切り替えます');
                    });
                }
            });
        } catch (error) {
            console.error('❌ [Firebase] 初期化失敗:', error);
            console.warn('⚠️ ローカルストレージモードで動作します');
        }
    } else if (isDemoMode) {
        // デモモード: Firebase認証をスキップ
        console.log('✅ [Firebase] デモモード - ローカルストレージのみ使用');
        console.info('💡 クラウド同期機能は無効です（本番環境では有効になります）');
        // auth, db, user は未初期化のまま（ローカルストレージのみ使用）
    } else {
        // Firebase設定なし
        console.warn('⚠️ [Firebase] 無効 - ローカルストレージのみ使用');
    }

window.onload = () => {
    // FIX-4: IndexedDBはノンブロッキングで実行（失敗しても起動）
    // 旧コード: initializeTeamsData() をブロッキング呼び出し → フリーズの根本原因
    if (typeof window.initializeTeamsData === 'function') {
        Promise.resolve().then(() => window.initializeTeamsData()).catch(e => {
            console.warn('[v52.176] initializeTeamsData エラー (無視):', e);
        });
    }
    // UI初期化は同期的に即座に実行
    try {
        initAdminUI();
        updateView();
        console.log('[v52.177] ✅ UI初期化完了 (onload)');
    } catch(err) {
        console.error('[v52.176] ❌ UI初期化エラー:', err);
        // フォールバック: 少し遅延して再試行
        setTimeout(() => { try { initAdminUI(); updateView(); } catch(e2) { console.error(e2); } }, 200);
    }
};

// Phase 4.11.55: ボタンイベントリスナー登録
document.addEventListener('DOMContentLoaded', function() {
    console.log('[Phase 4.11.55] 🔧 ボタンイベントリスナー登録開始');
    // データインポートボタン
    const importBtn = document.querySelector('button[title="データのインポート"]');
    if (importBtn) {
        importBtn.onclick = function() {
            if (window.openImportModal) {
                window.openImportModal();
            } else {
                console.error('[Phase 4.11.55] ❌ openImportModal が未定義');
            }
        };
        console.log('[Phase 4.11.55] ✅ データインポートボタン登録');
    }
    
    // タブボタン
    const tabButtons = document.querySelectorAll('button[onclick*="switchTab"]');
    tabButtons.forEach((btn, index) => {
        const onclickAttr = btn.getAttribute('onclick');
        const match = onclickAttr.match(/switchTab\('([^']+)'\)/);
        if (match) {
            const tabName = match[1];
            btn.onclick = function() {
                if (window.switchTab) {
                    window.switchTab(tabName);
                } else {
                    console.error('[Phase 4.11.55] ❌ switchTab が未定義');
                }
            };
            console.log(`[Phase 4.11.55] ✅ タブボタン登録: ${tabName}`);
        }
    });
    
    console.log('[Phase 4.11.55] ✅ 全ボタンイベントリスナー登録完了');
});
</script>

<!-- ========== 追加モーダル（v50.59から統合） ========== -->
<div id="labelManagerModal" class="fixed inset-0 modal-overlay hidden items-center justify-center z-[300] p-6">
    <div class="bg-white rounded-[2.5rem] w-full max-w-lg overflow-hidden shadow-2xl animate-in zoom-in-95">
        <div class="p-8 bg-slate-900 text-white flex justify-between items-center">
            <h2 class="text-2xl uppercase">カスタムラベル管理</h2>
            <button onclick="window.closeLabelManager()" class="text-white/50 hover:text-white text-3xl">&times;</button>
        </div>
        <div class="p-8 space-y-6">
            <div class="bg-slate-50 p-4 rounded-xl border border-slate-200">
                <p class="text-[10px] text-slate-400 uppercase mb-2">新規作成</p>
                <div class="flex gap-2 mb-2">
                    <input type="text" id="newLabelName" placeholder="ラベル名 (例: 2026日本代表)" class="input-box">
                </div>
                <div class="flex items-center gap-4 mb-2">
                    <label class="flex items-center gap-2 cursor-pointer text-xs">
                        <input type="radio" name="newLabelType" value="general" checked class="text-emerald-600 focus:ring-emerald-500">
                        一般ラベル (分類など)
                    </label>
                    <label class="flex items-center gap-2 cursor-pointer text-xs">
                        <input type="radio" name="newLabelType" value="special" class="text-yellow-600 focus:ring-yellow-500">
                        特殊カード (TOTWなど)
                    </label>
                </div>
                <button onclick="window.addNewCustomLabel()" class="w-full bg-emerald-600 text-white py-3 rounded-xl text-xs uppercase shadow-lg">追加</button>
            </div>
            <div id="customLabelsList" class="max-h-[40vh] overflow-y-auto custom-scrollbar border-t pt-4 space-y-3"></div>
        </div>
        <div class="p-8 border-t border-slate-100 flex justify-end">
            <button onclick="window.closeLabelManager()" class="bg-slate-900 text-white px-8 py-3 rounded-xl text-xs">閉じる</button>
        </div>
    </div>
</div>

<div id="editPlayerModal" class="fixed inset-0 modal-overlay hidden items-center justify-center z-[200] p-6">
    <div class="bg-white rounded-[2.5rem] w-full max-w-2xl overflow-hidden shadow-2xl animate-in zoom-in-95">
        <div class="p-8 bg-slate-900 text-white flex justify-between items-center">
            <h2 id="modalTitle" class="text-2xl uppercase text-white">選手データの管理</h2>
            <button onclick="window.closeEditModal()" class="text-white/50 hover:text-white text-3xl">&times;</button>
        </div>
        <div class="p-8 grid grid-cols-2 gap-4 max-h-[60vh] overflow-y-auto custom-scrollbar">
            <input type="hidden" id="editPlayerId">
            <div class="col-span-full mb-2">
                <label class="text-[10px] text-slate-400 uppercase">PSID (一意識別子)</label>
                <input type="text" id="editPlayerName" class="input-box">
            </div>
            <div class="col-span-full mb-2">
                <label class="text-[10px] text-slate-400 uppercase">ニックネーム</label>
                <input type="text" id="editPlayerNickname" class="input-box" placeholder="例: カカシ">
            </div>
            <div class="col-span-full mb-2">
                <label class="text-[10px] text-slate-400 uppercase">所属チームを選択</label>
                <select id="editPlayerTeamId" class="input-box"></select>
                <button onclick="window.moveToFreeAgent()" type="button" class="mt-2 text-[10px] text-red-500 hover:text-red-700 underline flex items-center gap-1">
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7a4 4 0 11-8 0 4 4 0 018 0zM9 14a6 6 0 00-6 6v1h12v-1a6 6 0 00-6-6zM21 12h-6"></path></svg>
                    退団・FA（フリーエージェント）として登録
                </button>
            </div>
            <div class="col-span-full mb-4 bg-slate-50 p-4 rounded-2xl border border-slate-200">
                <label class="text-[10px] text-slate-400 uppercase block mb-2">付与するラベル / 特殊カード</label>
                <div id="editPlayerLabelsContainer" class="flex flex-wrap gap-2"></div>
            </div>
            <div><label class="text-[10px] text-slate-400 uppercase">背番号</label><input type="text" id="editPlayerNumber" class="input-box" placeholder="例: 10 または -"></div>
            <div><label class="text-[10px] text-slate-400 uppercase">総合数値</label><input type="number" id="editPlayerRating" class="input-box"></div>
            <div><label class="text-[10px] text-slate-400 uppercase">出場数</label><input type="number" id="editPlayerApps" class="input-box"></div>
            <div><label class="text-[10px] text-slate-400 uppercase">勝率</label><input type="number" id="editPlayerWinRate" class="input-box"></div>
            <div><label class="text-[10px] text-slate-400 uppercase">ゴール</label><input type="number" id="editPlayerGoals" class="input-box"></div>
            <div><label class="text-[10px] text-slate-400 uppercase">アシスト</label><input type="number" id="editPlayerAssists" class="input-box"></div>
            <div><label class="text-[10px] text-slate-400 uppercase">完封</label><input type="number" id="editPlayerCleanSheets" class="input-box"></div>
            <div><label class="text-[10px] text-slate-400 uppercase">警告</label><input type="number" id="editPlayerYellow" class="input-box"></div>
            <div><label class="text-[10px] text-slate-400 uppercase">退場</label><input type="number" id="editPlayerRed" class="input-box"></div>
            <div class="col-span-full">
                <label class="text-[10px] text-slate-400 uppercase">在籍状況 (スタッツ記録用)</label>
                <select id="editPlayerStatus" class="input-box">
                    <option value="在籍">🟢 在籍中</option>
                    <option value="退団">🔴 退団</option>
                    <option value="FA">🟡 FA（フリーエージェント）</option>
                </select>
                <p class="text-[9px] text-slate-400 mt-1">※ここの「退団」はあくまで最新スタッツの付帯情報です。完全移籍/FA処理は上のチーム選択欄から行ってください。</p>
            </div>
        </div>
        <div class="p-8 border-t border-slate-100 flex flex-col gap-3">
            <div class="flex gap-3">
                <button onclick="window.closeEditModal()" class="flex-1 py-4 border-2 border-slate-100 rounded-2xl text-slate-400 hover:bg-slate-50 transition">キャンセル</button>
                <button onclick="window.commitPlayerEdit()" class="flex-[2] py-4 bg-emerald-600 text-white rounded-2xl shadow-xl shadow-emerald-100 hover:bg-emerald-700 transition">💾 履歴を記録して保存</button>
            </div>
            <button onclick="window.openDeletePlayerDialog(document.getElementById('editPlayerId').value)"
                class="w-full py-3 bg-red-50 text-red-600 border border-red-200 rounded-2xl text-sm hover:bg-red-100 transition">
                🗑️ この選手を削除する…
            </button>
        </div>
    </div>
</div>

<div id="historyModal" class="fixed inset-0 modal-overlay hidden items-center justify-center z-[200] p-6">
    <div class="bg-slate-50 rounded-[3rem] w-full max-w-4xl overflow-hidden shadow-2xl flex flex-col max-h-[90vh]">
        <div class="p-8 bg-white border-b border-slate-200 flex justify-between items-center">
            <div>
                <h2 id="historyTitle" class="text-3xl uppercase">UPDATE HISTORY</h2>
                <p class="text-slate-400 text-xs uppercase tracking-widest mt-1">過去の更新データと所属履歴</p>
            </div>
            <button onclick="window.closeHistoryModal()" class="w-12 h-12 rounded-full bg-slate-100 text-slate-400 text-2xl flex items-center justify-center">&times;</button>
        </div>
        <div id="historyContent" class="p-10 overflow-y-auto custom-scrollbar space-y-6"></div>
    </div>
</div>

<div id="mergeConfirmModal" class="fixed inset-0 modal-overlay hidden items-center justify-center z-[500] p-6">
    <div class="bg-white rounded-[2.5rem] w-full max-w-5xl overflow-hidden shadow-2xl flex flex-col max-h-[90vh]">
        <div class="p-8 bg-orange-500 text-white flex justify-between items-center">
            <div>
                <h2 class="text-2xl uppercase">⚠️ データマージ・移籍確認</h2>
                <p class="text-[10px] opacity-90 mt-1">AI解析結果と既存データベースの間に差異（移籍の可能性など）が見つかりました。</p>
            </div>
            <button onclick="window.closeMergeModal()" class="text-white/50 hover:text-white text-3xl">&times;</button>
        </div>
        <div id="mergeConflictList" class="p-8 overflow-y-auto custom-scrollbar flex-1 bg-slate-50 space-y-4"></div>
        <div class="p-6 border-t border-slate-200 bg-white flex justify-between items-center">
            <button onclick="window.ignoreAllMergeConflicts()" class="bg-red-100 text-red-700 border border-red-200 px-6 py-4 rounded-2xl text-sm uppercase tracking-wider hover:bg-red-200 transition">🚫 すべて無視（追加しない）</button>
            <span class="text-xs text-slate-500">すべての確認を終えてから保存してください</span>
            <button onclick="window.executeFinalSave()" class="bg-emerald-600 text-white px-10 py-4 rounded-2xl shadow-xl uppercase hover:bg-emerald-700 transition">確定してDBに保存</button>
        </div>
    </div>
</div>

<div id="cardMergeConfirmModal" class="fixed inset-0 modal-overlay hidden items-center justify-center z-[600] p-6">
    <div class="bg-white rounded-[2.5rem] w-full max-w-5xl overflow-hidden shadow-2xl flex flex-col max-h-[90vh]">
        <div class="p-8 bg-blue-500 text-white flex justify-between items-start">
            <div class="flex-1" id="cardMergeModalHeaderLeft">
                <div class="flex items-center gap-4 mb-2">
                    <h2 class="text-2xl uppercase">⚠️ カードラベル紐付け確認</h2>
                    <span id="cardDetectCountBadge" class="bg-white text-blue-600 px-4 py-1 rounded-full text-sm shadow-md"></span>
                </div>
                <p class="text-[10px] opacity-90 mt-1">画像や記事から検出したPSIDの紐付けと、イベントラベル名を確認・編集してください。</p>
            </div>
            <button onclick="window.closeCardMergeModal()" class="text-white/50 hover:text-white text-3xl ml-4">&times;</button>
        </div>
        <div id="cardMergeConflictList" class="p-8 overflow-y-auto custom-scrollbar flex-1 bg-slate-100 space-y-4"></div>
        <div class="p-6 border-t border-slate-200 bg-white flex justify-between items-center">
            <span class="text-xs text-slate-500">確認後、選択した選手にラベルを適用します</span>
            <button onclick="window.ignoreAllCardMergeConflicts()" class="bg-red-100 text-red-700 border border-red-200 px-6 py-4 rounded-2xl text-sm uppercase tracking-wider hover:bg-red-200 transition">🚫 すべて無視</button>
            <button onclick="window.executeCardMergeSave()" class="bg-blue-600 text-white px-10 py-4 rounded-2xl shadow-xl uppercase hover:bg-blue-700 transition">確定してラベルを付与</button>
        </div>
    </div>
</div>
<!-- ========== モーダル統合ここまで ========== -->

<!-- ========== 一括インポート機能（v50.68新規追加） ========== -->
<div id="bulkImportModal" class="fixed inset-0 modal-overlay hidden items-center justify-center z-[700] p-6">
    <div class="bg-white rounded-[2.5rem] w-full max-w-6xl overflow-hidden shadow-2xl flex flex-col max-h-[90vh]">
        <div class="p-8 bg-gradient-to-r from-indigo-600 to-purple-600 text-white flex justify-between items-center">
            <div>
                <h2 class="text-2xl uppercase">📥 選手データ一括インポート</h2>
                <p class="text-[10px] opacity-90 mt-1">CSV/JSON形式のファイルをアップロードして複数選手を一度に登録</p>
            </div>
            <button onclick="window.closeBulkImportModal()" class="text-white/50 hover:text-white text-3xl">&times;</button>
        </div>
        
        <div class="p-8 space-y-6 overflow-y-auto custom-scrollbar flex-1">
            <!-- ファイルアップロードエリア -->
            <div class="bg-slate-50 border-2 border-dashed border-slate-300 rounded-2xl p-8 text-center">
                <input type="file" id="importFileInput" accept=".csv,.json" class="hidden" onchange="window.handleImportFile(event)">
                <label for="importFileInput" class="cursor-pointer block">
                    <div class="text-6xl mb-4">📄</div>
                    <p class="text-lg font-bold mb-2">ファイルを選択またはドラッグ＆ドロップ</p>
                    <p class="text-xs text-slate-500">対応形式: CSV, JSON（最大5MB）</p>
                </label>
            </div>

            <!-- CSVフォーマット説明 -->
            <details class="bg-blue-50 border border-blue-200 rounded-xl p-4">
                <summary class="cursor-pointer font-bold text-sm text-blue-800">📋 CSVフォーマット例（クリックで展開）</summary>
                <pre class="mt-4 bg-white p-4 rounded text-xs overflow-x-auto">PSID,ニックネーム,チーム名,背番号,総合数値,出場数,勝率,ゴール,アシスト
PlayerA,カカシ,FC Onions,10,85,20,65.5,12,8
PlayerB,ナルト,WELLDONE,7,82,18,70.2,15,5</pre>
            </details>

            <!-- プレビューエリア -->
            <div id="importPreviewArea" class="hidden">
                <div class="bg-slate-100 border border-slate-300 rounded-2xl p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold">📊 インポートプレビュー</h3>
                        <span id="importCount" class="bg-indigo-600 text-white px-4 py-1 rounded-full text-sm">0件</span>
                    </div>
                    
                    <!-- 統計情報 -->
                    <div class="grid grid-cols-4 gap-4 mb-4">
                        <div class="bg-white p-4 rounded-xl text-center">
                            <p class="text-xs text-slate-500">新規登録</p>
                            <p id="newPlayersCount" class="text-2xl font-bold text-green-600">0</p>
                        </div>
                        <div class="bg-white p-4 rounded-xl text-center">
                            <p class="text-xs text-slate-500">重複</p>
                            <p id="duplicatePlayersCount" class="text-2xl font-bold text-orange-600">0</p>
                        </div>
                        <div class="bg-white p-4 rounded-xl text-center">
                            <p class="text-xs text-slate-500">チーム自動紐付</p>
                            <p id="autoMatchedCount" class="text-2xl font-bold text-blue-600">0</p>
                        </div>
                        <div class="bg-white p-4 rounded-xl text-center">
                            <p class="text-xs text-slate-500">要確認</p>
                            <p id="unmatchedCount" class="text-2xl font-bold text-red-600">0</p>
                        </div>
                    </div>

                    <!-- プレビューテーブル -->
                    <div class="max-h-[40vh] overflow-y-auto custom-scrollbar bg-white rounded-xl">
                        <table class="w-full text-xs">
                            <thead class="bg-slate-800 text-white sticky top-0">
                                <tr>
                                    <th class="p-3 text-left">選択</th>
                                    <th class="p-3 text-left">PSID</th>
                                    <th class="p-3 text-left">ニックネーム</th>
                                    <th class="p-3 text-left">チーム</th>
                                    <th class="p-3 text-left">マッチング</th>
                                    <th class="p-3 text-left">状態</th>
                                </tr>
                            </thead>
                            <tbody id="importPreviewTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- フッター -->
        <div class="p-6 border-t border-slate-200 bg-white flex justify-between items-center">
            <div class="text-xs text-slate-500">
                <span id="selectedImportCount">0</span>件を選択中
            </div>
            <div class="flex gap-4">
                <button onclick="window.closeBulkImportModal()" class="px-6 py-3 border-2 border-slate-300 rounded-xl text-slate-600">キャンセル</button>
                <button onclick="window.executeImport()" id="executeImportBtn" class="px-10 py-3 bg-indigo-600 text-white rounded-xl shadow-xl uppercase hover:bg-indigo-700 transition disabled:bg-slate-300" disabled>インポート実行</button>
            </div>
        </div>
    </div>
</div>
<!-- ========== 一括インポート機能ここまで ========== -->


<script>
// ========================================
// 一括インポート機能 (v50.68)
// ========================================
let importedData = [];
let teamMatchResults = {};

window.openBulkImportModal = function() {
  document.getElementById('bulkImportModal').classList.remove('hidden');
  document.getElementById('bulkImportModal').classList.add('flex');
  console.log('[Import] モーダルを開きました');
};

window.closeBulkImportModal = function() {
  document.getElementById('bulkImportModal').classList.remove('flex');
  document.getElementById('bulkImportModal').classList.add('hidden');
  importedData = [];
  document.getElementById('importPreviewArea').classList.add('hidden');
  document.getElementById('importFileInput').value = '';
  console.log('[Import] モーダルを閉じました');
};

window.handleImportFile = function(event) {
  const file = event.target.files[0];
  if (!file) return;
  
  console.log('[Import] ファイル選択:', file.name, file.type, file.size);
  
  if (file.size > 5 * 1024 * 1024) {
    alert('ファイルサイズが5MBを超えています');
    return;
  }
  
  const reader = new FileReader();
  reader.onload = function(e) {
    const text = e.target.result;
    try {
      if (file.name.endsWith('.csv')) {
        importedData = parseCSV(text);
      } else if (file.name.endsWith('.json')) {
        importedData = JSON.parse(text);
      } else {
        alert('対応していないファイル形式です');
        return;
      }
      
      console.log('[Import] パース完了:', importedData.length, '件');
      processImportData();
      renderImportPreview();
    } catch (err) {
      console.error('[Import] パースエラー:', err);
      alert('ファイルの読み込みに失敗しました: ' + err.message);
    }
  };
  reader.readAsText(file);
};

function parseCSV(text) {
  const lines = text.trim().split('\n');
  const headers = lines[0].split(',').map(h => h.trim());
  const data = [];
  
  for (let i = 1; i < lines.length; i++) {
    const values = lines[i].split(',').map(v => v.trim());
    const obj = {};
    headers.forEach((h, idx) => {
      obj[h] = values[idx] || '';
    });
    data.push(obj);
  }
  
  return data;
}

function processImportData() {
  let newCount = 0, dupCount = 0, matchedCount = 0, unmatchedCount = 0;
  
  importedData.forEach(item => {
    const psid = item.PSID || item.psid || '';
    const teamName = item['チーム名'] || item.team || item.Team || '';
    
    // 重複チェック
    const existing = playerMaster.find(p => p.name === psid);
    item._isDuplicate = !!existing;
    item._isNew = !existing;
    
    if (existing) {
      dupCount++;
    } else {
      newCount++;
    }
    
    // チーム自動マッチング
    if (teamName) {
      const matched = autoMatchTeam(teamName);
      item._matchedTeam = matched;
      
      if (matched) {
        matchedCount++;
      } else {
        unmatchedCount++;
      }
    }
    
    item._selected = true; // デフォルトで選択
  });
  
  teamMatchResults = { newCount, dupCount, matchedCount, unmatchedCount };
  
  document.getElementById('newPlayersCount').textContent = newCount;
  document.getElementById('duplicatePlayersCount').textContent = dupCount;
  document.getElementById('autoMatchedCount').textContent = matchedCount;
  document.getElementById('unmatchedCount').textContent = unmatchedCount;
  document.getElementById('importCount').textContent = importedData.length + '件';
  
  updateSelectedCount();
}

function autoMatchTeam(teamName) {
  if (!teamName) return null;
  
  // 完全一致
  let match = teamMaster.find(t => t.name === teamName);
  if (match) return match;
  
  // 部分一致
  match = teamMaster.find(t => t.name.includes(teamName) || teamName.includes(t.name));
  if (match) return match;
  
  // 類似度マッチング（簡易版）
  const similarities = teamMaster.map(t => ({
    team: t,
    score: calculateSimilarity(teamName.toLowerCase(), t.name.toLowerCase())
  })).sort((a, b) => b.score - a.score);
  
  if (similarities[0] && similarities[0].score > 0.6) {
    return similarities[0].team;
  }
  
  return null;
}

function calculateSimilarity(s1, s2) {
  const longer = s1.length > s2.length ? s1 : s2;
  const shorter = s1.length > s2.length ? s2 : s1;
  
  if (longer.length === 0) return 1.0;
  
  const editDistance = levenshteinDistance(longer, shorter);
  return (longer.length - editDistance) / longer.length;
}

function levenshteinDistance(s1, s2) {
  const costs = [];
  for (let i = 0; i <= s1.length; i++) {
    let lastValue = i;
    for (let j = 0; j <= s2.length; j++) {
      if (i === 0) {
        costs[j] = j;
      } else if (j > 0) {
        let newValue = costs[j - 1];
        if (s1.charAt(i - 1) !== s2.charAt(j - 1)) {
          newValue = Math.min(Math.min(newValue, lastValue), costs[j]) + 1;
        }
        costs[j - 1] = lastValue;
        lastValue = newValue;
      }
    }
    if (i > 0) costs[s2.length] = lastValue;
  }
  return costs[s2.length];
}

function renderImportPreview() {
  const tbody = document.getElementById('importPreviewTable');
  tbody.innerHTML = '';
  
  importedData.forEach((item, idx) => {
    const row = document.createElement('tr');
    row.className = 'border-b border-slate-200 hover:bg-slate-50';
    
    const statusClass = item._isDuplicate ? 'text-orange-600' : 'text-green-600';
    const statusText = item._isDuplicate ? '重複' : '新規';
    
    const matchClass = item._matchedTeam ? 'text-blue-600' : 'text-red-600';
    const matchText = item._matchedTeam ? item._matchedTeam.name : '未マッチング';
    
    row.innerHTML = `
      <td class="p-3"><input type="checkbox" ${item._selected ? 'checked' : ''} onchange="window.toggleImportItem(${idx}, this.checked)"></td>
      <td class="p-3 font-mono">${item.PSID || item.psid || ''}</td>
      <td class="p-3">${item['ニックネーム'] || item.nickname || ''}</td>
      <td class="p-3">${item['チーム名'] || item.team || ''}</td>
      <td class="p-3 ${matchClass}">${matchText}</td>
      <td class="p-3 ${statusClass} font-bold">${statusText}</td>
    `;
    
    tbody.appendChild(row);
  });
  
  document.getElementById('importPreviewArea').classList.remove('hidden');
  document.getElementById('executeImportBtn').disabled = false;
}

window.toggleImportItem = function(idx, selected) {
  importedData[idx]._selected = selected;
  updateSelectedCount();
};

function updateSelectedCount() {
  const count = importedData.filter(i => i._selected).length;
  document.getElementById('selectedImportCount').textContent = count;
  document.getElementById('executeImportBtn').disabled = count === 0;
}

window.executeImport = function() {
  const selectedItems = importedData.filter(i => i._selected);
  
  if (selectedItems.length === 0) {
    alert('インポートする項目を選択してください');
    return;
  }
  
  if (!confirm(`${selectedItems.length}件の選手データをインポートしますか？
重複データは上書きされます。`)) {
    return;
  }
  
  let imported = 0, skipped = 0;
  
  selectedItems.forEach(item => {
    const psid = item.PSID || item.psid;
    const nickname = item['ニックネーム'] || item.nickname || '';
    const teamId = item._matchedTeam ? item._matchedTeam.id : '';
    const number = item['背番号'] || item.number || '-';
    const rating = parseInt(item['総合数値'] || item.rating || 0);
    const apps = parseInt(item['出場数'] || item.apps || 0);
    const winRate = parseFloat(item['勝率'] || item.winRate || 0);
    const goals = parseInt(item['ゴール'] || item.goals || 0);
    const assists = parseInt(item['アシスト'] || item.assists || 0);
    
    if (!psid) {
      skipped++;
      return;
    }
    
    const existingIdx = playerMaster.findIndex(p => p.name === psid);
    
    const playerData = {
      name: psid,
      nickname: nickname,
      teamId: teamId,
      number: number,
      rating: rating,
      apps: apps,
      winRate: winRate,
      goals: goals,
      assists: assists,
      cleanSheets: parseInt(item['完封'] || item.cleanSheets || 0),
      yellow: parseInt(item['警告'] || item.yellow || 0),
      red: parseInt(item['退場'] || item.red || 0),
      status: '在籍',
      labels: []
    };
    
    if (existingIdx >= 0) {
      playerMaster[existingIdx] = { ...playerMaster[existingIdx], ...playerData };
    } else {
      playerMaster.push(playerData);
    }
    
    imported++;
  });
  
  console.log(`[Import] 完了: ${imported}件インポート, ${skipped}件スキップ`);
  
  saveToCloud(user.uid);
  updateView();
  closeBulkImportModal();
  
  alert(`✅ インポート完了

成功: ${imported}件
スキップ: ${skipped}件`);
};
// ========================================
</script>

<!-- ========== Phase 4.11.55 Modals ========== -->
<!-- データインポートモーダル -->


    <!-- チーム追加/編集フォームモーダル -->
    <div class="modal" id="team-form-modal">
        <div class="modal-overlay"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 style="font-size: 20px; color: #1e293b;" id="teamFormTitle">新規チーム追加</h2>
                <button class="modal-close" onclick="window.closeModal('team-form-modal')" style="background: #ef4444; color: white; border: none; border-radius: 8px; padding: 8px 16px; cursor: pointer; font-size: 14px;">
                    × 閉じる
                </button>
            </div>
            <div class="modal-body">
                <form id="teamForm" onsubmit="window.saveTeam(event)" style="display: flex; flex-direction: column; gap: 20px;">
                    <input type="hidden" id="teamFormId" value="">
                    
                    <div>
                        <label style="display: block; font-size: 14px; color: #334155; margin-bottom: 8px; font-weight: 600;">
                            チーム名 <span style="color: #ef4444;">*</span>
                        </label>
                        <input type="text" id="teamNameInput" required 
                               style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px;"
                               placeholder="例: Team Alpha">
                    </div>
                    
                    <div>
                        <label style="display: block; font-size: 14px; color: #334155; margin-bottom: 8px; font-weight: 600;">
                            ステータス
                        </label>
                        <select id="teamStatusInput" 
                                style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px;">
                            <option value="active">アクティブ</option>
                            <option value="inactive">非アクティブ</option>
                        </select>
                    </div>
                    
                    <div>
                        <label style="display: block; font-size: 14px; color: #334155; margin-bottom: 8px; font-weight: 600;">
                            備考
                        </label>
                        <textarea id="teamNotesInput" rows="3" 
                                  style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; resize: vertical;"
                                  placeholder="チームに関するメモ（任意）"></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                        <button type="submit" 
                                style="flex: 1; background: #10b981; color: white; border: none; padding: 12px; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer;">
                            💾 保存
                        </button>
                        <button type="button" onclick="window.closeModal('team-form-modal')" 
                                style="flex: 1; background: #64748b; color: white; border: none; padding: 12px; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer;">
                            キャンセル
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
<div class="modal" id="import-modal">
    <div class="modal-overlay"></div>
    <div class="modal-content" style="max-width: 900px;">
        <div class="modal-header">
            <h2 class="modal-title">📥 データインポート</h2>
            <button class="modal-close" onclick="closeModal('import-modal')">&times;</button>
        </div>
        <div class="modal-body">
            <!-- タブ切り替え -->
            <div style="margin-bottom: 20px; border-bottom: 2px solid #e2e8f0;">
                <button class="import-tab-btn active" data-tab="csv">CSV</button>
                <button class="import-tab-btn" data-tab="json">JSON</button>
            </div>
            
            <!-- CSVインポート -->
            <div id="csv-import-panel" class="import-panel active">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: bold;">
                        📂 CSVファイルを選択
                    </label>
                    <div id="csv-drop-zone" style="
                        border: 2px dashed #cbd5e0;
                        border-radius: 8px;
                        padding: 40px;
                        text-align: center;
                        background: #f7fafc;
                        cursor: pointer;
                        transition: all 0.3s;
                    ">
                        <input type="file" id="csv-file-input" accept=".csv" style="display: none;">
                        <div style="font-size: 48px; margin-bottom: 10px;">📄</div>
                        <p style="color: #718096; margin: 0;">
                            クリックまたはドラッグ&ドロップで CSVファイルを選択
                        </p>
                        <p style="color: #a0aec0; font-size: 12px; margin-top: 5px;">
                            フォーマット: Name,Category,Rarity,Effect,Timing
                        </p>
                    </div>
                </div>
                
                <!-- CSV設定 -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-size: 13px; color: #4a5568;">
                            区切り文字
                        </label>
                        <select id="csv-delimiter" style="width: 100%; padding: 8px; border: 1px solid #cbd5e0; border-radius: 4px;">
                            <option value=",">カンマ (,)</option>
                            <option value=";">セミコロン (;)</option>
                            <option value="	">タブ (	)</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px;">
                            <input type="checkbox" id="csv-has-header" checked>
                            ヘッダー行あり
                        </label>
                        <label style="display: block;">
                            <input type="checkbox" id="csv-skip-duplicates" checked>
                            重複スキップ
                        </label>
                    </div>
                </div>
                
                <!-- プレビュー -->
                <div id="csv-preview-container" style="display: none;">
                    <h3 style="margin-bottom: 10px;">📋 プレビュー</h3>
                    <div id="csv-preview" style="
                        max-height: 300px;
                        overflow: auto;
                        border: 1px solid #e2e8f0;
                        border-radius: 4px;
                        background: white;
                    "></div>
                    <div id="csv-stats" style="
                        margin-top: 10px;
                        padding: 10px;
                        background: #edf2f7;
                        border-radius: 4px;
                        font-size: 13px;
                    "></div>
                </div>
            </div>
            
            <!-- JSONインポート -->
            <div id="json-import-panel" class="import-panel" style="display: none;">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: bold;">
                        📂 JSONファイルを選択
                    </label>
                    <div id="json-drop-zone" style="
                        border: 2px dashed #cbd5e0;
                        border-radius: 8px;
                        padding: 40px;
                        text-align: center;
                        background: #f7fafc;
                        cursor: pointer;
                    ">
                        <input type="file" id="json-file-input" accept=".json" style="display: none;">
                        <div style="font-size: 48px; margin-bottom: 10px;">📋</div>
                        <p style="color: #718096; margin: 0;">
                            クリックまたはドラッグ&ドロップで JSONファイルを選択
                        </p>
                        <p style="color: #a0aec0; font-size: 12px; margin-top: 5px;">
                            フォーマット: [{name, category, rarity, effect, timing}, ...]
                        </p>
                    </div>
                </div>
                
                <!-- JSON設定 -->
                <div style="margin-bottom: 20px;">
                    <label style="display: block;">
                        <input type="checkbox" id="json-skip-duplicates" checked>
                        重複スキップ
                    </label>
                    <label style="display: block;">
                        <input type="checkbox" id="json-validate-schema">
                        スキーマ検証
                    </label>
                </div>
                
                <!-- プレビュー -->
                <div id="json-preview-container" style="display: none;">
                    <h3 style="margin-bottom: 10px;">📋 プレビュー</h3>
                    <div id="json-preview" style="
                        max-height: 300px;
                        overflow: auto;
                        border: 1px solid #e2e8f0;
                        border-radius: 4px;
                        background: white;
                        padding: 15px;
                    "></div>
                    <div id="json-stats" style="
                        margin-top: 10px;
                        padding: 10px;
                        background: #edf2f7;
                        border-radius: 4px;
                        font-size: 13px;
                    "></div>
                </div>
            </div>
            
            <!-- エラー表示 -->
            <div id="import-errors" style="display: none; margin-top: 15px; padding: 12px; background: #fed7d7; border-left: 4px solid #f56565; border-radius: 4px;">
                <strong>⚠️ エラー:</strong>
                <ul id="import-error-list" style="margin: 5px 0 0 20px;"></ul>
            </div>
        </div>
        <div class="modal-footer" style="display: flex; justify-content: space-between; align-items: center;">
            <button id="import-clear-btn" class="btn-secondary" style="display: none;">
                🔄 リセット
            </button>
            <div>
                <button class="btn-secondary" onclick="closeModal('import-modal')" style="margin-right: 10px;">
                    キャンセル
                </button>
                <button id="import-execute-btn" class="btn-primary" style="display: none;">
                    ✅ インポート実行
                </button>
            </div>
        </div>
    </div>
</div>

<!-- ========== Phase 4.11.55 Modals End ========== -->


<script>

    // ============================================
    // ダークモード切替機能
    // ============================================
    
    // 初期テーマを設定
    (function initTheme() {
        // localStorageから保存されたテーマを取得
        const savedTheme = localStorage.getItem('theme');
        
        // システム設定を検出
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        // 優先順位: localStorage > システム設定 > デフォルト(light)
        const theme = savedTheme || (prefersDark ? 'dark' : 'light');
        
        // テーマを適用
        document.documentElement.setAttribute('data-theme', theme);
        
        // アイコンを更新
        updateThemeIcon(theme);
        
        console.log(`🌙 [Dark Mode] 初期テーマ設定: ${theme}`);
    })();
    
    // テーマを切り替える
    window.toggleTheme = function() {
        console.log('🔄 [Debug] toggleTheme() 呼び出し');
        const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
        const newTheme = currentTheme === 'light' ? 'dark' : 'light';
        
        // テーマを適用
        document.documentElement.setAttribute('data-theme', newTheme);
        
        // localStorageに保存
        localStorage.setItem('theme', newTheme);
        
        // アイコンを更新
        updateThemeIcon(newTheme);
        
        console.log(`🌙 [Dark Mode] テーマ切替: ${currentTheme} → ${newTheme}`);
    };
    
    // アイコンを更新
    function updateThemeIcon(theme) {
        const checkbox = document.getElementById('themeToggleCheckbox');
        if (checkbox) {
            checkbox.checked = (theme === 'dark');
        }
    }

    
    // システム設定の変更を監視
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
        // 手動設定がない場合のみ、システム設定に従う
        if (!localStorage.getItem('theme')) {
            const newTheme = e.matches ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            updateThemeIcon(newTheme);
            console.log(`🌙 [Dark Mode] システム設定変更: ${newTheme}`);
        }
    });


</script>

<!-- ── Sprint 2: Team Transfer Modal ──────────────────────────────────── -->
<div id="transferModal" class="fixed inset-0 modal-overlay hidden items-center justify-center z-[300] p-6">
    <div class="bg-white dark:bg-[var(--bg-secondary)] rounded-[2rem] shadow-2xl border-4 border-amber-100 dark:border-amber-900 w-full max-w-lg max-h-[90vh] overflow-y-auto">
        <div class="bg-gradient-to-r from-amber-500 to-orange-500 rounded-t-[1.7rem] p-6 text-white">
            <div class="flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-black uppercase">🔄 チーム移籍処理</h2>
                    <p class="text-xs opacity-80 mt-1">選手の所属チームを変更します</p>
                </div>
                <button onclick="window.closeTransferModal()" class="text-white/80 hover:text-white text-2xl leading-none">✕</button>
            </div>
        </div>
        <div class="p-6 space-y-5">
            <!-- Target players -->
            <div>
                <p class="text-xs font-bold text-slate-500 uppercase mb-2">対象選手</p>
                <div id="transferPlayerList" class="flex flex-wrap gap-2 p-3 bg-slate-50 dark:bg-[var(--bg-tertiary)] rounded-xl border border-slate-200 min-h-[40px]"></div>
            </div>
            <!-- From / To -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <p class="text-xs font-bold text-slate-500 uppercase mb-2">現在の所属</p>
                    <div class="transfer-team-badge">
                        <span>📤</span>
                        <span id="transferFromTeam" class="text-slate-700 dark:text-slate-200">—</span>
                    </div>
                </div>
                <div>
                    <p class="text-xs font-bold text-slate-500 uppercase mb-2">移籍先チーム <span class="text-red-500">*</span></p>
                    <select id="transferToTeam" class="w-full bg-white dark:bg-[var(--bg-tertiary)] border-2 border-slate-200 dark:border-[var(--border-color)] rounded-xl px-3 py-2 text-sm outline-none focus:border-amber-500 transition-all">
                        <option value="">-- 移籍先チームを選択 --</option>
                    </select>
                </div>
            </div>
            <!-- Date + Type -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <p class="text-xs font-bold text-slate-500 uppercase mb-2">移籍日</p>
                    <input type="date" id="transferDate" class="w-full bg-white dark:bg-[var(--bg-tertiary)] border-2 border-slate-200 dark:border-[var(--border-color)] rounded-xl px-3 py-2 text-sm outline-none focus:border-amber-500">
                </div>
                <div>
                    <p class="text-xs font-bold text-slate-500 uppercase mb-2">移籍タイプ</p>
                    <select id="transferType" class="w-full bg-white dark:bg-[var(--bg-tertiary)] border-2 border-slate-200 dark:border-[var(--border-color)] rounded-xl px-3 py-2 text-sm outline-none focus:border-amber-500">
                        <option value="完全移籍">🔄 完全移籍</option>
                        <option value="レンタル">🔁 レンタル移籍</option>
                        <option value="レンタル終了">↩️ レンタル終了・復帰</option>
                        <option value="FA加入">✍️ FA加入</option>
                        <option value="退団・FA">🚪 退団 → FA</option>
                    </select>
                </div>
            </div>
            <!-- Notes -->
            <div>
                <p class="text-xs font-bold text-slate-500 uppercase mb-2">備考（任意）</p>
                <input type="text" id="transferNotes" placeholder="例: 17th シーズン開始時" class="w-full bg-white dark:bg-[var(--bg-tertiary)] border-2 border-slate-200 dark:border-[var(--border-color)] rounded-xl px-3 py-2 text-sm outline-none focus:border-amber-500">
            </div>
            <!-- Buttons -->
            <div class="flex gap-3 pt-2">
                <button onclick="window.closeTransferModal()" class="flex-1 bg-slate-100 dark:bg-[var(--bg-tertiary)] text-slate-700 dark:text-slate-200 py-3 rounded-xl font-bold hover:bg-slate-200 transition">キャンセル</button>
                <button onclick="window.executeTransfer()" class="flex-1 bg-gradient-to-r from-amber-500 to-orange-500 text-white py-3 rounded-xl font-bold shadow-lg hover:from-amber-600 hover:to-orange-600 transition">
                    🔄 移籍を確定する
                </button>
            </div>
        </div>
    </div>
</div>
<!-- ── End Transfer Modal ─────────────────────────────────────────────── -->


<!-- FIX-13: Import Accumulation Choice Modal -->
<div id="importChoiceModal" class="fixed inset-0 modal-overlay hidden items-center justify-center z-[400] p-6">
    <div class="bg-white rounded-[2rem] shadow-2xl border-4 border-blue-100 w-full max-w-md">
        <div class="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-t-[1.7rem] p-6 text-white">
            <h2 class="text-xl font-black">📥 DBインポート方法を選択</h2>
            <p class="text-xs opacity-80 mt-1">既存データが存在します。どのようにインポートしますか？</p>
        </div>
        <div class="p-6 space-y-4">
            <div class="grid grid-cols-2 gap-3 text-xs text-slate-600 bg-slate-50 rounded-xl p-4">
                <div>現在のDB: <span id="importChoiceExisting" class="font-bold text-indigo-600">0名</span></div>
                <div>インポート: <span id="importChoiceIncoming" class="font-bold text-emerald-600">0名</span></div>
                <div class="col-span-2">ファイル日時: <span id="importChoiceFile" class="font-bold">—</span></div>
            </div>
            <button onclick="window.resolveImportChoice('accumulate')"
                class="w-full p-4 bg-emerald-50 border-2 border-emerald-300 rounded-2xl text-left hover:bg-emerald-100 transition">
                <div class="font-bold text-emerald-800">🔗 累積ドッキング（推奨）</div>
                <div class="text-xs text-emerald-600 mt-1">現在のDBを保持しつつ、インポートデータを追加・マージします。両方のバージョンをDBタブで比較・切替可能になります。</div>
            </button>
            <button onclick="window.resolveImportChoice('overwrite')"
                class="w-full p-4 bg-red-50 border-2 border-red-200 rounded-2xl text-left hover:bg-red-100 transition">
                <div class="font-bold text-red-700">⚠️ 上書き（既存データを削除）</div>
                <div class="text-xs text-red-500 mt-1">現在のDBをすべて削除してインポートデータに置き換えます。この操作は取り消せません。</div>
            </button>
            <button onclick="window.resolveImportChoice(null)"
                class="w-full py-3 bg-slate-100 text-slate-500 rounded-xl text-sm hover:bg-slate-200 transition">
                キャンセル
            </button>
        </div>
    </div>
</div>

<!-- FIX-8/14: Delete Player 3-choice Modal -->
<div id="deletePlayerModal" class="fixed inset-0 modal-overlay hidden items-center justify-center z-[400] p-6">
    <div class="bg-white rounded-[2rem] shadow-2xl border-4 border-red-100 w-full max-w-sm">
        <div class="bg-gradient-to-r from-red-500 to-rose-600 rounded-t-[1.7rem] p-6 text-white">
            <h2 class="text-xl font-black">🗑️ 選手削除</h2>
            <p class="text-sm mt-1 opacity-90">「<span id="deletePlayerName" class="font-bold"></span>」をどのように処理しますか？</p>
        </div>
        <div class="p-6 space-y-3">
            <button onclick="window.confirmDeletePlayer('full')"
                class="w-full p-4 bg-red-50 border-2 border-red-300 rounded-2xl text-left hover:bg-red-100 transition">
                <div class="font-bold text-red-700">💣 完全削除</div>
                <div class="text-xs text-red-500 mt-1">DBから完全に削除します。この操作は取り消せません。</div>
            </button>
            <button onclick="window.confirmDeletePlayer('fa')"
                class="w-full p-4 bg-amber-50 border-2 border-amber-300 rounded-2xl text-left hover:bg-amber-100 transition">
                <div class="font-bold text-amber-700">🚪 完全無所属（FA）</div>
                <div class="text-xs text-amber-600 mt-1">退団を記録してFAとして残します。過去所属チームに履歴が残ります。</div>
            </button>
            <button onclick="window.closeDeletePlayerDialog()"
                class="w-full py-3 bg-slate-100 text-slate-500 rounded-xl text-sm hover:bg-slate-200 transition">
                キャンセル
            </button>
        </div>
    </div>
</div>


<script>
// ════════════════════════════════════════════════════════════════════
// eS League DB Pro v52.177 - Sprint 3 JavaScript
// Features: API Key Pool, Parallel Batch, Player Detail, CSV Export, URL Hash
// ════════════════════════════════════════════════════════════════════

// ─── Sprint 3: Gemini API Key Pool (Rotation) ───────────────────────
const _apiKeyPool = {
    keys: [],         // { key: string, label: string, active: boolean }
    _currentIndex: 0,

    load() {
        try {
            const saved = JSON.parse(localStorage.getItem('geminiApiKeyPool') || '[]');
            this.keys = saved.filter(k => k && k.key);
        } catch(e) { this.keys = []; }
        // Migrate single key if exists
        const singleKey = localStorage.getItem('geminiApiKey') || window.geminiApiKey || '';
        if (singleKey && !this.keys.find(k => k.key === singleKey)) {
            this.keys.unshift({ key: singleKey, label: 'Key #1', active: true });
        }
    },

    save() {
        try {
            localStorage.setItem('geminiApiKeyPool', JSON.stringify(this.keys));
        } catch(e) {}
    },

    next() {
        const active = this.keys.filter(k => k.active);
        if (active.length === 0) return null;
        const idx = this._currentIndex % active.length;
        this._currentIndex++;
        return active[idx].key;
    },

    add(key, label) {
        if (this.keys.find(k => k.key === key)) return false;
        this.keys.push({ key, label: label || `Key #${this.keys.length + 1}`, active: true });
        this.save();
        return true;
    },

    remove(index) {
        this.keys.splice(index, 1);
        this.save();
    },

    toggle(index) {
        if (this.keys[index]) {
            this.keys[index].active = !this.keys[index].active;
            this.save();
        }
    },

    get activeCount() { return this.keys.filter(k => k.active).length; },
};

_apiKeyPool.load();
window._apiKeyPool = _apiKeyPool;

// Override getApiKey to use pool rotation
window.getApiKey = function() {
    const poolKey = _apiKeyPool.next();
    if (poolKey) return poolKey;
    // Fallback: legacy inputs
    return document.getElementById('geminiApiKey_admin')?.value
        || document.getElementById('geminiApiKey_card')?.value
        || document.getElementById('geminiApiKey_db')?.value
        || '';
};

// Render API key pool UI
window.renderApiKeyPool = function() {
    const container = document.getElementById('apiKeyPoolContainer');
    if (!container) return;
    if (_apiKeyPool.keys.length === 0) {
        container.innerHTML = '<p class="text-xs text-slate-400">キーが登録されていません</p>';
    } else {
        container.innerHTML = _apiKeyPool.keys.map((k, i) => `
            <div class="api-key-row">
                <div class="api-key-status ${k.active ? '' : 'inactive'}"></div>
                <span class="api-key-label">${k.label} (${k.key.slice(0,8)}...)</span>
                <button onclick="window._apiKeyPool.toggle(${i}); window.renderApiKeyPool();" class="api-key-toggle" title="${k.active ? '無効化' : '有効化'}">${k.active ? '有効' : '無効'}</button>
                <button onclick="window._apiKeyPool.remove(${i}); window.renderApiKeyPool();" class="api-key-remove" title="削除">✕</button>
            </div>
        `).join('');
    }
    const badge = document.getElementById('apiKeyCountBadge');
    if (badge) badge.textContent = `${_apiKeyPool.activeCount}キー有効`;
};

window.addApiKeyToPool = function() {
    const keyInput = document.getElementById('newApiKeyInput');
    const labelInput = document.getElementById('newApiKeyLabel');
    const key = keyInput?.value.trim();
    const label = labelInput?.value.trim() || `Key #${_apiKeyPool.keys.length + 1}`;
    if (!key || !key.startsWith('AIzaSy')) {
        if (typeof showMessage === 'function') showMessage('有効なAPIキーを入力してください (AIzaSy...)', 'error');
        return;
    }
    if (_apiKeyPool.add(key, label)) {
        if (keyInput) keyInput.value = '';
        if (labelInput) labelInput.value = '';
        window.renderApiKeyPool();
        if (typeof showMessage === 'function') showMessage(`APIキー「${label}」を追加しました (合計 ${_apiKeyPool.keys.length}本)`, 'success');
    } else {
        if (typeof showMessage === 'function') showMessage('このキーは既に登録されています', 'error');
    }
};

// ─── Sprint 3: Parallel Batch Processing (P0) ────────────────────────
const BATCH_CONCURRENCY = 3; // 1=直列(安全), 3=高速, 5=積極的

// v52.182 BUG-3 Fix: startBatchProcessingParallel
// 旧実装は processTeamBatch (未定義) を呼ぶだけのゾンビコードだったため削除。
// window.startBatchProcessing は Block C (module) の本物の startBatchProcessing を
// Object.assign(window,...) 経由で参照しているのでここで上書きしない。
// 「並列バッジ」表示は残す。
(function() {
    const origStart = window.startBatchProcessing;
    if (typeof origStart !== 'function') return;

    window.startBatchProcessing = async function startBatchProcessingParallel_v182() {
        // 並列バッジ表示 (視覚的フィードバック)
        const concLabel = document.getElementById('batchConcurrencyLabel');
        if (concLabel) concLabel.textContent = '解析中...';
        // Block C の本物の startBatchProcessing を呼ぶ
        await origStart();
        if (concLabel) concLabel.textContent = '完了';
    };
    console.log('[v52.182] ✅ startBatchProcessing ラッパー登録完了（ゾンビコード削除済み）');
})();

// ─── Sprint 3: Sparkline Chart ────────────────────────────────────────
function renderSparkline(canvasId, data) {
    const canvas = document.getElementById(canvasId);
    if (!canvas || !canvas.getContext) return;
    const ctx = canvas.getContext('2d');
    const W = canvas.width || 200;
    const H = canvas.height || 60;
    ctx.clearRect(0, 0, W, H);
    if (!data || data.length < 2) return;
    const vals = data.map(Number).filter(v => !isNaN(v));
    if (vals.length < 2) return;
    const min = Math.min(...vals);
    const max = Math.max(...vals);
    const range = max - min || 1;
    const padX = 10, padY = 8;
    const toX = i => padX + (i / (vals.length - 1)) * (W - padX * 2);
    const toY = v => H - padY - ((v - min) / range) * (H - padY * 2);

    // Line
    ctx.beginPath();
    ctx.moveTo(toX(0), toY(vals[0]));
    vals.slice(1).forEach((v, i) => ctx.lineTo(toX(i + 1), toY(v)));
    ctx.strokeStyle = '#6366f1';
    ctx.lineWidth = 2;
    ctx.stroke();

    // Fill under line
    ctx.beginPath();
    ctx.moveTo(toX(0), H - padY);
    ctx.lineTo(toX(0), toY(vals[0]));
    vals.slice(1).forEach((v, i) => ctx.lineTo(toX(i + 1), toY(v)));
    ctx.lineTo(toX(vals.length - 1), H - padY);
    ctx.closePath();
    ctx.fillStyle = 'rgba(99,102,241,0.12)';
    ctx.fill();

    // Dots
    vals.forEach((v, i) => {
        ctx.beginPath();
        ctx.arc(toX(i), toY(v), 3, 0, Math.PI * 2);
        ctx.fillStyle = '#6366f1';
        ctx.fill();
    });

    // Labels on endpoints
    ctx.fillStyle = '#475569';
    ctx.font = '9px sans-serif';
    ctx.fillText(vals[0], toX(0) + 4, toY(vals[0]) - 4);
    ctx.fillText(vals[vals.length - 1], toX(data.length - 1) - 16, toY(vals[vals.length - 1]) - 4);
}
window.renderSparkline = renderSparkline;

// ─── Sprint 3: Player Detail Side Panel (P1) ─────────────────────────
window.openDetailPanel = function(psid) {
    const panel = document.getElementById('playerDetailPanel');
    const content_el = document.getElementById('playerDetailContent');
    if (!panel || !content_el) return;

    const players = typeof playerMaster !== 'undefined' ? playerMaster : [];
    const teams = typeof teamMaster !== 'undefined' ? teamMaster : [];
    const p = players.find(pl => pl.name === psid || pl.psid === psid);
    if (!p) {
        content_el.innerHTML = '<p class="text-red-400 text-center mt-8">選手が見つかりません</p>';
        panel.classList.add('open');
        return;
    }

    const team = teams.find(t => t.id === p.teamId);
    const teamName = team ? team.name : (p.teamId || 'FA');
    const status = typeof getPlayerStatus === 'function' ? getPlayerStatus(p) : (p.status || '');
    const pastTeams = p.past_teams || [];
    const labels = p.labels || [];

    // Stats for sparkline (ratings over past matches)
    const ratings = (p.matchStats || []).map(s => s.rating || 0).filter(r => r > 0);
    const sparkId = 'detailSparkline_' + Date.now();

    const statusBadge = status === 'FA' ? 'bg-amber-100 text-amber-800' :
                        status === '退団' ? 'bg-red-100 text-red-800' :
                        'bg-emerald-100 text-emerald-700';

    content_el.innerHTML = `
        <div class="mb-4">
            <h2 class="text-xl font-bold text-slate-800">${p.nickname || p.name}</h2>
            <p class="text-sm text-slate-500">PSID: ${p.name || '―'}</p>
            <span class="inline-block mt-1 px-2 py-0.5 rounded-full text-xs font-semibold ${statusBadge}">${status || '在籍'}</span>
        </div>
        <div class="grid grid-cols-2 gap-2 mb-4 text-sm">
            <div class="bg-slate-50 rounded p-2">
                <div class="text-xs text-slate-400">チーム</div>
                <div class="font-semibold">${teamName}</div>
            </div>
            <div class="bg-slate-50 rounded p-2">
                <div class="text-xs text-slate-400">背番号</div>
                <div class="font-semibold">${p.jerseyNumber || '―'}</div>
            </div>
            <div class="bg-slate-50 rounded p-2">
                <div class="text-xs text-slate-400">ゴール</div>
                <div class="font-semibold">${p.goals ?? '―'}</div>
            </div>
            <div class="bg-slate-50 rounded p-2">
                <div class="text-xs text-slate-400">アシスト</div>
                <div class="font-semibold">${p.assists ?? '―'}</div>
            </div>
        </div>
        ${ratings.length >= 2 ? `
        <div class="mb-4">
            <div class="text-xs text-slate-400 mb-1">レーティング推移</div>
            <canvas id="${sparkId}" class="history-sparkline" width="380" height="60"></canvas>
        </div>` : ''}
        ${labels.length > 0 ? `
        <div class="mb-4">
            <div class="text-xs text-slate-400 mb-1">ラベル</div>
            <div class="flex flex-wrap gap-1">
                ${labels.map(l => `<span class="px-2 py-0.5 rounded-full text-xs bg-indigo-100 text-indigo-700">${l}</span>`).join('')}
            </div>
        </div>` : ''}
        ${pastTeams.length > 0 ? `
        <div class="mb-4">
            <div class="text-xs text-slate-400 mb-2">移籍履歴</div>
            <div class="space-y-1">
                ${pastTeams.map(pt => `
                <div class="flex items-center gap-2 text-xs bg-slate-50 rounded p-2">
                    <span class="text-slate-500">${pt.joinDate || '?'} → ${pt.leftDate || '現在'}</span>
                    <span class="font-semibold">${pt.name || '?'}</span>
                    ${pt.joinType ? `<span class="px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded">${pt.joinType}</span>` : ''}
                </div>`).join('')}
            </div>
        </div>` : ''}
        <div class="flex gap-2 mt-4">
            <button onclick="window.openEditModal && window.openEditModal('${p.name || p.psid}')" 
                    class="flex-1 bg-indigo-600 text-white text-xs font-semibold py-2 rounded hover:bg-indigo-700">✏️ 編集</button>
            <button onclick="window.openTransferModal && window.openTransferModal('${p.name || p.psid}')"
                    class="flex-1 bg-emerald-600 text-white text-xs font-semibold py-2 rounded hover:bg-emerald-700">🔄 移籍</button>
        </div>
    `;

    panel.classList.add('open');

    // Render sparkline after DOM update
    if (ratings.length >= 2) {
        setTimeout(() => window.renderSparkline(sparkId, ratings), 50);
    }
};

window.closeDetailPanel = function() {
    const panel = document.getElementById('playerDetailPanel');
    if (panel) panel.classList.remove('open');
};

// ─── Sprint 3: Transfer History CSV Export (P1) ──────────────────────
function exportTransferHistoryCSV() {
    const players = typeof playerMaster !== 'undefined' ? playerMaster : [];
    const teams = typeof teamMaster !== 'undefined' ? teamMaster : [];

    if (players.length === 0) {
        if (typeof showMessage === 'function') showMessage('データがありません', 'error');
        return;
    }

    const BOM = '\uFEFF';
    const NL = '\n';
    const headers = ['PSID', 'ニックネーム', '現チーム', '現ステータス', '過去チーム', '入団日', '退団日', '移籍種別', 'メモ'];
    const rows = [headers];

    players.forEach(p => {
        const currentTeam = teams.find(t => t.id === p.teamId)?.name || (p.teamId || 'FA');
        const status = typeof getPlayerStatus === 'function' ? getPlayerStatus(p) : (p.status || '');
        const pastTeams = p.past_teams || [];

        if (pastTeams.length === 0) {
            rows.push([p.name, p.nickname || '', currentTeam, status, '', p.joinDate || '', '', '', '']);
        } else {
            // Current team row
            rows.push([p.name, p.nickname || '', currentTeam, status, '(現在)', p.joinDate || '', '', '', '']);
            // Past teams
            pastTeams.forEach(pt => {
                rows.push([p.name, p.nickname || '', currentTeam, status, pt.name || '', pt.joinDate || '', pt.leftDate || '', pt.joinType || '', pt.notes || '']);
            });
        }
    });

    const escape = cell => '"' + String(cell == null ? '' : cell).replace(/"/g, '""') + '"';
    const csvContent = BOM + rows.map(r => r.map(escape).join(',')).join(NL);

    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'es_league_transfer_history_' + new Date().toISOString().slice(0, 10) + '.csv';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    setTimeout(() => URL.revokeObjectURL(url), 100);

    if (typeof showMessage === 'function') showMessage('移籍履歴CSVをダウンロードしました', 'success');
}
window.exportTransferHistoryCSV = exportTransferHistoryCSV;

// ─── Sprint 3: URL Hash State Sharing (P2) ───────────────────────────
const _hashState = {
    save() {
        try {
            const state = {
                tab: typeof currentTab !== 'undefined' ? (currentTab || 'teams') : 'teams',
                teams: typeof playerViewSelectedTeams !== 'undefined' ? (playerViewSelectedTeams || []) : [],
                leagues: typeof playerViewSelectedLeagues !== 'undefined' ? (playerViewSelectedLeagues || []) : [],
                q: document.getElementById('playerSearch')?.value || '',
            };
            const hash = btoa(unescape(encodeURIComponent(JSON.stringify(state))));
            const url = new URL(window.location.href);
            url.hash = hash;
            return url.toString();
        } catch(e) { return window.location.href; }
    },
    load() {
        try {
            const hash = window.location.hash.slice(1);
            if (!hash) return;
            const state = JSON.parse(decodeURIComponent(escape(atob(hash))));
            if (state.tab && typeof window.switchTab === 'function') {
                setTimeout(() => window.switchTab(state.tab), 200);
            }
            if (state.q) {
                setTimeout(() => {
                    const el = document.getElementById('playerSearch');
                    if (el) { el.value = state.q; el.dispatchEvent(new Event('input')); }
                }, 300);
            }
        } catch(e) {}
    }
};

window.copyFilterURL = function() {
    const url = _hashState.save();
    navigator.clipboard?.writeText(url).then(() => {
        if (typeof showMessage === 'function') showMessage('フィルターURLをコピーしました', 'success');
    }).catch(() => {
        if (typeof showMessage === 'function') showMessage(url, 'info');
    });
};

// Load state on DOMContentLoaded
document.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
        try { _hashState.load(); } catch(e) {}
        try { window.renderApiKeyPool(); } catch(e) {}
    }, 500);
});

console.log('[v52.182] ✅ Sprint3 JS loaded (API Pool + Batch + Detail Panel + CSV + URL Hash) [BUG-1,2,3 Fixed]');
// ===== v52.178: smartStartSaveProcess (DB反映ボタン常時表示対応) =====
// v52.182 BUG-1 Fix: smartStartSaveProcess
// 旧実装は batchPendingResults (モジュールスコープ) を直接参照していたため ReferenceError
// → window.getBatchPendingResults() / window.getAutoAnalysisQueue() 経由でアクセス
window.smartStartSaveProcess = function() {
    // モジュールスコープの変数にアクセサ経由でアクセス
    const pending = (typeof window.getBatchPendingResults === 'function')
        ? window.getBatchPendingResults()
        : null;
    const queue = (typeof window.getAutoAnalysisQueue === 'function')
        ? window.getAutoAnalysisQueue()
        : null;

    const hasPending = pending && (
        (pending.latest  && pending.latest.length  > 0) ||
        (pending.lifetime && pending.lifetime.length > 0)
    );
    const hasQueueDone = queue && Array.isArray(queue) && queue.some(x => x.status === 'done');

    if (!hasPending && !hasQueueDone) {
        // 未解析時: 警告メッセージを表示
        const showMsg = typeof showMessage === 'function' ? showMessage
                      : typeof window.showMessage === 'function' ? window.showMessage
                      : (m) => alert(m);
        showMsg('⚠️ まだ解析データがありません。先に「解析を開始」してください。', 'error');
        // ボタンを一瞬揺らすアニメーション
        const btn = document.getElementById('batchApplyBtn');
        if (btn) {
            btn.classList.add('shake-anim');
            setTimeout(() => btn.classList.remove('shake-anim'), 600);
        }
        return;
    }
    // 解析データあり → 通常の保存処理へ
    if (typeof window.startSaveProcess === 'function') {
        window.startSaveProcess();
    } else {
        console.error('[v52.182] window.startSaveProcess が未定義です');
    }
};
// ===== v52.178: smartStartSaveProcess 終了 =====

</script>

<!-- ═══════════════════════════════════════════════════════════════
     大会ランキング機能 (v52.182 Phase 4.26 Tournament Ranking)
     ─ openTournamentRanking(leagueId)
     ─ fetchAndSaveRanking(leagueId)
     ─ loadRankingHistory(leagueId)
     ─ renderRankingModal(data, history)
     ─ getTournamentRankingContext()
═══════════════════════════════════════════════════════════════ -->

<!-- 大会ランキング モーダル -->
<div id="tournamentRankingModal" class="fixed inset-0 bg-black/60 z-[9999] hidden flex items-center justify-center p-4">
  <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col">
    <!-- ヘッダー -->
    <div class="flex items-center justify-between px-6 py-4 border-b border-slate-200 dark:border-slate-700 bg-gradient-to-r from-amber-500 to-orange-500 text-white">
      <div>
        <h2 class="text-xl font-bold" id="rankingModalTitle">🏆 大会ランキング</h2>
        <p class="text-sm text-amber-100" id="rankingModalSubtitle">リーグ順位表・個人ランキング</p>
      </div>
      <div class="flex items-center gap-2">
        <button id="rankingFetchBtn" onclick="window.fetchAndSaveRanking()" class="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg text-sm font-bold transition-colors flex items-center gap-1">
          <span id="rankingFetchIcon">🔄</span> データ取得
        </button>
        <button onclick="window.closeTournamentRanking()" class="text-white/80 hover:text-white text-2xl font-light px-2">✕</button>
      </div>
    </div>
    <!-- タブ -->
    <div class="flex border-b border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 overflow-x-auto shrink-0">
      <button onclick="window.switchRankingTab('overall')" id="rtab-overall" class="ranking-tab-btn active px-4 py-3 text-sm font-bold whitespace-nowrap border-b-2 border-amber-500 text-amber-600">📊 総合順位</button>
      <button onclick="window.switchRankingTab('goals')" id="rtab-goals" class="ranking-tab-btn px-4 py-3 text-sm font-bold whitespace-nowrap border-b-2 border-transparent text-slate-500 hover:text-slate-700">⚽ 得点ランク</button>
      <button onclick="window.switchRankingTab('assists')" id="rtab-assists" class="ranking-tab-btn px-4 py-3 text-sm font-bold whitespace-nowrap border-b-2 border-transparent text-slate-500 hover:text-slate-700">🎯 アシストランク</button>
      <button onclick="window.switchRankingTab('cleansheets')" id="rtab-cleansheets" class="ranking-tab-btn px-4 py-3 text-sm font-bold whitespace-nowrap border-b-2 border-transparent text-slate-500 hover:text-slate-700">🧤 無失点ランク</button>
      <button onclick="window.switchRankingTab('trend')" id="rtab-trend" class="ranking-tab-btn px-4 py-3 text-sm font-bold whitespace-nowrap border-b-2 border-transparent text-slate-500 hover:text-slate-700">📈 推移グラフ</button>
      <button onclick="window.switchRankingTab('history')" id="rtab-history" class="ranking-tab-btn px-4 py-3 text-sm font-bold whitespace-nowrap border-b-2 border-transparent text-slate-500 hover:text-slate-700">🗓️ 履歴</button>
    </div>
    <!-- コンテンツ -->
    <div class="flex-1 overflow-y-auto p-6" id="rankingModalContent">
      <div class="text-center text-slate-400 py-12">
        <div class="text-5xl mb-3">🏆</div>
        <p class="font-bold text-lg">大会ランキングを読み込んでいます...</p>
        <p class="text-sm mt-2">「🔄 データ取得」ボタンで最新データを取得できます</p>
      </div>
    </div>
    <!-- フッター: URL + 最終更新 -->
    <div class="px-6 py-3 bg-slate-50 dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700 flex items-center justify-between text-xs text-slate-500">
      <span id="rankingModalUrl" class="font-mono truncate max-w-xs"></span>
      <span id="rankingModalLastUpdated">-</span>
    </div>
  </div>
</div>

<script>
// ═══════════════════════════════════════════════════════════════
// 大会ランキング機能 (v52.179)
// ═══════════════════════════════════════════════════════════════

let currentRankingLeagueId = null;
let currentRankingData = null;
let rankingTrendChart = null;

// DB helper - tournamentRankings ストア
function openRankingDB() {
  return new Promise((resolve, reject) => {
    const req = indexedDB.open('eS_League_DB', 4);
    req.onsuccess = () => resolve(req.result);
    req.onerror = () => reject(req.error);
    req.onupgradeneeded = (e) => {
      const db = e.target.result;
      if (!db.objectStoreNames.contains('tournamentRankings')) {
        const s = db.createObjectStore('tournamentRankings', { keyPath: 'id' });
        s.createIndex('leagueId', 'leagueId', { unique: false });
        s.createIndex('date', 'date', { unique: false });
      }
    };
  });
}

async function saveRankingToDB(rankingData) {
  const db = await openRankingDB();
  return new Promise((resolve, reject) => {
    const tx = db.transaction('tournamentRankings', 'readwrite');
    const store = tx.objectStore('tournamentRankings');
    store.put(rankingData);
    tx.oncomplete = () => resolve();
    tx.onerror = () => reject(tx.error);
  });
}

async function getRankingHistory(leagueId) {
  const db = await openRankingDB();
  return new Promise((resolve, reject) => {
    const tx = db.transaction('tournamentRankings', 'readonly');
    const idx = tx.objectStore('tournamentRankings').index('leagueId');
    const req = idx.getAll(leagueId);
    req.onsuccess = () => resolve((req.result || []).sort((a, b) => new Date(b.date) - new Date(a.date)));
    req.onerror = () => reject(req.error);
  });
}

async function deleteOldRankings(leagueId, keepCount = 30) {
  const history = await getRankingHistory(leagueId);
  if (history.length <= keepCount) return;
  const db = await openRankingDB();
  const toDelete = history.slice(keepCount);
  return new Promise((resolve) => {
    const tx = db.transaction('tournamentRankings', 'readwrite');
    const store = tx.objectStore('tournamentRankings');
    toDelete.forEach(r => store.delete(r.id));
    tx.oncomplete = () => resolve();
  });
}

// 大会ランキングモーダルを開く
window.openTournamentRanking = async function(leagueId) {
  if (!leagueId) { showMessage('リーグIDが不明です', 'error'); return; }
  currentRankingLeagueId = String(leagueId).padStart(4, '0');
  const url = `https://es-league.games/japan/fifa/league/?leagueno=${currentRankingLeagueId}`;
  const modal = document.getElementById('tournamentRankingModal');
  modal.classList.remove('hidden');
  modal.classList.add('flex');

  document.getElementById('rankingModalTitle').textContent = `🏆 大会ランキング (リーグ #${currentRankingLeagueId})`;
  document.getElementById('rankingModalSubtitle').textContent = `leagueno=${currentRankingLeagueId}`;
  document.getElementById('rankingModalUrl').textContent = url;
  document.getElementById('rankingModalLastUpdated').textContent = '読込中...';

  // 保存済みの最新データをまず表示
  try {
    const history = await getRankingHistory(currentRankingLeagueId);
    if (history.length > 0) {
      currentRankingData = history[0];
      window.switchRankingTab('overall');
      document.getElementById('rankingModalLastUpdated').textContent =
        `最終取得: ${currentRankingData.date} ${currentRankingData.fetchedAt ? new Date(currentRankingData.fetchedAt).toLocaleTimeString('ja-JP') : ''}`;
    } else {
      document.getElementById('rankingModalContent').innerHTML = `
        <div class="text-center text-slate-400 py-12">
          <div class="text-5xl mb-3">📭</div>
          <p class="font-bold text-lg">まだデータがありません</p>
          <p class="text-sm mt-2 mb-4">「🔄 データ取得」ボタンで最新のランキングデータを取得してください</p>
          <p class="text-xs text-slate-400 font-mono">${url}</p>
        </div>`;
      document.getElementById('rankingModalLastUpdated').textContent = 'データなし';
    }
  } catch(e) {
    console.error('ランキング読込エラー:', e);
  }
};

window.closeTournamentRanking = function() {
  const modal = document.getElementById('tournamentRankingModal');
  modal.classList.add('hidden');
  modal.classList.remove('flex');
  if (rankingTrendChart) { rankingTrendChart.destroy(); rankingTrendChart = null; }
};

// データ取得 (fetchHtmlWithFallback + Gemini AI 解析)
window.fetchAndSaveRanking = async function() {
  if (!currentRankingLeagueId) return;
  const key = window.getApiKey ? window.getApiKey() : null;
  if (!key) { showMessage('APIキーを設定してください', 'error'); return; }

  const btn = document.getElementById('rankingFetchBtn');
  const icon = document.getElementById('rankingFetchIcon');
  btn.disabled = true;
  icon.textContent = '⏳';
  document.getElementById('rankingModalContent').innerHTML = `
    <div class="text-center py-12">
      <div class="animate-spin text-4xl mb-4">⚙️</div>
      <p class="font-bold text-slate-600 dark:text-slate-300">ランキングデータ取得中...</p>
      <p class="text-sm text-slate-400 mt-2">CORSプロキシ経由でページを取得し、AIで解析します</p>
    </div>`;

  const url = `https://es-league.games/japan/fifa/league/?leagueno=${currentRankingLeagueId}`;
  try {
    // Step 1: HTMLを取得
    document.getElementById('rankingModalContent').innerHTML = `<div class="text-center py-8"><div class="animate-spin text-3xl mb-3">🌐</div><p class="text-sm text-slate-500">Step 1/3: ページHTMLを取得中...</p></div>`;
    const html = await fetchHtmlWithFallback(url, null);

    // Step 2: Gemini AIで解析
    document.getElementById('rankingModalContent').innerHTML = `<div class="text-center py-8"><div class="animate-bounce text-3xl mb-3">🤖</div><p class="text-sm text-slate-500">Step 2/3: AIがランキングデータを解析中...</p></div>`;
    const prompt = `以下はeS-Leagueの大会ページ(leagueno=${currentRankingLeagueId})のHTMLです。
以下のJSONスキーマで全ランキングデータを抽出してください。

{
  "leagueTitle": "大会名",
  "updatedAt": "更新日時文字列",
  "overall": [
    {"rank": 1, "club": "クラブ名", "points": 30, "played": 10, "wins": 9, "draws": 3, "losses": 1, "goalsFor": 25, "goalsAgainst": 8, "goalDiff": 17, "form": "WWWDW"}
  ],
  "goals": [{"rank": 1, "player": "PSID", "club": "クラブ名", "count": 15}],
  "assists": [{"rank": 1, "player": "PSID", "club": "クラブ名", "count": 10}],
  "cleanSheets": [{"rank": 1, "player": "PSID", "club": "クラブ名", "count": 8}]
}

HTMLが不完全な場合は取得できたデータのみ入れてください。JSONのみ返答してください。

HTML:
${html ? html.substring(0, 15000) : '(取得失敗)'}`;

    const payload = {
      contents: [{ parts: [{ text: prompt }] }],
      generationConfig: { temperature: 0.1 }
    };
    const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${key}`, {
      method: 'POST', body: JSON.stringify(payload), headers: { 'Content-Type': 'application/json' }
    });
    const json = await res.json();
    const rawText = json.candidates?.[0]?.content?.parts?.[0]?.text || '{}';

    // JSON抽出
    const jsonMatch = rawText.match(/```json\n?([\s\S]+?)```/) || rawText.match(/({[\s\S]+})/);
    const parsed = JSON.parse(jsonMatch ? jsonMatch[1] : rawText);

    // Step 3: 保存
    document.getElementById('rankingModalContent').innerHTML = `<div class="text-center py-8"><div class="text-3xl mb-3">💾</div><p class="text-sm text-slate-500">Step 3/3: データをIndexedDBに保存中...</p></div>`;
    const now = new Date();
    const dateStr = now.toISOString().slice(0, 10);
    const rankingEntry = {
      id: `${currentRankingLeagueId}_${now.toISOString()}`,
      leagueId: currentRankingLeagueId,
      date: dateStr,
      fetchedAt: now.getTime(),
      leagueTitle: parsed.leagueTitle || `リーグ #${currentRankingLeagueId}`,
      updatedAt: parsed.updatedAt || dateStr,
      overall: parsed.overall || [],
      goals: parsed.goals || [],
      assists: parsed.assists || [],
      cleanSheets: parsed.cleanSheets || []
    };
    await saveRankingToDB(rankingEntry);
    await deleteOldRankings(currentRankingLeagueId, 52); // 最大52週分保持

    currentRankingData = rankingEntry;
    document.getElementById('rankingModalTitle').textContent = `🏆 ${rankingEntry.leagueTitle}`;
    document.getElementById('rankingModalLastUpdated').textContent =
      `最終取得: ${dateStr} ${now.toLocaleTimeString('ja-JP')}`;
    window.switchRankingTab('overall');
    showMessage('ランキングデータを取得・保存しました', 'success');

  } catch(e) {
    console.error('ランキング取得エラー:', e);
    document.getElementById('rankingModalContent').innerHTML = `
      <div class="text-center py-12">
        <div class="text-5xl mb-3">⚠️</div>
        <p class="font-bold text-red-600">データ取得に失敗しました</p>
        <p class="text-sm text-slate-500 mt-2">${e.message}</p>
        <p class="text-xs text-slate-400 mt-3">CORSプロキシが利用できない場合、<br>下の「手動入力」ボタンからJSONを直接貼り付けてください</p>
        <button onclick="window.openManualRankingInput()" class="mt-4 bg-indigo-600 text-white px-6 py-2 rounded-lg text-sm font-bold hover:bg-indigo-700">📋 手動入力</button>
      </div>`;
    showMessage('ランキング取得失敗: ' + e.message, 'error');
  } finally {
    btn.disabled = false;
    icon.textContent = '🔄';
  }
};

// タブ切り替え
window.switchRankingTab = function(tab) {
  document.querySelectorAll('.ranking-tab-btn').forEach(b => {
    b.classList.remove('border-amber-500', 'text-amber-600', 'active');
    b.classList.add('border-transparent', 'text-slate-500');
  });
  const active = document.getElementById(`rtab-${tab}`);
  if (active) {
    active.classList.add('border-amber-500', 'text-amber-600', 'active');
    active.classList.remove('border-transparent', 'text-slate-500');
  }
  if (!currentRankingData) {
    document.getElementById('rankingModalContent').innerHTML = `<div class="text-center py-12 text-slate-400"><p>データを取得してください</p></div>`;
    return;
  }
  const content = document.getElementById('rankingModalContent');
  switch(tab) {
    case 'overall':    content.innerHTML = renderOverallTable(currentRankingData); break;
    case 'goals':      content.innerHTML = renderIndividualRanking(currentRankingData.goals, '⚽ 得点ランキング', '得点', 'goals'); break;
    case 'assists':    content.innerHTML = renderIndividualRanking(currentRankingData.assists, '🎯 アシストランキング', 'アシスト', 'assists'); break;
    case 'cleansheets':content.innerHTML = renderIndividualRanking(currentRankingData.cleanSheets, '🧤 無失点ランキング', '無失点', 'cleanSheets'); break;
    case 'trend':      renderTrendTab(content); break;
    case 'history':    renderHistoryTab(content); break;
  }
};

function renderOverallTable(data) {
  if (!data.overall || data.overall.length === 0) {
    return `<div class="text-center py-8 text-slate-400"><p>総合順位データがありません</p><button onclick="window.fetchAndSaveRanking()" class="mt-3 bg-amber-500 text-white px-4 py-2 rounded-lg text-sm">データ取得</button></div>`;
  }
  const rows = data.overall.map(r => {
    const formHtml = (r.form || '').split('').map(c =>
      c === 'W' ? `<span class="bg-green-500 text-white px-1 py-0.5 rounded text-[10px] font-bold">W</span>` :
      c === 'D' ? `<span class="bg-yellow-400 text-white px-1 py-0.5 rounded text-[10px] font-bold">D</span>` :
      c === 'L' ? `<span class="bg-red-500 text-white px-1 py-0.5 rounded text-[10px] font-bold">L</span>` : ''
    ).join(' ');
    const rankBadge = r.rank <= 3 ?
      ['🥇','🥈','🥉'][r.rank-1] + ` <span class="font-bold">${r.rank}</span>` :
      `<span class="text-slate-500">${r.rank}</span>`;
    return `<tr class="border-b border-slate-100 dark:border-slate-700 hover:bg-amber-50 dark:hover:bg-slate-700 transition-colors">
      <td class="py-2 px-3 text-center">${rankBadge}</td>
      <td class="py-2 px-3 font-bold text-slate-800 dark:text-white">${r.club || '-'}</td>
      <td class="py-2 px-3 text-center font-bold text-indigo-600 text-lg">${r.points ?? '-'}</td>
      <td class="py-2 px-3 text-center text-slate-600">${r.played ?? '-'}</td>
      <td class="py-2 px-3 text-center text-green-600 font-bold">${r.wins ?? '-'}</td>
      <td class="py-2 px-3 text-center text-yellow-600">${r.draws ?? '-'}</td>
      <td class="py-2 px-3 text-center text-red-600">${r.losses ?? '-'}</td>
      <td class="py-2 px-3 text-center">${r.goalsFor ?? '-'}</td>
      <td class="py-2 px-3 text-center">${r.goalsAgainst ?? '-'}</td>
      <td class="py-2 px-3 text-center font-bold ${(r.goalDiff || 0) >= 0 ? 'text-green-600' : 'text-red-600'}">${r.goalDiff !== undefined ? (r.goalDiff >= 0 ? '+' : '') + r.goalDiff : '-'}</td>
      <td class="py-2 px-3 text-center"><div class="flex gap-0.5 justify-center">${formHtml}</div></td>
    </tr>`;
  }).join('');
  return `
    <div class="mb-3 text-xs text-slate-500">更新: ${data.updatedAt || data.date} | 取得: ${data.date}</div>
    <div class="overflow-x-auto rounded-xl border border-slate-200 dark:border-slate-700">
      <table class="w-full text-sm">
        <thead class="bg-slate-100 dark:bg-slate-700">
          <tr>
            <th class="py-2 px-3 text-center text-xs font-bold text-slate-600 dark:text-slate-300">順位</th>
            <th class="py-2 px-3 text-left text-xs font-bold text-slate-600 dark:text-slate-300">クラブ</th>
            <th class="py-2 px-3 text-center text-xs font-bold text-indigo-600">勝点</th>
            <th class="py-2 px-3 text-center text-xs text-slate-500">試合</th>
            <th class="py-2 px-3 text-center text-xs text-green-600">勝</th>
            <th class="py-2 px-3 text-center text-xs text-yellow-600">分</th>
            <th class="py-2 px-3 text-center text-xs text-red-600">敗</th>
            <th class="py-2 px-3 text-center text-xs text-slate-500">得点</th>
            <th class="py-2 px-3 text-center text-xs text-slate-500">失点</th>
            <th class="py-2 px-3 text-center text-xs text-slate-600">得失差</th>
            <th class="py-2 px-3 text-center text-xs text-slate-500">最近5試合</th>
          </tr>
        </thead>
        <tbody>${rows}</tbody>
      </table>
    </div>`;
}

function renderIndividualRanking(rankData, title, label, key) {
  if (!rankData || rankData.length === 0) {
    return `<div class="text-center py-8 text-slate-400"><p>${title} データがありません</p><button onclick="window.fetchAndSaveRanking()" class="mt-3 bg-amber-500 text-white px-4 py-2 rounded-lg text-sm">データ取得</button></div>`;
  }
  const rows = rankData.map(r => {
    const rankBadge = r.rank <= 3 ? ['🥇','🥈','🥉'][r.rank-1] : r.rank;
    const barWidth = rankData[0] ? Math.round(((r.count || 0) / (rankData[0].count || 1)) * 100) : 0;
    // DBの選手データと照合
    const dbPlayer = typeof playerMaster !== 'undefined' ? playerMaster.find(p => p.name === r.player || p.nickname === r.player) : null;
    const dbBadge = dbPlayer ? `<span class="ml-1 text-[9px] bg-green-100 text-green-700 px-1 py-0.5 rounded">DB✓</span>` : '';
    return `<tr class="border-b border-slate-100 dark:border-slate-700 hover:bg-amber-50 dark:hover:bg-slate-700 transition-colors">
      <td class="py-3 px-4 text-center text-lg">${rankBadge}</td>
      <td class="py-3 px-4">
        <div class="font-bold text-slate-800 dark:text-white">${r.player || '-'}${dbBadge}</div>
        <div class="text-xs text-slate-500">${r.club || '-'}</div>
      </td>
      <td class="py-3 px-4 text-center">
        <div class="font-bold text-2xl text-amber-600">${r.count ?? '-'}</div>
        <div class="text-xs text-slate-400">${label}</div>
      </td>
      <td class="py-3 px-4 w-32">
        <div class="bg-slate-200 dark:bg-slate-600 rounded-full h-2">
          <div class="bg-amber-500 h-2 rounded-full transition-all" style="width:${barWidth}%"></div>
        </div>
      </td>
    </tr>`;
  }).join('');
  return `
    <h3 class="text-lg font-bold mb-4 text-slate-700 dark:text-white">${title}</h3>
    <div class="overflow-x-auto rounded-xl border border-slate-200 dark:border-slate-700">
      <table class="w-full">
        <thead class="bg-slate-100 dark:bg-slate-700">
          <tr>
            <th class="py-2 px-4 text-center text-xs text-slate-500">順位</th>
            <th class="py-2 px-4 text-left text-xs text-slate-500">選手 / クラブ</th>
            <th class="py-2 px-4 text-center text-xs text-amber-600">${label}</th>
            <th class="py-2 px-4 text-xs text-slate-400">割合</th>
          </tr>
        </thead>
        <tbody>${rows}</tbody>
      </table>
    </div>`;
}

// 推移グラフタブ
async function renderTrendTab(container) {
  if (!currentRankingLeagueId) return;
  container.innerHTML = `<div class="text-center py-8"><div class="animate-spin text-2xl">⚙️</div><p class="text-sm text-slate-400 mt-2">履歴データ読込中...</p></div>`;
  const history = await getRankingHistory(currentRankingLeagueId);
  if (history.length < 2) {
    container.innerHTML = `<div class="text-center py-12 text-slate-400">
      <div class="text-4xl mb-3">📈</div>
      <p class="font-bold">推移グラフには最低2回のデータ取得が必要です</p>
      <p class="text-sm mt-2">現在: ${history.length}回分のデータ</p>
      <p class="text-xs mt-3 text-slate-300">定期的にデータ取得することで週次・月次の推移が確認できます</p>
    </div>`;
    return;
  }

  // 全クラブを収集
  const allClubs = [...new Set(history.flatMap(h => (h.overall || []).map(r => r.club)))].filter(Boolean);

  container.innerHTML = `
    <div class="mb-4">
      <label class="text-sm font-bold text-slate-600 dark:text-slate-300 mr-2">クラブ選択:</label>
      <select id="trendClubSelect" class="border border-slate-300 rounded-lg px-2 py-1 text-sm" onchange="window.updateTrendChart()">
        ${allClubs.map(c => `<option value="${c}">${c}</option>`).join('')}
      </select>
      <label class="text-sm font-bold text-slate-600 dark:text-slate-300 ml-4 mr-2">指標:</label>
      <select id="trendMetricSelect" class="border border-slate-300 rounded-lg px-2 py-1 text-sm" onchange="window.updateTrendChart()">
        <option value="points">勝点</option>
        <option value="wins">勝利数</option>
        <option value="goalsFor">得点数</option>
        <option value="goalDiff">得失点差</option>
      </select>
    </div>
    <div class="relative h-64 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 p-4">
      <canvas id="rankingTrendCanvas"></canvas>
    </div>
    <p class="text-xs text-slate-400 mt-2 text-center">取得日: ${history.map(h => h.date).join(' | ')}</p>`;

  // 少し待ってからChart描画
  setTimeout(() => window.updateTrendChart(history), 100);
}

window.updateTrendChart = function(historyData) {
  const clubSel = document.getElementById('trendClubSelect');
  const metricSel = document.getElementById('trendMetricSelect');
  if (!clubSel || !metricSel) return;
  const club = clubSel.value;
  const metric = metricSel.value;

  getRankingHistory(currentRankingLeagueId).then(history => {
    if (!history.length) return;
    const reversed = [...history].reverse(); // 古い順
    const labels = reversed.map(h => h.date);
    const values = reversed.map(h => {
      const row = (h.overall || []).find(r => r.club === club);
      return row ? (row[metric] ?? null) : null;
    });

    const canvas = document.getElementById('rankingTrendCanvas');
    if (!canvas) return;
    if (rankingTrendChart) { rankingTrendChart.destroy(); }
    rankingTrendChart = new Chart(canvas, {
      type: 'line',
      data: {
        labels,
        datasets: [{
          label: `${club} - ${metric}`,
          data: values,
          borderColor: '#f59e0b',
          backgroundColor: 'rgba(245,158,11,0.1)',
          borderWidth: 2,
          pointBackgroundColor: '#f59e0b',
          pointRadius: 5,
          fill: true,
          tension: 0.3
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: {
          y: { beginAtZero: false, grid: { color: 'rgba(0,0,0,0.05)' } },
          x: { grid: { display: false } }
        }
      }
    });
  });
};

// 履歴タブ
async function renderHistoryTab(container) {
  if (!currentRankingLeagueId) return;
  const history = await getRankingHistory(currentRankingLeagueId);
  if (history.length === 0) {
    container.innerHTML = `<div class="text-center py-12 text-slate-400"><div class="text-4xl mb-3">🗓️</div><p>保存された履歴がありません</p></div>`;
    return;
  }
  const rows = history.map(h => `
    <tr class="border-b border-slate-100 hover:bg-slate-50 cursor-pointer transition-colors" onclick="window.loadHistorySnapshot('${h.id}')">
      <td class="py-3 px-4 font-mono text-sm font-bold text-indigo-600">${h.date}</td>
      <td class="py-3 px-4 text-sm text-slate-700">${h.leagueTitle || '-'}</td>
      <td class="py-3 px-4 text-center text-sm">${(h.overall || []).length}チーム</td>
      <td class="py-3 px-4 text-center text-sm">${(h.goals || []).length}件</td>
      <td class="py-3 px-4 text-xs text-slate-400 font-mono">${h.fetchedAt ? new Date(h.fetchedAt).toLocaleString('ja-JP') : '-'}</td>
      <td class="py-3 px-4 text-center">
        <button onclick="event.stopPropagation();window.deleteRankingSnapshot('${h.id}')" class="text-red-400 hover:text-red-600 text-xs px-2 py-1 rounded hover:bg-red-50 transition-colors">🗑️</button>
      </td>
    </tr>`).join('');
  container.innerHTML = `
    <div class="flex justify-between items-center mb-4">
      <h3 class="font-bold text-slate-700 dark:text-white">📦 保存済みスナップショット (${history.length}件)</h3>
      <button onclick="window.exportRankingHistory()" class="bg-slate-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-slate-700">📤 JSON出力</button>
    </div>
    <div class="overflow-x-auto rounded-xl border border-slate-200 dark:border-slate-700">
      <table class="w-full text-sm">
        <thead class="bg-slate-100">
          <tr>
            <th class="py-2 px-4 text-left text-xs text-slate-500">日付</th>
            <th class="py-2 px-4 text-left text-xs text-slate-500">大会名</th>
            <th class="py-2 px-4 text-center text-xs text-slate-500">総合</th>
            <th class="py-2 px-4 text-center text-xs text-slate-500">得点</th>
            <th class="py-2 px-4 text-left text-xs text-slate-500">取得時刻</th>
            <th class="py-2 px-4 text-center text-xs text-slate-500">削除</th>
          </tr>
        </thead>
        <tbody>${rows}</tbody>
      </table>
    </div>
    <p class="text-xs text-slate-400 mt-3">行をクリックするとそのスナップショットを表示します（最大52件保存）</p>`;
}

window.loadHistorySnapshot = async function(snapshotId) {
  const db = await openRankingDB();
  const entry = await new Promise((res, rej) => {
    const tx = db.transaction('tournamentRankings', 'readonly');
    const req = tx.objectStore('tournamentRankings').get(snapshotId);
    req.onsuccess = () => res(req.result);
    req.onerror = () => rej(req.error);
  });
  if (entry) {
    currentRankingData = entry;
    document.getElementById('rankingModalLastUpdated').textContent = `スナップショット: ${entry.date}`;
    window.switchRankingTab('overall');
    showMessage(`${entry.date} のスナップショットを表示`, 'success');
  }
};

window.deleteRankingSnapshot = async function(snapshotId) {
  if (!confirm('このスナップショットを削除しますか？')) return;
  const db = await openRankingDB();
  await new Promise((res, rej) => {
    const tx = db.transaction('tournamentRankings', 'readwrite');
    tx.objectStore('tournamentRankings').delete(snapshotId);
    tx.oncomplete = () => res();
    tx.onerror = () => rej(tx.error);
  });
  showMessage('削除しました', 'success');
  window.switchRankingTab('history');
};

window.exportRankingHistory = async function() {
  if (!currentRankingLeagueId) return;
  const history = await getRankingHistory(currentRankingLeagueId);
  const blob = new Blob([JSON.stringify(history, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = `ranking_${currentRankingLeagueId}_${new Date().toISOString().slice(0,10)}.json`;
  document.body.appendChild(a); a.click(); document.body.removeChild(a);
  setTimeout(() => URL.revokeObjectURL(url), 500);
};

// 手動入力モード (CORSブロック時の代替)
window.openManualRankingInput = function() {
  document.getElementById('rankingModalContent').innerHTML = `
    <div class="space-y-4">
      <div class="bg-blue-50 dark:bg-blue-900/30 rounded-xl p-4 text-sm text-blue-700 dark:text-blue-300">
        <p class="font-bold mb-1">📋 手動入力モード</p>
        <p>大会ページを開き、以下のJSON形式でデータを貼り付けてください。</p>
        <p class="font-mono text-xs mt-2 bg-white/50 p-2 rounded">
          URL: https://es-league.games/japan/fifa/league/?leagueno=${currentRankingLeagueId}
        </p>
      </div>
      <textarea id="manualRankingJson" class="w-full h-64 border border-slate-300 rounded-xl p-3 font-mono text-xs"
        placeholder='{"leagueTitle": "大会名", "overall": [{"rank":1,"club":"FC Example","points":30,...}], "goals": [], "assists": [], "cleanSheets": []}'></textarea>
      <div class="flex gap-2">
        <button onclick="window.saveManualRanking()" class="bg-amber-500 text-white px-6 py-2 rounded-lg font-bold hover:bg-amber-600 flex-1">💾 保存</button>
        <button onclick="window.switchRankingTab('overall')" class="bg-slate-300 text-slate-700 px-4 py-2 rounded-lg hover:bg-slate-400">キャンセル</button>
      </div>
    </div>`;
};

window.saveManualRanking = async function() {
  const json = document.getElementById('manualRankingJson')?.value;
  if (!json) return;
  try {
    const parsed = JSON.parse(json);
    const now = new Date();
    const entry = {
      id: `${currentRankingLeagueId}_${now.toISOString()}`,
      leagueId: currentRankingLeagueId,
      date: now.toISOString().slice(0, 10),
      fetchedAt: now.getTime(),
      leagueTitle: parsed.leagueTitle || `リーグ #${currentRankingLeagueId}`,
      updatedAt: parsed.updatedAt || now.toISOString().slice(0, 10),
      overall: parsed.overall || [],
      goals: parsed.goals || [],
      assists: parsed.assists || [],
      cleanSheets: parsed.cleanSheets || []
    };
    await saveRankingToDB(entry);
    currentRankingData = entry;
    window.switchRankingTab('overall');
    showMessage('手動入力データを保存しました', 'success');
  } catch(e) {
    showMessage('JSONの形式が正しくありません: ' + e.message, 'error');
  }
};

// AIクエリへのコンテキスト提供
window.getTournamentRankingContext = async function() {
  try {
    const db = await openRankingDB();
    // 全リーグの最新データを取得
    const all = await new Promise((res, rej) => {
      const tx = db.transaction('tournamentRankings', 'readonly');
      const req = tx.objectStore('tournamentRankings').getAll();
      req.onsuccess = () => res(req.result || []);
      req.onerror = () => rej(req.error);
    });
    if (all.length === 0) return '';
    // リーグIDごとに最新1件
    const byLeague = {};
    all.forEach(r => {
      if (!byLeague[r.leagueId] || r.fetchedAt > byLeague[r.leagueId].fetchedAt) {
        byLeague[r.leagueId] = r;
      }
    });
    const ctx = Object.values(byLeague).map(r =>
      `【大会ランキング: ${r.leagueTitle} (${r.date})】\n` +
      `総合TOP5: ${(r.overall||[]).slice(0,5).map(x => `${x.rank}.${x.club}(${x.points}pt)`).join(', ')}\n` +
      `得点TOP3: ${(r.goals||[]).slice(0,3).map(x => `${x.player}(${x.count})`).join(', ')}\n` +
      `アシストTOP3: ${(r.assists||[]).slice(0,3).map(x => `${x.player}(${x.count})`).join(', ')}\n` +
      `無失点TOP3: ${(r.cleanSheets||[]).slice(0,3).map(x => `${x.player}(${x.count})`).join(', ')}`
    ).join('\n\n');
    return ctx ? `\n\n【大会ランキングデータ】\n${ctx}` : '';
  } catch(e) {
    console.warn('ランキングコンテキスト取得エラー:', e);
    return '';
  }
};

// ESC キーで閉じる
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape' && !document.getElementById('tournamentRankingModal').classList.contains('hidden')) {
    window.closeTournamentRanking();
  }
});
</script>

</body>
</html>